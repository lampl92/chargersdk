cscope 15 D:\Documents\Projects\chargersdk\build\EmBitz"               0001064153
	@D:\Documents\Projects\chargersdk\build\EmBitz\startup\startup_stm32f429x.S

3 .
syÁax
 
	gunif›d


4 .
¬ch
 
	g¬mv7
-
	gm


6 .
	g£ùiÚ
 .
	g¡ack


7 .
	g®ign
 3

8 #ifdeà
__STACK_SIZE


9 .
equ
 
	gSck_Size
, 
	g__STACK_SIZE


11 .
equ
 
	gSck_Size
, 0xA00

13 .
globl
 
	g__SckTİ


14 .
globl
 
__SckLim™


15 
	g__SckLim™
:

16 .
¥aû
 
Sck_Size


17 .
size
 
__SckLim™
, . - __StackLimit

18 
	g__SckTİ
:

19 .
size
 
__SckTİ
, . - 
	g__SckTİ


21 .
	g£ùiÚ
 .
	gh—p


22 .
	g®ign
 3

23 #ifdeà
__HEAP_SIZE


24 .
equ
 
	gH—p_Size
, 
	g__HEAP_SIZE


26 .
equ
 
	gH—p_Size
, 0xC00

28 .
globl
 
	g__H—pBa£


29 .
globl
 
__H—pLim™


30 
	g__H—pBa£
:

31 .
H—p_Size


32 .
¥aû
 
H—p_Size


33 .
’dif


34 .
size
 
__H—pBa£
, . - __HeapBase

35 
	g__H—pLim™
:

36 .
size
 
__H—pLim™
, . - 
	g__H—pLim™


38 .
	g£ùiÚ
 .
	gi¤_veùÜ


39 .
	g®ign
 2

40 .
globl
 
__i¤_veùÜ


41 
	g__i¤_veùÜ
:

42 .
__SckTİ


43 .
Re£t_HªdËr


44 .
NMI_HªdËr


45 .
H¬dFauÉ_HªdËr


46 .
MemMªage_HªdËr


47 .
BusFauÉ_HªdËr


48 .
U§geFauÉ_HªdËr


53 .
SVC_HªdËr


54 .
DebugMÚ_HªdËr


56 .
P’dSV_HªdËr


57 .
SysTick_HªdËr


61 .
WWDG_IRQHªdËr


62 .
PVD_IRQHªdËr


63 .
TAMP_STAMP_IRQHªdËr


64 .
RTC_WKUP_IRQHªdËr


65 .
FLASH_IRQHªdËr


66 .
RCC_IRQHªdËr


67 .
EXTI0_IRQHªdËr


68 .
EXTI1_IRQHªdËr


69 .
EXTI2_IRQHªdËr


70 .
EXTI3_IRQHªdËr


71 .
EXTI4_IRQHªdËr


72 .
DMA1_SŒ—m0_IRQHªdËr


73 .
DMA1_SŒ—m1_IRQHªdËr


74 .
DMA1_SŒ—m2_IRQHªdËr


75 .
DMA1_SŒ—m3_IRQHªdËr


76 .
DMA1_SŒ—m4_IRQHªdËr


77 .
DMA1_SŒ—m5_IRQHªdËr


78 .
DMA1_SŒ—m6_IRQHªdËr


79 .
ADC_IRQHªdËr


80 .
CAN1_TX_IRQHªdËr


81 .
CAN1_RX0_IRQHªdËr


82 .
CAN1_RX1_IRQHªdËr


83 .
CAN1_SCE_IRQHªdËr


84 .
EXTI9_5_IRQHªdËr


85 .
TIM1_BRK_TIM9_IRQHªdËr


86 .
TIM1_UP_TIM10_IRQHªdËr


87 .
TIM1_TRG_COM_TIM11_IRQHªdËr


88 .
TIM1_CC_IRQHªdËr


89 .
TIM2_IRQHªdËr


90 .
TIM3_IRQHªdËr


91 .
TIM4_IRQHªdËr


92 .
I2C1_EV_IRQHªdËr


93 .
I2C1_ER_IRQHªdËr


94 .
I2C2_EV_IRQHªdËr


95 .
I2C2_ER_IRQHªdËr


96 .
SPI1_IRQHªdËr


97 .
SPI2_IRQHªdËr


98 .
USART1_IRQHªdËr


99 .
USART2_IRQHªdËr


100 .
USART3_IRQHªdËr


101 .
EXTI15_10_IRQHªdËr


102 .
RTC_AÏrm_IRQHªdËr


103 .
OTG_FS_WKUP_IRQHªdËr


104 .
TIM8_BRK_TIM12_IRQHªdËr


105 .
TIM8_UP_TIM13_IRQHªdËr


106 .
TIM8_TRG_COM_TIM14_IRQHªdËr


107 .
TIM8_CC_IRQHªdËr


108 .
DMA1_SŒ—m7_IRQHªdËr


109 .
FMC_IRQHªdËr


110 .
SDIO_IRQHªdËr


111 .
TIM5_IRQHªdËr


112 .
SPI3_IRQHªdËr


113 .
UART4_IRQHªdËr


114 .
UART5_IRQHªdËr


115 .
TIM6_DAC_IRQHªdËr


116 .
TIM7_IRQHªdËr


117 .
DMA2_SŒ—m0_IRQHªdËr


118 .
DMA2_SŒ—m1_IRQHªdËr


119 .
DMA2_SŒ—m2_IRQHªdËr


120 .
DMA2_SŒ—m3_IRQHªdËr


121 .
DMA2_SŒ—m4_IRQHªdËr


122 .
ETH_IRQHªdËr


123 .
ETH_WKUP_IRQHªdËr


124 .
CAN2_TX_IRQHªdËr


125 .
CAN2_RX0_IRQHªdËr


126 .
CAN2_RX1_IRQHªdËr


127 .
CAN2_SCE_IRQHªdËr


128 .
OTG_FS_IRQHªdËr


129 .
DMA2_SŒ—m5_IRQHªdËr


130 .
DMA2_SŒ—m6_IRQHªdËr


131 .
DMA2_SŒ—m7_IRQHªdËr


132 .
USART6_IRQHªdËr


133 .
I2C3_EV_IRQHªdËr


134 .
I2C3_ER_IRQHªdËr


135 .
OTG_HS_EP1_OUT_IRQHªdËr


136 .
OTG_HS_EP1_IN_IRQHªdËr


137 .
OTG_HS_WKUP_IRQHªdËr


138 .
OTG_HS_IRQHªdËr


139 .
DCMI_IRQHªdËr


140 .
CRYP_IRQHªdËr


141 .
HASH_RNG_IRQHªdËr


142 .
FPU_IRQHªdËr


143 .
UART7_IRQHªdËr


144 .
UART8_IRQHªdËr


145 .
SPI4_IRQHªdËr


146 .
SPI5_IRQHªdËr


147 .
SPI6_IRQHªdËr


148 .
SAI1_IRQHªdËr


149 .
LTDC_IRQHªdËr


150 .
LTDC_ER_IRQHªdËr


151 .
DMA2D_IRQHªdËr


153 .
size
 
__i¤_veùÜ
, . - 
	g__i¤_veùÜ


155 .
	g‹xt


156 .
	gthumb


157 .
	gthumb_func


158 .
	g®ign
 2

159 .
globl
 
	gRe£t_HªdËr


160 .
ty³
 
	gRe£t_HªdËr
, %
funùiÚ


161 
	gRe£t_HªdËr
:

169 
ldr
 
r1
, =
__‘ext


170 
ldr
 
r2
, =
__d©a_¡¬t__


171 
ldr
 
r3
, =
__d©a_’d__


177 .
æash_to_¿m_loİ
:

178 
cmp
 
r2
, 
r3


179 
™‰
 
É


180 
ld¾t
 
	gr0
, [
r1
], #4

181 
¡¾t
 
	gr0
, [
r2
], #4

182 
	gbÉ
 .
	gæash_to_¿m_loİ


184 
subs
 
	gr3
, 
r2


185 
	gbË
 .
	gæash_to_¿m_loİ_’d


186 .
	gæash_to_¿m_loİ
:

187 
subs
 
r3
, #4

188 
ldr
 
	gr0
, [
r1
, 
r3
]

189 
¡r
 
	gr0
, [
r2
, 
r3
]

190 
	gbgt
 .
	gæash_to_¿m_loİ


191 .
	gæash_to_¿m_loİ_’d
:

194 #iâdeà
__NO_SYSTEM_INIT


195 
ldr
 
r0
, =
Sy¡emIn™


196 
blx
 
r0


199 
ldr
 
r0
, =
_¡¬t


200 
bx
 
r0


201 .
poŞ


202 .
size
 
Re£t_HªdËr
, . - 
	gRe£t_HªdËr


207 .
	g®ign
 1

208 .
	gthumb_func


209 .
w—k
 
	g_¡¬t


210 .
ty³
 
	g_¡¬t
, %
funùiÚ


211 
	g_¡¬t
:

214 
ldr
 
r1
, = 
__bss_¡¬t__


215 
ldr
 
r2
, = 
__bss_’d__


216 
movs
 
r3
, #0

217 
	gb
 .
	gfl_z”o_bss


218 .
	gloİ_z”o_bss
:

219 
¡r
 
r3
, [
r1
], #4

221 .
	gfl_z”o_bss
:

222 
cmp
 
r1
, 
r2


223 
	gbcc
 .
loİ_z”o_bss


226 
bl
 
maš


227 
	gb
 .

228 .
size
 
	g_¡¬t
, . - _start

233 .
maüo
 
def_œq_hªdËr
 
	ghªdËr_Çme


234 .
	g®ign
 1

235 .
	gthumb_func


236 .
	gw—k
 \
	ghªdËr_Çme


237 .
	gty³
 \
	ghªdËr_Çme
, %
	gfunùiÚ


238 \
	ghªdËr_Çme
 :

239 
b
 .

240 .
size
 \
hªdËr_Çme
, . - \
	ghªdËr_Çme


241 .
’dm


243 
def_œq_hªdËr
 
NMI_HªdËr


244 
def_œq_hªdËr
 
H¬dFauÉ_HªdËr


245 
def_œq_hªdËr
 
MemMªage_HªdËr


246 
def_œq_hªdËr
 
BusFauÉ_HªdËr


247 
def_œq_hªdËr
 
U§geFauÉ_HªdËr


248 
def_œq_hªdËr
 
SVC_HªdËr


249 
def_œq_hªdËr
 
DebugMÚ_HªdËr


250 
def_œq_hªdËr
 
P’dSV_HªdËr


251 
def_œq_hªdËr
 
SysTick_HªdËr


252 
def_œq_hªdËr
 
DeçuÉ_HªdËr


255 
def_œq_hªdËr
 
WWDG_IRQHªdËr


256 
def_œq_hªdËr
 
PVD_IRQHªdËr


257 
def_œq_hªdËr
 
TAMP_STAMP_IRQHªdËr


258 
def_œq_hªdËr
 
RTC_WKUP_IRQHªdËr


259 
def_œq_hªdËr
 
FLASH_IRQHªdËr


260 
def_œq_hªdËr
 
RCC_IRQHªdËr


261 
def_œq_hªdËr
 
EXTI0_IRQHªdËr


262 
def_œq_hªdËr
 
EXTI1_IRQHªdËr


263 
def_œq_hªdËr
 
EXTI2_IRQHªdËr


264 
def_œq_hªdËr
 
EXTI3_IRQHªdËr


265 
def_œq_hªdËr
 
EXTI4_IRQHªdËr


266 
def_œq_hªdËr
 
DMA1_SŒ—m0_IRQHªdËr


267 
def_œq_hªdËr
 
DMA1_SŒ—m1_IRQHªdËr


268 
def_œq_hªdËr
 
DMA1_SŒ—m2_IRQHªdËr


269 
def_œq_hªdËr
 
DMA1_SŒ—m3_IRQHªdËr


270 
def_œq_hªdËr
 
DMA1_SŒ—m4_IRQHªdËr


271 
def_œq_hªdËr
 
DMA1_SŒ—m5_IRQHªdËr


272 
def_œq_hªdËr
 
DMA1_SŒ—m6_IRQHªdËr


273 
def_œq_hªdËr
 
ADC_IRQHªdËr


274 
def_œq_hªdËr
 
CAN1_TX_IRQHªdËr


275 
def_œq_hªdËr
 
CAN1_RX0_IRQHªdËr


276 
def_œq_hªdËr
 
CAN1_RX1_IRQHªdËr


277 
def_œq_hªdËr
 
CAN1_SCE_IRQHªdËr


278 
def_œq_hªdËr
 
EXTI9_5_IRQHªdËr


279 
def_œq_hªdËr
 
TIM1_BRK_TIM9_IRQHªdËr


280 
def_œq_hªdËr
 
TIM1_UP_TIM10_IRQHªdËr


281 
def_œq_hªdËr
 
TIM1_TRG_COM_TIM11_IRQHªdËr


282 
def_œq_hªdËr
 
TIM1_CC_IRQHªdËr


283 
def_œq_hªdËr
 
TIM2_IRQHªdËr


284 
def_œq_hªdËr
 
TIM3_IRQHªdËr


285 
def_œq_hªdËr
 
TIM4_IRQHªdËr


286 
def_œq_hªdËr
 
I2C1_EV_IRQHªdËr


287 
def_œq_hªdËr
 
I2C1_ER_IRQHªdËr


288 
def_œq_hªdËr
 
I2C2_EV_IRQHªdËr


289 
def_œq_hªdËr
 
I2C2_ER_IRQHªdËr


290 
def_œq_hªdËr
 
SPI1_IRQHªdËr


291 
def_œq_hªdËr
 
SPI2_IRQHªdËr


292 
def_œq_hªdËr
 
USART1_IRQHªdËr


293 
def_œq_hªdËr
 
USART2_IRQHªdËr


294 
def_œq_hªdËr
 
USART3_IRQHªdËr


295 
def_œq_hªdËr
 
EXTI15_10_IRQHªdËr


296 
def_œq_hªdËr
 
RTC_AÏrm_IRQHªdËr


297 
def_œq_hªdËr
 
OTG_FS_WKUP_IRQHªdËr


298 
def_œq_hªdËr
 
TIM8_BRK_TIM12_IRQHªdËr


299 
def_œq_hªdËr
 
TIM8_UP_TIM13_IRQHªdËr


300 
def_œq_hªdËr
 
TIM8_TRG_COM_TIM14_IRQHªdËr


301 
def_œq_hªdËr
 
TIM8_CC_IRQHªdËr


302 
def_œq_hªdËr
 
DMA1_SŒ—m7_IRQHªdËr


303 
def_œq_hªdËr
 
FMC_IRQHªdËr


304 
def_œq_hªdËr
 
SDIO_IRQHªdËr


305 
def_œq_hªdËr
 
TIM5_IRQHªdËr


306 
def_œq_hªdËr
 
SPI3_IRQHªdËr


307 
def_œq_hªdËr
 
UART4_IRQHªdËr


308 
def_œq_hªdËr
 
UART5_IRQHªdËr


309 
def_œq_hªdËr
 
TIM6_DAC_IRQHªdËr


310 
def_œq_hªdËr
 
TIM7_IRQHªdËr


311 
def_œq_hªdËr
 
DMA2_SŒ—m0_IRQHªdËr


312 
def_œq_hªdËr
 
DMA2_SŒ—m1_IRQHªdËr


313 
def_œq_hªdËr
 
DMA2_SŒ—m2_IRQHªdËr


314 
def_œq_hªdËr
 
DMA2_SŒ—m3_IRQHªdËr


315 
def_œq_hªdËr
 
DMA2_SŒ—m4_IRQHªdËr


316 
def_œq_hªdËr
 
ETH_IRQHªdËr


317 
def_œq_hªdËr
 
ETH_WKUP_IRQHªdËr


318 
def_œq_hªdËr
 
CAN2_TX_IRQHªdËr


319 
def_œq_hªdËr
 
CAN2_RX0_IRQHªdËr


320 
def_œq_hªdËr
 
CAN2_RX1_IRQHªdËr


321 
def_œq_hªdËr
 
CAN2_SCE_IRQHªdËr


322 
def_œq_hªdËr
 
OTG_FS_IRQHªdËr


323 
def_œq_hªdËr
 
DMA2_SŒ—m5_IRQHªdËr


324 
def_œq_hªdËr
 
DMA2_SŒ—m6_IRQHªdËr


325 
def_œq_hªdËr
 
DMA2_SŒ—m7_IRQHªdËr


326 
def_œq_hªdËr
 
USART6_IRQHªdËr


327 
def_œq_hªdËr
 
I2C3_EV_IRQHªdËr


328 
def_œq_hªdËr
 
I2C3_ER_IRQHªdËr


329 
def_œq_hªdËr
 
OTG_HS_EP1_OUT_IRQHªdËr


330 
def_œq_hªdËr
 
OTG_HS_EP1_IN_IRQHªdËr


331 
def_œq_hªdËr
 
OTG_HS_WKUP_IRQHªdËr


332 
def_œq_hªdËr
 
OTG_HS_IRQHªdËr


333 
def_œq_hªdËr
 
DCMI_IRQHªdËr


334 
def_œq_hªdËr
 
CRYP_IRQHªdËr


335 
def_œq_hªdËr
 
HASH_RNG_IRQHªdËr


336 
def_œq_hªdËr
 
FPU_IRQHªdËr


337 
def_œq_hªdËr
 
UART7_IRQHªdËr


338 
def_œq_hªdËr
 
UART8_IRQHªdËr


339 
def_œq_hªdËr
 
SPI4_IRQHªdËr


340 
def_œq_hªdËr
 
SPI5_IRQHªdËr


341 
def_œq_hªdËr
 
SPI6_IRQHªdËr


342 
def_œq_hªdËr
 
SAI1_IRQHªdËr


343 
def_œq_hªdËr
 
LTDC_IRQHªdËr


344 
def_œq_hªdËr
 
LTDC_ER_IRQHªdËr


345 
def_œq_hªdËr
 
	gDMA2D_IRQHªdËr


347 .
	g’d


	@D:\Documents\Projects\chargersdk\build\EmBitz\version.h

1 #iâdeà
VERSION_H


2 
	#VERSION_H


	)

5 
	#DATE
 "24"

	)

6 
	#MONTH
 "02"

	)

7 
	#YEAR
 "2017"

	)

8 
	#UBUNTU_VERSION_STYLE
 "17.02"

	)

11 
	#STATUS
 "AÍha"

	)

12 
	#STATUS_SHORT
 "a"

	)

15 
	#MAJOR
 1

	)

16 
	#MINOR
 5

	)

17 
	#BUILD
 533

	)

18 
	#REVISION
 2892

	)

21 
	#BUILDS_COUNT
 894

	)

22 
	#RC_FILEVERSION
 1,5,533,2892

	)

23 
	#RC_FILEVERSION_STRING
 "1, 5, 533, 2892\0"

	)

24 
	#FULLVERSION_STRING
 "1.5.533.2892"

	)

27 
	#BUILD_HISTORY
 33

	)

	@D:\Documents\Projects\chargersdk\nand\system\evse_config.xml

1 <?
xml
 
	gv”siÚ
="1.0" 
’codšg
="gb2312" ?>

2 <
CÚfig
>

3 <!-- 
EVSE
ÅäÖÃ -->

4 <
EVSE
>

6 <
SN
>0001</SN>

7 <
ID
>0001</ID>

8 <
Ty³
>
B
</Type>

9 <
TÙ®Pošt
>2</TotalPoint>

11 </
EVSE
>

13 </
CÚfig
>

	@D:\Documents\Projects\chargersdk\nand\system\public_info.xml

1 <?
xml
 
	gv”siÚ
="1.0" 
’codšg
="gb2312"?>

2 <
O³¿tÜInfo
> <!-- »ù´¡ÉèÊ©ÔËĞĞÉÌĞÅÏ¢ -->

3 <!-- ÔËÓªÉÌ
ID
 9×Ö·û -->

4 <
O³¿tÜID
>0001</OperatorID>

6 <
O³¿tÜName
>±±¾©¶¯Á¦Ô´</OperatorName>

8 <
O³¿tÜT–1
>010-83682266</OperatorTel1>

9 <
O³¿tÜT–2
>

10 </
O³¿tÜT–2
>

12 <
O³¿tÜRegAdd»ss
>

14 </
O³¿tÜRegAdd»ss
>

16 <
O³¿tÜNÙe
>

17 
www
.
dpc
.
com
.
ú


18 </
O³¿tÜNÙe
>

19 </
O³¿tÜInfo
>

22 <
StiÚInfo
>

24 <
StiÚID
>0001</StationID>

25 <!-- ÔËĞĞÉÌ
ID
 9×Ö·û-->

26 <
O³¿tÜID
>0001</OperatorID>

28 <
Equm’tOwÃrID
>0001</EquipmentOwnerID>

30 <
StiÚName
>¶¯Á¦Ô´Í£³µ³¡</StationName>

32 <
CouÁryCode
>
CN
</CountryCode>

34 <
A»aCode
>010</AreaCode>

36 <
Add»ss
>

38 </
Add»ss
>

40 <
StiÚT–
>

42 </
StiÚT–
>

44 <
S”viûT–
>

46 </
S”viûT–
>

54 <
StiÚTy³
>

56 </
StiÚTy³
>

62 <
StiÚStus
>

64 </
StiÚStus
>

66 <
P¬kNums
>

68 </
P¬kNums
>

70 <
StiÚLng
>

72 </
StiÚLng
>

74 <
StiÚL©
>

76 </
StiÚL©
>

78 <
S™eGuide
>

80 </
S™eGuide
>

82 <
CÚ¡ruùiÚ
>

84 </
CÚ¡ruùiÚ
>

86 <
Piùu»s
>

87 
h‰p
:

88 </
Piùu»s
>

90 <
	gM©chC¬s
>

92 </
	gM©chC¬s
>

94 <
	gP¬kInfo
>

96 </
	gP¬kInfo
>

98 <
	gBusšessHours
>

100 </
	gBusšessHours
>

102 <
	gEËùric™yF“
>

103 <
	gSegm’tF“
>1.00</SegmentFee>

104 <
	gSegm’tS¹
>01:00</
Segm’tS¹
>

105 <
Segm’tEnd
>03:59</SegmentEnd>

106 </
EËùric™yF“
>

108 <
S”viûF“
>

110 </
S”viûF“
>

112 <
P¬kF“
>

114 </
P¬kF“
>

115 <!-- Ö§¸¶·½Ê½£ºË¢¿¨/ÏßÉÏ/ÏÖ½ğ¡£ÆäÖĞµç×ÓÇ®°üÀà¿¨ÎªË¢¿¨£¬Éí·İ¼øÈ¨¿¨£¬Î¢ĞÅ/Ö§¸¶±¦£¬
APP
ÎªÏßÉÏ -->

116 <
Paym’t
>

118 </
Paym’t
>

120 <
SuµÜtOrd”
>

122 </
SuµÜtOrd”
>

124 <
Rem¬k
>

126 </
Rem¬k
>

127 </
StiÚInfo
>

130 <
Equm’tInfos
>

132 <
Equm’tID
>

134 </
Equm’tID
>

136 <
Mªuçùu»rID
>

138 </
Mªuçùu»rID
>

139 <
Mªuçùu»rName
>

141 </
Mªuçùu»rName
>

143 <
Equm’tMod–
>

144 
AC7kW


145 </
Equm’tMod–
>

147 <
ProduùiÚD©e
>

148 
YYYY
-
MM
-
DD


149 </
ProduùiÚD©e
>

155 <
Equm’tTy³
>

157 </
Equm’tTy³
>

158 <
CÚÃùÜInfos
>

159 </
CÚÃùÜInfos
>

160 <
Equm’tLng
>

161 </
Equm’tLng
>

162 <
Equm’tL©
>

163 </
Equm’tL©
>

164 <
Pow”
>

166 </
Pow”
>

167 <
Equm’tName
>

169 </
Equm’tName
>

170 </
Equm’tInfos
>

172 <
CÚÃùÜInfos
>

174 <
CÚÃùÜID
>

176 </
CÚÃùÜID
>

178 <
CÚÃùÜTy³
>

179 </
CÚÃùÜTy³
>

181 <!-- ¶î¶¨µçÑ¹ÉÏÏŞ µ¥Î»£º
V
 -->

182 <
VŞ©ageUµ”Lim™s
>

184 </
VŞ©ageUµ”Lim™s
>

185 <!-- ¶î¶¨µçÑ¹ÏÂÏŞ µ¥Î»£º
V
 -->

186 <
VŞ©ageLow”Lim™s
>

188 </
VŞ©ageLow”Lim™s
>

189 <!-- ¶î¶¨µçÁ÷ µ¥Î»£º
A
 -->

190 <
Cu¼’t
>

192 </
Cu¼’t
>

193 <!-- ¶î¶¨¹¦ÂÊ µ¥Î»£º
kW
-->

194 <
Pow”
>

196 </
Pow”
>

198 <
P¬kNo
>

199 </
P¬kNo
>

201 <
N©iÚ®Snd¬d
>

203 </
N©iÚ®Snd¬d
>

204 </
CÚÃùÜInfos
>

	@D:\Documents\Projects\chargersdk\src\app\EVSE.c

8 
	~"šşudes.h
"

9 
	~"ev£_glob®s.h
"

10 
	~"u£¾ib_li¡.h
"

11 
	~"š‹rçû.h
"

26 
E¼ÜCode_t
 
	$G‘SN
(*
pvEVSE
)

28 
ušt8_t
 
tmpSN
[
defEVSESNL’gth
];

29 
ušt8_t
 
tmpL’gth
;

30 
E¼ÜCode_t
 
”rcode
;

31 
EVSE_t
 *
pEVSE
;

33 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

34 
”rcode
 = 
ERR_NO
;

35 
	`mem£t
(
tmpSN
, 0, 
defEVSESNL’gth
);

36 
tmpL’gth
 = 0;

43 
pEVSE
->
šfo
.
ucSNL’gth
 = 
tmpL’gth
;

44 
	`memmove
(
pEVSE
->
šfo
.
ucSN
, 
tmpSN
, 
defEVSESNL’gth
);

46  
”rcode
;

47 
	}
}

58 
E¼ÜCode_t
 
	$G‘ID
(*
pvEVSE
)

60 
ušt8_t
 
tmpID
[
defEVSEIDL’gth
];

61 
ušt8_t
 
tmpL’gth
;

62 
E¼ÜCode_t
 
”rcode
;

63 
EVSE_t
 *
pEVSE
;

65 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

66 
”rcode
 = 
ERR_NO
;

67 
	`mem£t
(
tmpID
, 0, 
defEVSEIDL’gth
);

68 
tmpL’gth
 = 0;

76 
pEVSE
->
šfo
.
ucIDL’ght
 = 
tmpL’gth
;

77 
	`memmove
(
pEVSE
->
šfo
.
ucID
, 
tmpID
, 
defEVSEIDL’gth
);

79  
”rcode
;

80 
	}
}

96 
E¼ÜCode_t
 
	$G‘Ty³
(*
pvEVSE
)

98 
ušt8_t
 
tmpTy³
;

99 
E¼ÜCode_t
 
”rcode
;

100 
EVSE_t
 *
pEVSE
;

102 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

103 
tmpTy³
 = 0;

104 
”rcode
 = 
ERR_NO
;

112 
pEVSE
->
šfo
.
ucTy³
 = 
tmpTy³
;

114  
”rcode
;

115 
	}
}

123 
E¼ÜCode_t
 
	$G‘TÙ®Pošt
(*
pvEVSE
)

125 
ušt8_t
 
tmpTÙ®
;

126 
E¼ÜCode_t
 
”rcode
;

127 
EVSE_t
 *
pEVSE
;

129 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

130 
tmpTÙ®
 = 2;

131 
”rcode
 = 
ERR_NO
;

139 
pEVSE
->
šfo
.
ucTÙ®Pošt
 = 
tmpTÙ®
;

141  
”rcode
;

142 
	}
}

153 
E¼ÜCode_t
 
	$G‘LngL©
(*
pvEVSE
)

155 
tmpLng
, 
tmpL©
;

156 
E¼ÜCode_t
 
”rcode
;

157 
EVSE_t
 *
pEVSE
;

159 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

160 
tmpLng
 = 0;

161 
tmpL©
 = 0;

162 
”rcode
 = 
ERR_NO
;

170 
pEVSE
->
šfo
.
dLng
 = 
tmpLng
;

171 
pEVSE
->
šfo
.
dL©
 = 
tmpLng
;

173  
”rcode
;

174 
	}
}

191 
E¼ÜCode_t
 
	$G‘SüamS‹
(*
pvEVSE
)

193 
ušt32_t
 
tmpSüamS‹
;

194 
E¼ÜCode_t
 
”rcode
;

195 
EVSE_t
 *
pEVSE
;

197 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

199 
”rcode
 = 
ERR_NO
;

200 
tmpSüamS‹
 = 0;

208 
pEVSE
->
¡©us
.
ulSüamS‹
 = 
tmpSüamS‹
;

210  
”rcode
;

211 
	}
}

222 
E¼ÜCode_t
 
	$G‘KnockS‹
(*
pvEVSE
)

224 
ušt32_t
 
tmpKnockS‹
;

225 
E¼ÜCode_t
 
”rcode
;

226 
EVSE_t
 *
pEVSE
;

228 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

229 
”rcode
 = 
ERR_NO
;

230 
tmpKnockS‹
 = 0;

238 
pEVSE
->
¡©us
.
ulKnockS‹
 = 
tmpKnockS‹
;

240  
”rcode
;

241 
	}
}

252 
E¼ÜCode_t
 
	$G‘PES‹
(*
pvEVSE
)

254 
ušt32_t
 
tmpPES‹
;

255 
E¼ÜCode_t
 
”rcode
;

256 
EVSE_t
 *
pEVSE
;

258 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

259 
”rcode
 = 
ERR_NO
;

260 
tmpPES‹
 = 0;

268 
pEVSE
->
¡©us
.
ulPES‹
 = 
tmpPES‹
;

270  
”rcode
;

271 
	}
}

282 
E¼ÜCode_t
 
	$G‘Pow”OffS‹
(*
pvEVSE
)

284 
ušt32_t
 
tmpOffS‹
;

285 
E¼ÜCode_t
 
”rcode
;

286 
EVSE_t
 *
pEVSE
;

288 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

289 
”rcode
 = 
ERR_NO
;

290 
tmpOffS‹
 = 0;

298 
pEVSE
->
¡©us
.
ulPow”OffS‹
 = 
tmpOffS‹
;

300  
”rcode
;

301 
	}
}

313 
E¼ÜCode_t
 
	$G‘A¼e¡”S‹
(*
pvEVSE
)

315 
ušt32_t
 
tmpA¼e¡”S‹
;

316 
E¼ÜCode_t
 
”rcode
;

317 
EVSE_t
 *
pEVSE
;

319 
pEVSE
 = (
EVSE_t
 *)
pvEVSE
;

320 
”rcode
 = 
ERR_NO
;

321 
tmpA¼e¡”S‹
 = 0;

322 
pEVSE
->
¡©us
.
ulA¼e¡”S‹
 = 
tmpA¼e¡”S‹
;

323  
”rcode
;

324 
	}
}

326 
EVSE_t
 *
	$EVSEC»©e
()

328 
EVSE_t
 *
pEVSE
;

329 
pEVSE
 = (
EVSE_t
 *)
	`m®loc
((EVSE_t));

331 
	`mem£t
(
pEVSE
->
šfo
.
ucSN
, 0, 
defEVSESNL’gth
);

332 
	`mem£t
(
pEVSE
->
šfo
.
ucID
, 0, 
defEVSEIDL’gth
);

333 
pEVSE
->
šfo
.
ucTy³
 = 2;

334 
pEVSE
->
šfo
.
ucTÙ®Pošt
 = 2;

335 
pEVSE
->
šfo
.
dLng
 = 116.275833;

336 
pEVSE
->
šfo
.
dL©
 = 39.831944;

338 
pEVSE
->
šfo
.
G‘SN
 = GetSN;

339 
pEVSE
->
šfo
.
G‘ID
 = GetID;

340 
pEVSE
->
šfo
.
G‘Ty³
 = GetType;

341 
pEVSE
->
šfo
.
G‘TÙ®Pošt
 = GetTotalPoint;

342 
pEVSE
->
šfo
.
G‘LngL©
 = GetLngLat;

344 
pEVSE
->
¡©us
.
ulA¼e¡”S‹
 = 0;

345 
pEVSE
->
¡©us
.
ulKnockS‹
 = 0;

346 
pEVSE
->
¡©us
.
ulPES‹
 = 0;

347 
pEVSE
->
¡©us
.
ulPow”OffS‹
 = 0;

348 
pEVSE
->
¡©us
.
ulSüamS‹
 = 0;

350 
pEVSE
->
¡©us
.
G‘A¼e¡”S‹
 = GetArresterState;

351 
pEVSE
->
¡©us
.
G‘KnockS‹
 = GetKnockState;

352 
pEVSE
->
¡©us
.
G‘PES‹
 = GetPEState;

353 
pEVSE
->
¡©us
.
G‘Pow”OffS‹
 = GetPowerOffState;

354 
pEVSE
->
¡©us
.
G‘SüamS‹
 = GetScramState;

356  
pEVSE
;

357 
	}
}

359 
	$Ch¬gePoštIn™
()

361 
Ch¬gePošt_t
 *
pch¬g•ošt
[2];

363 
pLi¡Ch¬gePošt
 = 
	`U£rLi¡C»©e
();

364 
i
;

365 
i
 = 0; i < 
pEVSE
->
šfo
.
ucTÙ®Pošt
; i++)

367 
pch¬g•ošt
[
i
] = 
	`Ch¬gePoštC»©e
(i);

369 
	`THROW_ERROR
(
i
, 
pch¬g•ošt
[i]->
šfo
.
	`G‘CÚÃùÜTy³
Õch¬g•ošt[i]), 
ERR_LEVEL_WARNING
);

370 
	`THROW_ERROR
(
i
, 
pch¬g•ošt
[i]->
šfo
.
	`G‘VŞ©ageUµ”Lim™s
Õch¬g•ošt[i]), 
ERR_LEVEL_WARNING
);

371 
	`THROW_ERROR
(
i
, 
pch¬g•ošt
[i]->
šfo
.
	`G‘VŞ©ageLow”Lim™s
Õch¬g•ošt[i]), 
ERR_LEVEL_WARNING
);

372 
	`THROW_ERROR
(
i
, 
pch¬g•ošt
[i]->
šfo
.
	`G‘R©edCu¼’t
Õch¬g•ošt[i]), 
ERR_LEVEL_WARNING
);

373 
	`THROW_ERROR
(
i
, 
pch¬g•ošt
[i]->
šfo
.
	`G‘R©edPow”
Õch¬g•ošt[i]), 
ERR_LEVEL_WARNING
);

375 
pLi¡Ch¬gePošt
->
	`Add
ÕLi¡Ch¬gePošt, 
pch¬g•ošt
[
i
]);

377 
	}
}

378 
	$EVSEš™
()

380 
pEVSE
 = 
	`EVSEC»©e
();

382 
	`THROW_ERROR
(
defDevID_FILE
, 
pEVSE
->
šfo
.
	`G‘SN
ÕEVSE), 
ERR_LEVEL_WARNING
);

383 
	`THROW_ERROR
(
defDevID_FILE
, 
pEVSE
->
šfo
.
	`G‘ID
ÕEVSE), 
ERR_LEVEL_WARNING
);

384 
	`THROW_ERROR
(
defDevID_FILE
, 
pEVSE
->
šfo
.
	`G‘Ty³
ÕEVSE), 
ERR_LEVEL_WARNING
);

385 
	`THROW_ERROR
(
defDevID_FILE
, 
pEVSE
->
šfo
.
	`G‘TÙ®Pošt
ÕEVSE), 
ERR_LEVEL_WARNING
);

386 
	`THROW_ERROR
(
defDevID_FILE
, 
pEVSE
->
šfo
.
	`G‘LngL©
ÕEVSE), 
ERR_LEVEL_WARNING
);

388 
	`Ch¬gePoštIn™
();

390 
pRFIDDev
 = 
	`RFIDDevC»©e
();

391 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\EVSE.h

8 #iâdeà 
__EVSE_H


9 
	#__EVSE_H


	)

11 
	~"¡m32f4xx.h
"

12 
	~"ev£_cÚfig.h
"

13 
	~"”rÜcode.h
"

15 
	$E¼ÜCode_t
 (*
	tpEVSE_á
)(*
	tpvEVSE
);

17 
	s_EVSEInfo


19 
ušt8_t
 
ucSN
[
defEVSESNL’gth
];

20 
ušt8_t
 
ucSNL’gth
;

21 
ušt8_t
 
ucID
[
defEVSEIDL’gth
];

22 
ušt8_t
 
ucIDL’ght
;

23 
ušt8_t
 
ucTy³
;

24 
ušt8_t
 
ucTÙ®Pošt
;

25 
dLng
;

26 
dL©
;

28 
pEVSE_á
 
G‘SN
;

29 
pEVSE_á
 
G‘ID
;

30 
pEVSE_á
 
G‘Ty³
;

31 
pEVSE_á
 
G‘TÙ®Pošt
;

32 
pEVSE_á
 
G‘LngL©
;

33 }
	tEVSEInfo_t
;

35 
	s_EVSEStus


37 
ušt32_t
 
ulSüamS‹
;

38 
ušt32_t
 
ulKnockS‹
;

39 
ušt32_t
 
ulPES‹
;

40 
ušt32_t
 
ulPow”OffS‹
;

41 
ušt32_t
 
ulA¼e¡”S‹
;

43 
pEVSE_á
 
G‘SüamS‹
;

44 
pEVSE_á
 
G‘KnockS‹
;

45 
pEVSE_á
 
G‘PES‹
;

46 
pEVSE_á
 
G‘Pow”OffS‹
;

47 
pEVSE_á
 
G‘A¼e¡”S‹
;

48 }
	tEVSEStus_t
;

50 
	s_EVSE


52 
EVSEInfo_t
 
šfo
;

53 
EVSEStus_t
 
¡©us
;

54 }
	tEVSE_t
;

56 
EVSE_t
 *
	`EVSEC»©e
();

57 
	`EVSEš™
();

	@D:\Documents\Projects\chargersdk\src\app\chargepoint.c

8 
	~<¡dlib.h
>

9 
	~<¡ršg.h
>

10 
	~"ev£_glob®s.h
"

11 
	~"ch¬g•ošt.h
"

19 
E¼ÜCode_t
 
	$G‘CÚÃùÜTy³
(*
pvPošt
)

21 
Ch¬gePošt_t
 *
pPošt
;

22 
ušt8_t
 
ucPoštID
;

23 
ušt8_t
 
tmpTy³
;

24 
E¼ÜCode_t
 
”rcode
;

26 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

27 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

28 
tmpTy³
 = 
defCÚÃùÜTy³B
;

29 
”rcode
 = 
ERR_NO
;

37 
pPošt
->
šfo
.
ucCÚÃùÜTy³
 = 
tmpTy³
;

39  
”rcode
;

40 
	}
}

41 
E¼ÜCode_t
 
	$G‘VŞ©ageUµ”Lim™s
(*
pvPošt
)

43 
Ch¬gePošt_t
 *
pPošt
;

44 
ušt8_t
 
ucPoštID
;

45 
tmpVŞtUpLim
;

46 
E¼ÜCode_t
 
”rcode
;

48 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

49 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

50 
tmpVŞtUpLim
 = 250;

51 
”rcode
 = 
ERR_NO
;

59 
pPošt
->
šfo
.
dVŞ©ageUµ”Lim™s
 = 
tmpVŞtUpLim
;

61  
”rcode
;

62 
	}
}

63 
E¼ÜCode_t
 
	$G‘VŞ©ageLow”Lim™s
(*
pvPošt
)

65 
Ch¬gePošt_t
 *
pPošt
;

66 
ušt8_t
 
ucPoštID
;

67 
tmpVŞtLowLim
;

68 
E¼ÜCode_t
 
”rcode
;

70 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

71 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

72 
tmpVŞtLowLim
 = 190;

73 
”rcode
 = 
ERR_NO
;

81 
pPošt
->
šfo
.
dVŞ©ageLow”Lim™s
 = 
tmpVŞtLowLim
;

83  
”rcode
;

84 
	}
}

85 
E¼ÜCode_t
 
	$G‘ACTempUµ”Lim™s
(*
pvPošt
)

87 
Ch¬gePošt_t
 *
pPošt
;

88 
ušt8_t
 
ucPoštID
;

89 
tmpACTempUµ”Lim
;

90 
E¼ÜCode_t
 
”rcode
;

92 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

93 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

94 
tmpACTempUµ”Lim
 = 105;

95 
”rcode
 = 
ERR_NO
;

103 
pPošt
->
šfo
.
dACTempUµ”Lim™s
 = 
tmpACTempUµ”Lim
;

105  
”rcode
;

106 
	}
}

107 
E¼ÜCode_t
 
	$G‘ACTempLow”Lim™s
(*
pvPošt
)

109 
Ch¬gePošt_t
 *
pPošt
;

110 
ušt8_t
 
ucPoštID
;

111 
tmpACTempLow”Lim
;

112 
E¼ÜCode_t
 
”rcode
;

114 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

115 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

116 
tmpACTempLow”Lim
 = -40;

117 
”rcode
 = 
ERR_NO
;

125 
pPošt
->
šfo
.
dACTempLow”Lim™s
 = 
tmpACTempLow”Lim
;

127  
”rcode
;

128 
	}
}

129 
E¼ÜCode_t
 
	$G‘CÚÃùÜTempUµ”Lim™s
(*
pvPošt
)

131 
Ch¬gePošt_t
 *
pPošt
;

132 
ušt8_t
 
ucPoštID
;

133 
tmpCÚÃùÜTempUµ”Lim
;

134 
E¼ÜCode_t
 
”rcode
;

136 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

137 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

138 
tmpCÚÃùÜTempUµ”Lim
 = 105;

139 
”rcode
 = 
ERR_NO
;

147 
pPošt
->
šfo
.
dCÚÃùÜTempUµ”Lim™s
 = 
tmpCÚÃùÜTempUµ”Lim
;

149  
”rcode
;

150 
	}
}

151 
E¼ÜCode_t
 
	$G‘CÚÃùÜTempLow”Lim™s
(*
pvPošt
)

153 
Ch¬gePošt_t
 *
pPošt
;

154 
ušt8_t
 
ucPoštID
;

155 
tmpCÚÃùÜTempLow”Lim
;

156 
E¼ÜCode_t
 
”rcode
;

158 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

159 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

160 
tmpCÚÃùÜTempLow”Lim
 = -40;

161 
”rcode
 = 
ERR_NO
;

169 
pPošt
->
šfo
.
dCÚÃùÜTempLow”Lim™s
 = 
tmpCÚÃùÜTempLow”Lim
;

171  
”rcode
;

172 
	}
}

173 
E¼ÜCode_t
 
	$G‘R©edCu¼’t
(*
pvPošt
)

175 
Ch¬gePošt_t
 *
pPošt
;

176 
ušt8_t
 
ucPoštID
;

177 
tmpCu¼
;

178 
E¼ÜCode_t
 
”rcode
;

180 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

181 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

182 
tmpCu¼
 = 32;

183 
”rcode
 = 
ERR_NO
;

191 
pPošt
->
šfo
.
dR©edCu¼’t
 = 
tmpCu¼
;

193  
”rcode
;

194 
	}
}

195 
E¼ÜCode_t
 
	$G‘R©edPow”
(*
pvPošt
)

197 
Ch¬gePošt_t
 *
pPošt
;

198 
ušt8_t
 
ucPoštID
;

199 
tmpPow
;

200 
E¼ÜCode_t
 
”rcode
;

202 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

203 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

204 
tmpPow
 = 7;

205 
”rcode
 = 
ERR_NO
;

213 
pPošt
->
šfo
.
dR©edPow”
 = 
tmpPow
;

215  
”rcode
;

216 
	}
}

233 
E¼ÜCode_t
 
	$G‘Ch¬gšgVŞge
(*
pvPošt
)

235 
Ch¬gePošt_t
 *
pPošt
;

236 
ušt8_t
 
ucPoštID
;

237 
tmpVŞt
;

238 
E¼ÜCode_t
 
”rcode
;

240 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

241 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

242 
tmpVŞt
 = 0;

243 
”rcode
 = 
ERR_NO
;

251 
pPošt
->
¡©us
.
dCh¬gšgVŞge
 = 
tmpVŞt
;

253  
”rcode
;

254 
	}
}

264 
E¼ÜCode_t
 
	$G‘Ch¬gšgCu¼’t
(*
pvPošt
)

266 
Ch¬gePošt_t
 *
pPošt
;

267 
ušt8_t
 
ucPoštID
;

268 
tmpCu¼
;

269 
E¼ÜCode_t
 
”rcode
;

271 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

272 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

273 
tmpCu¼
 = 0;

274 
”rcode
 = 
ERR_NO
;

282 
pPošt
->
¡©us
.
dCh¬gšgCu¼’t
 = 
tmpCu¼
;

284  
”rcode
;

285 
	}
}

295 
E¼ÜCode_t
 
	$G‘Ch¬gšgF»qu’û
(*
pvPošt
)

297 
Ch¬gePošt_t
 *
pPošt
;

298 
ušt8_t
 
ucPoštID
;

299 
tmpF»q
;

300 
E¼ÜCode_t
 
”rcode
;

302 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

303 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

304 
tmpF»q
 = 0;

305 
”rcode
 = 
ERR_NO
;

313 
pPošt
->
¡©us
.
dCh¬gšgF»qu’û
 = 
tmpF»q
;

315  
”rcode
;

316 
	}
}

326 
E¼ÜCode_t
 
	$G‘CPS‹
(*
pvPošt
)

328 
Ch¬gePošt_t
 *
pPošt
;

329 
ušt8_t
 
ucPoštID
;

330 
Ch¬gePoštS‹Ty³
 
tmpCPS‹
;

331 
E¼ÜCode_t
 
”rcode
;

333 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

334 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

335 
tmpCPS‹
 = 
CP_12V
;

336 
”rcode
 = 
ERR_NO
;

344 
pPošt
->
¡©us
.
xCPS‹
 = 
tmpCPS‹
;

346  
”rcode
;

347 
	}
}

355 
E¼ÜCode_t
 
	$S‘CPSw™ch
(*
pvPošt
, 
ušt8_t
 
cmd
)

357 
Ch¬gePošt_t
 *
pPošt
;

358 
ušt8_t
 
ucPoštID
;

359 
E¼ÜCode_t
 
”rcode
;

361 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

362 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

363 
”rcode
 = 
ERR_NO
;

371  
”rcode
;

372 
	}
}

382 
E¼ÜCode_t
 
	$S‘LßdP”ûÁ
(*
pvPošt
, 
ušt8_t
 
ucLßdP”ûÁ
)

384 
Ch¬gePošt_t
 *
pPošt
;

385 
ušt8_t
 
ucPoštID
;
	`S‘CPSw™ch
(*
pvPošt
, ušt8_ˆ
cmd
)

386 
ušt8_t
 
tmpCPPWM
;

387 
E¼ÜCode_t
 
”rcode
;

389 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

390 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

391 
tmpCPPWM
 = 53;

392 
”rcode
 = 
ERR_NO
;

400 
pPošt
->
¡©us
.
ucLßdP”ûÁ
 = ucLoadPercent;

402  
”rcode
;

403 
	}
}

412 
E¼ÜCode_t
 
	$G‘CCS‹
(*
pvPošt
)

414 
Ch¬gePošt_t
 *
pPošt
;

415 
ušt8_t
 
ucPoštID
;

416 
Ch¬gePoštS‹Ty³
 
tmpCCS‹
;

417 
E¼ÜCode_t
 
”rcode
;

419 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

420 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

421 
tmpCCS‹
 = 
CC_NO
;

422 
”rcode
 = 
ERR_NO
;

430 
pPošt
->
¡©us
.
xCCS‹
 = 
tmpCCS‹
;

432  
”rcode
;

433 
	}
}

443 
E¼ÜCode_t
 
	$G‘PlugS‹
(*
pvPošt
)

445 
Ch¬gePošt_t
 *
pPošt
;

446 
ušt8_t
 
ucPoštID
;

447 
ušt32_t
 
tmpPlugS‹
;

448 
E¼ÜCode_t
 
”rcode
;

450 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

451 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

452 
tmpPlugS‹
 = 
UNPLUG
;

453 
”rcode
 = 
ERR_NO
;

457 if(
pPošt
->
šfo
.
ucCÚÃùÜTy³
 =ğ
defCÚÃùÜTy³B
)

459 
	`THROW_ERROR
(
ucPoštID
, 
	`G‘CCS‹
(
pvPošt
), 
ERR_LEVEL_CRITICAL
);

460 
	`THROW_ERROR
(
ucPoštID
, 
	`G‘CPS‹
(
pvPošt
), 
ERR_LEVEL_CRITICAL
);

461 if(
pPošt
->
¡©us
.
xCCS‹
 =ğ
CC_PE
 &&…Pošt->¡©us.
xCPS‹
 !ğ
CP_12V
 &&…Pošt->¡©us.xCPS‹ !ğ
CP_ERR
)

463 
tmpPlugS‹
 = 
PLUG
;

466 if(
pPošt
->
šfo
.
ucCÚÃùÜTy³
 =ğ
defCÚÃùÜTy³C
)

468 
	`THROW_ERROR
(
ucPoštID
, 
	`G‘CPS‹
(
pvPošt
), 
ERR_LEVEL_CRITICAL
);

469 if(
pPošt
->
¡©us
.
xCPS‹
 !ğ
CP_12V
 &&…Pošt->¡©us.xCPS‹ !ğ
CP_ERR
)

471 
tmpPlugS‹
 = 
PLUG
;

477 
pPošt
->
¡©us
.
xPlugS‹
 = 
tmpPlugS‹
;

479  
”rcode
;

480 
	}
}

490 
E¼ÜCode_t
 
	$G‘BTy³CÚÃùÜLock
(*
pvPošt
)

492 
Ch¬gePošt_t
 *
pPošt
;

493 
ušt8_t
 
ucPoštID
;

494 
Ch¬gePoštS‹Ty³
 
tmpLockS‹
;

495 
E¼ÜCode_t
 
”rcode
;

497 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

498 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

499 
tmpLockS‹
 = 
LOCK
;

500 
”rcode
 = 
ERR_NO
;

509 
pPošt
->
¡©us
.
xBTy³CÚÃùÜLockS‹
 = 
tmpLockS‹
;

511  
”rcode
;

512 
	}
}

523 
E¼ÜCode_t
 
	$S‘BTy³CÚÃùÜLock
(*
pvPošt
, 
ušt8_t
 
cmd
)

525 
Ch¬gePošt_t
 *
pPošt
;

526 
ušt8_t
 
ucPoštID
;

527 
Ch¬gePoštS‹Ty³
 
tmpLockS‹
;

528 
E¼ÜCode_t
 
”rcode
;

530 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

531 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

532 
tmpLockS‹
 = 
UNLOCK
;

533 
”rcode
 = 
ERR_NO
;

535 if(
pPošt
->
¡©us
.
xBTy³CÚÃùÜLockS‹
 =ğ
UNLOCK
)

544 
	`THROW_ERROR
(
pPošt
->
šfo
.
ucCh¬gePoštID
, 
	`G‘BTy³CÚÃùÜLock
ÕPošt), 
ERR_LEVEL_WARNING
);

546  
”rcode
;

547 
	}
}

557 
E¼ÜCode_t
 
	$G‘ACLTemp
(*
pvPošt
)

559 
Ch¬gePošt_t
 *
pPošt
;

560 
ušt8_t
 
ucPoštID
;

561 
tmpACLTemp
;

562 
E¼ÜCode_t
 
”rcode
;

564 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

565 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

566 
tmpACLTemp
 = 0;

567 
”rcode
 = 
ERR_NO
;

575 
pPošt
->
¡©us
.
dACLTemp
 = 
tmpACLTemp
;

577  
”rcode
;

578 
	}
}

587 
E¼ÜCode_t
 
	$G‘ACNTemp
(*
pvPošt
)

589 
Ch¬gePošt_t
 *
pPošt
;

590 
ušt8_t
 
ucPoštID
;

591 
tmpACNTemp
;

592 
E¼ÜCode_t
 
”rcode
;

594 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

595 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

596 
tmpACNTemp
 = 0;

597 
”rcode
 = 
ERR_NO
;

605 
pPošt
->
¡©us
.
dACNTemp
 = 
tmpACNTemp
;

607  
”rcode
;

608 
	}
}

617 
E¼ÜCode_t
 
	$G‘BTy³CÚÃùÜTemp1
(*
pvPošt
)

619 
Ch¬gePošt_t
 *
pPošt
;

620 
ušt8_t
 
ucPoštID
;

621 
tmpTemp
;

622 
E¼ÜCode_t
 
”rcode
;

624 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

625 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

626 
tmpTemp
 = 0;

627 
”rcode
 = 
ERR_NO
;

635 
pPošt
->
¡©us
.
dBTy³CÚÃùÜTemp1
 = 
tmpTemp
;

637  
”rcode
;

638 
	}
}

646 
E¼ÜCode_t
 
	$G‘BTy³CÚÃùÜTemp2
(*
pvPošt
)

648 
Ch¬gePošt_t
 *
pPošt
;

649 
ušt8_t
 
ucPoštID
;

650 
tmpTemp
;

651 
E¼ÜCode_t
 
”rcode
;

653 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

654 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

655 
tmpTemp
 = 0;

656 
”rcode
 = 
ERR_NO
;

664 
pPošt
->
¡©us
.
dBTy³CÚÃùÜTemp2
 = 
tmpTemp
;

666  
”rcode
;

667 
	}
}

676 
E¼ÜCode_t
 
	$S¹Ch¬ge
(*
pvPošt
)

678 
Ch¬gePošt_t
 *
pPošt
;

679 
ušt8_t
 
ucPoštID
;

680 
Ch¬gePoštS‹Ty³
 
tmpCh¬geStus
;

681 
E¼ÜCode_t
 
”rcode
;

683 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

684 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

685 
”rcode
 = 
ERR_NO
;

691  
”rcode
;

692 
	}
}

701 
E¼ÜCode_t
 
	$StİCh¬ge
(*
pvPošt
)

703 
Ch¬gePošt_t
 *
pPošt
;

704 
ušt8_t
 
ucPoštID
;

705 
Ch¬gePoštS‹Ty³
 
tmpCh¬geStus
;

706 
E¼ÜCode_t
 
”rcode
;

708 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

709 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

710 
”rcode
 = 
ERR_NO
;

717  
”rcode
;

718 
	}
}

725 
E¼ÜCode_t
 
	$G‘R–ayS‹
(*
pvPošt
)

727 
Ch¬gePošt_t
 *
pPošt
;

728 
ušt8_t
 
ucPoštID
;

729 
ušt8_t
 
tmpLSt
;

730 
ušt8_t
 
tmpNSt
;

731 
E¼ÜCode_t
 
”rcode
;

733 
pPošt
 = (
Ch¬gePošt_t
 *)
pvPošt
;

734 
ucPoštID
 = 
pPošt
->
šfo
.
ucCh¬gePoštID
;

735 
tmpLSt
 = 
SWITCH_OFF
;

736 
tmpNSt
 = 
SWITCH_OFF
;

737 
”rcode
 = 
ERR_NO
;

745 
pPošt
->
¡©us
.
ucR–ayLS‹
 = 
tmpLSt
;

746 
pPošt
->
¡©us
.
ucR–ayNS‹
 = 
tmpNSt
;

748  
”rcode
;

749 
	}
}

750 
Ch¬gePošt_t
 *
	$Ch¬gePoštG‘HªdË
(
ušt8_t
 
ucCh¬gePoštID
)

752 
Ch¬gePošt_t
 *
pPošt
;

754 
pPošt
 = (
Ch¬gePošt_t
 *)(
pLi¡Ch¬gePošt
->
pLi¡PoštA¼ay
[
ucCh¬gePoštID
]);

756  
pPošt
;

757 
	}
}

758 
Ch¬gePošt_t
 *
	$Ch¬gePoštC»©e
(
ušt8_t
 
ucCh¬gePoštID
 )

760 
Ch¬gePošt_t
 *
pCh¬gePošt
;

761 
pCh¬gePošt
 = (
Ch¬gePošt_t
 *)
	`m®loc
((ChargePoint_t));

762 if(
pCh¬gePošt
 =ğ
NULL
)

764  
NULL
;

766 
pCh¬gePošt
->
šfo
.
ucCh¬gePoštID
 = ucChargePointID;

767 
pCh¬gePošt
->
šfo
.
ucCÚÃùÜTy³
 = 
defCÚÃùÜTy³B
;

768 
pCh¬gePošt
->
šfo
.
dVŞ©ageUµ”Lim™s
 = 0;

769 
pCh¬gePošt
->
šfo
.
dVŞ©ageLow”Lim™s
 = 0;

770 
pCh¬gePošt
->
šfo
.
dACTempUµ”Lim™s
 = 0;

771 
pCh¬gePošt
->
šfo
.
dACTempLow”Lim™s
 = 0;

772 
pCh¬gePošt
->
šfo
.
dCÚÃùÜTempUµ”Lim™s
 = 0;

773 
pCh¬gePošt
->
šfo
.
dCÚÃùÜTempLow”Lim™s
 = 0;

774 
pCh¬gePošt
->
šfo
.
dR©edCu¼’t
 = 0;

775 
pCh¬gePošt
->
šfo
.
dR©edPow”
 = 0;

777 
pCh¬gePošt
->
šfo
.
G‘CÚÃùÜTy³
 = GetConnectorType;

778 
pCh¬gePošt
->
šfo
.
G‘VŞ©ageUµ”Lim™s
 = GetVolatageUpperLimits;

779 
pCh¬gePošt
->
šfo
.
G‘VŞ©ageLow”Lim™s
 = GetVolatageLowerLimits;

780 
pCh¬gePošt
->
šfo
.
G‘ACTempUµ”Lim™s
 = GetACTempUpperLimits;

781 
pCh¬gePošt
->
šfo
.
G‘ACTempLow”Lim™s
 = GetACTempLowerLimits;

782 
pCh¬gePošt
->
šfo
.
G‘CÚÃùÜTempUµ”Lim™s
 = GetConnectorTempUpperLimits;

783 
pCh¬gePošt
->
šfo
.
G‘CÚÃùÜTempLow”Lim™s
 = GetConnectorTempLowerLimits;

784 
pCh¬gePošt
->
šfo
.
G‘R©edCu¼’t
 = GetRatedCurrent;

785 
pCh¬gePošt
->
šfo
.
G‘R©edPow”
 = GetRatedPower;

787 
	`mem£t
(
pCh¬gePošt
->
¡©us
.
ucH–dC¬dUID
, 0, 
defUIDL’gth
);

788 
pCh¬gePošt
->
¡©us
.
dACLTemp
 = 0;

789 
pCh¬gePošt
->
¡©us
.
dACNTemp
 = 0;

790 
pCh¬gePošt
->
¡©us
.
dBTy³CÚÃùÜTemp1
 = 0;

791 
pCh¬gePošt
->
¡©us
.
dBTy³CÚÃùÜTemp2
 = 0;

792 
pCh¬gePošt
->
¡©us
.
dCh¬gšgCu¼’t
 = 0;

793 
pCh¬gePošt
->
¡©us
.
dCh¬gšgF»qu’û
 = 0;

794 
pCh¬gePošt
->
¡©us
.
dCh¬gšgVŞge
 = 0;

795 
pCh¬gePošt
->
¡©us
.
xBTy³CÚÃùÜLockS‹
 = 0;

796 
pCh¬gePošt
->
¡©us
.
xCCS‹
 = 0;

797 
pCh¬gePošt
->
¡©us
.
xCPS‹
 = 0;

798 
pCh¬gePošt
->
¡©us
.
ucLßdP”ûÁ
 = 100;

799 
pCh¬gePošt
->
¡©us
.
xPlugS‹
 = 0;

800 
pCh¬gePošt
->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
 = 
	`xEv’tGroupC»©e
();

801 
pCh¬gePošt
->
¡©us
.
xHªdËEv’tExû±iÚ
 = 
	`xEv’tGroupC»©e
();

803 
pCh¬gePošt
->
¡©us
.
G‘Ch¬gšgVŞge
 = GetChargingVoltage;

804 
pCh¬gePošt
->
¡©us
.
G‘Ch¬gšgCu¼’t
 = GetChargingCurrent;

805 
pCh¬gePošt
->
¡©us
.
G‘Ch¬gšgF»qu’û
 = GetChargingFrequence;

807 
pCh¬gePošt
->
¡©us
.
G‘CPS‹
 = GetCPState;

808 
pCh¬gePošt
->
¡©us
.
S‘CPSw™ch
 = SetCPSwitch;

809 
pCh¬gePošt
->
¡©us
.
G‘CCS‹
 = GetCCState;

810 
pCh¬gePošt
->
¡©us
.
G‘PlugS‹
 = GetPlugState;

811 
pCh¬gePošt
->
¡©us
.
G‘BTy³CÚÃùÜLock
 = GetBTypeConnectorLock;

812 
pCh¬gePošt
->
¡©us
.
S‘BTy³CÚÃùÜLock
 = SetBTypeConnectorLock;

813 
pCh¬gePošt
->
¡©us
.
G‘ACLTemp
 = GetACLTemp;

814 
pCh¬gePošt
->
¡©us
.
G‘ACNTemp
 = GetACNTemp;

815 
pCh¬gePošt
->
¡©us
.
G‘BTy³CÚÃùÜTemp1
 = GetBTypeConnectorTemp1;

816 
pCh¬gePošt
->
¡©us
.
G‘BTy³CÚÃùÜTemp2
 = GetBTypeConnectorTemp2;

817 
pCh¬gePošt
->
¡©us
.
S¹Ch¬ge
 = StartCharge;

818 
pCh¬gePošt
->
¡©us
.
StİCh¬ge
 = StopCharge;

820 
pCh¬gePošt
->
¡©e
 = 
POINT_IDLE
;

821  
pCh¬gePošt
;

822 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\chargepoint.h

8 #iâdeà 
__CHARGEPOINT_H


9 
	#__CHARGEPOINT_H


	)

11 
	~"¡m32f4xx.h
"

12 
	~"F»eRTOS.h
"

13 
	~"ev’t_groups.h
"

14 
	~"”rÜcode.h
"

15 
	~"š‹rçû_rfid.h
"

17 
	#defCÚÃùÜTy³B
 'B'

	)

18 
	#defCÚÃùÜTy³C
 'C'

	)

20 
	e__Ch¬gePoštS‹Ty³


22 
	mNO_ERR
 = 0,

24 
	mCP_ERR
,

25 
	mCP_12V
,

26 
	mCP_9V
,

27 
	mCP_9V_PWM
,

28 
	mCP_6V_PWM
,

30 
	mCC_PE
,

31 
	mCC_NO
,

33 
	mPLUG
,

34 
	mUNPLUG
,

36 
	mLOCK
,

37 
	mUNLOCK


38 }
	tCh¬gePoštS‹Ty³
;

40 
	$E¼ÜCode_t
 (*
	tpCh¬gePošt_á
)(*
	tpvPošt
);

42 
	s_Ch¬gePoštInfo


44 
ušt8_t
 
ucCh¬gePoštID
;

45 
ušt8_t
 
ucCÚÃùÜTy³
;

46 
dVŞ©ageUµ”Lim™s
;

47 
dVŞ©ageLow”Lim™s
;

48 
dACTempUµ”Lim™s
;

49 
dACTempLow”Lim™s
;

50 
dCÚÃùÜTempUµ”Lim™s
;

51 
dCÚÃùÜTempLow”Lim™s
;

52 
dR©edCu¼’t
;

53 
dR©edPow”
;

55 
pCh¬gePošt_á
 
G‘CÚÃùÜTy³
;

56 
pCh¬gePošt_á
 
G‘VŞ©ageUµ”Lim™s
;

57 
pCh¬gePošt_á
 
G‘VŞ©ageLow”Lim™s
;

58 
pCh¬gePošt_á
 
G‘ACTempUµ”Lim™s
;

59 
pCh¬gePošt_á
 
G‘ACTempLow”Lim™s
;

60 
pCh¬gePošt_á
 
G‘CÚÃùÜTempUµ”Lim™s
;

61 
pCh¬gePošt_á
 
G‘CÚÃùÜTempLow”Lim™s
;

62 
pCh¬gePošt_á
 
G‘R©edCu¼’t
;

63 
pCh¬gePošt_á
 
G‘R©edPow”
;

64 }
	tCh¬gePoštInfo_t
;

66 
	s_Ch¬gePoštStus


68 
ušt8_t
 
ucH–dC¬dUID
[
defUIDL’gth
];

69 
Ch¬gePoštS‹Ty³
 
xCPS‹
;

70 
ušt8_t
 
ucLßdP”ûÁ
;

71 
Ch¬gePoštS‹Ty³
 
xCCS‹
;

72 
Ch¬gePoštS‹Ty³
 
xPlugS‹
;

73 
dACLTemp
;

74 
dACNTemp
;

75 
dBTy³CÚÃùÜTemp1
;

76 
dBTy³CÚÃùÜTemp2
;

77 
Ch¬gePoštS‹Ty³
 
xBTy³CÚÃùÜLockS‹
;

78 
dCh¬gšgVŞge
;

79 
dCh¬gšgCu¼’t
;

80 
dCh¬gšgF»qu’û
;

81 
Ev’tGroupHªdË_t
 
xHªdËEv’tS¹CÚd™iÚ
;

82 
Ev’tGroupHªdË_t
 
xHªdËEv’tExû±iÚ
;

83 
ušt8_t
 
ucR–ayLS‹
;

84 
ušt8_t
 
ucR–ayNS‹
;

86 
pCh¬gePošt_á
 
G‘Ch¬gšgVŞge
;

87 
pCh¬gePošt_á
 
G‘Ch¬gšgCu¼’t
;

88 
pCh¬gePošt_á
 
G‘Ch¬gšgF»qu’û
;

90 
pCh¬gePošt_á
 
G‘CPS‹
;

91 
	`E¼ÜCode_t
 (*
S‘CPSw™ch
)(*
pvPošt
, 
ušt8_t
 
cmd
);

92 
	`E¼ÜCode_t
 (*
S‘LßdP”ûÁ
)(*
pvPošt
, 
ušt8_t
 
ucLßdP”ûÁ
);

93 
pCh¬gePošt_á
 
G‘CCS‹
;

94 
pCh¬gePošt_á
 
G‘PlugS‹
;

95 
pCh¬gePošt_á
 
G‘BTy³CÚÃùÜLock
;

96 
	`E¼ÜCode_t
 (*
S‘BTy³CÚÃùÜLock
)(*
pvPošt
, 
ušt8_t
 
cmd
);

97 
pCh¬gePošt_á
 
G‘ACLTemp
;

98 
pCh¬gePošt_á
 
G‘ACNTemp
;

99 
pCh¬gePošt_á
 
G‘BTy³CÚÃùÜTemp1
;

100 
pCh¬gePošt_á
 
G‘BTy³CÚÃùÜTemp2
;

101 
pCh¬gePošt_á
 
S¹Ch¬ge
;

102 
pCh¬gePošt_á
 
StİCh¬ge
;

103 
pCh¬gePošt_á
 
G‘R–ayS‹
;

105 }
	tCh¬gePoštStus_t
;

107 
	e_Ch¬gePoštS‹


109 
POINT_IDLE
,

110 
POINT_PLUGED
,

111 
POINT_PRECONTRACT
,

112 
POINT_STARTCHARGE
,

113 
POINT_CHARGING
,

114 
POINT_CHARGING_HALFLOAD
,

115 
POINT_ERROR


116 }
	tCh¬gePoštS‹_t
;

119 
	s_Ch¬gePošt


121 
Ch¬gePoštInfo_t
 
šfo
;

122 
Ch¬gePoštStus_t
 
¡©us
;

123 
Ch¬gePoštS‹_t
 
¡©e
;

124 } 
	tCh¬gePošt_t
;

126 
Ch¬gePošt_t
 *
	`Ch¬gePoštC»©e
(
ušt8_t
 
ucCh¬gePoštID
 );

127 
Ch¬gePošt_t
 *
	`Ch¬gePoštG‘HªdË
(
ušt8_t
 
ucCh¬gePoštID
);

	@D:\Documents\Projects\chargersdk\src\app\errorcode.c

8 
	~"šşudes.h
"

9 
	~"”rÜcode.h
"

14 cÚ¡ 
ušt8_t
 *
	g¡rE¼ÜCode
[100] =

53 
	$ThrowE¼ÜCode
(
ušt32_t
 
ulDevID
, 
E¼ÜCode_t
 
”rcode
, 
E¼ÜLev–_t
 
”¾ev–
)

55 
E¼ÜPackage_t
 
·ckage
;

57 
·ckage
.
ulDevID
 = ulDevID;

58 
·ckage
.
code
 = 
”rcode
;

59 
·ckage
.
Ëv–
 = 
”¾ev–
;

61 
	`xQueueS’d
(
xHªdËQueueE¼ÜPackage
, (*)&
·ckage
, 0);

62 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\errorcode.h

8 #iâdeà 
__ERRORCODE_H


9 
	#__ERRORCODE_H


	)

11 
	#THROW_ERROR
(
_dev
, 
_”rcode
,
_”¾ev–
) { \

12 
E¼ÜCode_t
 
_maüo_”rcode
 = 
_”rcode
; \

13 if(
_maüo_”rcode
 !ğ
ERR_NO
) \

15 
	`ThrowE¼ÜCode
(
_dev
, 
_maüo_”rcode
,
_”¾ev–
); \

17 }

	)

18 
	e_E¼ÜCode


20 
	mERR_NO
,

21 
	mERR_SCRAM_FAULT
,

22 
	mERR_GSENSOR_FAULT
,

23 
	mERR_PE_FAULT
,

24 
	mERR_POWEROFF_DECT_FAULT
,

25 
	mERR_ARRESTER_FAULT
,

27 
	mERR_POINT_METER_FAULT
,

28 
	mERR_POINT_CP_FAULT
,

29 
	mERR_POINT_CC_FAULT
,

30 
	mERR_POINT_PLUG_FAULT
,

31 
	mERR_POINT_B_LOCK_FAULT
,

32 
	mERR_POINT_CANT_LOCK
,

33 
	mERR_POINT_ACLTEMP_DECT_FAULT
,

34 
	mERR_POINT_ACNTEMP_DECT_FAULT
,

35 
	mERR_POINT_BTEMP1_DECT_FAULT
,

36 
	mERR_POINT_BTEMP2_DECT_FAULT
,

37 
	mERR_POINT_STARTCHARGE
,

38 
	mERR_POINT_STOPCHARGE
,

40 
	mERR_FILE_RW
,

41 
	mERR_FILE_NO
,

42 
	mERR_OTHER
,

43 
	mERR_RFID_FAULT
,

44 
	mERR_RFID_PE
,

45 
	mERR_RFID_NE
,

46 
	mERR_RFID_FE
,

47 
	mERR_RFID_ORE
,

48 
	mERR_RFID_DMA
,

49 
	mERR_NETMODULE_PE
,

50 
	mERR_NETMODULE_NE
,

51 
	mERR_NETMODULE_FE
,

52 
	mERR_NETMODULE_ORE
,

53 
	mERR_NETMODULE_DMA
,

55 
	mERR_NONET


57 } 
	tE¼ÜCode_t
;

59 
	e_E¼ÜLev–


61 
	mERR_LEVEL_OK
,

62 
	mERR_LEVEL_TIPS
,

63 
	mERR_LEVEL_WARNING
,

64 
	mERR_LEVEL_CRITICAL
,

65 
	mERR_LEVEL_CLEAR


66 } 
	tE¼ÜLev–_t
;

68 
	s_E¼ÜPackage


70 
ušt32_t
 
	mulDevID
;

71 
E¼ÜCode_t
 
	mcode
;

72 
E¼ÜLev–_t
 
	mËv–
;

73 }
	tE¼ÜPackage_t
;

77 
	#defDevID_FILE
 0xFC

	)

78 
	#defDevID_RFID
 0xFE

	)

79 
	#defDevID_N‘MoudË
 0xFD

	)

80 
	#defDevID_EVSE
 0xFF

	)

83 cÚ¡ 
ušt8_t
 *
¡rE¼ÜCode
[];

85 
ThrowE¼ÜCode
(
ušt32_t
 
ulDevID
, 
E¼ÜCode_t
 
”rcode
, 
E¼ÜLev–_t
 
”¾ev–
);

	@D:\Documents\Projects\chargersdk\src\app\evse_config.h

8 #iâdeà
__EVSE_CONFIG_H


9 
	#__EVSE_CONFIG_H


	)

11 
	#defTÙ®Pošt
 2

	)

12 
	#defUIDL’gth
 4

	)

13 
	#defEVSESNL’gth
 24

	)

14 
	#defEVSEIDL’gth
 24

	)

15 
	#defFeNameL’gth
 64

	)

16 
	#defNodeNameL’gth
 64

	)

	@D:\Documents\Projects\chargersdk\src\app\evse_globals.c

8 
	~"š‹rçû.h
"

9 
	~"u£¾ib_li¡.h
"

12 
EVSE_t
 *
	gpEVSE
;

13 
U£rLi¡_t
 *
	gpLi¡Ch¬gePošt
;

14 
RFIDDev_t
 *
	gpRFIDDev
;

	@D:\Documents\Projects\chargersdk\src\app\evse_globals.h

8 #iâdeà 
__EVSE_GLOBALS_H


9 
	#__EVSE_GLOBALS_H


	)

11 
	~"EVSE.h
"

12 
	~"š‹rçû_rfid.h
"

13 
	~"u£¾ib_li¡.h
"

16 
	#SWITCH_ON
 1

	)

17 
	#SWITCH_OFF
 0

	)

19 
	#BIT_0
 ( 1 << 0 )

	)

20 
	#BIT_1
 ( 1 << 1 )

	)

21 
	#BIT_2
 ( 1 << 2 )

	)

22 
	#BIT_3
 ( 1 << 3 )

	)

23 
	#BIT_4
 ( 1 << 4 )

	)

24 
	#BIT_5
 ( 1 << 5 )

	)

25 
	#BIT_6
 ( 1 << 6 )

	)

26 
	#BIT_7
 ( 1 << 7 )

	)

27 
	#BIT_8
 ( 1 << 8 )

	)

28 
	#BIT_9
 ( 1 << 9 )

	)

29 
	#BIT_10
 ( 1 << 10 )

	)

30 
	#BIT_11
 ( 1 << 11 )

	)

31 
	#BIT_12
 ( 1 << 12 )

	)

32 
	#BIT_13
 ( 1 << 13 )

	)

33 
	#BIT_14
 ( 1 << 14 )

	)

34 
	#BIT_15
 ( 1 << 15 )

	)

35 
	#BIT_16
 ( 1 << 16 )

	)

36 
	#BIT_17
 ( 1 << 17 )

	)

37 
	#BIT_18
 ( 1 << 18 )

	)

38 
	#BIT_19
 ( 1 << 19 )

	)

39 
	#BIT_20
 ( 1 << 20 )

	)

40 
	#BIT_21
 ( 1 << 21 )

	)

41 
	#BIT_22
 ( 1 << 22 )

	)

42 
	#BIT_23
 ( 1 << 23 )

	)

43 
	#BIT_24
 ( 1 << 24 )

	)

44 
	#BIT_25
 ( 1 << 25 )

	)

45 
	#BIT_26
 ( 1 << 26 )

	)

46 
	#BIT_27
 ( 1 << 27 )

	)

47 
	#BIT_28
 ( 1 << 28 )

	)

48 
	#BIT_29
 ( 1 << 29 )

	)

49 
	#BIT_30
 ( 1 << 30 )

	)

50 
	#BIT_31
 ( 1 << 31 )

	)

56 
	#defEv’tB™GÙUIDtoRFID
 
BIT_0


57 
	#defEv’tB™GÙUIDtoHMI
 
BIT_1


58 
	#defEv’tB™IsNewUID
 
BIT_2


59 
	#defEv’tB™G‘AccouÁStus
 
BIT_3


60 

	)

62 
	#defEv’tB™AddOrd”
 
BIT_0


	)

63 
	#defEv’tB™AddOrd”OK
 
BIT_1


	)

65 
	#defEv’tB™RemÙe


	)

67 
	#defEv’tB™DŸgTempW
 
BIT_0


69 
	#defEv’tB™Exû±iÚTempW
 
BIT_0


70 
	#defEv’tB™Exû±iÚTempC
 
BIT_1


71 
	#defEv’tB™Exû±iÚVŞt
 
BIT_2


	)

72 
	#defEv’tB™Exû±iÚCu¼
 
BIT_3


	)

73 
	#defEv’tB™Exû±iÚCr™iÿl
 
defEv’tB™Exû±iÚTempC


	)

76 
	#defEv’tB™StdAuthed
 
BIT_0


	)

77 
	#defEv’tB™StdLocked
 
BIT_1


	)

78 
	#defEv’tB™StdVŞtOK
 
BIT_2


	)

79 
	#defEv’tB™StdCu¼OK
 
BIT_3


	)

80 
	#defEv’tB™StdCPOK
 
BIT_4


	)

81 
	#defEv’tB™StdCCOK
 
BIT_5


	)

82 
	#defEv’tB™StdCÚnTempOK
 
BIT_6


	)

83 
	#defEv’tB™StdACTempOK
 
BIT_7


	)

84 
	#defEv’tB™StdPlugOK
 
BIT_8


	)

85 
	#defEv’tB™CPSw™chCÚd™iÚ
 
defEv’tB™StdLocked
 | \

86 
defEv’tB™StdVŞtOK
 | \

87 
defEv’tB™StdCÚnTempOK
 | \

88 
defEv’tB™StdACTempOK
 | \

89 
defEv’tB™StdPlugOK


	)

91 
	#defEv’tB™StdOK
 
BIT_9


	)

93 
	#defEv’tB™Tim”CBTemp
 
BIT_0


	)

94 
	#defEv’tB™Tim”CBLockS‹
 
BIT_1


	)

95 
	#defEv’tB™Tim”CBPlugS‹
 
BIT_2


	)

96 
	#defEv’tB™Tim”CBCh¬gšgD©a
 
BIT_3


	)

97 
	#defEv’tB™Tim”CBEVSES‹
 
BIT_4


	)

98 
	#defEv’tB™Tim”CBRFID
 
BIT_5


	)

99 
	#defEv’tB™Tim”CBD©aReäesh
 
BIT_6


	)

104 
EVSE_t
 *
pEVSE
;

105 
U£rLi¡_t
 *
pLi¡Ch¬gePošt
;

106 
RFIDDev_t
 *
pRFIDDev
;

	@D:\Documents\Projects\chargersdk\src\app\includes.h

1 #iâdeà 
__INCLUDES_H__


2 
	#__INCLUDES_H__


	)

9 
	~<¡d¬g.h
>

10 
	~<¡dio.h
>

11 
	~<¡dlib.h
>

12 
	~<m©h.h
>

13 
	~<¡dšt.h
>

14 
	~<¡ršg.h
>

22 
	~"¡m32f4xx.h
"

29 
	~"F»eRTOS.h
"

30 
	~"sk.h
"

31 
	~"queue.h
"

32 
	~"tim”s.h
"

33 
	~"ev’t_groups.h
"

43 
	~"GUI.h
"

44 
	~"WM.h
"

51 
	~"ff.h
"

58 
	~"ev£_glob®s.h
"

59 
	~"ev£_cÚfig.h
"

60 
	~"sysš™.h
"

61 
	~"EVSE.h
"

62 
	~"skü—‹.h
"

63 
	~"b¥.h
"

64 
	~"tšysh.h
"

65 
	~"x´štf.h
"

66 
	~"”rÜcode.h
"

	@D:\Documents\Projects\chargersdk\src\app\interface.h

8 #iâdeà
__INTERFACE_H


9 
	#__INTERFACE_H


	)

11 
	~"ch¬g•ošt.h
"

12 
	~"EVSE.h
"

13 
	~"š‹rçû_mÚ™Ü.h
"

14 
	~"š‹rçû_ch¬ge.h
"

15 
	~"š‹rçû_rfid.h
"

16 
	~"š‹rçû_d©a.h
"

17 
	~"š‹rçû_»mÙe.h
"

	@D:\Documents\Projects\chargersdk\src\app\interface_charge.c

8 
	~"šşudes.h
"

	@D:\Documents\Projects\chargersdk\src\app\interface_charge.h

8 #iâdeà 
__INTERFACE_CHARGE_H


9 
	#__INTERFACE_CHARGE_H


	)

	@D:\Documents\Projects\chargersdk\src\app\interface_data.c

8 
	~"šşudes.h
"

9 
	~"š‹rçû.h
"

10 
	~"mxml.h
"

11 
E¼ÜCode_t
 
	$C»©eOrd”XML
()

13 
FRESULT
 
»s
;

14 
E¼ÜCode_t
 
”rcode
;

15 
FIL
 
f
;

16 
mxml_node_t
 *
Üd”_roÙ
, *
Üd”_node
;

17 
»s
 = 
	`f_İ’
(&
f
, "Üd”/Üd”.xml", 
FA_CREATE_NEW
 | 
FA_WRITE
);

18 
»s
)

20 
FR_OK
:

21 
Üd”_roÙ
 = 
	`mxmlNewXML
("1.0");

22 
Üd”_node
 = 
	`mxmlNewEËm’t
(
Üd”_roÙ
, "Orders");

23 
	`mxmlSaveFe
(
Üd”_roÙ
, &
f
, 
wh™e¥aû_cb
);

24 
	`f_şo£
(&
f
);

25 
	`mxmlD–‘e
(
Üd”_roÙ
);

26 
”rcode
 = 
ERR_NO
;

29 
”rcode
 = 
ERR_FILE_RW
;

32  
”rcode
;

33 
	}
}

42 
E¼ÜCode_t
 
	$D©aAddOrd”
(
ušt32_t
 *
pulIndex
)

44 
E¼ÜCode_t
 
”rcode
;

45 
”rcode
 = 
ERR_NO
;

56 *
pulIndex
 = 1;

58  
”rcode
;

59 
	}
}

69 
E¼ÜCode_t
 
	$D©aG‘Ord”
Ğ
ušt32_t
 
ulIndex
, 
ušt8_t
 *
¡rNode
, *
pvG‘V®
)

71 
E¼ÜCode_t
 
”rcode
;

72 
”rcode
 = 
ERR_NO
;

79  
”rcode
;

80 
	}
}

81 
E¼ÜCode_t
 
	$D©aS‘Ord”
Ğ
ušt32_t
 
ulIndex
, 
ušt8_t
 *
¡rNode
, *
pvG‘V®
)

83 
E¼ÜCode_t
 
”rcode
;

84 
”rcode
 = 
ERR_NO
;

86  
”rcode
;

87 
	}
}

88 
E¼ÜCode_t
 
	$D©aD–Ord”
(
ušt32_t
 
ulIndex
)

90 
E¼ÜCode_t
 
”rcode
;

91 
”rcode
 = 
ERR_NO
;

92  
”rcode
;

93 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\interface_data.h

8 #iâdeà 
__INTERFACE_DATA_H


9 
	#__INTERFACE_DATA_H


	)

11 
	~"šşudes.h
"

13 
	s_Ord”D©a


16 
ušt8_t
 
	mucUID
[
defUIDL’gth
];

17 
ušt8_t
 
	mucAccouÁStus
;

18 
	mdB®ªû
;

19 
ušt8_t
 
	mucPoštID
;

20 
ušt8_t
 
	mucEVSESN
[
defEVSEIDL’gth
];

22 }
	tOrd”D©a_t
;

24 
	s_FeD©aTy³


27 }
	gFeD©aTy³_t
;

29 
E¼ÜCode_t
 
C»©eOrd”XML
();

	@D:\Documents\Projects\chargersdk\src\app\interface_diag.c

8 
	~"š‹rçû.h
"

10 
	$HªdËA¼e¡”E¼Ü
()

13 
	}
}

14 
	$HªdËVŞgeE¼Ü
(
Ch¬gePošt_t
 *
pPošt
)

17 
	}
}

18 
	$HªdËCu¼’tE¼Ü
(
Ch¬gePošt_t
 *
pPošt
)

21 
	}
}

22 
	$HªdËTempE¼Ü
(
Ch¬gePošt_t
 *
pPošt
)

25 
	}
}

26 
	$HªdËR–ayE¼Ü
(
Ch¬gePošt_t
 *
pPošt
)

29 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\interface_monitor.c

8 
	~"šşudes.h
"

9 
	~"š‹rçû.h
"

	@D:\Documents\Projects\chargersdk\src\app\interface_monitor.h

8 #iâdeà 
__INTERFACE_MONITOR_H


9 
	#__INTERFACE_MONITOR_H


	)

	@D:\Documents\Projects\chargersdk\src\app\interface_remote.c

9 
	~<time.h
>

10 
	~"šşudes.h
"

11 
	~"b¥.h
"

13 
E¼ÜCode_t
 
	$RemÙeG‘Time
(
tm
 *
pTimeBlock
)

15 
tm
 
tmpTimeBlock
;

16 
E¼ÜCode_t
 
”rcode
;

18 
”rcode
 = 
ERR_NO
;

23 *
pTimeBlock
 = 
tmpTimeBlock
;

25  
”rcode
;

26 
	}
}

34 
E¼ÜCode_t
 
	$RemÙeRegi¡
(
EVSE_t
 *
pEVSE
, 
ušt8_t
 *
ucR‘V®
 )

36 
E¼ÜCode_t
 
”rcode
;

38 
”rcode
 = 
ERR_NO
;

42 *
ucR‘V®
 = 0;

43  
”rcode
;

44 
	}
}

55 
E¼ÜCode_t
 
	$RemÙeG‘B®ªû
(
ušt8_t
 *
pucUID
, ušt8_ˆ
ucUIDL’gth
, ušt8_ˆ*
pucAccouÁStus
, *
pdB®ªû
)

57 
tmpB®ªû
;

58 
ušt8_t
 
tmpAccouÁSt
;

59 
E¼ÜCode_t
 
”rcode
;

61 
tmpAccouÁSt
 = 1;

62 
tmpB®ªû
 = 88888.88;

63 
”rcode
 = 
ERR_NO
;

67 *
pucAccouÁStus
 = 
tmpAccouÁSt
;

68 *
pdB®ªû
 = 
tmpB®ªû
;

70  
”rcode
;

71 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\interface_remote.h

8 #iâdeà 
__INTERFACE_REMOTE_H


9 
	#__INTERFACE_REMOTE_H


	)

11 
	~<time.h
>

13 
E¼ÜCode_t
 
RemÙeG‘Time
(
tm
 *
pTimeBlock
);

14 
E¼ÜCode_t
 
RemÙeG‘B®ªû
(
ušt8_t
 *
pucUID
, ušt8_ˆ
ucUIDL’gth
, ušt8_ˆ*
pucAccouÁStus
, *
pdB®ªû
);

	@D:\Documents\Projects\chargersdk\src\app\interface_rfid.c

8 
	~"šşudes.h
"

9 
	~"š‹rçû.h
"

11 
E¼ÜCode_t
 
	$MT626G‘UID
(*
pvRfid
)

13 
RFIDDev_t
 *
pRfid
;

14 
MT626CMD_t
 *
pmt626cmd
;

15 
ušt32_t
 
ulRecvdO±L’
;

16 
¡©e
;

17 
E¼ÜCode_t
 
”rcode
;

19 
pRfid
 = (
RFIDDev_t
 *)
pvRfid
;

20 
pmt626cmd
 = ((
MT626COM_t
 *)(
pRfid
->
com
))->
pMT626CMD
[
MT626_READ_UID_CMD
];

21 
¡©e
 = 
MT_STATE_N
;

22 
”rcode
 = 
ERR_NO
;

24 
	`xSem­hÜeTake
(
pRfid
->
xHªdËMu‹xRFID
, 
pÜtMAX_DELAY
);

26 
¡©e
 = 
	`T¿nsToMT626
(
pRfid
->
com
, 
MT626_READ_UID_CMD
, 
NULL
, 0);

27 if(
¡©e
 =ğ
MT_STATE_Y
)

29 
ulRecvdO±L’
 = 
pmt626cmd
->
uiRecvdO±L’
;

30 
	`memmove
(
pRfid
->
¡©us
.
ucUID
, 
pmt626cmd
->
ucRecvdO±D©a
, 
ulRecvdO±L’
);

31 
	`mem£t
(
pmt626cmd
->
ucRecvdO±D©a
, 0, 
ulRecvdO±L’
);

33 
	`xEv’tGroupS‘B™s
(
pRfid
->
xHªdËEv’tGroupRFID
, 
defEv’tB™GÙUIDtoRFID
);

35 if(
¡©e
 =ğ
MT_STATE_N
)

37 
	`xEv’tGroupCË¬B™s
(
pRfid
->
xHªdËEv’tGroupRFID
, 
defEv’tB™GÙUIDtoRFID
);

40 if(
¡©e
 =ğ
MT_COM_FAIL
)

42 
”rcode
 = 
ERR_RFID_FAULT
;

45 
	`xSem­hÜeGive
(
pRfid
->
xHªdËMu‹xRFID
);

47  
”rcode
;

48 
	}
}

50 
RFIDDev_t
 *
	$RFIDDevC»©e
()

52 
RFIDDev_t
 *
pRFID
;

54 
pRFID
 = (
RFIDDev_t
 *)
	`m®loc
((RFIDDev_t));

55 
pRFID
->
¡©us
.
ucFoundC¬d
 = 0;

56 
	`mem£t
(
pRFID
->
¡©us
.
ucUID
, 0 , 
defUIDL’gth
);

57 
pRFID
->
com
 = (*)
	`MT626COMC»©e
();

58 
pRFID
->
¡©us
.
G‘UID
 = 
MT626G‘UID
;

59 
pRFID
->
xHªdËMu‹xRFID
 = 
	`xSem­hÜeC»©eMu‹x
();

60 
pRFID
->
xHªdËEv’tGroupRFID
 = 
	`xEv’tGroupC»©e
();

62  
pRFID
;

63 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\interface_rfid.h

8 #iâdeà 
__INTERFACE_RFID_H


9 
	#__INTERFACE_RFID_H


	)

11 
	~"F»eRTOS.h
"

12 
	~"£mphr.h
"

13 
	~"ev’t_groups.h
"

14 
	~"RFIDR—d”_mt626.h
"

15 
	~"”rÜcode.h
"

16 
	~"ev£_cÚfig.h
"

17 
	s_RFIDDevStus


19 
ušt8_t
 
	mucFoundC¬d
;

20 
ušt8_t
 
	mucUID
[
defUIDL’gth
];

22 
E¼ÜCode_t
 (*
G‘UID
)(*
	mpvRFIDDev
);

23 }
	tRFIDDevStus_t
;

25 
	s_RFIDDev


27 
RFIDDevStus_t
 
	m¡©us
;

28 *
	mcom
;

29 
Sem­hÜeHªdË_t
 
	mxHªdËMu‹xRFID
;

30 
Ev’tGroupHªdË_t
 
	mxHªdËEv’tGroupRFID
;

31 }
	tRFIDDev_t
;

33 
RFIDDev_t
 *
RFIDDevC»©e
();

	@D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_err.c

	@D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_err.h

8 #iâdeà 
__PS_ERR_H


9 
	#__PS_ERR_H


	)

11 
	eps_E¼ÜCode


13 
	mERR_PS_NO
,

14 
	mERR_PS_OTHER


15 }
	tps_E¼ÜCode_t
;

	@D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_globals.h

8 #iâdeà
__PS_GLOBALS_H


9 
	#__PS_GLOBALS_H


	)

11 
	s_Ch¬geSegm’t


13 
ušt8_t
 
	mucEËùric™y
;

14 
ušt8_t
 
	mucF“
;

15 }
	tCh¬geSegm’t_t
;

17 
	s_Ord”


19 
ušt8_t
 
	mucEqum’tID
[8];

20 
ušt8_t
 
	mucCÚÃùÜID
;

21 
ušt8_t
 
	mucEËùric™yTÙ®
[4];

22 
ušt8_t
 
	mucPaym’t
;

23 
ušt8_t
 
	mucStİTy³
;

24 
ušt8_t
 
	mucRe£rved
;

25 
ušt8_t
 
	mucC¬dID
[8];

26 
ušt8_t
 
	mucF“TÙ®
;

27 
ušt8_t
 
	mucOrd”SN
[7];

28 
ušt8_t
 
	mucS”viûF“Ty³
;

29 
ušt8_t
 
	mucS”viûF“
[2];

30 
ušt8_t
 
	mucSegm’tTÙ®
;

31 
ušt8_t
 
	mucDeçuÉSegEËùric™y
;

32 
ušt8_t
 
	mucDeçuÉSegF“
;

33 
Ch¬geSegm’t_t
 *
	mpCh¬geSegm’t
;

34 }
	tOrd”_t


	@D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_protocol.c

	@D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_transportlayer.c

8 
	~"libpow”sh¬e/ps_”r.h
"

9 
ps_E¼ÜCode_t
 
	$O³nRemÙe
()

12 
	}
}

14 
ps_E¼ÜCode_t
 
	$Clo£RemÙe
()

17 
	}
}

19 
ps_E¼ÜCode_t
 
	$RecvRemÙe
()

22 
	}
}

23 
ps_E¼ÜCode_t
 
	$S’dRemÙe
()

26 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\main.c

11 
	~"šşudes.h
"

14 
	$maš
()

20 
	`DISABLE_INT
();

22 
	`b¥_In™
();

23 
	`sys_In™
();

25 
	`SysTaskC»©e
();

26 
	`AµTaskC»©e
();

27 
	`AµObjC»©e
();

29 
	`EVSEš™
();

31 
	`vTaskS¹ScheduËr
();

40 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\stm32f4xx_it.c

25 
	~"¡m32f4xx_™.h
"

47 
	$NMI_HªdËr
()

49 
	}
}

56 
	$H¬dFauÉ_HªdËr
()

62 
	}
}

69 
	$MemMªage_HªdËr
()

75 
	}
}

82 
	$BusFauÉ_HªdËr
()

88 
	}
}

95 
	$U§geFauÉ_HªdËr
()

101 
	}
}

118 
	$DebugMÚ_HªdËr
()

120 
	}
}

147 
	$EXTI9_5_IRQHªdËr
()

149 
	}
}

156 
	$EXTI15_10_IRQHªdËr
()

158 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\sysinit.c

1 
	~"šşudes.h
"

2 
	~"ff_g’_drv.h
"

3 
	~"Çnd_diskio.h
"

4 
	~"mxml.h
"

6 #ià
cÚfigAPPLICATION_ALLOCATED_HEAP
 == 1

8 
ušt8_t
 *
	gucH—p
 = (uint8_t *)(0XC0B00000);

11 
syscÚf_t
 
	gsyscÚf_·¿m
;

13 
FATFS
 
	gNANDDISKF©Fs
;

14 
	gNANDDISKP©h
[4];

16 
	$E¼Ü_HªdËr
()

19 
	}
}

21 
ušt8_t
 
	$ü—‹_sy¡em_dœ
()

23 
FRESULT
 
»s
;

24 
»s
 = 
	`f_mkdœ
("system");

25 
»s
)

27 
FR_OK
:

28 
FR_EXIST
:

29  
TRUE
;

31  
FALSE
;

33 
	}
}

34 
ušt8_t
 
	$ü—‹_syscÚf_xml
()

36 
FRESULT
 
»s
;

37 
FIL
 
f
;

38 
mxml_node_t
 *
syscÚf_Œ“
, *
syscÚf_node
, *
_ÿlib¿‹_node
, *
d©a_node
;

39 
»s
 = 
	`f_İ’
(&
f
, "sy¡em/syscÚf.xml", 
FA_CREATE_NEW
 | 
FA_WRITE
);

40 
»s
)

42 
FR_OK
:

43 
syscÚf_Œ“
 = 
	`mxmlNewXML
("1.0");

44 
syscÚf_node
 = 
	`mxmlNewEËm’t
(
syscÚf_Œ“
, "sysconf");

45 
_ÿlib¿‹_node
 = 
	`mxmlNewEËm’t
(
syscÚf_node
, "tp_calibrate");

46 
d©a_node
 = 
	`mxmlNewEËm’t
(
_ÿlib¿‹_node
, "AD_TOP");

47 
	`mxmlNewIÁeg”
(
d©a_node
, 270);

48 
d©a_node
 = 
	`mxmlNewEËm’t
(
_ÿlib¿‹_node
, "AD_BOTTOM");

49 
	`mxmlNewIÁeg”
(
d©a_node
, 3865);

50 
d©a_node
 = 
	`mxmlNewEËm’t
(
_ÿlib¿‹_node
, "AD_LEFT");

51 
	`mxmlNewIÁeg”
(
d©a_node
, 100);

52 
d©a_node
 = 
	`mxmlNewEËm’t
(
_ÿlib¿‹_node
, "AD_RIGHT");

53 
	`mxmlNewIÁeg”
(
d©a_node
, 3964);

54 
	`mxmlSaveFe
(
syscÚf_Œ“
, &
f
, 
wh™e¥aû_cb
);

55 
	`f_şo£
(&
f
);

56 
	`mxmlD–‘e
(
syscÚf_Œ“
);

57  
TRUE
;

58 
FR_EXIST
:

59  
FALSE
;

61  
FALSE
;

63 
	}
}

64 
ušt8_t
 
	$wr™e_syscÚf_xml
()

66 
FRESULT
 
»s
;

67 
FIL
 
f
;

68 
mxml_node_t
 *
syscÚf_Œ“
, *
syscÚf_node
, *
_ÿlib¿‹_node
, *
d©a_node
;

69 
»s
 = 
	`f_İ’
(&
f
, "sy¡em/syscÚf.xml", 
FA_OPEN_EXISTING
 |
FA_READ
|
FA_WRITE
);

70 
»s
)

72 
FR_OK
:

73 
syscÚf_Œ“
 = 
	`mxmlLßdFe
(
NULL
, &
f
, 
MXML_INTEGER_CALLBACK
);

74 if(
syscÚf_Œ“
 !ğ
NULL
)

76 
syscÚf_node
 = 
	`mxmlFšdEËm’t
(
syscÚf_Œ“
, syscÚf_Œ“, "syscÚf", 
NULL
, NULL, 
MXML_DESCEND
);

77 if(
syscÚf_node
 =ğ
NULL
)

79  
FALSE
;

81 
_ÿlib¿‹_node
 = 
	`mxmlFšdEËm’t
(
syscÚf_node
, 
syscÚf_Œ“
, "_ÿlib¿‹", 
NULL
, NULL, 
MXML_DESCEND
);

82 if(
_ÿlib¿‹_node
 =ğ
NULL
)

84  
FALSE
;

86 
d©a_node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_TOP", 
NULL
, NULL, 
MXML_DESCEND
);

87 if(
d©a_node
 =ğ
NULL
)

89  
FALSE
;

91 
	`mxmlS‘IÁeg”
 (
d©a_node
, 
syscÚf_·¿m
.
ad_tİ
);

92 
d©a_node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_BOTTOM", 
NULL
, NULL, 
MXML_DESCEND
);

93 if(
d©a_node
 =ğ
NULL
)

95  
FALSE
;

97 
	`mxmlS‘IÁeg”
 (
d©a_node
, 
syscÚf_·¿m
.
ad_bÙtom
);

98 
d©a_node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_LEFT", 
NULL
, NULL, 
MXML_DESCEND
);

99 if(
d©a_node
 =ğ
NULL
)

101  
FALSE
;

103 
	`mxmlS‘IÁeg”
 (
d©a_node
, 
syscÚf_·¿m
.
ad_Ëá
);

104 
d©a_node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_RIGHT", 
NULL
, NULL, 
MXML_DESCEND
);

105 if(
d©a_node
 =ğ
NULL
)

107  
FALSE
;

109 
	`mxmlS‘IÁeg”
 (
d©a_node
, 
syscÚf_·¿m
.
ad_right
);

110 
	`f_l£ek
(&
f
,0);

111 
	`mxmlSaveFe
(
syscÚf_Œ“
, &
f
, 
wh™e¥aû_cb
);

112 
	`f_şo£
(&
f
);

113 
	`mxmlD–‘e
(
syscÚf_Œ“
);

114  
TRUE
;

117  
FALSE
;

119 
	}
}

121 
ušt8_t
 
	$»ad_syscÚf_xml
()

123 
FRESULT
 
»s
;

124 
FIL
 
f
;

125 
mxml_node_t
 *
syscÚf_Œ“
, *
syscÚf_node
, *
_ÿlib¿‹_node
, *
node
;

126 
»s
 = 
	`f_İ’
(&
f
, "sy¡em/syscÚf.xml", 
FA_OPEN_EXISTING
 | 
FA_READ
);

127 
»s
)

129 
FR_OK
:

130 
syscÚf_Œ“
 = 
	`mxmlLßdFe
(
NULL
, &
f
, 
MXML_INTEGER_CALLBACK
);

131 if(
syscÚf_Œ“
 !ğ
NULL
)

133 
syscÚf_node
 = 
	`mxmlFšdEËm’t
(
syscÚf_Œ“
, syscÚf_Œ“, "syscÚf", 
NULL
, NULL, 
MXML_DESCEND
);

134 if(
syscÚf_node
 =ğ
NULL
)

136  
FALSE
;

138 
_ÿlib¿‹_node
 = 
	`mxmlFšdEËm’t
(
syscÚf_node
, 
syscÚf_Œ“
, "_ÿlib¿‹", 
NULL
, NULL, 
MXML_DESCEND
);

139 if(
_ÿlib¿‹_node
 =ğ
NULL
)

141  
FALSE
;

143 
node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_TOP", 
NULL
, NULL, 
MXML_DESCEND
);

144 if(
node
 =ğ
NULL
)

146  
FALSE
;

148 
syscÚf_·¿m
.
ad_tİ
 = 
	`mxmlG‘IÁeg”
(
node
);

149 
node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_BOTTOM", 
NULL
, NULL, 
MXML_DESCEND
);

150 if(
node
 =ğ
NULL
)

152  
FALSE
;

154 
syscÚf_·¿m
.
ad_bÙtom
 = 
	`mxmlG‘IÁeg”
(
node
);

155 
node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_LEFT", 
NULL
, NULL, 
MXML_DESCEND
);

156 if(
node
 =ğ
NULL
)

158  
FALSE
;

160 
syscÚf_·¿m
.
ad_Ëá
 = 
	`mxmlG‘IÁeg”
(
node
);

161 
node
 = 
	`mxmlFšdEËm’t
(
_ÿlib¿‹_node
, 
syscÚf_Œ“
, "AD_RIGHT", 
NULL
, NULL, 
MXML_DESCEND
);

162 if(
node
 =ğ
NULL
)

164  
FALSE
;

166 
syscÚf_·¿m
.
ad_right
 = 
	`mxmlG‘IÁeg”
(
node
);

167 
	`f_şo£
(&
f
);

168 
	`mxmlD–‘e
(
syscÚf_Œ“
);

169  
TRUE
;

172  
FALSE
;

174 
	}
}

175 
»rg‘_š™
();

176 
	$sys_In™
()

178 
	`»rg‘_š™
();

179 #ià
cÚfigAPPLICATION_ALLOCATED_HEAP
 == 0

180 
	`my_mem_š™
(
SRAMIN
);

181 
	`my_mem_š™
(
SRAMEX
);

182 
	`my_mem_š™
(
SRAMCCM
);

189 if(
	`FATFS_LškDriv”
(&
NANDDISK_Driv”
, 
NANDDISKP©h
) == 0)

192 if(
	`f_mouÁ
(&
NANDDISKF©Fs
, (
TCHAR
 cÚ¡ *)
NANDDISKP©h
, 1è!ğ
FR_OK
)

195 
	`E¼Ü_HªdËr
();

202 
	`ü—‹_sy¡em_dœ
();

203 
	`ü—‹_syscÚf_xml
();

204 
	`»ad_syscÚf_xml
();

209 
	`WM_S‘C»©eFÏgs
(
WM_CF_MEMDEV
);

210 
	`GUI_In™
();

211 
	`WM_MULTIBUF_EÇbË
(1);

213 
	`x´štf
("\nsystem initialized\n\r");

214 
	`x´štf
("\nhello charger\n\r");

215 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskOTA.c

8 
	~"skü—‹.h
"

9 
	~"skOTA.h
"

10 
	$vTaskOTA
(*
pvP¬am‘”s
)

14 #ià
DEBUG_TASK


15 
	`x´štf
("%s\n", 
TASKNAME_OTA
);

17 
	`vTaskD–ay
(1000);

19 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskOTA.h

8 #iâdeà 
__TASKOTA_H


9 
	#__TASKOTA_H


	)

	@D:\Documents\Projects\chargersdk\src\app\taskcharge.c

8 
	~"skü—‹.h
"

9 
	~"skch¬ge.h
"

10 
	~"š‹rçû.h
"

12 
	$vTaskEVSECh¬ge
(*
pvP¬am‘”s
)

14 
ušt32_t
 
ulTÙ®Pošt
 = 
pLi¡Ch¬gePošt
->
TÙ®
;

15 
Ch¬gePošt_t
 *
pPošt
[
ulTÙ®Pošt
];

16 
i
;

17 
Ev’tB™s_t
 
uxB™s
;

18 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

20 
pPošt
[
i
] = (
Ch¬gePošt_t
 *)(
pLi¡Ch¬gePošt
->
pLi¡PoštA¼ay
[i]);

24 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

26 
pPošt
[
i
]->
¡©e
)

28 
POINT_IDLE
:

29 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
,

30 
defEv’tB™StdPlugOK
,

31 
pdFALSE
,…dFALSE, 0);

32 if((
uxB™s
 & 
defEv’tB™StdPlugOK
) == defEventBitStdPlugOK)

36 
pPošt
[
i
]->
¡©e
 = 
POINT_PLUGED
;

38 
POINT_PLUGED
:

39 if(
pPošt
[
i
]->
šfo
.
ucCÚÃùÜTy³
 =ğ
defCÚÃùÜTy³B
)

41 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
,

42 
defEv’tB™StdLocked
,

43 
pdFALSE
,…dFALSE, 0);

44 if((
uxB™s
 & 
defEv’tB™StdLocked
) == defEventBitStdLocked)

50 
pPošt
[
i
]->
¡©us
.
	`S‘BTy³CÚÃùÜLock
ÕPošt[i], 
SWITCH_ON
);

53 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
,

54 
defEv’tB™CPSw™chCÚd™iÚ
,

55 
pdFALSE
, 
pdTRUE
, 100);

56 if((
uxB™s
 & 
defEv’tB™CPSw™chCÚd™iÚ
) == defEventBitCPSwitchCondition)

58 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`S‘CPSw™ch
ÕPošt[i], 
SWITCH_ON
), 
ERR_LEVEL_CRITICAL
);

59 
	`vTaskD–ay
(100);

65 if(
pPošt
[
i
]->
¡©us
.
xCPS‹
 =ğ
CP_9V_PWM
 ||…Pošt[i]->¡©us.xCPS‹ =ğ
CP_6V_PWM
)

67 
pPošt
[
i
]->
¡©e
 = 
POINT_PRECONTRACT
;

70 
POINT_PRECONTRACT
:

71 if(
pPošt
[
i
]->
¡©us
.
xCPS‹
 =ğ
CP_6V_PWM
)

73 
pPošt
[
i
]->
¡©e
 = 
POINT_STARTCHARGE
;

76 
POINT_STARTCHARGE
:

77 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`S¹Ch¬ge
ÕPošt[i]), 
ERR_LEVEL_CRITICAL
);

78 if(
pPošt
[
i
]->
¡©us
.
ucR–ayLS‹
 =ğ
SWITCH_ON
 &&

79 
pPošt
[
i
]->
¡©us
.
ucR–ayNS‹
 =ğ
SWITCH_ON
)

81 
pPošt
[
i
]->
¡©e
 = 
POINT_CHARGING
;

84 
POINT_CHARGING
:

85 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tExû±iÚ
,

86 
defEv’tB™Exû±iÚCr™iÿl


87 
pdFALSE
,…dFALSE, 0);

88 if((
uxB™s
 & 
defEv’tB™Exû±iÚCr™iÿl
) != 0)

90 
pPošt
[
i
]->
¡©us
.
	`StİCh¬ge
(pPoint[i]);

91 
pPošt
[
i
]->
¡©e
 = 
POINT_ERROR
;

95 
POINT_ERROR
:

102 #ià
DEBUG_CHARGE


103 
	`x´štf
("%s\n", 
TASKNAME_EVSECh¬ge
);

105 
	`vTaskD–ay
(10);

107 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskcharge.h

8 #iâdeà 
__TASKCHARGE_H


9 
	#__TASKCHARGE_H


	)

	@D:\Documents\Projects\chargersdk\src\app\taskcreate.c

14 
	~"šşudes.h
"

15 
	~"š‹rçû.h
"

16 
	~"şi_maš.h
"

20 
	#defSTACK_TaskCLI
 512

	)

21 
	#defSTACK_TaskGUI
 1024

	)

22 
	#defSTACK_TaskTouch
 128

	)

23 
	#defSTACK_TaskOTA
 512

	)

25 
	#defSTACK_TaskEVSERemÙe
 512

	)

26 
	#defSTACK_TaskEVSERFID
 512

	)

27 
	#defSTACK_TaskEVSECh¬ge
 512

	)

28 
	#defSTACK_TaskEVSEMÚ™Ü
 512

	)

29 
	#defSTACK_TaskEVSEDŸg
 512

	)

30 
	#defSTACK_TaskEVSED©a
 512

	)

36 
	#defPRIORITY_TaskCLI
 1

	)

37 
	#defPRIORITY_TaskGUI
 1

	)

38 
	#defPRIORITY_TaskTouch
 1

	)

39 
	#defPRIORITY_TaskOTA
 15

	)

41 
	#defPRIORITY_TaskEVSERemÙe
 3

	)

42 
	#defPRIORITY_TaskEVSERFID
 4

	)

43 
	#defPRIORITY_TaskEVSECh¬ge
 5

	)

44 
	#defPRIORITY_TaskEVSEMÚ™Ü
 7

	)

45 
	#defPRIORITY_TaskEVSEDŸg
 9

	)

46 
	#defPRIORITY_TaskEVSED©a
 1

	)

51 cÚ¡ *
	gTASKNAME_CLI
 = "TaskCLI";

52 cÚ¡ *
	gTASKNAME_GUI
 = "TaskGUI";

53 cÚ¡ *
	gTASKNAME_Touch
 = "TaskTouch";

54 cÚ¡ *
	gTASKNAME_OTA
 = "TaskOTA";

55 cÚ¡ *
	gTASKNAME_EVSERemÙe
 = "TaskEVSERemote";

56 cÚ¡ *
	gTASKNAME_EVSERFID
 = "TaskEVSERFID";

57 cÚ¡ *
	gTASKNAME_EVSECh¬ge
 = "TaskEVSECharge";

58 cÚ¡ *
	gTASKNAME_EVSEMÚ™Ü
 = "TaskEVSEMonitor";

59 cÚ¡ *
	gTASKNAME_EVSEDŸg
 = "TaskEVSEDiag";

60 cÚ¡ *
	gTASKNAME_EVSED©a
 = "TaskEVSEData";

65 
vTaskCLI
(*
pvP¬am‘”s
);

66 
vTaskGUI
(*
pvP¬am‘”s
);

67 
vTaskTouch
(*
pvP¬am‘”s
);

68 
vTaskOTA
(*
pvP¬am‘”s
);

70 
vTaskEVSERemÙe
(*
pvP¬am‘”s
);

71 
vTaskEVSERFID
(*
pvP¬am‘”s
);

72 
vTaskEVSECh¬ge
(*
pvP¬am‘”s
);

73 
vTaskEVSEMÚ™Ü
(*
pvP¬am‘”s
);

74 
vTaskEVSEDŸg
(*
pvP¬am‘”s
);

75 
vTaskEVSED©a
(*
pvP¬am‘”s
);

80 
TaskHªdË_t
 
	gxHªdËTaskCLI
 = 
NULL
;

81 
TaskHªdË_t
 
	gxHªdËTaskGUI
 = 
NULL
;

82 
TaskHªdË_t
 
	gxHªdËTaskTouch
 = 
NULL
;

83 
TaskHªdË_t
 
	gxHªdËTaskOTA
 = 
NULL
;

85 
TaskHªdË_t
 
	gxHªdËTaskEVSERemÙe
 = 
NULL
;

86 
TaskHªdË_t
 
	gxHªdËTaskEVSERFID
 = 
NULL
;

87 
TaskHªdË_t
 
	gxHªdËTaskEVSECh¬ge
 = 
NULL
;

88 
TaskHªdË_t
 
	gxHªdËTaskEVSEMÚ™Ü
 = 
NULL
;

89 
TaskHªdË_t
 
	gxHªdËTaskEVSEDŸg
 = 
NULL
;

90 
TaskHªdË_t
 
	gxHªdËTaskEVSED©a
 = 
NULL
;

94 
Ev’tGroupHªdË_t
 
	gxHªdËEv’tTim”CBNÙify
 = 
NULL
;

95 
Ev’tGroupHªdË_t
 
	gxHªdËEv’tD©a
 = 
NULL
;

96 
Ev’tGroupHªdË_t
 
	gxHªdËEv’tDŸg
 = 
NULL
;

97 
Ev’tGroupHªdË_t
 
	gxHªdËEv’tRemÙe
 = 
NULL
;

104 
QueueHªdË_t
 
	gxHªdËQueueOrd”s
 = 
NULL
;

105 
QueueHªdË_t
 
	gxHªdËQueueE¼ÜPackage
 = 
NULL
;

107 
Tim”HªdË_t
 
	gxHªdËTim”Temp
 = 
NULL
;

108 
Tim”HªdË_t
 
	gxHªdËTim”LockS‹
 = 
NULL
;

109 
Tim”HªdË_t
 
	gxHªdËTim”G‘Ch¬gePošt
 = 
NULL
;

110 
Tim”HªdË_t
 
	gxHªdËTim”PlugS‹
 = 
NULL
;

111 
Tim”HªdË_t
 
	gxHªdËTim”Ch¬gšgD©a
 = 
NULL
;

112 
Tim”HªdË_t
 
	gxHªdËTim”EVSES‹
 = 
NULL
;

113 
Tim”HªdË_t
 
	gxHªdËTim”RFID
 = 
NULL
;

114 
Tim”HªdË_t
 
	gxHªdËTim”D©aReäesh
 = 
NULL
;

117 
	$vTaskCLI
(*
pvP¬am‘”s
)

119 
	`şi_maš
();

120 
	}
}

122 
	$vTaskGUI
(*
pvP¬am‘”s
)

124 
	`MašTask
();

126 
	}
}

128 
	$vTaskTouch
(*
pvP¬am‘”s
)

132 
	`GUI_TOUCH_Exec
();

133 
	`vTaskD–ay
(10);

135 
	}
}

137 
	$SysTaskC»©e
 ()

139 
	`xTaskC»©e
Ğ
vTaskCLI
, 
TASKNAME_CLI
, 
defSTACK_TaskCLI
, 
NULL
, 
defPRIORITY_TaskCLI
, &
xHªdËTaskCLI
 );

140 
	`xTaskC»©e
Ğ
vTaskGUI
, 
TASKNAME_GUI
, 
defSTACK_TaskGUI
, 
NULL
, 
defPRIORITY_TaskGUI
, &
xHªdËTaskGUI
 );

141 
	`xTaskC»©e
Ğ
vTaskTouch
, 
TASKNAME_Touch
, 
defSTACK_TaskTouch
, 
NULL
, 
defPRIORITY_TaskTouch
, &
xHªdËTaskTouch
 );

142 
	`xTaskC»©e
Ğ
vTaskOTA
, 
TASKNAME_OTA
, 
defSTACK_TaskOTA
, 
NULL
, 
defPRIORITY_TaskOTA
, &
xHªdËTaskOTA
 );

143 
	}
}

145 
	$AµTaskC»©e
 ()

147 
	`xTaskC»©e
Ğ
vTaskEVSERemÙe
, 
TASKNAME_EVSERemÙe
, 
defSTACK_TaskEVSERemÙe
, 
NULL
, 
defPRIORITY_TaskEVSERemÙe
, &
xHªdËTaskEVSERemÙe
 );

148 
	`xTaskC»©e
Ğ
vTaskEVSERFID
, 
TASKNAME_EVSERFID
, 
defSTACK_TaskEVSERFID
, 
NULL
, 
defPRIORITY_TaskEVSERFID
, &
xHªdËTaskEVSERFID
 );

149 
	`xTaskC»©e
Ğ
vTaskEVSECh¬ge
, 
TASKNAME_EVSECh¬ge
, 
defSTACK_TaskEVSECh¬ge
, 
NULL
, 
defPRIORITY_TaskEVSECh¬ge
, &
xHªdËTaskEVSECh¬ge
 );

150 
	`xTaskC»©e
Ğ
vTaskEVSEMÚ™Ü
, 
TASKNAME_EVSEMÚ™Ü
, 
defSTACK_TaskEVSEMÚ™Ü
, 
NULL
, 
defPRIORITY_TaskEVSEMÚ™Ü
, &
xHªdËTaskEVSEMÚ™Ü
 );

151 
	`xTaskC»©e
Ğ
vTaskEVSEDŸg
, 
TASKNAME_EVSEDŸg
, 
defSTACK_TaskEVSEDŸg
, 
NULL
, 
defPRIORITY_TaskEVSEDŸg
, &
xHªdËTaskEVSEDŸg
 );

152 
	`xTaskC»©e
Ğ
vTaskEVSED©a
, 
TASKNAME_EVSED©a
, 
defSTACK_TaskEVSED©a
, 
NULL
, 
defPRIORITY_TaskEVSED©a
, &
xHªdËTaskEVSED©a
 );

153 
	}
}

157 
vEVSETim”CB
(
Tim”HªdË_t
 
xTim”
);

158 
vCh¬gePoštTim”CB
(
Tim”HªdË_t
 
xTim”
);

159 
vRFIDTim”CB
(
Tim”HªdË_t
 
xTim”
);

160 
	$AµObjC»©e
 ()

162 
xHªdËEv’tTim”CBNÙify
 = 
	`xEv’tGroupC»©e
();

163 
xHªdËEv’tD©a
 = 
	`xEv’tGroupC»©e
();

164 
xHªdËEv’tDŸg
 = 
	`xEv’tGroupC»©e
();

165 
xHªdËEv’tRemÙe
 = 
	`xEv’tGroupC»©e
();

168 
xHªdËQueueOrd”s
 = 
	`xQueueC»©e
(2, (
Ord”D©a_t
));

169 
xHªdËQueueE¼ÜPackage
 = 
	`xQueueC»©e
(100, (
E¼ÜPackage_t
));

171 
xHªdËTim”Temp
 = 
	`xTim”C»©e
("Tim”Temp", 5000, 
pdTRUE
, (*)
defTIMERID_Temp
, 
vCh¬gePoštTim”CB
);

172 
xHªdËTim”LockS‹
 = 
	`xTim”C»©e
("Tim”LockS‹", 1000, 
pdTRUE
, (*)
defTIMERID_LockS‹
, 
vCh¬gePoštTim”CB
);

173 
xHªdËTim”PlugS‹
 = 
	`xTim”C»©e
("Tim”PlugS‹", 50, 
pdTRUE
, (*)
defTIMERID_PlugS‹
, 
vCh¬gePoštTim”CB
);

174 
xHªdËTim”Ch¬gšgD©a
 = 
	`xTim”C»©e
("Tim”Ch¬gšgD©a", 50, 
pdTRUE
, (*)
defTIMERID_Ch¬gšgD©a
, 
vCh¬gePoštTim”CB
);

175 
xHªdËTim”EVSES‹
 = 
	`xTim”C»©e
("Tim”EVSES‹", 50, 
pdTRUE
, (*)
defTIMERID_EVSES‹
, 
vEVSETim”CB
);

176 
xHªdËTim”RFID
 = 
	`xTim”C»©e
("Tim”RFID", 500, 
pdTRUE
, (*)
defTIMERID_RFID
, 
vRFIDTim”CB
);

177 
xHªdËTim”D©aReäesh
 = 
	`xTim”C»©e
("Tim”D©aReäesh", 1000, 
pdTRUE
, (*)
defTIMERID_DATAREFRESH
, 
vEVSETim”CB
);

178 
	`xTim”S¹
(
xHªdËTim”Temp
, 0);

179 
	`xTim”S¹
(
xHªdËTim”LockS‹
, 0);

180 
	`xTim”S¹
(
xHªdËTim”PlugS‹
, 0);

181 
	`xTim”S¹
(
xHªdËTim”Ch¬gšgD©a
, 0);

182 
	`xTim”S¹
(
xHªdËTim”EVSES‹
, 0);

183 
	`xTim”S¹
(
xHªdËTim”RFID
, 0);

184 
	`xTim”S¹
(
xHªdËTim”D©aReäesh
, 0);

186 
	}
}

187 vŞ©
ušt32_t
 
	gulHighF»qu’cyTim”Ticks
 = 0UL;

188 
	$vAµliÿtiÚTickHook
( )

190 
ulHighF»qu’cyTim”Ticks
 = 
	`xTaskG‘TickCouÁ
();

191 
	}
}

205 
	$vAµliÿtiÚM®locFaedHook
( )

207 
	`skDISABLE_INTERRUPTS
();

209 
	}
}

223 
	$vAµliÿtiÚIdËHook
( )

225 
	}
}

233 
	$vAµliÿtiÚSckOv”æowHook
Ğ
TaskHªdË_t
 
pxTask
, *
pcTaskName
 )

235 Ğè
pcTaskName
;

236 Ğè
pxTask
;

241 
	`´štf_§ã
("¡ackov”æow!!ask = %s\n",
pcTaskName
);

242 
	`skDISABLE_INTERRUPTS
();

244 
	}
}

246 
	$vAs£¹C®Ëd
ĞcÚ¡ *
pcFe
,

247 
ulLše
 )

249 vŞ©
ul
 = 0;

251 
	`skENTER_CRITICAL
();

253  
ul
 == 0 )

255 
	`pÜtNOP
();

258 
	`skEXIT_CRITICAL
();

259 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskcreate.h

8 #iâdeà 
__TASKCREATE_H


9 
	#__TASKCREATE_H


	)

11 
	~"šşudes.h
"

13 
	#defTIMERID_Temp
 0

	)

14 
	#defTIMERID_LockS‹
 1

	)

15 
	#defTIMERID_CPCCS‹
 2

	)

16 
	#defTIMERID_Ch¬gšgD©a
 3

	)

17 
	#defTIMERID_EVSES‹
 4

	)

18 
	#defTIMERID_RFID
 5

	)

19 
	#defTIMERID_DATAREFRESH
 6

	)

21 cÚ¡ *
TASKNAME_CLI
;

22 cÚ¡ *
TASKNAME_GUI
;

23 cÚ¡ *
TASKNAME_Touch
;

24 cÚ¡ *
TASKNAME_OTA
;

25 cÚ¡ *
TASKNAME_EVSERemÙe
;

26 cÚ¡ *
TASKNAME_EVSERFID
;

27 cÚ¡ *
TASKNAME_EVSECh¬ge
;

28 cÚ¡ *
TASKNAME_EVSEMÚ™Ü
;

29 cÚ¡ *
TASKNAME_EVSEDŸg
;

30 cÚ¡ *
TASKNAME_EVSED©a
;

32 
Ev’tGroupHªdË_t
 
xHªdËEv’tTim”CBNÙify
;

33 
Ev’tGroupHªdË_t
 
xHªdËEv’tD©a
;

34 
Ev’tGroupHªdË_t
 
xHªdËEv’tDŸg
;

35 
Ev’tGroupHªdË_t
 
xHªdËEv’tRemÙe
;

38 
QueueHªdË_t
 
xHªdËQueueOrd”s
;

39 
QueueHªdË_t
 
xHªdËQueueE¼ÜPackage
;

41 
SysTaskC»©e
 ();

42 
AµTaskC»©e
 ();

43 
AµObjC»©e
();

	@D:\Documents\Projects\chargersdk\src\app\taskdata.c

8 
	~"šşudes.h
"

9 
	~"skü—‹.h
"

10 
	~"skd©a.h
"

11 
	~"š‹rçû.h
"

12 
	$vTaskEVSED©a
(*
pvP¬am‘”s
)

14 
ušt32_t
 
ulTÙ®Pošt
 = 
pLi¡Ch¬gePošt
->
TÙ®
;

15 
Ch¬gePošt_t
 *
pPošt
[
ulTÙ®Pošt
];

16 
i
;

17 
Ev’tB™s_t
 
uxB™s
;

19 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

21 
pPošt
[
i
] = (
Ch¬gePošt_t
 *)(
pLi¡Ch¬gePošt
->
pLi¡PoštA¼ay
[i]);

23 
uxB™s
 = 0;

25 
	`THROW_ERROR
(
	`C»©eOrd”XML
(), 
ERR_LEVEL_WARNING
);

29 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBD©aReäesh
, 
pdTRUE
, 
pdFALSE
, 0);

30 if((
uxB™s
 & 
defEv’tB™Tim”CBD©aReäesh
) == defEventBitTimerCBDataRefresh)

32 
	`THROW_ERROR
(
pEVSE
->
šfo
.
	`G‘SN
ÕEVSE), 
ERR_LEVEL_WARNING
);

33 
	`THROW_ERROR
(
pEVSE
->
šfo
.
	`G‘ID
ÕEVSE), 
ERR_LEVEL_WARNING
);

34 
	`THROW_ERROR
(
pEVSE
->
šfo
.
	`G‘Ty³
ÕEVSE), 
ERR_LEVEL_WARNING
);

35 
	`THROW_ERROR
(
pEVSE
->
šfo
.
	`G‘TÙ®Pošt
ÕEVSE), 
ERR_LEVEL_WARNING
);

36 
	`THROW_ERROR
(
pEVSE
->
šfo
.
	`G‘LngL©
ÕEVSE), 
ERR_LEVEL_WARNING
);

37 
i
 = 0; i < 
pEVSE
->
šfo
.
ucTÙ®Pošt
; i++)

39 
	`THROW_ERROR
(
pPošt
[
i
]->
šfo
.
	`G‘CÚÃùÜTy³
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

40 
	`THROW_ERROR
(
pPošt
[
i
]->
šfo
.
	`G‘VŞ©ageUµ”Lim™s
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

41 
	`THROW_ERROR
(
pPošt
[
i
]->
šfo
.
	`G‘VŞ©ageLow”Lim™s
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

42 
	`THROW_ERROR
(
pPošt
[
i
]->
šfo
.
	`G‘R©edCu¼’t
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

43 
	`THROW_ERROR
(
pPošt
[
i
]->
šfo
.
	`G‘R©edPow”
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

55 #ià
DEBUG_DATA


56 
	`´štf_§ã
("%s\n", 
TASKNAME_EVSED©a
);

58 
	`vTaskD–ay
(100);

60 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskdata.h

8 #iâdeà 
__TASKDATA_H


9 
	#__TASKDATA_H


	)

	@D:\Documents\Projects\chargersdk\src\app\taskdiag.c

8 
	~"skü—‹.h
"

9 
	~"skdŸg.h
"

11 
	$vTaskEVSEDŸg
(*
pvP¬am‘”s
)

13 
ušt32_t
 
ulTÙ®Pošt
 = 
pLi¡Ch¬gePošt
->
TÙ®
;

14 
Ch¬gePošt_t
 *
pPošt
[
ulTÙ®Pošt
];

15 
i
;

16 
Ev’tB™s_t
 
uxB™s
;

17 
Ba£Ty³_t
 
xResuÉ
;

18 
E¼ÜPackage_t
 
”½ack
;

20 
xResuÉ
 = 
pdFALSE
;

21 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

23 
pPošt
[
i
] = (
Ch¬gePošt_t
 *)(
pLi¡Ch¬gePošt
->
pLi¡PoštA¼ay
[i]);

29 
xResuÉ
 = 
	`xQueueReûive
(
xHªdËQueueE¼ÜPackage
, &
”½ack
, 0);

30 if(
xResuÉ
 =ğ
pdTRUE
 && 
”½ack
.
Ëv–
 =ğ
ERR_LEVEL_CRITICAL
)

32 #ifdeà
DEBUG_DIAG


33 
	`´štf_§ã
("%s(code: %d,Ëv–: %d)\n", 
¡rE¼ÜCode
[
”½ack
.
code
],ƒ¼·ck.code,ƒ¼·ck.
Ëv–
);

39 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

41 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tExû±iÚ
, 
defEv’tB™Exû±iÚTempW
,
pdTRUE
,
pdFALSE
,0);

42 if((
uxB™s
 & 
defEv’tB™Exû±iÚTempW
) == defEventBitExceptionTempW)

44 
pPošt
[
i
]->
¡©us
.
	`S‘LßdP”ûÁ
(pPoint[i], 50);

50 #ià
DEBUG_DIAG


51 
	`´štf_§ã
("%s\n", 
TASKNAME_EVSEDŸg
);

53 
	`vTaskD–ay
(10);

55 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskdiag.h

8 #iâdeà 
__TASKDIAG_H


9 
	#__TASKDIAG_H


	)

	@D:\Documents\Projects\chargersdk\src\app\taskmonitor.c

8 
	~"skü—‹.h
"

9 
	~"skmÚ™Ü.h
"

10 
	~"š‹rçû.h
"

12 
E¼ÜLev–_t
 
	$HªdËTemp
(
Ch¬gePošt_t
 *
pPošt
, 
‹mp
, 
low”
, 
uµ”
)

14 
E¼ÜLev–_t
 
”¾ev–
;

15 if(
‹mp
 >ğ
low”
 ||em°<ğ
uµ”
 )

17 if(
‹mp
 >ğ
uµ”
 - 10)

19 
”¾ev–
 = 
ERR_LEVEL_WARNING
;

23 
”¾ev–
 = 
ERR_LEVEL_OK
;

26 if(
‹mp
 > 
uµ”
)

28 
”¾ev–
 = 
ERR_LEVEL_CRITICAL
;

30 if(
‹mp
 < 
low”
)

34  
”¾ev–
;

35 
	}
}

37 
	$vTaskEVSEMÚ™Ü
(*
pvP¬am‘”s
)

39 
ušt32_t
 
ulTÙ®Pošt
 = 
pLi¡Ch¬gePošt
->
TÙ®
;

40 
Ch¬gePošt_t
 *
pPošt
[
ulTÙ®Pošt
];

41 
i
;

42 
ušt8_t
 
ucCu¼’tId
;

43 
Ev’tB™s_t
 
uxB™s
;

44 
E¼ÜLev–_t
 
”¾ev–
;

45 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

47 
pPošt
[
i
] = (
Ch¬gePošt_t
 *)(
pLi¡Ch¬gePošt
->
pLi¡PoštA¼ay
[i]);

49 
ucCu¼’tId
 = 0;

50 
uxB™s
 = 0;

55 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBTemp
, 
pdTRUE
, 
pdFALSE
, 0);

56 if((
uxB™s
 & 
defEv’tB™Tim”CBTemp
) == defEventBitTimerCBTemp)

58 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

60 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘ACLTemp
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

61 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘ACNTemp
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

62 if(
pPošt
[
i
]->
šfo
.
ucCÚÃùÜTy³
 =ğ
defCÚÃùÜTy³B
)

64 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘BTy³CÚÃùÜTemp1
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

65 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘BTy³CÚÃùÜTemp2
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

69 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBLockS‹
, 
pdTRUE
, 
pdFALSE
, 0);

70 if((
uxB™s
 & 
defEv’tB™Tim”CBLockS‹
) == defEventBitTimerCBLockState)

72 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

74 if(
pPošt
[
i
]->
šfo
.
ucCÚÃùÜTy³
 =ğ
defCÚÃùÜTy³B
)

76 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘BTy³CÚÃùÜLock
ÕPošt[i]), 
ERR_LEVEL_WARNING
);

80 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBPlugS‹
, 
pdTRUE
, 
pdFALSE
, 0);

81 if((
uxB™s
 & 
defEv’tB™Tim”CBPlugS‹
) == defEventBitTimerCBPlugState)

83 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

85 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘PlugS‹
ÕPošt[i]), 
ERR_LEVEL_CRITICAL
);

88 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBCh¬gšgD©a
, 
pdTRUE
, 
pdFALSE
, 0);

89 if((
uxB™s
 & 
defEv’tB™Tim”CBCh¬gšgD©a
) == defEventBitTimerCBChargingData)

91 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

93 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘Ch¬gšgVŞge
ÕPošt[i]), 
ERR_LEVEL_CRITICAL
);

94 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘Ch¬gšgCu¼’t
ÕPošt[i]), 
ERR_LEVEL_CRITICAL
);

95 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘Ch¬gšgF»qu’û
ÕPošt[i]), 
ERR_LEVEL_CRITICAL
);

96 
	`THROW_ERROR
(
i
, 
pPošt
[i]->
¡©us
.
	`G‘R–ayS‹
ÕPošt[i]), 
ERR_LEVEL_CRITICAL
);

99 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBEVSES‹
, 
pdTRUE
, 
pdFALSE
, 0);

100 if((
uxB™s
 & 
defEv’tB™Tim”CBEVSES‹
) == defEventBitTimerCBEVSEState)

102 
	`THROW_ERROR
(
defDevID_EVSE
, 
pEVSE
->
¡©us
.
	`G‘SüamS‹
ÕEVSE), 
ERR_LEVEL_CRITICAL
);

103 
	`THROW_ERROR
(
defDevID_EVSE
, 
pEVSE
->
¡©us
.
	`G‘PES‹
ÕEVSE), 
ERR_LEVEL_CRITICAL
);

104 
	`THROW_ERROR
(
defDevID_EVSE
, 
pEVSE
->
¡©us
.
	`G‘KnockS‹
ÕEVSE), 
ERR_LEVEL_TIPS
);

105 
	`THROW_ERROR
(
defDevID_EVSE
, 
pEVSE
->
¡©us
.
	`G‘A¼e¡”S‹
ÕEVSE), 
ERR_LEVEL_TIPS
);

106 
	`THROW_ERROR
(
defDevID_EVSE
, 
pEVSE
->
¡©us
.
	`G‘Pow”OffS‹
ÕEVSE), 
ERR_LEVEL_TIPS
);

108 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBRFID
, 
pdTRUE
, 
pdFALSE
, 0);

109 if((
uxB™s
 & 
defEv’tB™Tim”CBRFID
) == defEventBitTimerCBRFID)

111 
	`THROW_ERROR
(
defDevID_RFID
, 
pRFIDDev
->
¡©us
.
	`G‘UID
ÕRFIDDev), 
ERR_LEVEL_CRITICAL
);

117 if((
uxB™s
 & 
defEv’tB™Tim”CBTemp
) == defEventBitTimerCBTemp)

119 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

122 
”¾ev–
 = 
	`HªdËTemp
(
pPošt
[
i
]->
¡©us
.
dACLTemp
,

123 
pPošt
[
i
]->
šfo
.
dACTempLow”Lim™s
,

124 
pPošt
[
i
]->
šfo
.
dACTempUµ”Lim™s
);

125 
”¾ev–
)

127 
ERR_LEVEL_OK
:

128 
	`xEv’tGroupCË¬B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tExû±iÚ
, 
defEv’tB™Exû±iÚTempW
);

129 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdACTempOK
);

131 
ERR_LEVEL_WARNING
:

132 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tExû±iÚ
, 
defEv’tB™Exû±iÚTempW
);

133 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdACTempOK
);

135 
ERR_LEVEL_CRITICAL
:

137 
	`xEv’tGroupCË¬B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdACTempOK
);

138 
	`ThrowE¼ÜCode
(
i
, 
ERR_POINT_ACLTEMP_DECT_FAULT
, 
ERR_LEVEL_CRITICAL
);

143 
”¾ev–
 = 
	`HªdËTemp
(
pPošt
[
i
]->
¡©us
.
dACNTemp
,

144 
pPošt
[
i
]->
šfo
.
dACTempLow”Lim™s
,

145 
pPošt
[
i
]->
šfo
.
dACTempUµ”Lim™s
);

146 
”¾ev–
)

148 
ERR_LEVEL_OK
:

149 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdACTempOK
);

151 
ERR_LEVEL_WARNING
:

152 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tExû±iÚ
, 
defEv’tB™Exû±iÚTempW
);

153 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdACTempOK
);

155 
ERR_LEVEL_CRITICAL
:

157 
	`xEv’tGroupCË¬B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdACTempOK
);

158 
	`ThrowE¼ÜCode
(
i
, 
ERR_POINT_ACNTEMP_DECT_FAULT
, 
ERR_LEVEL_CRITICAL
);

162 if(
pPošt
[
i
]->
šfo
.
ucCÚÃùÜTy³
 =ğ
defCÚÃùÜTy³B
)

165 
”¾ev–
 = 
	`HªdËTemp
(
pPošt
[
i
]->
¡©us
.
dBTy³CÚÃùÜTemp1
,

166 
pPošt
[
i
]->
šfo
.
dCÚÃùÜTempLow”Lim™s
,

167 
pPošt
[
i
]->
šfo
.
dCÚÃùÜTempUµ”Lim™s
);

168 
”¾ev–
)

170 
ERR_LEVEL_OK
:

171 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdCÚnTempOK
);

173 
ERR_LEVEL_WARNING
:

175 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tExû±iÚ
, 
defEv’tB™Exû±iÚTempW
);

176 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdCÚnTempOK
);

178 
ERR_LEVEL_CRITICAL
:

180 
	`xEv’tGroupCË¬B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdCÚnTempOK
);

181 
	`ThrowE¼ÜCode
(
i
, 
ERR_POINT_BTEMP1_DECT_FAULT
, 
ERR_LEVEL_CRITICAL
);

186 
”¾ev–
 = 
	`HªdËTemp
(
pPošt
[
i
]->
¡©us
.
dBTy³CÚÃùÜTemp2
,

187 
pPošt
[
i
]->
šfo
.
dCÚÃùÜTempLow”Lim™s
,

188 
pPošt
[
i
]->
šfo
.
dCÚÃùÜTempUµ”Lim™s
);

189 
”¾ev–
)

191 
ERR_LEVEL_OK
:

192 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdCÚnTempOK
);

194 
ERR_LEVEL_WARNING
:

196 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tExû±iÚ
, 
defEv’tB™Exû±iÚTempW
);

197 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdCÚnTempOK
);

199 
ERR_LEVEL_CRITICAL
:

201 
	`xEv’tGroupCË¬B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdCÚnTempOK
);

202 
	`ThrowE¼ÜCode
(
i
, 
ERR_POINT_BTEMP2_DECT_FAULT
, 
ERR_LEVEL_CRITICAL
);

208 if((
uxB™s
 & 
defEv’tB™Tim”CBLockS‹
) == defEventBitTimerCBLockState)

210 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

212 if(
pPošt
[
i
]->
šfo
.
ucCÚÃùÜTy³
 =ğ
defCÚÃùÜTy³B
)

214 if(
pPošt
[
i
]->
¡©us
.
xBTy³CÚÃùÜLockS‹
 =ğ
LOCK
)

216 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdLocked
);

220 
	`xEv’tGroupCË¬B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdLocked
);

226 if((
uxB™s
 & 
defEv’tB™Tim”CBPlugS‹
) == defEventBitTimerCBPlugState)

228 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

230 if(
pPošt
[
i
]->
¡©us
.
xPlugS‹
 =ğ
PLUG
)

232 
	`xEv’tGroupS‘B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdPlugOK
);

234 if(
pPošt
[
i
]->
¡©us
.
xPlugS‹
 =ğ
UNPLUG
)

236 
	`xEv’tGroupCË¬B™s
(
pPošt
[
i
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdPlugOK
);

240 if((
uxB™s
 & 
defEv’tB™Tim”CBCh¬gšgD©a
) == defEventBitTimerCBChargingData)

242 
i
 = 0; i < 
ulTÙ®Pošt
; i++)

249 if((
uxB™s
 & 
defEv’tB™Tim”CBEVSES‹
) == defEventBitTimerCBEVSEState)

260 #ià
DEBUG_TASK


261 
	`x´štf
("%s\n", 
TASKNAME_EVSEMÚ™Ü
);

263 
	`vTaskD–ay
(50);

265 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskmonitor.h

8 #iâdeà 
__TASKMONITOR_H


9 
	#__TASKMONITOR_H


	)

	@D:\Documents\Projects\chargersdk\src\app\taskremote.c

8 
	~"šşudes.h
"

9 
	~"š‹rçû.h
"

10 
	~"skü—‹.h
"

11 
	~"sk»mÙe.h
"

13 
	$vTaskEVSERemÙe
(*
pvP¬am‘”s
)

15 
Ev’tB™s_t
 
uxB™s
 = 0;

16 
Ord”D©a_t
 
Ord”D©a
;

17 
E¼ÜCode_t
 
”rcode
;

19 
uxB™s
 = 0;

20 
Ord”D©a
.
ucAccouÁStus
 = 0;

21 
Ord”D©a
.
dB®ªû
 = 0;

22 
”rcode
 = 0;

26 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pRFIDDev
->
xHªdËEv’tGroupRFID
,

27 
defEv’tB™IsNewUID
,

28 
pdTRUE
, 
pdFALSE
, 0);

29 if((
uxB™s
 & 
defEv’tB™IsNewUID
) == defEventBitIsNewUID)

31 
	`xQueueReûive
(
xHªdËQueueOrd”s
, &
Ord”D©a
, 1000);

32 
	`THROW_ERROR
(
”rcode
 = 
	`RemÙeG‘B®ªû
(
Ord”D©a
.
ucUID
, 
defUIDL’gth
, &Ord”D©a.
ucAccouÁStus
, &Ord”D©a.
dB®ªû
), 
ERR_LEVEL_CRITICAL
);

33 if(
”rcode
 = 
ERR_NO
)

35 
	`xQueueS’d
(
xHªdËQueueOrd”s
, &
Ord”D©a
, 0);

36 
	`xEv’tGroupS‘B™s
(
pRFIDDev
->
xHªdËEv’tGroupRFID
,
defEv’tB™G‘AccouÁStus
);

39 #ià
DEBUG_REMOTE


40 
	`´štf_§ã
("%s\n", 
TASKNAME_EVSERemÙe
);

42 
	`vTaskD–ay
(100);

44 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskremote.h

8 #iâdeà 
__TASKREMOTE_H


9 
	#__TASKREMOTE_H


	)

	@D:\Documents\Projects\chargersdk\src\app\taskrfid.c

8 
	~"šşudes.h
"

9 
	~"skü—‹.h
"

10 
	~"skrfid.h
"

11 
	~"š‹rçû.h
"

13 
	e_RFIDS‹


15 
	mSTATE_NOUID
,

16 
	mSTATE_GOTUID
,

17 
	mSTATE_OLDUID
,

18 
	mSTATE_NEWUID
,

19 
	mSTATE_GOODCARD
,

20 
	mSTATE_BADCARD
,

21 
	mSTATE_OWE
,

22 
	mSTATE_PRECONTRACT


23 } 
	tRFIDS‹_t
;

24 
	$Ord”In™D©a
(
Ord”D©a_t
 *
Üd”
)

26 
Üd”
->
dB®ªû
 = 0;

27 
Üd”
->
ucAccouÁStus
 = 0;

28 
	`memmove
(
Üd”
->
ucEVSESN
, 
pEVSE
->
šfo
.
ucSN
, 
defEVSESNL’gth
);

29 
Üd”
->
ucPoštID
 = 0;

30 
	`mem£t
(
Üd”
->
ucUID
, 0, 
defUIDL’gth
);

31 
	}
}

32 
	$vTaskEVSERFID
(*
pvP¬am‘”s
)

34 
i
;

35 
Ev’tB™s_t
 
uxB™s
;

36 
E¼ÜCode_t
 
”rcode
;

37 
Ch¬gePošt_t
 *
pPošt
[2];

38 
ušt8_t
 
ucTÙ®
;

39 
Ord”D©a_t
 
Ord”D©a
;

40 
RFIDS‹_t
 
RFIDS‹
;

42 
	`Ord”In™D©a
(&
Ord”D©a
);

43 
ucTÙ®
 = 
pEVSE
->
šfo
.
ucTÙ®Pošt
;

44 
i
 = 0; i < 
ucTÙ®
; i++)

46 
pPošt
[
i
] = 
	`Ch¬gePoštG‘HªdË
(i);

48 
uxB™s
 = 0;

49 
”rcode
 = 
ERR_NO
;

50 
RFIDS‹
 = 
STATE_NOUID
;

53 
RFIDS‹
)

55 
STATE_NOUID
:

56 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pRFIDDev
->
xHªdËEv’tGroupRFID
,

57 
defEv’tB™GÙUIDtoRFID
,

58 
pdTRUE
, 
pdFALSE
, 
pÜtMAX_DELAY
);

59 if((
uxB™s
 & 
defEv’tB™GÙUIDtoRFID
) == defEventBitGotUIDtoRFID)

61 
	`memmove
(
Ord”D©a
.
ucUID
, 
pRFIDDev
->
¡©us
.ucUID, 
defUIDL’gth
);

62 
RFIDS‹
 = 
STATE_GOTUID
;

65 
STATE_GOTUID
:

66 #ifdeà
DEBUG_RFID


67 
	`´štf_§ã
("im„fidask,find card, :)\n");

68 
	`´štf_§ã
("UID = ");

69 
i
 = 0; i < 
defUIDL’gth
; i++)

71 
	`´štf_§ã
("%x", 
Ord”D©a
.
ucUID
[
i
]);

73 
	`´štf_§ã
("\n");

75 
i
 = 0; i < 
pEVSE
->
šfo
.
ucTÙ®Pošt
; i++)

77 if(
	`memcmp
(
pPošt
[
i
]->
¡©us
.
ucH–dC¬dUID
, 
Ord”D©a
.
ucUID
, 
defUIDL’gth
) == 0)

80 #ifdeà
DEBUG_RFID


81 
	`´štf_§ã
("pošˆ%d ´Ë¿¨ÒÑË¢\n", 
i
);

83 
RFIDS‹
 = 
STATE_OLDUID
;

89 #ifdeà
DEBUG_RFID


90 
	`´štf_§ã
("pošˆ%d Î´Ë¢\n", 
i
);

92 
RFIDS‹
 = 
STATE_NEWUID
;

96 
STATE_NEWUID
:

97 
	`xQueueS’d
(
xHªdËQueueOrd”s
, &
Ord”D©a
, 0);

98 
uxB™s
 = 
	`xEv’tGroupSync
(
pRFIDDev
->
xHªdËEv’tGroupRFID
,

99 
defEv’tB™IsNewUID
,

100 
defEv’tB™G‘AccouÁStus
,

102 if((
uxB™s
 & 
defEv’tB™G‘AccouÁStus
) == defEventBitGetAccountStatus)

104 
	`xQueueReûive
(
xHªdËQueueOrd”s
, &
Ord”D©a
, 1000);

105 if(
Ord”D©a
.
ucAccouÁStus
 !ğ0 && Ord”D©a.
dB®ªû
 > 0)

107 
RFIDS‹
 = 
STATE_GOODCARD
;

109 if(
Ord”D©a
.
ucAccouÁStus
 == 0)

111 
RFIDS‹
 = 
STATE_BADCARD
;

113 if(
Ord”D©a
.
dB®ªû
 < 0)

115 
RFIDS‹
 = 
STATE_OWE
;

119 
STATE_OLDUID
:

120 
	`Ord”In™D©a
(&
Ord”D©a
);

121 
RFIDS‹
 = 
STATE_NOUID
;

123 
STATE_GOODCARD
:

127 
Ord”D©a
.
ucPoštID
 = 0;

128 
pPošt
[
Ord”D©a
.
ucPoštID
]->
¡©e
 = 
POINT_PRECONTRACT
;

129 
	`memmove
(
pPošt
[
Ord”D©a
.
ucPoštID
]->
¡©us
.
ucH–dC¬dUID
, Ord”D©a.
ucUID
, 
defUIDL’gth
);

130 
	`xEv’tGroupS‘B™s
(
pPošt
[
Ord”D©a
.
ucPoštID
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
, 
defEv’tB™StdAuthed
);

131 
RFIDS‹
 = 
STATE_PRECONTRACT
;

133 
STATE_BADCARD
:

137 
	`Ord”In™D©a
(&
Ord”D©a
);

138 
RFIDS‹
 = 
STATE_NOUID
;

140 
STATE_OWE
:

144 
	`Ord”In™D©a
(&
Ord”D©a
);

145 
RFIDS‹
 = 
STATE_NOUID
;

147 
STATE_PRECONTRACT
:

148 
uxB™s
 = 
	`xEv’tGroupWa™B™s
(
pPošt
[
Ord”D©a
.
ucPoštID
]->
¡©us
.
xHªdËEv’tS¹CÚd™iÚ
,

149 
defEv’tB™StdOK
,

150 
pdTRUE
, 
pdFALSE
, 1000);

151 if((
uxB™s
 & 
defEv’tB™StdOK
) == defEventBitStdOK)

160 
	}
}

	@D:\Documents\Projects\chargersdk\src\app\taskrfid.h

8 #iâdeà 
__TASKCARD_H


9 
	#__TASKCARD_H


	)

	@D:\Documents\Projects\chargersdk\src\app\timercallback.c

8 
	~"šşudes.h
"

9 
	~"š‹rçû.h
"

14 
	$vCh¬gePoštTim”CB
(
Tim”HªdË_t
 
xTim”
)

16 
ušt32_t
 
uxTim”ID
;

18 
uxTim”ID
 = (
ušt32_t
)
	`pvTim”G‘Tim”ID
(
xTim”
);

20 if(
uxTim”ID
 =ğ
defTIMERID_Temp
)

22 
	`xEv’tGroupS‘B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBTemp
);

24 if(
uxTim”ID
 =ğ
defTIMERID_LockS‹
)

26 
	`xEv’tGroupS‘B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBLockS‹
);

28 if(
uxTim”ID
 =ğ
defTIMERID_PlugS‹
)

30 
	`xEv’tGroupS‘B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBPlugS‹
);

32 if(
uxTim”ID
 =ğ
defTIMERID_Ch¬gšgD©a
)

34 
	`xEv’tGroupS‘B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBCh¬gšgD©a
);

36 
	}
}

37 
	$vEVSETim”CB
(
Tim”HªdË_t
 
xTim”
)

39 
ušt32_t
 
uxTim”ID
;

41 
uxTim”ID
 = (
ušt32_t
)
	`pvTim”G‘Tim”ID
(
xTim”
);

43 if(
uxTim”ID
 =ğ
defTIMERID_EVSES‹
)

45 
	`xEv’tGroupS‘B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBEVSES‹
);

47 if(
uxTim”ID
 =ğ
defTIMERID_DATAREFRESH
)

49 
	`xEv’tGroupS‘B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBD©aReäesh
);

51 
	}
}

53 
	$vRFIDTim”CB
(
Tim”HªdË_t
 
xTim”
)

55 
	`xEv’tGroupS‘B™s
(
xHªdËEv’tTim”CBNÙify
, 
defEv’tB™Tim”CBRFID
);

56 
	}
}

	@D:\Documents\Projects\chargersdk\src\cli\cli_app.c

1 
	~"šşudes.h
"

4 
	#WHITE
 0xFFFF

	)

5 
	#BLACK
 0x0000

	)

6 
	#BLUE
 0x001F

	)

7 
	#BRED
 0XF81F

	)

8 
	#GRED
 0XFFE0

	)

9 
	#GBLUE
 0X07FF

	)

10 
	#RED
 0xF800

	)

11 
	#MAGENTA
 0xF81F

	)

12 
	#GREEN
 0x07E0

	)

13 
	#CYAN
 0x7FFF

	)

14 
	#YELLOW
 0xFFE0

	)

15 
	#BROWN
 0XBC40

16 
	#BRRED
 0XFC07

17 
	#GRAY
 0X8430

19 

	)

20 
	#DARKBLUE
 0X01CF

21 
	#LIGHTBLUE
 0X7D7C

22 
	#GRAYBLUE
 0X5458

24 

	)

25 
	#LIGHTGREEN
 0X841F

27 
	#LGRAY
 0XC618

28 

	)

29 
	#LGRAYBLUE
 0XA651

30 
	#LBBLUE
 0X2B12

31 

	)

33 
	$şi_h–lo_ât
(
¬gc
, **
¬gv
)

35 
	`x´štf
("\nhello world\n");

36 
	`x´štf
("HCLK = SYSCLK = %dMHz\n", 
Sy¡emCÜeClock
 / 1000000);

37 
	`x´štf
("AHB = SYSCLK / DIV1 = %dMHz\n", 
Sy¡emCÜeClock
 / 1000000 / 1);

38 
	`x´štf
("APB1 = SYSCLK / DIV4 = %dMHz\n", 
Sy¡emCÜeClock
 / 1000000 / 4);

39 
	`x´štf
("APB2 = SYSCLK / DIV2 = %dMHz\n", 
Sy¡emCÜeClock
 / 1000000 / 2);

43 
i
 = 0; i < 12; i++)

45 
i
)

48 
	`LTDC_CË¬
(
WHITE
);

51 
	`LTDC_CË¬
(
BLACK
);

54 
	`LTDC_CË¬
(
BLUE
);

57 
	`LTDC_CË¬
(
RED
);

60 
	`LTDC_CË¬
(
MAGENTA
);

63 
	`LTDC_CË¬
(
GREEN
);

66 
	`LTDC_CË¬
(
CYAN
);

69 
	`LTDC_CË¬
(
YELLOW
);

72 
	`LTDC_CË¬
(
BRRED
);

75 
	`LTDC_CË¬
(
GRAY
);

78 
	`LTDC_CË¬
(
LGRAY
);

81 
	`LTDC_CË¬
(
BROWN
);

84 
	`b¥_D–ayMS
(500);

87 
	}
}

89 
tšysh_cmd_t
 
	gşi_h–lo_cmd
 =

94 0, 
şi_h–lo_ât
,

101 
	$fsmc_sd¿m_‹¡
()

103 
u32
 
i
 = 0;

104 
u32
 
‹mp
 = 0;

105 
u32
 
sv®
 = 0;

106 
	`x´štf
("Ã¿¸ô16K×Ö½Ú,Ğ´ÈëÒ»¸öÊı¾İ,×Ü¹²Ğ´Èë2048¸öÊı¾İ,¸ÕºÃÊÇ32M×Ö½Ú\n");

107 
i
 = 0; i < 32 * 1024 * 1024; i += 16 * 1024)

109 *(
vu32
 *)(
Bªk5_SDRAM_ADDR
 + 
i
èğ
‹mp
;

110 
‹mp
++;

112 
‹mp
 = 0;

114 
i
 = 0; i < 32 * 1024 * 1024; i += 16 * 1024)

116 
sv®
 = *(
vu32
 *)(
Bªk5_SDRAM_ADDR
 + 
i
);

117 if(
‹mp
 =ğ
sv®
)

119 
	`x´štf
("[@0x%x]=OK!\n", 
Bªk5_SDRAM_ADDR
 | 
i
);

123 
	`x´štf
("[@0x%x]=ERR!\n", 
Bªk5_SDRAM_ADDR
 | 
i
);

126 
‹mp
++;

128 
	`x´štf
("SDRAM ÈİÁ¿:%dMB\r\n", 
i
 / 1024 / 1024);

129 
	}
}

132 
	$şi_‹¡sd¿m_ât
(
¬gc
, **
¬gv
)

134 
	`skENTER_CRITICAL
();

135 
	`fsmc_sd¿m_‹¡
();

136 
	`skEXIT_CRITICAL
();

137 
	}
}

139 
tšysh_cmd_t
 
	gşi_‹¡sd¿m_cmd
 =

144 0, 
şi_‹¡sd¿m_ât
,

148 
	$şi_sy¡emtime_ât
(
¬gc
, **
¬gv
)

150 
ušt8_t
 
tbuf
[40];

151 
RTC_TimeTy³Def
 
RTC_TimeSŒuù
;

152 
RTC_D©eTy³Def
 
RTC_D©eSŒuù
;

153 if(
¬gc
 == 1)

155 
	`skENTER_CRITICAL
();

156 
	`HAL_RTC_G‘Time
(&
RTC_HªdËr
, &
RTC_TimeSŒuù
, 
RTC_FORMAT_BIN
);

157 
	`x¥rštf
((*)
tbuf
, "Time:%02d:%02d:%02d", 
RTC_TimeSŒuù
.
Hours
, RTC_TimeSŒuù.
Mšu‹s
, RTC_TimeSŒuù.
SecÚds
);

158 
	`x´štf
("\n%s\n", 
tbuf
);

159 
	`HAL_RTC_G‘D©e
(&
RTC_HªdËr
, &
RTC_D©eSŒuù
, 
RTC_FORMAT_BIN
);

160 
	`x¥rštf
((*)
tbuf
, "D©e:20%02d-%02d-%02d", 
RTC_D©eSŒuù
.
Y—r
, RTC_D©eSŒuù.
MÚth
, RTC_D©eSŒuù.
D©e
);

161 
	`x´štf
("%s\n", 
tbuf
);

162 
	`x¥rštf
((*)
tbuf
, "W“k:%d", 
RTC_D©eSŒuù
.
W“kDay
);

163 
	`x´štf
("%s\n", 
tbuf
);

164 
	`skEXIT_CRITICAL
();

166 if(
	`¡rcmp
(
¬gv
[1], "-s") == 0)

168 *
¡r
 = 
¬gv
[2];

171 
	`skENTER_CRITICAL
();

172 if(
¡r
[0] !ğ'\"' && sŒ[
	`¡¾’
(str) - 1] != '\"')

174 
	`skENTER_CRITICAL
();

175 
	`x´štf
("\nWrong command!…lease date --help\n");

176 
	`skEXIT_CRITICAL
();

180 
¡r
 += 3;

183 
	`¡ºıy
((*)
tbuf
, 
¡r
, 2);

184 
RTC_D©eSŒuù
.
Y—r
 = (
ušt8_t
)
	`©oi
((*)
tbuf
);

186 
¡r
 += 3;

189 
	`¡ºıy
((*)
tbuf
, 
¡r
, 2);

190 
RTC_D©eSŒuù
.
MÚth
 = (
ušt8_t
)
	`©oi
((*)
tbuf
);

192 
¡r
 += 3;

195 
	`¡ºıy
((*)
tbuf
, 
¡r
, 2);

196 
RTC_D©eSŒuù
.
D©e
 = (
ušt8_t
)
	`©oi
((*)
tbuf
);

198 
	`RTC_S‘_D©e
(
RTC_D©eSŒuù
.
Y—r
, RTC_D©eSŒuù.
MÚth
, RTC_D©eSŒuù.
D©e
);

200 
¡r
 += 3;

203 
	`¡ºıy
((*)
tbuf
, 
¡r
, 2);

204 
RTC_TimeSŒuù
.
Hours
 = (
ušt8_t
)
	`©oi
((*)
tbuf
);

206 
¡r
 += 3;

209 
	`¡ºıy
((*)
tbuf
, 
¡r
, 2);

210 
RTC_TimeSŒuù
.
Mšu‹s
 = (
ušt8_t
)
	`©oi
((*)
tbuf
);

212 
¡r
 += 3;

215 
	`¡ºıy
((*)
tbuf
, 
¡r
, 2);

216 
RTC_TimeSŒuù
.
SecÚds
 = (
ušt8_t
)
	`©oi
((*)
tbuf
);

218 
	`RTC_S‘_Time
(
RTC_TimeSŒuù
.
Hours
, RTC_TimeSŒuù.
Mšu‹s
, RTC_TimeSŒuù.
SecÚds
);

220 
	`HAL_RTC_G‘Time
(&
RTC_HªdËr
, &
RTC_TimeSŒuù
, 
RTC_FORMAT_BIN
);

221 
	`x¥rštf
((*)
tbuf
, "Time:%02d:%02d:%02d", 
RTC_TimeSŒuù
.
Hours
, RTC_TimeSŒuù.
Mšu‹s
, RTC_TimeSŒuù.
SecÚds
);

222 
	`x´štf
("\n%s\n", 
tbuf
);

223 
	`HAL_RTC_G‘D©e
(&
RTC_HªdËr
, &
RTC_D©eSŒuù
, 
RTC_FORMAT_BIN
);

224 
	`x¥rštf
((*)
tbuf
, "D©e:20%02d-%02d-%02d", 
RTC_D©eSŒuù
.
Y—r
, RTC_D©eSŒuù.
MÚth
, RTC_D©eSŒuù.
D©e
);

225 
	`x´štf
("%s\n", 
tbuf
);

226 
	`x¥rštf
((*)
tbuf
, "W“k:%d", 
RTC_D©eSŒuù
.
W“kDay
);

227 
	`x´štf
("%s\n", 
tbuf
);

228 
	`skEXIT_CRITICAL
();

231 if(
	`¡rcmp
(
¬gv
[1], "--help") == 0)

233 
	`skENTER_CRITICAL
();

234 
	`x´štf
("\neg:date -s \"2016-09-12 15:04:00\"\n");

235 
	`skEXIT_CRITICAL
();

238 
	}
}

240 
tšysh_cmd_t
 
	gşi_sy¡emd©e_cmd
 =

245 0, 
şi_sy¡emtime_ât
,

249 
	$di¥Ïy_¬gs
(
¬gc
, **
¬gv
)

251 
i
;

252 
i
 = 0; i < 
¬gc
; i++)

254 
	`x´štf
("¬gv[%d]=\"%s\"\n", 
i
, 
¬gv
[i]);

256 
	}
}

258 
	$foo_ât
(
¬gc
, **
¬gv
)

260 
	`x´štf
("foo command called\n");

261 
	`di¥Ïy_¬gs
(
¬gc
, 
¬gv
);

262 
	}
}

264 
tšysh_cmd_t
 
	gmyfoocmd
 = {0, "foo", "foo command", "[args]",

265 
foo_ât
, 0, 0, 0

268 
	$™em_ât
(
¬gc
, **
¬gv
)

270 
	`x´štf
("™em%d commªd c®Ëd\n", ()
	`tšysh_g‘_¬g
());

271 
	`di¥Ïy_¬gs
(
¬gc
, 
¬gv
);

272 
	}
}

274 
tšysh_cmd_t
 
	gùxcmd
 = {0, "ctx", "contextual command", "item1|item2",

277 
tšysh_cmd_t
 
	g™em1
 = {&
ùxcmd
, "™em1", "fœ¡ i‹m", "[¬gs]", 
™em_ât
,

280 
tšysh_cmd_t
 
	g™em2
 = {&
ùxcmd
, "™em2", "£cÚd i‹m", "[¬gs]", 
™em_ât
,

285 
	$©oxi_ât
(
¬gc
, **
¬gv
)

287 
i
;

289 
i
 = 1; i < 
¬gc
; i++)

291 
	`x´štf
("\"%s\"-->%u (0x%x)\n",

292 
¬gv
[
i
], 
	`tšysh_©oxi
(argv[i]),inysh_atoxi(argv[i]));

294 
	}
}

296 
tšysh_cmd_t
 
	g©oxi_cmd
 = {0, "atoxi", "demonstrate‡toxi support",

297 "[¬gs-to-cÚv”t]", 
©oxi_ât
, 0, 0, 0

	@D:\Documents\Projects\chargersdk\src\cli\cli_fatfs.c

1 
	~"šşudes.h
"

2 
	~"ff.h
"

3 
	~"ff_g’_drv.h
"

4 
	~"Çnd_diskio.h
"

6 
FIL
 
	gMyFe
;

8 
	$E¼Ü_HªdËr
()

11 
	}
}

14 
	$şi_mkfs_ât
(
¬gc
, **
¬gv
)

16 
BYTE
 
wÜk
[
_MAX_SS
];

17 
fÜm©
;

18 
	`skENTER_CRITICAL
();

19 if(
	`¡rcmp
(
¬gv
[1], "-t") == 0)

26 if(
	`¡rÿ£cmp
(
¬gv
[2], "fat") == 0)

28 
fÜm©
 = 
FM_FAT
;

30 if(
	`¡rÿ£cmp
(
¬gv
[2], "fat32") == 0)

32 
fÜm©
 = 
FM_FAT32
;

34 if(
	`¡rÿ£cmp
(
¬gv
[2], "exfat") == 0)

36 
fÜm©
 = 
FM_EXFAT
;

38 if(
	`¡rÿ£cmp
(
¬gv
[2], "any") == 0)

40 
fÜm©
 = 
FM_ANY
;

42 if(
	`¡rÿ£cmp
(
¬gv
[2], "sfd") == 0)

44 
fÜm©
 = 
FM_SFD
;

47 if(
	`¡rÿ£cmp
(
¬gv
[3], "nand") == 0)

50 if(
	`f_mkfs
((
TCHAR
 cÚ¡ *)
NANDDISKP©h
, 
fÜm©
, 0, 
wÜk
, (wÜk)è!ğ
FR_OK
)

53 
	`E¼Ü_HªdËr
();

57 
	`x´štf
("\n¸ñÊ½»¯Íê³É,µ±Ç°ÎÄ¼şÏµÍ³%s\n", 
¬gv
[2]);

60 if(
	`¡rcmp
(
¬gv
[1], "--help") == 0)

63 
	`x´štf
("\nformat: FAT,FAT32,exFAT,ANY,SFD\n");

65 
	`x´štf
("\neg:mkfs -t FAT‚and\n");

70 
	`x´štf
("\nerror input\n");

71 
	`x´štf
("format: FAT,FAT32,exFAT,ANY,SFD\n");

72 
	`x´štf
("eg:mkfs -t FAT‚and\n");

74 
	`skEXIT_CRITICAL
();

75 
	}
}

77 
	$şi_mouÁ_ât
(
¬gc
, **
¬gv
)

79 
	`skENTER_CRITICAL
();

80 if(
	`¡rÿ£cmp
(
¬gv
[1], "nand") == 0)

83 if(
	`f_mouÁ
(&
NANDDISKF©Fs
, (
TCHAR
 cÚ¡ *)
NANDDISKP©h
, 1è!ğ
FR_OK
)

86 
	`E¼Ü_HªdËr
();

90 
	`x´štf
("\nmount ok.\n");

93 if(
	`¡rcmp
(
¬gv
[1], "--help") == 0)

96 
	`x´štf
("\neg:mount‚and\n");

99 
	`skEXIT_CRITICAL
();

100 
	}
}

102 
	$şi_umouÁ_ât
(
¬gc
, **
¬gv
)

104 
	`skENTER_CRITICAL
();

105 if(
	`¡rÿ£cmp
(
¬gv
[1], "nand") == 0)

107 if(
	`f_mouÁ
(
NULL
, (
TCHAR
 cÚ¡ *)
NANDDISKP©h
, 0è!ğ
FR_OK
)

110 
	`E¼Ü_HªdËr
();

114 
	`x´štf
("\numount ok.\n");

117 if(
	`¡rcmp
(
¬gv
[1], "--help") == 0)

120 
	`x´štf
("\neg:umount‚and\n");

123 
	`skEXIT_CRITICAL
();

126 
	}
}

129 
	$şi_‹¡çtfs_ât
(
¬gc
, **
¬gv
)

131 
ušt32_t
 
by‹swr™‹n
, 
by‹¤—d
;

132 
ušt8_t
 
w‹xt
[200] = "This is z working with FatFs";

133 
ušt8_t
 *
¹ext
;

134 
¹ext
 = 
	`m®loc
(200);

135 
	`mem£t
(
¹ext
, 0, 200);

137 if(
	`f_İ’
(&
MyFe
, "STM32.TXT", 
FA_CREATE_ALWAYS
 | 
FA_WRITE
è!ğ
FR_OK
)

140 
	`E¼Ü_HªdËr
();

145 
	`f_wr™e
(&
MyFe
, 
w‹xt
, 
	`¡¾’
((*)w‹xt), (*)&
by‹swr™‹n
);

147 
	`f_şo£
(&
MyFe
);

149 if(
	`f_İ’
(&
MyFe
, "STM32.TXT", 
FA_READ
è!ğ
FR_OK
)

151 
	`E¼Ü_HªdËr
();

155 
	`f_»ad
(&
MyFe
, 
¹ext
, 
	`f_size
(&MyFe), (*)&
by‹¤—d
);

158 
	`f_şo£
(&
MyFe
);

159 
	`skENTER_CRITICAL
();

160 
	`x´štf
("%s\n", 
¹ext
);

161 
	`ä“
(
¹ext
);

162 
	`skEXIT_CRITICAL
();

166 
	}
}

168 
f_g‘c
Ğ
FIL
 *
å
);

169 
	$şi_ÿt_ât
(
¬gc
, **
¬gv
)

171 
FRESULT
 
»s
;

172 
c
;

173 
	`skENTER_CRITICAL
();

175 if(
¬gc
 == 2)

177 
»s
 = 
	`f_İ’
(&
MyFe
, 
¬gv
[1], 
FA_READ
);

178 if(
»s
 !ğ
FR_OK
)

180 
	`x´štf
("Error file\n");

184 
c
 = 
	`f_g‘c
(&
MyFe
);

185 
c
 !ğ
EOF
)

187 
	`x´štf
("%c", 
c
);

188 
c
 = 
	`f_g‘c
(&
MyFe
);

190 ià(
	`f_eof
(&
MyFe
) != 0)

192 
	`x´štf
("\n End of file„eached.\n");

196 
	`x´štf
("\n Something went wrong.\n");

202 
	`x´štf
("no file input\n");

207 
	`skEXIT_CRITICAL
();

208 
	}
}

210 
tšysh_cmd_t
 
	gşi_ÿt_cmd
 = {0, "cat", "fatfs ÎÄ¼şÏÔÊ¾", "[file]",

211 
şi_ÿt_ât
, 0, 0, 0

213 
tšysh_cmd_t
 
	gşi_çtfs_cmd
 = {0, "testfatfs", "fatfs ²âÊÔ", "[none]",

214 
şi_‹¡çtfs_ât
, 0, 0, 0

216 
tšysh_cmd_t
 
	gşi_mkfs_cmd
 = {0, "mkfs", "ÖÆ×÷ÎÄ¼şÏµÍ³, Ê¹ÓÃÇ°Çë²é¿´°ïÖú --help", "--help",

217 
şi_mkfs_ât
, 0, 0, 0

219 
tšysh_cmd_t
 
	gşi_mouÁ_cmd
 = {0, "mount", "¹ÒÔÚ´ÅÅÌ, Ê¹ÓÃÇ°Çë²é¿´°ïÖú --help", "--help",

220 
şi_mouÁ_ât
, 0, 0, 0

222 
tšysh_cmd_t
 
	gşi_umouÁ_cmd
 = {0, "umount", "Ğ¶ÔØ´ÅÅÌ, Ê¹ÓÃÇ°Çë²é¿´°ïÖú --help", "--help",

223 
şi_umouÁ_ât
, 0, 0, 0

	@D:\Documents\Projects\chargersdk\src\cli\cli_main.c

1 
	~"šşudes.h
"

2 
	~"tšysh.h
"

3 
	~"şi_­p.h
"

4 
	~"şi_¹os.h
"

5 
	~"şi_çtfs.h
"

6 
	~"şi_xml.h
"

7 
	~"b¥_u¬t.h
"

8 
	~"u£¾ib_queue.h
"

10 
	$tšysh_ch¬_out
(
c
)

13 
	`´štf_§ã
("%c",
c
);

14 
	}
}

17 
	$şi_š™
()

19 
	`tšysh_£t_´om±
("\n[charger]$ ");

21 
	`tšysh_add_commªd
(&
şi_h–lo_cmd
);

22 
	`tšysh_add_commªd
(&
şi_sy¡emd©e_cmd
);

23 
	`tšysh_add_commªd
(&
şi_skli¡_cmd
);

27 
	`tšysh_add_commªd
(&
şi_mkfs_cmd
);

28 
	`tšysh_add_commªd
(&
şi_mouÁ_cmd
);

29 
	`tšysh_add_commªd
(&
şi_umouÁ_cmd
);

30 
	`tšysh_add_commªd
(&
şi_ÿt_cmd
);

33 
	`tšysh_add_commªd
(&
şi_çtfs_cmd
);

34 
	`tšysh_add_commªd
(&
şi_‹¡xml_cmd
);

35 
	`tšysh_add_commªd
(&
şi_‹¡xml_ü—‹_cmd
);

36 
	`tšysh_add_commªd
(&
şi_‹¡sd¿m_cmd
);

40 
	`tšysh_add_commªd
(&
myfoocmd
);

44 
	`tšysh_add_commªd
(&
ùxcmd
);

45 
	`tšysh_add_commªd
(&
™em1
);

46 
	`tšysh_add_commªd
(&
™em2
);

49 
	`tšysh_add_commªd
(&
©oxi_cmd
);

51 
	}
}

52 
Queue
 *
pCliRecvQue
;

54 
	$şi_maš
()

56 
ušt8_t
 
ch
;

57 
št8_t
 
»s
;

58 
	`şi_š™
();

61 
»s
 = 
	`»adRecvQue
(
pCliRecvQue
, &
ch
, 1);

62 if(
»s
 == 0)

64 
	`tšysh_ch¬_š
(
ch
);

67 
	`vTaskD–ay
(100);

69 
	}
}

	@D:\Documents\Projects\chargersdk\src\cli\cli_main.h

9 #iâdeà
CLI_MAIN_H


10 
	#CLI_MAIN_H


	)

13 
şi_maš
();

	@D:\Documents\Projects\chargersdk\src\cli\cli_rtos.c

1 
	~"šşudes.h
"

2 
	~"sk.h
"

3 
ušt8_t
 
	gacTaskStusBufãr
[500];

5 
	$şi_skli¡_ât
(
¬gc
, **
¬gv
)

7 
u16
 
F»eBy‹sRemaššg
=0;

8 
u16
 
memu£d
;

9 
u8
 
·ddr
[20];

10 
	`skENTER_CRITICAL
();

12 
	`x´štf
("\r\n");

13 
	`vTaskLi¡
((*)&
acTaskStusBufãr
);

14 
	`x´štf
("=================================================\r\n");

15 
	`x´štf
("ÈÎÎñÃû ÈÎÎñ×´Ì¬ ÓÅÏÈ¼¶ Ê£ÓàÕ» ÈÎÎñĞòºÅ\r\n");

16 
	`x´štf
("%s\r\n", 
acTaskStusBufãr
);

17 
	`x´štf
("\r\nÈÎÎñÃû ÔËĞĞ¼ÆÊı Ê¹ÓÃÂÊ\r\n");

18 
	`vTaskG‘RunTimeSts
((*)&
acTaskStusBufãr
);

19 
	`x´štf
("%s\r\n", 
acTaskStusBufãr
);

21 
F»eBy‹sRemaššg
=
	`xPÜtG‘F»eH—pSize
();

22 
memu£d
 = (
cÚfigTOTAL_HEAP_SIZE
-
F»eBy‹sRemaššg
) * 100 / configTOTAL_HEAP_SIZE;

23 
	`x¥rštf
((*)
·ddr
,"%d.%01d%%",
memu£d
/10,memused%10);

24 
	`x´štf
("SDRAM Ê¹ÓÃÂÊ: %s\n",
·ddr
);

25 
	`skEXIT_CRITICAL
();

26 
	}
}

28 
tšysh_cmd_t
 
	gşi_skli¡_cmd
={

33 
şi_skli¡_ât
,

	@D:\Documents\Projects\chargersdk\src\cli\cli_xml.c

1 
	~"šşudes.h
"

2 
	~"mxml.h
"

4 
	$şi_‹¡xml_ü—‹_ât
(
¬gc
, **
¬gv
)

6 
FIL
 
å
;

7 
i
;

9 
mxml_node_t
 *
xml
;

10 
mxml_node_t
 *
d©a
;

11 
mxml_node_t
 *
node
;

12 
mxml_node_t
 *
group
;

14 
xml
 = 
	`mxmlNewXML
("1.0");

16 
d©a
 = 
	`mxmlNewEËm’t
(
xml
, "data");

17 
i
 = 0; i < 100; i++)

19 
node
 = 
	`mxmlNewEËm’t
(
d©a
, "node");

20 
	`mxmlNewText
(
node
, 0, "val1");

21 
node
 = 
	`mxmlNewEËm’t
(
d©a
, "node");

22 
	`mxmlNewText
(
node
, 0, "val2");

23 
node
 = 
	`mxmlNewEËm’t
(
d©a
, "node");

24 
	`mxmlNewText
(
node
, 0, "val3");

26 
group
 = 
	`mxmlNewEËm’t
(
d©a
, "group");

28 
node
 = 
	`mxmlNewEËm’t
(
group
, "node");

29 
	`mxmlNewText
(
node
, 0, "val4");

30 
node
 = 
	`mxmlNewEËm’t
(
group
, "node");

31 
	`mxmlNewText
(
node
, 0, "val5");

32 
node
 = 
	`mxmlNewEËm’t
(
group
, "node");

33 
	`mxmlNewText
(
node
, 0, "val6");

35 
node
 = 
	`mxmlNewEËm’t
(
d©a
, "node");

36 
	`mxmlNewText
(
node
, 0, "val7");

37 
node
 = 
	`mxmlNewEËm’t
(
d©a
, "node");

38 
	`mxmlNewText
(
node
, 0, "val8");

39 if(
i
 % 10 == 0)

41 
	`x´štf
("˜ğ%d\n", 
i
);

45 
	`f_İ’
(&
å
, "‹¡mxml.xml", 
FA_CREATE_ALWAYS
 | 
FA_WRITE
);

46 
	`mxmlSaveFe
(
xml
, &
å
, 
MXML_NO_CALLBACK
);

47 
	`f_şo£
(&
å
);

48 
	`mxmlD–‘e
(
xml
);

50 
	}
}

51 
‹¡mxml_’Œy
(, **);

52 
	$şi_‹¡mxml_ât
(
¬gc
, **
¬gv
)

54 
	`skENTER_CRITICAL
();

55 
	`‹¡mxml_’Œy
(
¬gc
, 
¬gv
);

56 
	`skEXIT_CRITICAL
();

57 
	}
}

59 
tšysh_cmd_t
 
	gşi_‹¡xml_cmd
 = {0, "testmxml", "xml½âÎö²âÊÔ", "[args]",

60 
şi_‹¡mxml_ât
, 0, 0, 0

63 
tšysh_cmd_t
 
	gşi_‹¡xml_ü—‹_cmd
 = {0, "testxmlcreate", "xml´´½¨²âÊÔ", "[args]",

64 
şi_‹¡xml_ü—‹_ât
, 0, 0, 0

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp.h

8 #iâdeà
_BSP_H_


9 
	#_BSP_H


	)

16 
	#STM32F4


	)

18 
	#USE_F»eRTOS


	)

23 
	#b¥USART1_P»em±PriÜ™y
 3

	)

24 
	#b¥USART1_SubPriÜ™y
 0

	)

26 
	#b¥USART2_P»em±PriÜ™y
 4

	)

27 
	#b¥USART2_SubPriÜ™y
 0

	)

29 
	#b¥USART3_P»em±PriÜ™y
 5

	)

30 
	#b¥USART3_SubPriÜ™y
 0

	)

32 
	#b¥LTDC_P»em±PriÜ™y
 15

	)

33 
	#b¥LTDC_SubPriÜ™y
 0

	)

40 #ifdeà
USE_F»eRTOS


41 
	#DISABLE_INT
(è
	`skENTER_CRITICAL
()

	)

42 
	#ENABLE_INT
(è
	`skEXIT_CRITICAL
()

	)

45 
	#ENABLE_INT
(è
	`__£t_PRIMASK
(0è

	)

46 
	#DISABLE_INT
(è
	`__£t_PRIMASK
(1è

	)

55 
	#EXTI9_5_ISR_MOVE_OUT


	)

57 
	#DEBUG_GPS_TO_COM1


	)

59 #iâdeà
TRUE


60 
	#TRUE
 1

	)

63 #iâdeà
FALSE


64 
	#FALSE
 0

	)

68 
	~<¡d¬g.h
>

69 
	~<¡dio.h
>

70 
	~<¡ršg.h
>

71 
	~<¡dlib.h
>

72 
	~<¡dšt.h
>

73 
	~"”rÜcode.h
"

76 
	~"b¥_u¬t.h
"

77 
	~"b¥_sd¿m.h
"

78 
	~"b¥_dwt.h
"

79 
	~"b¥_¹c.h
"

81 
	~"b¥_u£r_lib.h
"

82 
	~"b¥_Çnd_hw.h
"

83 
	~"b¥_Çnd_ál.h
"

84 
	~"b¥_touch_2046.h
"

87 
b¥_In™
();

88 
b¥_IdË
();

89 
b¥_E¼Ü_HªdËr
();

93 
št32_t
 
	ts32
;

94 
št16_t
 
	ts16
;

95 
št8_t
 
	ts8
;

97 cÚ¡ 
	tšt32_t
 
	tsc32
;

98 cÚ¡ 
	tšt16_t
 
	tsc16
;

99 cÚ¡ 
	tšt8_t
 
	tsc8
;

101 
__IO
 
	tšt32_t
 
	tvs32
;

102 
__IO
 
	tšt16_t
 
	tvs16
;

103 
__IO
 
	tšt8_t
 
	tvs8
;

105 
__I
 
	tšt32_t
 
	tvsc32
;

106 
__I
 
	tšt16_t
 
	tvsc16
;

107 
__I
 
	tšt8_t
 
	tvsc8
;

109 
ušt32_t
 
	tu32
;

110 
ušt16_t
 
	tu16
;

111 
ušt8_t
 
	tu8
;

113 cÚ¡ 
	tušt32_t
 
	tuc32
;

114 cÚ¡ 
	tušt16_t
 
	tuc16
;

115 cÚ¡ 
	tušt8_t
 
	tuc8
;

117 
__IO
 
	tušt32_t
 
	tvu32
;

118 
__IO
 
	tušt16_t
 
	tvu16
;

119 
__IO
 
	tušt8_t
 
	tvu8
;

121 
__I
 
	tušt32_t
 
	tvuc32
;

122 
__I
 
	tušt16_t
 
	tvuc16
;

123 
__I
 
	tušt8_t
 
	tvuc8
;

128 
	#BITBAND
(
addr
, 
b™num
è(×dd¸& 0xF0000000)+0x2000000+(×dd¸&0xFFFFF)<<5)+(b™num<<2))

	)

129 
	#MEM_ADDR
(
addr
è*((vŞ©*)×ddr))

	)

130 
	#BIT_ADDR
(
addr
, 
b™num
è
	`MEM_ADDR
(
	`BITBAND
×ddr, b™num))

	)

132 
	#GPIOA_ODR_Addr
 (
GPIOA_BASE
+20)

133 
	#GPIOB_ODR_Addr
 (
GPIOB_BASE
+20)

134 
	#GPIOC_ODR_Addr
 (
GPIOC_BASE
+20)

135 
	#GPIOD_ODR_Addr
 (
GPIOD_BASE
+20)

136 
	#GPIOE_ODR_Addr
 (
GPIOE_BASE
+20)

137 
	#GPIOF_ODR_Addr
 (
GPIOF_BASE
+20)

138 
	#GPIOG_ODR_Addr
 (
GPIOG_BASE
+20)

139 
	#GPIOH_ODR_Addr
 (
GPIOH_BASE
+20)

140 
	#GPIOI_ODR_Addr
 (
GPIOI_BASE
+20)

141 
	#GPIOJ_ODR_ADDr
 (
GPIOJ_BASE
+20)

142 
	#GPIOK_ODR_ADDr
 (
GPIOK_BASE
+20)

143 

	)

144 
	#GPIOA_IDR_Addr
 (
GPIOA_BASE
+16)

145 
	#GPIOB_IDR_Addr
 (
GPIOB_BASE
+16)

146 
	#GPIOC_IDR_Addr
 (
GPIOC_BASE
+16)

147 
	#GPIOD_IDR_Addr
 (
GPIOD_BASE
+16)

148 
	#GPIOE_IDR_Addr
 (
GPIOE_BASE
+16)

149 
	#GPIOF_IDR_Addr
 (
GPIOF_BASE
+16)

150 
	#GPIOG_IDR_Addr
 (
GPIOG_BASE
+16)

151 
	#GPIOH_IDR_Addr
 (
GPIOH_BASE
+16)

152 
	#GPIOI_IDR_Addr
 (
GPIOI_BASE
+16)

153 
	#GPIOJ_IDR_Addr
 (
GPIOJ_BASE
+16)

154 
	#GPIOK_IDR_Addr
 (
GPIOK_BASE
+16)

155 

	)

158 
	#PAout
(
n
è
	`BIT_ADDR
(
GPIOA_ODR_Addr
,n)

159 
	#PAš
(
n
è
	`BIT_ADDR
(
GPIOA_IDR_Addr
,n)

160 

	)

161 
	#PBout
(
n
è
	`BIT_ADDR
(
GPIOB_ODR_Addr
,n)

162 
	#PBš
(
n
è
	`BIT_ADDR
(
GPIOB_IDR_Addr
,n)

163 

	)

164 
	#PCout
(
n
è
	`BIT_ADDR
(
GPIOC_ODR_Addr
,n)

165 
	#PCš
(
n
è
	`BIT_ADDR
(
GPIOC_IDR_Addr
,n)

166 

	)

167 
	#PDout
(
n
è
	`BIT_ADDR
(
GPIOD_ODR_Addr
,n)

168 
	#PDš
(
n
è
	`BIT_ADDR
(
GPIOD_IDR_Addr
,n)

169 

	)

170 
	#PEout
(
n
è
	`BIT_ADDR
(
GPIOE_ODR_Addr
,n)

171 
	#PEš
(
n
è
	`BIT_ADDR
(
GPIOE_IDR_Addr
,n)

172 

	)

173 
	#PFout
(
n
è
	`BIT_ADDR
(
GPIOF_ODR_Addr
,n)

174 
	#PFš
(
n
è
	`BIT_ADDR
(
GPIOF_IDR_Addr
,n)

175 

	)

176 
	#PGout
(
n
è
	`BIT_ADDR
(
GPIOG_ODR_Addr
,n)

177 
	#PGš
(
n
è
	`BIT_ADDR
(
GPIOG_IDR_Addr
,n)

178 

	)

179 
	#PHout
(
n
è
	`BIT_ADDR
(
GPIOH_ODR_Addr
,n)

180 
	#PHš
(
n
è
	`BIT_ADDR
(
GPIOH_IDR_Addr
,n)

181 

	)

182 
	#PIout
(
n
è
	`BIT_ADDR
(
GPIOI_ODR_Addr
,n)

183 
	#PIš
(
n
è
	`BIT_ADDR
(
GPIOI_IDR_Addr
,n)

184 

	)

185 
	#PJout
(
n
è
	`BIT_ADDR
(
GPIOJ_ODR_Addr
,n)

186 
	#PJš
(
n
è
	`BIT_ADDR
(
GPIOJ_IDR_Addr
,n)

187 

	)

188 
	#PKout
(
n
è
	`BIT_ADDR
(
GPIOK_ODR_Addr
,n)

189 
	#PKš
(
n
è
	`BIT_ADDR
(
GPIOK_IDR_Addr
,n)

190 

	)

191 
´štf_§ã
(*
fÜm©
, ...);

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp_gpio.h

8 #iâdeà 
__BSP_GPIO_H


9 
	#__BSP_GPIO_H


	)

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp_timer.h

8 #iâdeà 
__BSP_TIMER_H


9 
	#__BSP_TIMER_H


	)

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp_uart.h

9 #iâdeà
BSP_USART_H_


10 
	#BSP_USART_H_


	)

12 
	~"b¥.h
"

13 
	~"u£¾ib_queue.h
"

15 
	#CLI_USARTx_BASE
 
USART2


	)

16 
	#CLI_USARTx_BAUDRATE
 115200

	)

17 
	#CLI_USARTx_IRQHªdËr
 
	`USART2_IRQHªdËr
()

	)

18 
	#CLI_QUEUE_SIZE
 10

	)

20 
	#RFID_USARTx_BASE
 
USART3


	)

21 
	#RFID_USARTx_BAUDRATE
 115200

	)

22 
	#RFID_USARTx_IRQHªdËr
 
	`USART3_IRQHªdËr
()

	)

23 
	#RFID_QUEUE_SIZE
 100

	)

27 
	#COUNTOF
(
__BUFFER__
è((__BUFFER__è/ (*(__BUFFER__)))

	)

30 
b¥_U¬t_In™
();

31 
št8_t
 
»adRecvQue
(
Queue
 *
q
, 
ušt8_t
 *
ch
, 
ušt16_t
 
time_out
);

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp.c

9 
	~"šşudes.h
"

10 
	~"b¥.h
"

14 
Sy¡emClock_CÚfig
();

15 
Stm32_Clock_In™
(
ušt32_t
 
¶Ê
,ušt32_ˆ
¶lm
,ušt32_ˆ
¶Í
,ušt32_ˆ
¶lq
);

24 
	$b¥_In™
()

33 
	`HAL_In™
();

34 
	`Sy¡emClock_CÚfig
();

35 
	`Sy¡emCÜeClockUpd©e
();

37 
	`__HAL_RCC_CRC_CLK_ENABLE
();

38 
	`b¥_RTC_In™
();

39 
	`b¥_DWT_In™
();

40 
	`b¥_SDRAM_In™
();

41 
	`b¥_U¬t_In™
();

44 
	`b¥_Touch_In™
();

46 
	}
}

89 
	$Sy¡emClock_CÚfig
()

91 
RCC_ClkIn™Ty³Def
 
RCC_ClkIn™SŒuù
;

92 
RCC_OscIn™Ty³Def
 
RCC_OscIn™SŒuù
;

94 
ušt32_t
 
¶lm
 = 25;

95 
ušt32_t
 
¶Ê
 = 384;

96 
ušt32_t
 
¶Í
 = 
RCC_PLLP_DIV2
;

97 
ušt32_t
 
¶lq
 = 8;

100 
	`__HAL_RCC_PWR_CLK_ENABLE
();

105 
	`__HAL_PWR_VOLTAGESCALING_CONFIG
(
PWR_REGULATOR_VOLTAGE_SCALE1
);

108 
RCC_OscIn™SŒuù
.
OscÏtÜTy³
 = 
RCC_OSCILLATORTYPE_HSE
;

109 
RCC_OscIn™SŒuù
.
HSES‹
 = 
RCC_HSE_ON
;

110 
RCC_OscIn™SŒuù
.
PLL
.
PLLS‹
 = 
RCC_PLL_ON
;

111 
RCC_OscIn™SŒuù
.
PLL
.
PLLSourû
 = 
RCC_PLLSOURCE_HSE
;

112 
RCC_OscIn™SŒuù
.
PLL
.
PLLM
 = 
¶lm
;

113 
RCC_OscIn™SŒuù
.
PLL
.
PLLN
 = 
¶Ê
;

114 
RCC_OscIn™SŒuù
.
PLL
.
PLLP
 = 
¶Í
;

115 
RCC_OscIn™SŒuù
.
PLL
.
PLLQ
 = 
¶lq
;

116 if(
	`HAL_RCC_OscCÚfig
(&
RCC_OscIn™SŒuù
è!ğ
HAL_OK
)

119 
	`b¥_E¼Ü_HªdËr
();

122 if(
	`HAL_PWREx_EÇbËOv”Drive
(è!ğ
HAL_OK
)

125 
	`b¥_E¼Ü_HªdËr
();

130 
RCC_ClkIn™SŒuù
.
ClockTy³
 = (
RCC_CLOCKTYPE_SYSCLK
 | 
RCC_CLOCKTYPE_HCLK
 | 
RCC_CLOCKTYPE_PCLK1
 | 
RCC_CLOCKTYPE_PCLK2
);

131 
RCC_ClkIn™SŒuù
.
SYSCLKSourû
 = 
RCC_SYSCLKSOURCE_PLLCLK
;

132 
RCC_ClkIn™SŒuù
.
AHBCLKDivid”
 = 
RCC_SYSCLK_DIV1
;

133 
RCC_ClkIn™SŒuù
.
APB1CLKDivid”
 = 
RCC_HCLK_DIV4
;

134 
RCC_ClkIn™SŒuù
.
APB2CLKDivid”
 = 
RCC_HCLK_DIV2
;

135 if(
	`HAL_RCC_ClockCÚfig
(&
RCC_ClkIn™SŒuù
, 
FLASH_LATENCY_5
è!ğ
HAL_OK
)

138 
	`b¥_E¼Ü_HªdËr
();

140 
	}
}

142 
	$b¥_E¼Ü_HªdËr
()

146 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_dwt.c

11 
	~"b¥.h
"

19 
	#DWT_CYCCNT
 *(vŞ©*)0xE0001004

	)

20 
	#DWT_CR
 *(vŞ©*)0xE0001000

	)

21 
	#DEM_CR
 *(vŞ©*)0xE000EDFC

	)

22 
	#DBGMCU_CR
 *(vŞ©*)0xE0042004

	)

24 
	#DEM_CR_TRCENA
 (1 << 24)

	)

25 
	#DWT_CR_CYCCNTENA
 (1 << 0)

	)

36 
	$b¥_DWT_In™
()

38 
DEM_CR
 |ğ()
DEM_CR_TRCENA
;

39 
DWT_CYCCNT
 = ()0u;

40 
DWT_CR
 |ğ()
DWT_CR_CYCCNTENA
;

41 
	}
}

52 
	$b¥_D–ayMS
(
ušt32_t
 
_ulD–ayTime
)

54 
	`b¥_D–ayUS
(1000*
_ulD–ayTime
);

55 
	}
}

94 
	$b¥_D–ayUS
(
ušt32_t
 
_ulD–ayTime
)

96 
ušt32_t
 
tCÁ
, 
tD–ayCÁ
;

97 
ušt32_t
 
tS¹
;

99 
tS¹
 = 
DWT_CYCCNT
;

100 
tCÁ
 = 0;

101 
tD–ayCÁ
 = 
_ulD–ayTime
 * (
Sy¡emCÜeClock
 / 1000000);

103 
tCÁ
 < 
tD–ayCÁ
)

105 
tCÁ
 = 
DWT_CYCCNT
 - 
tS¹
;

107 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_gpio.c

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_nand_ftl.c

1 
	~"b¥.h
"

26 
u8
 
	$FTL_In™
()

28 
u8
 
‹mp
;

29 if(
	`NAND_In™
())

33 if(
Çnd_dev
.
lut
)

35 
	`ä“
(
Çnd_dev
.
lut
);

37 
Çnd_dev
.
lut
 = 
	`m®loc
(Òªd_dev.
block_tÙ®num
) * 2);

38 
	`mem£t
(
Çnd_dev
.
lut
, 0,‚ªd_dev.
block_tÙ®num
 * 2);

39 if(!
Çnd_dev
.
lut
)

43 
‹mp
 = 
	`FTL_C»©eLUT
(1);

44 if(
‹mp
)

46 
	`x´štf
("format‚and flash...\r\n");

47 
‹mp
 = 
	`FTL_FÜm©
();

48 if(
‹mp
)

50 
	`x´štf
("format failed!\r\n");

56 
	`x´štf
("tÙ® block‚um:%d\r\n", 
Çnd_dev
.
block_tÙ®num
);

57 
	`x´štf
("good block‚um:%d\r\n", 
Çnd_dev
.
good_blocknum
);

58 
	`x´štf
("v®id block‚um:%d\r\n", 
Çnd_dev
.
v®id_blocknum
);

61 
	}
}

65 
	$FTL_BadBlockM¬k
(
u32
 
blocknum
)

67 
u32
 
‹mp
 = 0XAAAAAAAA;

68 
	`NAND_Wr™eS·»
(
blocknum
 * 
Çnd_dev
.
block_·g’um
, 0, (
u8
 *)&
‹mp
, 4);

69 
	`NAND_Wr™eS·»
(
blocknum
 * 
Çnd_dev
.
block_·g’um
 + 1, 0, (
u8
 *)&
‹mp
, 4);

70 
	}
}

75 
u8
 
	$FTL_CheckBadBlock
(
u32
 
blocknum
)

77 
u8
 
æag
 = 0;

78 
	`NAND_R—dS·»
(
blocknum
 * 
Çnd_dev
.
block_·g’um
, 0, &
æag
, 1);

79 if(
æag
 == 0XFF)

81 
	`NAND_R—dS·»
(
blocknum
 * 
Çnd_dev
.
block_·g’um
 + 1, 0, &
æag
, 1);

82 if(
æag
 == 0XFF)

92 
	}
}

97 
u8
 
	$FTL_U£dBlockM¬k
(
u32
 
blocknum
)

99 
u8
 
U£dæag
 = 0XCC;

100 
u8
 
‹mp
 = 0;

101 
‹mp
 = 
	`NAND_Wr™eS·»
(
blocknum
 * 
Çnd_dev
.
block_·g’um
, 1, (
u8
 *)&
U£dæag
, 1);

102  
‹mp
;

103 
	}
}

109 
u32
 
	$FTL_FšdUnu£dBlock
(
u32
 
sblock
, 
u8
 
æag
)

111 
u32
 
‹mp
 = 0;

112 
u32
 
blocknum
 = 0;

113 
blocknum
 = 
sblock
 + 1; blocknum > 0; blocknum--)

115 if(((
blocknum
 - 1è% 2è=ğ
æag
)

117 
	`NAND_R—dS·»
((
blocknum
 - 1)*
Çnd_dev
.
block_·g’um
, 0, (
u8
 *)&
‹mp
, 4);

118 if(
‹mp
 == 0XFFFFFFFF)

120 (
blocknum
 - 1);

126 
	}
}

131 
u32
 
	$FTL_FšdSamePÏÃUnu£dBlock
(
u32
 
sblock
)

133 
u32
 
curblock
 = 0XFFFFFFFF;

134 
u32
 
unu£dblock
 = 0;

135 if(
curblock
 > (
Çnd_dev
.
block_tÙ®num
 - 1))

137 
curblock
 = 
Çnd_dev
.
block_tÙ®num
 - 1;

139 
unu£dblock
 = 
	`FTL_FšdUnu£dBlock
(
curblock
, 
sblock
 % 2);

140 if(
unu£dblock
 =ğ0XFFFFFFFF && 
curblock
 < (
Çnd_dev
.
block_tÙ®num
 - 1))

142 
curblock
 = 
Çnd_dev
.
block_tÙ®num
 - 1;

143 
unu£dblock
 = 
	`FTL_FšdUnu£dBlock
(
curblock
, 
sblock
 % 2);

145 if(
unu£dblock
 == 0XFFFFFFFF)

149 
curblock
 = 
unu£dblock
;

150  
unu£dblock
;

151 
	}
}

159 
u8
 
	$FTL_CİyAndWr™eToBlock
(
u32
 
Sourû_PageNum
, 
u16
 
CŞNum
, 
u8
 *
pBufãr
, u32 
NumBy‹ToWr™e
)

161 
u16
 
i
 = 0, 
‹mp
 = 0, 
w¾’
;

162 
u32
 
sourû_block
 = 0, 
·geoff£t
 = 0;

163 
u32
 
unu£dblock
 = 0;

164 
sourû_block
 = 
Sourû_PageNum
 / 
Çnd_dev
.
block_·g’um
;

165 
·geoff£t
 = 
Sourû_PageNum
 % 
Çnd_dev
.
block_·g’um
;

166 
»Œy
:

167 
unu£dblock
 = 
	`FTL_FšdSamePÏÃUnu£dBlock
(
sourû_block
);

168 if(
unu£dblock
 > 
Çnd_dev
.
block_tÙ®num
)

172 
i
 = 0; i < 
Çnd_dev
.
block_·g’um
; i++)

174 if(
i
 >ğ
·geoff£t
 && 
NumBy‹ToWr™e
)

176 if(
NumBy‹ToWr™e
 > (
Çnd_dev
.
·ge_mašsize
 - 
CŞNum
))

178 
w¾’
 = 
Çnd_dev
.
·ge_mašsize
 - 
CŞNum
;

182 
w¾’
 = 
NumBy‹ToWr™e
;

184 
‹mp
 = 
	`NAND_CİyPageW™hWr™e
(
sourû_block
 * 
Çnd_dev
.
block_·g’um
 + 
i
, 
unu£dblock
 *‚ªd_dev.block_·g’um + i, 
CŞNum
, 
pBufãr
, 
w¾’
);

185 
CŞNum
 = 0;

186 
pBufãr
 +ğ
w¾’
;

187 
NumBy‹ToWr™e
 -ğ
w¾’
;

191 
‹mp
 = 
	`NAND_CİyPageW™houtWr™e
(
sourû_block
 * 
Çnd_dev
.
block_·g’um
 + 
i
, 
unu£dblock
 *‚and_dev.block_pagenum + i);

193 if(
‹mp
)

195 
	`FTL_BadBlockM¬k
(
unu£dblock
);

196 
	`FTL_C»©eLUT
(1);

197 
»Œy
;

200 if(
i
 =ğ
Çnd_dev
.
block_·g’um
)

202 
	`FTL_U£dBlockM¬k
(
unu£dblock
);

203 
	`NAND_E¿£Block
(
sourû_block
);

205 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

207 if(
Çnd_dev
.
lut
[
i
] =ğ
sourû_block
)

209 
Çnd_dev
.
lut
[
i
] = 
unu£dblock
;

215 
	}
}

219 
u16
 
	$FTL_LBNToPBN
(
u32
 
LBNNum
)

221 
u16
 
PBNNo
 = 0;

223 if(
LBNNum
 > 
Çnd_dev
.
v®id_blocknum
)

227 
PBNNo
 = 
Çnd_dev
.
lut
[
LBNNum
];

228  
PBNNo
;

229 
	}
}

237 
u8
 
	$FTL_Wr™eSeùÜs
(
u8
 *
pBufãr
, 
u32
 
SeùÜNo
, 
u16
 
SeùÜSize
, u32 
SeùÜCouÁ
)

239 
u8
 
æag
 = 0;

240 
u16
 
‹mp
;

241 
u32
 
i
 = 0;

242 
u16
 
w£cs
;

243 
u32
 
wËn
;

244 
u32
 
LBNNo
;

245 
u32
 
PBNNo
;

246 
u32
 
PhyPageNo
;

247 
u32
 
PageOff£t
;

248 
u32
 
BlockOff£t
;

249 
u32
 
m¬kdpbn
 = 0XFFFFFFFF;

250 
i
 = 0; i < 
SeùÜCouÁ
; i++)

252 
LBNNo
 = (
SeùÜNo
 + 
i
è/ (
Çnd_dev
.
block_·g’um
 * (Çnd_dev.
·ge_mašsize
 / 
SeùÜSize
));

253 
PBNNo
 = 
	`FTL_LBNToPBN
(
LBNNo
);

254 if(
PBNNo
 >ğ
Çnd_dev
.
block_tÙ®num
)

258 
BlockOff£t
 = ((
SeùÜNo
 + 
i
è% (
Çnd_dev
.
block_·g’um
 * (Çnd_dev.
·ge_mašsize
 / 
SeùÜSize
))) * SectorSize;

259 
PhyPageNo
 = 
PBNNo
 * 
Çnd_dev
.
block_·g’um
 + 
BlockOff£t
 /‚ªd_dev.
·ge_mašsize
;

260 
PageOff£t
 = 
BlockOff£t
 % 
Çnd_dev
.
·ge_mašsize
;

261 
‹mp
 = 
Çnd_dev
.
·ge_mašsize
 - 
PageOff£t
;

262 
‹mp
 /ğ
SeùÜSize
;

263 
w£cs
 = 
SeùÜCouÁ
 - 
i
;

264 if(
w£cs
 >ğ
‹mp
)

266 
w£cs
 = 
‹mp
;

268 
wËn
 = 
w£cs
 * 
SeùÜSize
;

270 
æag
 = 
	`NAND_R—dPageComp
(
PhyPageNo
, 
PageOff£t
, 0XFFFFFFFF, 
wËn
 / 4, &
‹mp
);

271 if(
æag
)

275 if(
‹mp
 =ğ(
wËn
 / 4))

277 
æag
 = 
	`NAND_Wr™ePage
(
PhyPageNo
, 
PageOff£t
, 
pBufãr
, 
wËn
);

281 
æag
 = 1;

283 if(
æag
 =ğ0 && (
m¬kdpbn
 !ğ
PBNNo
))

285 
æag
 = 
	`FTL_U£dBlockM¬k
(
PBNNo
);

286 
m¬kdpbn
 = 
PBNNo
;

288 if(
æag
)

290 
‹mp
 = ((
u32
)
Çnd_dev
.
block_·g’um
 *‚ªd_dev.
·ge_mašsize
 - 
BlockOff£t
è/ 
SeùÜSize
;

291 
w£cs
 = 
SeùÜCouÁ
 - 
i
;

292 if(
w£cs
 >ğ
‹mp
)

294 
w£cs
 = 
‹mp
;

296 
wËn
 = 
w£cs
 * 
SeùÜSize
;

297 
æag
 = 
	`FTL_CİyAndWr™eToBlock
(
PhyPageNo
, 
PageOff£t
, 
pBufãr
, 
wËn
);

298 if(
æag
)

303 
i
 +ğ
w£cs
 - 1;

304 
pBufãr
 +ğ
wËn
;

307 
	}
}

315 
u8
 
	$FTL_R—dSeùÜs
(
u8
 *
pBufãr
, 
u32
 
SeùÜNo
, 
u16
 
SeùÜSize
, u32 
SeùÜCouÁ
)

317 
u8
 
æag
 = 0;

318 
u16
 
r£cs
;

319 
u32
 
i
 = 0;

320 
u32
 
LBNNo
;

321 
u32
 
PBNNo
;

322 
u32
 
PhyPageNo
;

323 
u32
 
PageOff£t
;

324 
u32
 
BlockOff£t
;

325 
i
 = 0; i < 
SeùÜCouÁ
; i++)

327 
LBNNo
 = (
SeùÜNo
 + 
i
è/ (
Çnd_dev
.
block_·g’um
 * (Çnd_dev.
·ge_mašsize
 / 
SeùÜSize
));

328 
PBNNo
 = 
	`FTL_LBNToPBN
(
LBNNo
);

329 if(
PBNNo
 >ğ
Çnd_dev
.
block_tÙ®num
)

333 
BlockOff£t
 = ((
SeùÜNo
 + 
i
è% (
Çnd_dev
.
block_·g’um
 * (Çnd_dev.
·ge_mašsize
 / 
SeùÜSize
))) * SectorSize;

334 
PhyPageNo
 = 
PBNNo
 * 
Çnd_dev
.
block_·g’um
 + 
BlockOff£t
 /‚ªd_dev.
·ge_mašsize
;

335 
PageOff£t
 = 
BlockOff£t
 % 
Çnd_dev
.
·ge_mašsize
;

336 
r£cs
 = (
Çnd_dev
.
·ge_mašsize
 - 
PageOff£t
è/ 
SeùÜSize
;

337 if(
r£cs
 > (
SeùÜCouÁ
 - 
i
))

339 
r£cs
 = 
SeùÜCouÁ
 - 
i
;

341 
æag
 = 
	`NAND_R—dPage
(
PhyPageNo
, 
PageOff£t
, 
pBufãr
, 
r£cs
 * 
SeùÜSize
);

342 if(
æag
 =ğ
NSTA_ECC1BITERR
)

344 
æag
 = 
	`NAND_R—dPage
(
PhyPageNo
, 
PageOff£t
, 
pBufãr
, 
r£cs
 * 
SeùÜSize
);

345 if(
æag
 =ğ
NSTA_ECC1BITERR
)

347 
	`FTL_CİyAndWr™eToBlock
(
PhyPageNo
, 
PageOff£t
, 
pBufãr
, 
r£cs
 * 
SeùÜSize
);

348 
æag
 = 
	`FTL_BlockCom·»
(
PhyPageNo
 / 
Çnd_dev
.
block_·g’um
, 0XFFFFFFFF);

349 if(
æag
 == 0)

351 
æag
 = 
	`FTL_BlockCom·»
(
PhyPageNo
 / 
Çnd_dev
.
block_·g’um
, 0X00);

352 
	`NAND_E¿£Block
(
PhyPageNo
 / 
Çnd_dev
.
block_·g’um
);

354 if(
æag
)

356 
	`FTL_BadBlockM¬k
(
PhyPageNo
 / 
Çnd_dev
.
block_·g’um
);

357 
	`FTL_C»©eLUT
(1);

359 
æag
 = 0;

362 if(
æag
 =ğ
NSTA_ECC2BITERR
)

364 
æag
 = 0;

366 if(
æag
)

370 
pBufãr
 +ğ
SeùÜSize
 * 
r£cs
;

371 
i
 +ğ
r£cs
 - 1;

374 
	}
}

380 
u8
 
	$FTL_C»©eLUT
(
u8
 
mode
)

382 
u32
 
i
;

383 
u8
 
buf
[4];

384 
u32
 
LBNnum
 = 0;

385 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

387 
Çnd_dev
.
lut
[
i
] = 0XFFFF;

389 
Çnd_dev
.
good_blocknum
 = 0;

390 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

392 
	`NAND_R—dS·»
(
i
 * 
Çnd_dev
.
block_·g’um
, 0, 
buf
, 4);

393 if((
buf
[0] =ğ0XFFè&& 
mode
)

395 
	`NAND_R—dS·»
(
i
 * 
Çnd_dev
.
block_·g’um
 + 1, 0, 
buf
, 1);

397 if(
buf
[0] == 0XFF)

399 
LBNnum
 = ((
u16
)
buf
[3] << 8) + buf[2];

400 if(
LBNnum
 < 
Çnd_dev
.
block_tÙ®num
)

402 
Çnd_dev
.
lut
[
LBNnum
] = 
i
;

404 
Çnd_dev
.
good_blocknum
++;

408 
	`x´štf
("bad block index:%d\r\n", 
i
);

412 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

414 if(
Çnd_dev
.
lut
[
i
] >ğÇnd_dev.
block_tÙ®num
)

416 
Çnd_dev
.
v®id_blocknum
 = 
i
;

420 if(
Çnd_dev
.
v®id_blocknum
 < 100)

425 
	}
}

431 
u8
 
	$FTL_BlockCom·»
(
u32
 
blockx
, u32 
cmpv®
)

433 
u8
 
»s
;

434 
u16
 
i
, 
j
, 
k
;

435 
i
 = 0; i < 3; i++)

437 
j
 = 0; j < 
Çnd_dev
.
block_·g’um
; j++)

439 
	`NAND_R—dPageComp
(
blockx
 * 
Çnd_dev
.
block_·g’um
, 0, 
cmpv®
,‚ªd_dev.
·ge_mašsize
 / 4, &
k
);

440 if(
k
 !ğ(
Çnd_dev
.
·ge_mašsize
 / 4))

445 if(
j
 =ğ
Çnd_dev
.
block_·g’um
)

449 
»s
 = 
	`NAND_E¿£Block
(
blockx
);

450 if(
»s
)

452 
	`x´štf
("”rÜƒ¿£ block:%d\r\n", 
i
);

456 if(
cmpv®
 != 0XFFFFFFFF)

458 
k
 = 0; k < 
Çnd_dev
.
block_·g’um
; k++)

460 
	`NAND_Wr™ePageCÚ¡
(
blockx
 * 
Çnd_dev
.
block_·g’um
 + 
k
, 0, 0,‚ªd_dev.
·ge_mašsize
 / 4);

465 
	`x´štf
("bad block checked:%d\r\n", 
blockx
);

467 
	}
}

472 
u32
 
	$FTL_S—rchBadBlock
()

474 
u8
 *
blktbl
;

475 
u8
 
»s
;

476 
u32
 
i
, 
j
;

477 
u32
 
goodblock
 = 0;

478 
blktbl
 = 
	`m®loc
(
Çnd_dev
.
block_tÙ®num
);

479 
	`NAND_E¿£Ch
();

480 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

482 
»s
 = 
	`FTL_BlockCom·»
(
i
, 0XFFFFFFFF);

483 if(
»s
)

485 
blktbl
[
i
] = 1;

489 
blktbl
[
i
] = 0;

490 
j
 = 0; j < 
Çnd_dev
.
block_·g’um
; j++)

492 
	`NAND_Wr™ePageCÚ¡
(
i
 * 
Çnd_dev
.
block_·g’um
 + 
j
, 0, 0,‚ªd_dev.
·ge_mašsize
 / 4);

496 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

498 if(
blktbl
[
i
] == 0)

500 
»s
 = 
	`FTL_BlockCom·»
(
i
, 0);

501 if(
»s
)

503 
blktbl
[
i
] = 1;

507 
goodblock
++;

511 
	`NAND_E¿£Ch
();

512 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

514 if(
blktbl
[
i
])

516 
	`FTL_BadBlockM¬k
(
i
);

519  
goodblock
;

520 
	}
}

525 
u8
 
	$FTL_FÜm©
()

527 
u8
 
‹mp
;

528 
u32
 
i
, 
n
;

529 
u32
 
goodblock
 = 0;

530 
Çnd_dev
.
good_blocknum
 = 0;

531 #ià
FTL_USE_BAD_BLOCK_SEARCH
==1

532 
Çnd_dev
.
good_blocknum
 = 
	`FTL_S—rchBadBlock
();

534 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

536 
‹mp
 = 
	`FTL_CheckBadBlock
(
i
);

537 if(
‹mp
 == 0)

539 
‹mp
 = 
	`NAND_E¿£Block
(
i
);

540 if(
‹mp
)

542 
	`x´štf
("Bad block:%d\r\n", 
i
);

543 
	`FTL_BadBlockM¬k
(
i
);

547 
Çnd_dev
.
good_blocknum
++;

552 
	`x´štf
("good_blocknum:%d\r\n", 
Çnd_dev
.
good_blocknum
);

553 if(
Çnd_dev
.
good_blocknum
 < 100)

557 
goodblock
 = (
Çnd_dev
.
good_blocknum
 * 93) / 100;

558 
n
 = 0;

559 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

561 
‹mp
 = 
	`FTL_CheckBadBlock
(
i
);

562 if(
‹mp
 == 0)

564 
	`NAND_Wr™eS·»
(
i
 * 
Çnd_dev
.
block_·g’um
, 2, (
u8
 *)&
n
, 2);

565 
n
++;

566 if(
n
 =ğ
goodblock
)

572 if(
	`FTL_C»©eLUT
(1))

577 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_nand_hw.c

1 
	~"b¥.h
"

3 
	#USE_WAITRB
 0

	)

4 
	#BSP_DELAY_US_VAL
 20

	)

5 
NAND_HªdËTy³Def
 
	gNAND_HªdËr
;

6 
Çnd_©Œiu‹
 
	gÇnd_dev
;

9 
u8
 
	$NAND_In™
()

11 
FMC_NAND_PCC_TimšgTy³Def
 
ComS·ûTimšg
, 
A‰S·ûTimšg
;

13 
NAND_HªdËr
.
In¡ªû
 = 
FMC_NAND_DEVICE
;

14 
NAND_HªdËr
.
In™
.
NªdBªk
 = 
FMC_NAND_BANK3
;

15 
NAND_HªdËr
.
In™
.
Wa™ã©u»
 = 
FMC_NAND_PCC_WAIT_FEATURE_DISABLE
;

16 
NAND_HªdËr
.
In™
.
MemÜyD©aWidth
 = 
FMC_NAND_PCC_MEM_BUS_WIDTH_8
;

17 
NAND_HªdËr
.
In™
.
EccComputiÚ
 = 
FMC_NAND_ECC_DISABLE
;

18 
NAND_HªdËr
.
In™
.
ECCPageSize
 = 
FMC_NAND_ECC_PAGE_SIZE_2048BYTE
;

19 
NAND_HªdËr
.
In™
.
TCLRS‘upTime
 = 0;

20 
NAND_HªdËr
.
In™
.
TARS‘upTime
 = 1;

22 
ComS·ûTimšg
.
S‘upTime
 = 2;

23 
ComS·ûTimšg
.
Wa™S‘upTime
 = 3;

24 
ComS·ûTimšg
.
HŞdS‘upTime
 = 2;

25 
ComS·ûTimšg
.
HiZS‘upTime
 = 1;

27 
A‰S·ûTimšg
.
S‘upTime
 = 2;

28 
A‰S·ûTimšg
.
Wa™S‘upTime
 = 3;

29 
A‰S·ûTimšg
.
HŞdS‘upTime
 = 2;

30 
A‰S·ûTimšg
.
HiZS‘upTime
 = 1;

32 
	`HAL_NAND_In™
(&
NAND_HªdËr
, &
ComS·ûTimšg
, &
A‰S·ûTimšg
);

33 
	`NAND_Re£t
();

34 
	`b¥_D–ayMS
(100);

35 
Çnd_dev
.
id
 = 
	`NAND_R—dID
();

36 
	`NAND_ModeS‘
(4);

37 if(
Çnd_dev
.
id
 =ğ
MT29F16G08ABABA
)

39 
Çnd_dev
.
·ge_tÙ®size
 = 4320;

40 
Çnd_dev
.
·ge_mašsize
 = 4096;

41 
Çnd_dev
.
·ge_¥¬esize
 = 224;

42 
Çnd_dev
.
block_·g’um
 = 128;

43 
Çnd_dev
.
¶ªe_blocknum
 = 2048;

44 
Çnd_dev
.
block_tÙ®num
 = 4096;

46 if(
Çnd_dev
.
id
 =ğ
MT29F4G08ABADA
)

48 
Çnd_dev
.
·ge_tÙ®size
 = 2112;

49 
Çnd_dev
.
·ge_mašsize
 = 2048;

50 
Çnd_dev
.
·ge_¥¬esize
 = 64;

51 
Çnd_dev
.
block_·g’um
 = 64;

52 
Çnd_dev
.
¶ªe_blocknum
 = 2048;

53 
Çnd_dev
.
block_tÙ®num
 = 4096;

60 
	}
}

64 
	$HAL_NAND_M¥In™
(
NAND_HªdËTy³Def
 *
hÇnd
)

66 
GPIO_In™Ty³Def
 
GPIO_In™u»
;

68 
	`__HAL_RCC_FMC_CLK_ENABLE
();

69 
	`__HAL_RCC_GPIOD_CLK_ENABLE
();

70 
	`__HAL_RCC_GPIOE_CLK_ENABLE
();

71 
	`__HAL_RCC_GPIOG_CLK_ENABLE
();

74 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_6
;

75 
GPIO_In™u»
.
Mode
 = 
GPIO_MODE_INPUT
;

76 
GPIO_In™u»
.
PuÎ
 = 
GPIO_PULLUP
;

77 
GPIO_In™u»
.
S³ed
 = 
GPIO_SPEED_HIGH
;

78 
	`HAL_GPIO_In™
(
GPIOD
, &
GPIO_In™u»
);

81 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_9
;

82 
GPIO_In™u»
.
Mode
 = 
GPIO_MODE_AF_PP
;

83 
GPIO_In™u»
.
PuÎ
 = 
GPIO_NOPULL
;

84 
GPIO_In™u»
.
S³ed
 = 
GPIO_SPEED_HIGH
;

85 
GPIO_In™u»
.
AÉ”Ç‹
 = 
GPIO_AF12_FMC
;

86 
	`HAL_GPIO_In™
(
GPIOG
, &
GPIO_In™u»
);

89 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_0
 | 
GPIO_PIN_1
 | 
GPIO_PIN_4
 | 
GPIO_PIN_5
 | \

90 
GPIO_PIN_11
 | 
GPIO_PIN_12
 | 
GPIO_PIN_14
 | 
GPIO_PIN_15
;

91 
GPIO_In™u»
.
PuÎ
 = 
GPIO_NOPULL
;

92 
	`HAL_GPIO_In™
(
GPIOD
, &
GPIO_In™u»
);

95 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_7
 | 
GPIO_PIN_8
 | 
GPIO_PIN_9
 | 
GPIO_PIN_10
;

96 
	`HAL_GPIO_In™
(
GPIOE
, &
GPIO_In™u»
);

97 
	}
}

102 
u8
 
	$NAND_ModeS‘
(
u8
 
mode
)

104 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_FEATURE
;

105 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
) = 0X01;

106 *(
vu8
 *)
NAND_ADDRESS
 = 
mode
;

107 *(
vu8
 *)
NAND_ADDRESS
 = 0;

108 *(
vu8
 *)
NAND_ADDRESS
 = 0;

109 *(
vu8
 *)
NAND_ADDRESS
 = 0;

110 if(
	`NAND_Wa™FÜR—dy
(è=ğ
NSTA_READY
)

118 
	}
}

123 
u32
 
	$NAND_R—dID
()

125 
u8
 
deviûid
[5];

126 
u32
 
id
;

127 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_READID
;

128 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
) = 0X00;

130 
deviûid
[0] = *(
vu8
 *)
NAND_ADDRESS
;

131 
deviûid
[1] = *(
vu8
 *)
NAND_ADDRESS
;

132 
deviûid
[2] = *(
vu8
 *)
NAND_ADDRESS
;

133 
deviûid
[3] = *(
vu8
 *)
NAND_ADDRESS
;

134 
deviûid
[4] = *(
vu8
 *)
NAND_ADDRESS
;

138 
id
 = ((
u32
)
deviûid
[1]) << 24 | ((u32)deviceid[2]) << 16 | ((u32)deviceid[3]) << 8 | deviceid[4];

139  
id
;

140 
	}
}

145 
u8
 
	$NAND_R—dStus
()

147 
vu8
 
d©a
 = 0;

148 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_READSTA
;

149 
d©a
++;

150 
d©a
++;

151 
d©a
++;

152 
d©a
++;

153 
d©a
++;

154 
d©a
 = *(
vu8
 *)
NAND_ADDRESS
;

155  
d©a
;

156 
	}
}

160 
u8
 
	$NAND_Wa™FÜR—dy
()

162 
u8
 
¡©us
 = 0;

163 
vu32
 
time
 = 0;

166 
¡©us
 = 
	`NAND_R—dStus
();

167 if(
¡©us
 & 
NSTA_READY
)

171 
time
++;

172 if(
time
 >= 0X1FFFF)

174  
NSTA_TIMEOUT
;

177  
NSTA_READY
;

178 
	}
}

182 
u8
 
	$NAND_Re£t
()

184 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_RESET
;

185 if(
	`NAND_Wa™FÜR—dy
(è=ğ
NSTA_READY
)

193 
	}
}

199 
u8
 
	$NAND_Wa™RB
(
vu8
 
rb
)

201 
vu16
 
time
 = 0;

202 
time
 < 20)

204 
time
++;

205 if(
NAND_RB
 =ğ
rb
)

211 
	}
}

213 
	$NAND_D–ay
(
vu32
 
i
)

215 
i
 > 0)

217 
i
--;

219 
	}
}

227 
u8
 
	$NAND_R—dPage
(
u32
 
PageNum
, 
u16
 
CŞNum
, 
u8
 *
pBufãr
, u16 
NumBy‹ToR—d
)

229 
vu16
 
i
 = 0;

230 
u8
 
»s
 = 0;

231 
u8
 
ecúum
 = 0;

232 
u8
 
ecc¡¬t
 = 0;

233 
u8
 
”r¡a
 = 0;

234 
u8
 *
p
;

235 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_AREA_A
;

237 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
CŞNum
;

238 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
CŞNum
 >> 8);

239 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
PageNum
;

240 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 8);

241 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 16);

242 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_AREA_TRUE1
;

249 #ià
USE_WAITRB


250 
»s
=
	`NAND_Wa™RB
(0);

251 if(
»s
) 
NSTA_TIMEOUT
;

253 
»s
=
	`NAND_Wa™RB
(1);

254 if(
»s
) 
NSTA_TIMEOUT
;

256 
	`b¥_D–ayUS
(
BSP_DELAY_US_VAL
);

260 if(
NumBy‹ToR—d
 % 
NAND_ECC_SECTOR_SIZE
)

263 
i
 = 0; i < 
NumBy‹ToR—d
; i++)

265 *(
vu8
 *)
pBufãr
++ = *(vu8 *)
NAND_ADDRESS
;

270 
ecúum
 = 
NumBy‹ToR—d
 / 
NAND_ECC_SECTOR_SIZE
;

271 
ecc¡¬t
 = 
CŞNum
 / 
NAND_ECC_SECTOR_SIZE
;

272 
p
 = 
pBufãr
;

273 
»s
 = 0;„e < 
ecúum
;„es++)

275 
FMC_Bªk2_3
->
PCR3
 |= 1 << 6;

276 
i
 = 0; i < 
NAND_ECC_SECTOR_SIZE
; i++)

278 *(
vu8
 *)
pBufãr
++ = *(vu8 *)
NAND_ADDRESS
;

280 !(
FMC_Bªk2_3
->
SR3
 & (1 << 6)));

281 
Çnd_dev
.
ecc_hdbuf
[
»s
 + 
ecc¡¬t
] = 
FMC_Bªk2_3
->
ECCR3
;

282 
FMC_Bªk2_3
->
PCR3
 &= ~(1 << 6);

284 
i
 = 
Çnd_dev
.
·ge_mašsize
 + 0X10 + 
ecc¡¬t
 * 4;

285 
	`NAND_D–ay
(30);

286 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
) = 0X05;

288 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
i
;

289 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
i
 >> 8);

290 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
) = 0XE0;

291 
	`NAND_D–ay
(30);

292 
pBufãr
 = (
u8
 *)&
Çnd_dev
.
ecc_rdbuf
[
ecc¡¬t
];

293 
i
 = 0; i < 4 * 
ecúum
; i++)

295 *(
vu8
 *)
pBufãr
++ = *(vu8 *)
NAND_ADDRESS
;

297 
i
 = 0; i < 
ecúum
; i++)

299 if(
Çnd_dev
.
ecc_rdbuf
[
i
 + 
ecc¡¬t
] !ğÇnd_dev.
ecc_hdbuf
[i +ƒccstart])

301 
	`x´štf
("”¸hd,rd:0x%x,0x%x\r\n", 
Çnd_dev
.
ecc_hdbuf
[
i
 + 
ecc¡¬t
],‚ªd_dev.
ecc_rdbuf
[i +ƒccstart]);

302 
	`x´štf
("ecúum,ecc¡¬t:%d,%d\r\n", 
ecúum
, 
ecc¡¬t
);

303 
	`x´štf
("PageNum,CŞNum:%d,%d\r\n", 
PageNum
, 
CŞNum
);

304 
»s
 = 
	`NAND_ECC_CÜ»ùiÚ
(
p
 + 
NAND_ECC_SECTOR_SIZE
 * 
i
, 
Çnd_dev
.
ecc_rdbuf
[˜+ 
ecc¡¬t
],‚ªd_dev.
ecc_hdbuf
[i +ƒccstart]);

305 if(
»s
)

307 
”r¡a
 = 
NSTA_ECC2BITERR
;

311 
”r¡a
 = 
NSTA_ECC1BITERR
;

316 if(
	`NAND_Wa™FÜR—dy
(è!ğ
NSTA_READY
)

318 
”r¡a
 = 
NSTA_ERROR
;

320  
”r¡a
;

321 
	}
}

330 
u8
 
	$NAND_R—dPageComp
(
u32
 
PageNum
, 
u16
 
CŞNum
, u32 
CmpV®
, u16 
NumBy‹ToR—d
, u16 *
NumBy‹Equ®
)

332 
u16
 
i
 = 0;

333 #ià
USE_WAITRB


334 
u8
 
»s
 = 0;

336 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_AREA_A
;

338 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
CŞNum
;

339 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
CŞNum
 >> 8);

340 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
PageNum
;

341 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 8);

342 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 16);

343 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_AREA_TRUE1
;

349 #ià
USE_WAITRB


350 
»s
=
	`NAND_Wa™RB
(0);

351 if(
»s
) 
NSTA_TIMEOUT
;

353 
»s
=
	`NAND_Wa™RB
(1);

354 if(
»s
) 
NSTA_TIMEOUT
;

356 
	`b¥_D–ayUS
(
BSP_DELAY_US_VAL
);

358 
i
 = 0; i < 
NumBy‹ToR—d
; i++)

360 if(*(
vu32
 *)
NAND_ADDRESS
 !ğ
CmpV®
)

365 *
NumBy‹Equ®
 = 
i
;

366 if(
	`NAND_Wa™FÜR—dy
(è!ğ
NSTA_READY
)

368  
NSTA_ERROR
;

371 
	}
}

379 
u8
 
	$NAND_Wr™ePage
(
u32
 
PageNum
, 
u16
 
CŞNum
, 
u8
 *
pBufãr
, u16 
NumBy‹ToWr™e
)

381 
vu16
 
i
 = 0;

382 
u8
 
»s
 = 0;

383 
u8
 
ecúum
 = 0;

384 
u8
 
ecc¡¬t
 = 0;

386 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_WRITE0
;

388 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
CŞNum
;

389 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
CŞNum
 >> 8);

390 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
PageNum
;

391 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 8);

392 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 16);

393 
	`NAND_D–ay
(30);

394 if(
NumBy‹ToWr™e
 % 
NAND_ECC_SECTOR_SIZE
)

396 
i
 = 0; i < 
NumBy‹ToWr™e
; i++)

398 *(
vu8
 *)
NAND_ADDRESS
 = *(vu8 *)
pBufãr
++;

403 
ecúum
 = 
NumBy‹ToWr™e
 / 
NAND_ECC_SECTOR_SIZE
;

404 
ecc¡¬t
 = 
CŞNum
 / 
NAND_ECC_SECTOR_SIZE
;

405 
»s
 = 0;„e < 
ecúum
;„es++)

407 
FMC_Bªk2_3
->
PCR3
 |= 1 << 6;

408 
i
 = 0; i < 
NAND_ECC_SECTOR_SIZE
; i++)

410 *(
vu8
 *)
NAND_ADDRESS
 = *(vu8 *)
pBufãr
++;

412 !(
FMC_Bªk2_3
->
SR3
 & (1 << 6)));

413 
Çnd_dev
.
ecc_hdbuf
[
»s
 + 
ecc¡¬t
] = 
FMC_Bªk2_3
->
ECCR3
;

414 
FMC_Bªk2_3
->
PCR3
 &= ~(1 << 6);

416 
i
 = 
Çnd_dev
.
·ge_mašsize
 + 0X10 + 
ecc¡¬t
 * 4;

417 
	`NAND_D–ay
(30);

418 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
) = 0X85;

420 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
i
;

421 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
i
 >> 8);

422 
	`NAND_D–ay
(30);

423 
pBufãr
 = (
u8
 *)&
Çnd_dev
.
ecc_hdbuf
[
ecc¡¬t
];

424 
i
 = 0; i < 
ecúum
; i++)

426 
»s
 = 0;„es < 4;„es++)

428 *(
vu8
 *)
NAND_ADDRESS
 = *(vu8 *)
pBufãr
++;

432 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_WRITE_TURE1
;

433 if(
	`NAND_Wa™FÜR—dy
(è!ğ
NSTA_READY
)

435  
NSTA_ERROR
;

438 
	}
}

446 
u8
 
	$NAND_Wr™ePageCÚ¡
(
u32
 
PageNum
, 
u16
 
CŞNum
, u32 
cv®
, u16 
NumBy‹ToWr™e
)

448 
u16
 
i
 = 0;

449 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_WRITE0
;

451 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
CŞNum
;

452 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
CŞNum
 >> 8);

453 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
PageNum
;

454 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 8);

455 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
PageNum
 >> 16);

456 
	`NAND_D–ay
(30);

457 
i
 = 0; i < 
NumBy‹ToWr™e
; i++)

459 *(
vu32
 *)
NAND_ADDRESS
 = 
cv®
;

461 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_WRITE_TURE1
;

462 if(
	`NAND_Wa™FÜR—dy
(è!ğ
NSTA_READY
)

464  
NSTA_ERROR
;

467 
	}
}

474 
u8
 
	$NAND_CİyPageW™houtWr™e
(
u32
 
Sourû_PageNum
, u32 
De¡_PageNum
)

476 #ià
USE_WAITRB


477 
u8
 
»s
 = 0;

479 
u16
 
sourû_block
 = 0, 
de¡_block
 = 0;

481 
sourû_block
 = 
Sourû_PageNum
 / 
Çnd_dev
.
block_·g’um
;

482 
de¡_block
 = 
De¡_PageNum
 / 
Çnd_dev
.
block_·g’um
;

483 if((
sourû_block
 % 2è!ğ(
de¡_block
 % 2))

485  
NSTA_ERROR
;

487 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD0
;

489 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)0;

490 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)0;

491 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
Sourû_PageNum
;

492 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
Sourû_PageNum
 >> 8);

493 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
Sourû_PageNum
 >> 16);

494 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD1
;

500 #ià
USE_WAITRB


501 
»s
=
	`NAND_Wa™RB
(0);

502 if(
»s
) 
NSTA_TIMEOUT
;

504 
»s
=
	`NAND_Wa™RB
(1);

505 if(
»s
) 
NSTA_TIMEOUT
;

507 
	`b¥_D–ayUS
(
BSP_DELAY_US_VAL
);

509 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD2
;

511 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)0;

512 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)0;

513 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
De¡_PageNum
;

514 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
De¡_PageNum
 >> 8);

515 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
De¡_PageNum
 >> 16);

516 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD3
;

517 if(
	`NAND_Wa™FÜR—dy
(è!ğ
NSTA_READY
)

519  
NSTA_ERROR
;

522 
	}
}

533 
u8
 
	$NAND_CİyPageW™hWr™e
(
u32
 
Sourû_PageNum
, u32 
De¡_PageNum
, 
u16
 
CŞNum
, 
u8
 *
pBufãr
, u16 
NumBy‹ToWr™e
)

535 
u8
 
»s
 = 0;

536 
vu16
 
i
 = 0;

537 
u16
 
sourû_block
 = 0, 
de¡_block
 = 0;

538 
u8
 
ecúum
 = 0;

539 
u8
 
ecc¡¬t
 = 0;

541 
sourû_block
 = 
Sourû_PageNum
 / 
Çnd_dev
.
block_·g’um
;

542 
de¡_block
 = 
De¡_PageNum
 / 
Çnd_dev
.
block_·g’um
;

543 if((
sourû_block
 % 2è!ğ(
de¡_block
 % 2))

545  
NSTA_ERROR
;

547 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD0
;

549 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)0;

550 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)0;

551 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
Sourû_PageNum
;

552 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
Sourû_PageNum
 >> 8);

553 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
Sourû_PageNum
 >> 16);

554 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD1
;

561 #ià
USE_WAITRB


562 
»s
=
	`NAND_Wa™RB
(0);

563 if(
»s
) 
NSTA_TIMEOUT
;

565 
»s
=
	`NAND_Wa™RB
(1);

566 if(
»s
) 
NSTA_TIMEOUT
;

568 
	`b¥_D–ayUS
(
BSP_DELAY_US_VAL
);

570 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD2
;

572 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
CŞNum
;

573 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
CŞNum
 >> 8);

574 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
De¡_PageNum
;

575 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
De¡_PageNum
 >> 8);

576 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
De¡_PageNum
 >> 16);

578 
	`NAND_D–ay
(30);

579 if(
NumBy‹ToWr™e
 % 
NAND_ECC_SECTOR_SIZE
)

581 
i
 = 0; i < 
NumBy‹ToWr™e
; i++)

583 *(
vu8
 *)
NAND_ADDRESS
 = *(vu8 *)
pBufãr
++;

588 
ecúum
 = 
NumBy‹ToWr™e
 / 
NAND_ECC_SECTOR_SIZE
;

589 
ecc¡¬t
 = 
CŞNum
 / 
NAND_ECC_SECTOR_SIZE
;

590 
»s
 = 0;„e < 
ecúum
;„es++)

592 
FMC_Bªk2_3
->
PCR3
 |= 1 << 6;

593 
i
 = 0; i < 
NAND_ECC_SECTOR_SIZE
; i++)

595 *(
vu8
 *)
NAND_ADDRESS
 = *(vu8 *)
pBufãr
++;

597 !(
FMC_Bªk2_3
->
SR3
 & (1 << 6)));

598 
Çnd_dev
.
ecc_hdbuf
[
»s
 + 
ecc¡¬t
] = 
FMC_Bªk2_3
->
ECCR3
;

599 
FMC_Bªk2_3
->
PCR3
 &= ~(1 << 6);

601 
i
 = 
Çnd_dev
.
·ge_mašsize
 + 0X10 + 
ecc¡¬t
 * 4;

602 
	`NAND_D–ay
(30);

603 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
) = 0X85;

605 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
i
;

606 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
i
 >> 8);

607 
	`NAND_D–ay
(30);

608 
pBufãr
 = (
u8
 *)&
Çnd_dev
.
ecc_hdbuf
[
ecc¡¬t
];

609 
i
 = 0; i < 
ecúum
; i++)

611 
»s
 = 0;„es < 4;„es++)

613 *(
vu8
 *)
NAND_ADDRESS
 = *(vu8 *)
pBufãr
++;

617 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_MOVEDATA_CMD3
;

618 if(
	`NAND_Wa™FÜR—dy
(è!ğ
NSTA_READY
)

620  
NSTA_ERROR
;

623 
	}
}

631 
u8
 
	$NAND_R—dS·»
(
u32
 
PageNum
, 
u16
 
CŞNum
, 
u8
 *
pBufãr
, u16 
NumBy‹ToR—d
)

633 
u8
 
‹mp
 = 0;

634 
u8
 
»mašby‹
 = 0;

635 
»mašby‹
 = 
Çnd_dev
.
·ge_¥¬esize
 - 
CŞNum
;

636 if(
NumBy‹ToR—d
 > 
»mašby‹
)

638 
NumBy‹ToR—d
 = 
»mašby‹
;

640 
‹mp
 = 
	`NAND_R—dPage
(
PageNum
, 
CŞNum
 + 
Çnd_dev
.
·ge_mašsize
, 
pBufãr
, 
NumBy‹ToR—d
);

641  
‹mp
;

642 
	}
}

650 
u8
 
	$NAND_Wr™eS·»
(
u32
 
PageNum
, 
u16
 
CŞNum
, 
u8
 *
pBufãr
, u16 
NumBy‹ToWr™e
)

652 
u8
 
‹mp
 = 0;

653 
u8
 
»mašby‹
 = 0;

654 
»mašby‹
 = 
Çnd_dev
.
·ge_¥¬esize
 - 
CŞNum
;

655 if(
NumBy‹ToWr™e
 > 
»mašby‹
)

657 
NumBy‹ToWr™e
 = 
»mašby‹
;

659 
‹mp
 = 
	`NAND_Wr™ePage
(
PageNum
, 
CŞNum
 + 
Çnd_dev
.
·ge_mašsize
, 
pBufãr
, 
NumBy‹ToWr™e
);

660  
‹mp
;

661 
	}
}

666 
u8
 
	$NAND_E¿£Block
(
u32
 
BlockNum
)

668 if(
Çnd_dev
.
id
 =ğ
MT29F16G08ABABA
)

670 
BlockNum
 <<= 7;

672 if(
Çnd_dev
.
id
 =ğ
MT29F4G08ABADA
)

674 
BlockNum
 <<= 6;

676 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_ERASE0
;

678 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)
BlockNum
;

679 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
BlockNum
 >> 8);

680 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_ADDR
èğ(
u8
)(
BlockNum
 >> 16);

681 *(
vu8
 *)(
NAND_ADDRESS
 | 
NAND_CMD
èğ
NAND_ERASE1
;

682 if(
	`NAND_Wa™FÜR—dy
(è!ğ
NSTA_READY
)

684  
NSTA_ERROR
;

687 
	}
}

689 
	$NAND_E¿£Ch
()

691 
u8
 
¡©us
;

692 
u16
 
i
 = 0;

693 
i
 = 0; i < 
Çnd_dev
.
block_tÙ®num
; i++)

695 
¡©us
 = 
	`NAND_E¿£Block
(
i
);

696 if(
¡©us
)

698 
	`x´štf
("E¿£ %d block fa!!£¬´íÎóÂëÎª%d\r\n", 
i
, 
¡©us
);

701 
	}
}

708 
u16
 
	$NAND_ECC_G‘_OE
(
u8
 
Û
, 
u32
 
eccv®
)

710 
u8
 
i
;

711 
u16
 
ecùemp
 = 0;

712 
i
 = 0; i < 24; i++)

714 if((
i
 % 2è=ğ
Û
)

716 if((
eccv®
 >> 
i
) & 0X01)

718 
ecùemp
 +ğ1 << (
i
 >> 1);

722  
ecùemp
;

723 
	}
}

729 
u8
 
	$NAND_ECC_CÜ»ùiÚ
(
u8
 *
d©a_buf
, 
u32
 
ecüd
, u32 
eccş
)

731 
u16
 
ecüdo
, 
ecüde
, 
eccşo
, 
eccşe
;

732 
u16
 
eccchk
 = 0;

733 
u16
 
”rÜpos
 = 0;

734 
u32
 
by‹pos
 = 0;

735 
ecüdo
 = 
	`NAND_ECC_G‘_OE
(1, 
ecüd
);

736 
ecüde
 = 
	`NAND_ECC_G‘_OE
(0, 
ecüd
);

737 
eccşo
 = 
	`NAND_ECC_G‘_OE
(1, 
eccş
);

738 
eccşe
 = 
	`NAND_ECC_G‘_OE
(0, 
eccş
);

739 
eccchk
 = 
ecüdo
 ^ 
ecüde
 ^ 
eccşo
 ^ 
eccşe
;

740 if(
eccchk
 == 0XFFF)

742 
”rÜpos
 = 
ecüdo
 ^ 
eccşo
;

743 
	`x´štf
("”rÜpos:%d\r\n", 
”rÜpos
);

744 
by‹pos
 = 
”rÜpos
 / 8;

745 
d©a_buf
[
by‹pos
] ^ğ1 << (
”rÜpos
 % 8);

749 
	`x´štf
("2bitƒccƒrror or more\r\n");

753 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_rtc.c

1 
	~"b¥.h
"

16 
RTC_HªdËTy³Def
 
	gRTC_HªdËr
;

23 
HAL_StusTy³Def
 
	$RTC_S‘_Time
(
u8
 
hour
, u8 
mš
, u8 
£c
)

25 
RTC_TimeTy³Def
 
RTC_TimeSŒuùu»
;

26 
u8
 
ampm
;

27 if(
RTC_HªdËr
.
In™
.
HourFÜm©
 =ğ
RTC_HOURFORMAT_24
)

29 if(
hour
 <= 12)

31 
ampm
 = 
RTC_HOURFORMAT12_AM
;

33 if(
hour
 > 12 && hour < 23)

35 
ampm
 = 
RTC_HOURFORMAT12_PM
;

38 if(
RTC_HªdËr
.
In™
.
HourFÜm©
 =ğ
RTC_HOURFORMAT_12
)

43 
RTC_TimeSŒuùu»
.
Hours
 = 
hour
;

44 
RTC_TimeSŒuùu»
.
Mšu‹s
 = 
mš
;

45 
RTC_TimeSŒuùu»
.
SecÚds
 = 
£c
;

46 
RTC_TimeSŒuùu»
.
TimeFÜm©
 = 
ampm
;

47 
RTC_TimeSŒuùu»
.
DayLightSavšg
 = 
RTC_DAYLIGHTSAVING_NONE
;

48 
RTC_TimeSŒuùu»
.
StÜeO³¿tiÚ
 = 
RTC_STOREOPERATION_RESET
;

49  
	`HAL_RTC_S‘Time
(&
RTC_HªdËr
, &
RTC_TimeSŒuùu»
, 
RTC_FORMAT_BIN
);

50 
	}
}

57 
HAL_StusTy³Def
 
	$RTC_S‘_D©e
(
u8
 
y—r
, u8 
mÚth
, u8 
d©e
)

59 
RTC_D©eTy³Def
 
RTC_D©eSŒuùu»
;

60 
y
, 
m
, 
d
, 
w
;

61 
y
 = 
y—r
;

62 
m
 = 
mÚth
;

63 
d
 = 
d©e
;

65 if(
m
 == 1 || m == 2)

67 
m
 += 12;

68 
y
--;

70 
w
 = (
d
 + 2 * 
m
 + 3 * (m + 1è/ 5 + 
y
 + y / 4 - y / 100 + y / 400) % 7;

72 
RTC_D©eSŒuùu»
.
W“kDay
 = 
w
+1;

73 
RTC_D©eSŒuùu»
.
MÚth
 = 
mÚth
;

74 
RTC_D©eSŒuùu»
.
D©e
 = 
d©e
;

75 
RTC_D©eSŒuùu»
.
Y—r
 = 
y—r
;

76  
	`HAL_RTC_S‘D©e
(&
RTC_HªdËr
, &
RTC_D©eSŒuùu»
, 
RTC_FORMAT_BIN
);

77 
	}
}

82 
u8
 
	$b¥_RTC_In™
()

86 
RTC_HªdËr
.
In¡ªû
 = 
RTC
;

87 
RTC_HªdËr
.
In™
.
HourFÜm©
 = 
RTC_HOURFORMAT_24
;

88 
RTC_HªdËr
.
In™
.
AsynchP»div
 = 0X7F;

89 
RTC_HªdËr
.
In™
.
SynchP»div
 = 0XFF;

90 
RTC_HªdËr
.
In™
.
OutPut
 = 
RTC_OUTPUT_DISABLE
;

91 
RTC_HªdËr
.
In™
.
OutPutPŞ¬™y
 = 
RTC_OUTPUT_POLARITY_HIGH
;

92 
RTC_HªdËr
.
In™
.
OutPutTy³
 = 
RTC_OUTPUT_TYPE_OPENDRAIN
;

93 if(
	`HAL_RTC_In™
(&
RTC_HªdËr
è!ğ
HAL_OK
)

98 if(
	`HAL_RTCEx_BKUPR—d
(&
RTC_HªdËr
, 
RTC_BKP_DR0
) != 0X5050)

100 
	`RTC_S‘_Time
(9, 34, 56);

101 
	`RTC_S‘_D©e
(16, 11, 21);

102 
	`HAL_RTCEx_BKUPWr™e
(&
RTC_HªdËr
, 
RTC_BKP_DR0
, 0X5050);

105 
	}
}

110 
	$HAL_RTC_M¥In™
(
RTC_HªdËTy³Def
 *
h¹c
)

112 
RCC_OscIn™Ty³Def
 
RCC_OscIn™SŒuù
;

113 
RCC_P”hCLKIn™Ty³Def
 
P”hClkIn™SŒuù
;

115 
	`__HAL_RCC_PWR_CLK_ENABLE
();

116 
	`HAL_PWR_EÇbËBkUpAcûss
();

118 
RCC_OscIn™SŒuù
.
OscÏtÜTy³
 = 
RCC_OSCILLATORTYPE_LSE
;

119 
RCC_OscIn™SŒuù
.
PLL
.
PLLS‹
 = 
RCC_PLL_NONE
;

120 
RCC_OscIn™SŒuù
.
LSES‹
 = 
RCC_LSE_ON
;

121 
	`HAL_RCC_OscCÚfig
(&
RCC_OscIn™SŒuù
);

123 
P”hClkIn™SŒuù
.
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_RTC
;

124 
P”hClkIn™SŒuù
.
RTCClockS–eùiÚ
 = 
RCC_RTCCLKSOURCE_LSE
;

125 
	`HAL_RCCEx_P”hCLKCÚfig
(&
P”hClkIn™SŒuù
);

127 
	`__HAL_RCC_RTC_ENABLE
();

128 
	}
}

133 
	$RTC_S‘_AÏrmA
(
u8
 
w“k
, u8 
hour
, u8 
mš
, u8 
£c
)

135 
RTC_AÏrmTy³Def
 
RTC_AÏrmSturuù
;

137 
RTC_AÏrmSturuù
.
AÏrmTime
.
Hours
 = 
hour
;

138 
RTC_AÏrmSturuù
.
AÏrmTime
.
Mšu‹s
 = 
mš
;

139 
RTC_AÏrmSturuù
.
AÏrmTime
.
SecÚds
 = 
£c
;

140 
RTC_AÏrmSturuù
.
AÏrmTime
.
SubSecÚds
 = 0;

141 
RTC_AÏrmSturuù
.
AÏrmTime
.
TimeFÜm©
 = 
RTC_HOURFORMAT12_AM
;

143 
RTC_AÏrmSturuù
.
AÏrmMask
 = 
RTC_ALARMMASK_NONE
;

144 
RTC_AÏrmSturuù
.
AÏrmSubSecÚdMask
 = 
RTC_ALARMSUBSECONDMASK_NONE
;

145 
RTC_AÏrmSturuù
.
AÏrmD©eW“kDayS–
 = 
RTC_ALARMDATEWEEKDAYSEL_WEEKDAY
;

146 
RTC_AÏrmSturuù
.
AÏrmD©eW“kDay
 = 
w“k
;

147 
RTC_AÏrmSturuù
.
AÏrm
 = 
RTC_ALARM_A
;

148 
	`HAL_RTC_S‘AÏrm_IT
(&
RTC_HªdËr
, &
RTC_AÏrmSturuù
, 
RTC_FORMAT_BIN
);

150 
	`HAL_NVIC_S‘PriÜ™y
(
RTC_AÏrm_IRQn
, 0x01, 0x02);

151 
	`HAL_NVIC_EÇbËIRQ
(
RTC_AÏrm_IRQn
);

152 
	}
}

164 
	$RTC_S‘_WakeUp
(
u32
 
wk£l
, 
u16
 
út
)

166 
	`__HAL_RTC_WAKEUPTIMER_CLEAR_FLAG
(&
RTC_HªdËr
, 
RTC_FLAG_WUTF
);

168 
	`HAL_RTCEx_S‘WakeUpTim”_IT
(&
RTC_HªdËr
, 
út
, 
wk£l
);

170 
	`HAL_NVIC_S‘PriÜ™y
(
RTC_WKUP_IRQn
, 0x02, 0x02);

171 
	`HAL_NVIC_EÇbËIRQ
(
RTC_WKUP_IRQn
);

172 
	}
}

175 
	$RTC_AÏrm_IRQHªdËr
()

177 
	`HAL_RTC_AÏrmIRQHªdËr
(&
RTC_HªdËr
);

178 
	}
}

181 
	$HAL_RTC_AÏrmAEv’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

183 
	`x´štf
("ALARM A!\r\n");

184 
	}
}

187 
	$RTC_WKUP_IRQHªdËr
()

189 
	`HAL_RTCEx_WakeUpTim”IRQHªdËr
(&
RTC_HªdËr
);

190 
	}
}

193 
	$HAL_RTCEx_WakeUpTim”Ev’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

196 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_sdram.c

1 
	~"b¥.h
"

3 
SDRAM_HªdËTy³Def
 
	gSDRAM_HªdËr
;

6 
	$b¥_SDRAM_In™
()

8 
FMC_SDRAM_TimšgTy³Def
 
SDRAM_Timšg
;

12 
ušt32_t
 
tRSC
 = 2;

13 
ušt32_t
 
tXSR
 = 8;

14 
ušt32_t
 
tRAS
 = 7;

15 
ušt32_t
 
tRC
 = 7;

16 
ušt32_t
 
tWR
 = 2;

17 
ušt32_t
 
tRP
 = 2;

18 
ušt32_t
 
tRCD
 = 2;

20 
SDRAM_HªdËr
.
In¡ªû
=
FMC_SDRAM_DEVICE
;

21 
SDRAM_HªdËr
.
In™
.
SDBªk
=
FMC_SDRAM_BANK1
;

22 
SDRAM_HªdËr
.
In™
.
CŞumnB™sNumb”
=
FMC_SDRAM_COLUMN_BITS_NUM_9
;

23 
SDRAM_HªdËr
.
In™
.
RowB™sNumb”
=
FMC_SDRAM_ROW_BITS_NUM_13
;

24 
SDRAM_HªdËr
.
In™
.
MemÜyD©aWidth
=
FMC_SDRAM_MEM_BUS_WIDTH_16
;

25 
SDRAM_HªdËr
.
In™
.
IÁ”ÇlBªkNumb”
=
FMC_SDRAM_INTERN_BANKS_NUM_4
;

26 
SDRAM_HªdËr
.
In™
.
CASL©’cy
=
FMC_SDRAM_CAS_LATENCY_3
;

27 
SDRAM_HªdËr
.
In™
.
Wr™ePrÙeùiÚ
=
FMC_SDRAM_WRITE_PROTECTION_DISABLE
;

28 
SDRAM_HªdËr
.
In™
.
SDClockP”iod
=
FMC_SDRAM_CLOCK_PERIOD_2
;

29 
SDRAM_HªdËr
.
In™
.
R—dBur¡
=
FMC_SDRAM_RBURST_ENABLE
;

30 
SDRAM_HªdËr
.
In™
.
R—dPeD–ay
=
FMC_SDRAM_RPIPE_DELAY_1
;

32 
SDRAM_Timšg
.
LßdToAùiveD–ay
 = 
tRSC
;

33 
SDRAM_Timšg
.
Ex™S–fReäeshD–ay
 = 
tXSR
;

34 
SDRAM_Timšg
.
S–fReäeshTime
 = 
tRAS
;

35 
SDRAM_Timšg
.
RowCyşeD–ay
 = 
tRC
;

36 
SDRAM_Timšg
.
Wr™eRecov”yTime
 = 
tWR
;

37 
SDRAM_Timšg
.
RPD–ay
 = 
tRP
;

38 
SDRAM_Timšg
.
RCDD–ay
 = 
tRCD
;

39 
	`HAL_SDRAM_In™
(&
SDRAM_HªdËr
,&
SDRAM_Timšg
);

41 
	`SDRAM_In™Ÿliz©iÚ_Sequ’û
(&
SDRAM_HªdËr
);

50 
	`HAL_SDRAM_Prog¿mReäeshR©e
(&
SDRAM_HªdËr
,730);

52 
	}
}

54 
	$SDRAM_In™Ÿliz©iÚ_Sequ’û
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

56 
ušt32_t
 
‹mp
 = 0;

58 
	`SDRAM_S’d_Cmd
(0,
FMC_SDRAM_CMD_CLK_ENABLE
,1,0);

59 
	`b¥_D–ayUS
(300);

60 
	`SDRAM_S’d_Cmd
(0,
FMC_SDRAM_CMD_PALL
,1,0);

61 
	`SDRAM_S’d_Cmd
(0,
FMC_SDRAM_CMD_AUTOREFRESH_MODE
,8,0);

65 
‹mp
=(
ušt32_t
)
SDRAM_MODEREG_BURST_LENGTH_1
 |

66 
SDRAM_MODEREG_BURST_TYPE_SEQUENTIAL
 |

67 
SDRAM_MODEREG_CAS_LATENCY_3
 |

68 
SDRAM_MODEREG_OPERATING_MODE_STANDARD
 |

69 
SDRAM_MODEREG_WRITEBURST_MODE_SINGLE
;

70 
	`SDRAM_S’d_Cmd
(0,
FMC_SDRAM_CMD_LOAD_MODE
,1,
‹mp
);

71 
	}
}

77 
	$HAL_SDRAM_M¥In™
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

79 
GPIO_In™Ty³Def
 
GPIO_In™u»
;

81 
	`__HAL_RCC_FMC_CLK_ENABLE
();

82 
	`__HAL_RCC_GPIOC_CLK_ENABLE
();

83 
	`__HAL_RCC_GPIOD_CLK_ENABLE
();

84 
	`__HAL_RCC_GPIOE_CLK_ENABLE
();

85 
	`__HAL_RCC_GPIOF_CLK_ENABLE
();

86 
	`__HAL_RCC_GPIOG_CLK_ENABLE
();

88 
GPIO_In™u»
.
Pš
=
GPIO_PIN_0
|
GPIO_PIN_2
|
GPIO_PIN_3
;

89 
GPIO_In™u»
.
Mode
=
GPIO_MODE_AF_PP
;

90 
GPIO_In™u»
.
PuÎ
=
GPIO_PULLUP
;

91 
GPIO_In™u»
.
S³ed
=
GPIO_SPEED_HIGH
;

92 
GPIO_In™u»
.
AÉ”Ç‹
=
GPIO_AF12_FMC
;

93 
	`HAL_GPIO_In™
(
GPIOC
,&
GPIO_In™u»
);

95 
GPIO_In™u»
.
Pš
=
GPIO_PIN_0
|
GPIO_PIN_1
|
GPIO_PIN_8
|
GPIO_PIN_9
|
GPIO_PIN_10
|
GPIO_PIN_14
|
GPIO_PIN_15
;

96 
	`HAL_GPIO_In™
(
GPIOD
,&
GPIO_In™u»
);

98 
GPIO_In™u»
.
Pš
=
GPIO_PIN_0
|
GPIO_PIN_1
|
GPIO_PIN_7
|
GPIO_PIN_8
|
GPIO_PIN_9
|
GPIO_PIN_10
| 
GPIO_PIN_11
|
GPIO_PIN_12
|
GPIO_PIN_13
|
GPIO_PIN_14
|
GPIO_PIN_15
;

99 
	`HAL_GPIO_In™
(
GPIOE
,&
GPIO_In™u»
);

101 
GPIO_In™u»
.
Pš
=
GPIO_PIN_0
|
GPIO_PIN_1
|
GPIO_PIN_2
|
GPIO_PIN_3
|
GPIO_PIN_4
|
GPIO_PIN_5
|
GPIO_PIN_11
|
GPIO_PIN_12
|
GPIO_PIN_13
|
GPIO_PIN_14
|
GPIO_PIN_15
;

102 
	`HAL_GPIO_In™
(
GPIOF
,&
GPIO_In™u»
);

104 
GPIO_In™u»
.
Pš
=
GPIO_PIN_0
|
GPIO_PIN_1
|
GPIO_PIN_2
|
GPIO_PIN_4
|
GPIO_PIN_5
|
GPIO_PIN_8
|
GPIO_PIN_15
;

105 
	`HAL_GPIO_In™
(
GPIOG
,&
GPIO_In™u»
);

106 
	}
}

114 
ušt8_t
 
	$SDRAM_S’d_Cmd
(
ušt8_t
 
bªkx
,ušt8_ˆ
cmd
,ušt8_ˆ
»äesh
,
ušt16_t
 
»gv®
)

116 
ušt32_t
 
rg‘_bªk
=0;

117 
FMC_SDRAM_CommªdTy³Def
 
Commªd
;

119 if(
bªkx
==0è
rg‘_bªk
=
FMC_SDRAM_CMD_TARGET_BANK1
;

120 if(
bªkx
==1è
rg‘_bªk
=
FMC_SDRAM_CMD_TARGET_BANK2
;

121 
Commªd
.
CommªdMode
=
cmd
;

122 
Commªd
.
CommªdT¬g‘
=
rg‘_bªk
;

123 
Commªd
.
AutoReäeshNumb”
=
»äesh
;

124 
Commªd
.
ModeRegi¡”Defš™iÚ
=
»gv®
;

125 if(
	`HAL_SDRAM_S’dCommªd
(&
SDRAM_HªdËr
,&
Commªd
,0X1000)==
HAL_OK
)

130 
	}
}

136 
	$FMC_SDRAM_Wr™eBufãr
(
ušt8_t
 *
pBufãr
,
ušt32_t
 
Wr™eAddr
,ušt32_ˆ
n
)

138 ;
n
!=0;n--)

140 *(
__IO
 
ušt8_t
 *)(
Bªk5_SDRAM_ADDR
+
Wr™eAddr
)=*
pBufãr
;

141 
Wr™eAddr
++;

142 
pBufãr
++;

144 
	}
}

150 
	$FMC_SDRAM_R—dBufãr
(
ušt8_t
 *
pBufãr
,
ušt32_t
 
R—dAddr
,ušt32_ˆ
n
)

152 ;
n
!=0;n--)

154 *
pBufãr
++=*(
__IO
 
ušt8_t
 *)(
Bªk5_SDRAM_ADDR
+
R—dAddr
);

155 
R—dAddr
++;

157 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_timer.c

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_touch_2046.c

1 
	~"b¥.h
"

2 
	~"¡dlib.h
"

3 
	~"m©h.h
"

5 
u8
 
	gCMD_RDX
 = 0XD0;

6 
u8
 
	gCMD_RDY
 = 0X90;

10 
	$TP_Wr™e_By‹
(
u8
 
num
)

12 
u8
 
couÁ
 = 0;

13 
couÁ
 = 0; count < 8; count++)

15 if(
num
 & 0x80)

17 
TDIN
 = 1;

21 
TDIN
 = 0;

23 
num
 <<= 1;

24 
TCLK
 = 0;

25 
	`b¥_D–ayUS
(5);

26 
TCLK
 = 1;

28 
	}
}

33 
u16
 
	$TP_R—d_AD
(
u8
 
CMD
)

35 
u8
 
couÁ
 = 0;

36 
u16
 
Num
 = 0;

37 
TCLK
 = 0;

38 
TDIN
 = 0;

39 
TCS
 = 0;

40 
	`TP_Wr™e_By‹
(
CMD
);

41 
	`b¥_D–ayUS
(200);

42 
TCLK
 = 0;

43 
	`b¥_D–ayUS
(1);

44 
TCLK
 = 1;

45 
	`b¥_D–ayUS
(1);

46 
TCLK
 = 0;

47 
couÁ
 = 0; count < 16; count++)

49 
Num
 <<= 1;

50 
TCLK
 = 0;

51 
	`b¥_D–ayUS
(1);

52 
TCLK
 = 1;

53 if(
DOUT
)

55 
Num
 |= 1;

58 
Num
 >>= 4;

59 
TCS
 = 1;

60 (
Num
);

61 
	}
}

67 
	#READ_TIMES
 5

68 
	#LOST_VAL
 1

69 
u16
 
	`TP_R—d_XOY
(
u8
 
xy
)

	)

71 
u16
 
	gi
, 
	gj
;

72 
u16
 
	gbuf
[
READ_TIMES
];

73 
u16
 
	gsum
 = 0;

74 
u16
 
	g‹mp
;

75 
	gi
 = 0; i < 
	gREAD_TIMES
; i++)

77 
	gbuf
[
i
] = 
TP_R—d_AD
(
xy
);

79 
	gi
 = 0; i < 
	gREAD_TIMES
 - 1; i++)

81 
	gj
 = 
i
 + 1; j < 
	gREAD_TIMES
; j++)

83 if(
	gbuf
[
i
] > buf[
j
])

85 
	g‹mp
 = 
buf
[
i
];

86 
	gbuf
[
i
] = 
buf
[
j
];

87 
	gbuf
[
j
] = 
‹mp
;

91 
	gsum
 = 0;

92 
	gi
 = 
LOST_VAL
; i < 
	gREAD_TIMES
 - 
	gLOST_VAL
; i++)

94 
	gsum
 +ğ
buf
[
i
];

96 
	g‹mp
 = 
sum
 / (
READ_TIMES
 - 2 * 
LOST_VAL
);

97  
	g‹mp
;

103 
u8
 
	$TP_R—d_XY
(
u16
 *
x
, u16 *
y
)

105 
u16
 
x‹mp
, 
y‹mp
, 
z1
;

106 
´essu»
;

107 
xTPr
 = 738, 
yTPr
 = 222;

108 
z1
 = 
	`TP_R—d_XOY
(0xB4);

109 
x‹mp
 = 
	`TP_R—d_XOY
(
CMD_RDX
);

110 
y‹mp
 = 
	`TP_R—d_XOY
(
CMD_RDY
);

112 if(
x‹mp
 < 100 || 
y‹mp
 < 100)

116 *
x
 = 
x‹mp
;

117 *
y
 = 
y‹mp
;

118 
´essu»
 = (
xTPr
 * ()
x‹mp
è/ 4096.0à* (4096.0à/ ()
z1
 - 1è- 
yTPr
 * (1 - ()
y‹mp
 / 4096.0f);

119 if(
´essu»
 < 400 ||…ressure > 800)

127 
	}
}

133 
	#ERR_RANGE
 100

134 
u8
 
	`TP_R—d_XY2
(
u16
 *
x
, u16 *
y
)

	)

136 
u16
 
	gx1
, 
	gy1
;

137 
u16
 
	gx2
, 
	gy2
;

138 
u8
 
	gæag
;

139 
	gæag
 = 
TP_R—d_XY
(&
x1
, &
y1
);

140 if(
	gæag
 == 0)

144 
	gæag
 = 
TP_R—d_XY
(&
x2
, &
y2
);

145 if(
	gæag
 == 0)

149 if(((
	gx2
 <ğ
x1
 && x1 < 
x2
 + 
ERR_RANGE
) || (x1 <= x2 && x2 < x1 + ERR_RANGE))

150 && ((
y2
 <ğ
y1
 && y1 < y2 + 
ERR_RANGE
) || (y1 <= y2 && y2 < y1 + ERR_RANGE)))

152 *
x
 = (
x1
 + 
x2
) / 2;

153 *
	gy
 = (
y1
 + 
y2
) / 2;

162 
u8
 
	$TP_R—d_P»ssu»
(*
´essu»
)

164 
u16
 
x
, 
y
, 
z1
;

165 
xTPr
 = 738, 
yTPr
 = 222;

166 
z1
 = 
	`TP_R—d_XOY
(0xB4);

167 
	`TP_R—d_XY2
(&
x
, &
y
);

168 *
´essu»
 = (
xTPr
 * ()
x
è/ 4096.0à* (4096.0à/ ()
z1
 - 1è- 
yTPr
 * (1 - ()
y
 / 4096.0f);

170 
	}
}

177 
	$TP_Sÿn
(
u16
 *
adc_x
, u16 *
adc_y
)

179 
u8
 
_´es£d
;

180 
u8
 
šv®id_couÁ
 = 0;

181 
_´es£d
 = 
PEN
 ? 0 : 1;

184 if(
_´es£d
 == 1)

186 
	`TP_R—d_XY2
(
adc_x
, 
adc_y
è!ğ1 && 
šv®id_couÁ
 < 20)

188 
šv®id_couÁ
++;

190 if(
šv®id_couÁ
 >= 20)

192 *
adc_x
 = 0xffff;

193 *
adc_y
 = 0xffff;

199 *
adc_x
 = 0xffff;

200 *
adc_y
 = 0xffff;

202 
	}
}

205 
	$TP_Save_Adjd©a
()

208 
	}
}

212 
u8
 
	$TP_G‘_Adjd©a
()

216 
	}
}

221 
u8
 
	$b¥_Touch_In™
()

223 
GPIO_In™Ty³Def
 
GPIO_In™u»
;

226 
	`__HAL_RCC_GPIOH_CLK_ENABLE
();

227 
	`__HAL_RCC_GPIOI_CLK_ENABLE
();

228 
	`__HAL_RCC_GPIOG_CLK_ENABLE
();

231 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_6
;

232 
GPIO_In™u»
.
Mode
 = 
GPIO_MODE_OUTPUT_PP
;

233 
GPIO_In™u»
.
PuÎ
 = 
GPIO_PULLUP
;

234 
GPIO_In™u»
.
S³ed
 = 
GPIO_SPEED_HIGH
;

235 
	`HAL_GPIO_In™
(
GPIOH
, &
GPIO_In™u»
);

238 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_3
 | 
GPIO_PIN_8
;

239 
	`HAL_GPIO_In™
(
GPIOI
, &
GPIO_In™u»
);

242 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_7
;

243 
GPIO_In™u»
.
Mode
 = 
GPIO_MODE_INPUT
;

244 
	`HAL_GPIO_In™
(
GPIOH
, &
GPIO_In™u»
);

247 
GPIO_In™u»
.
Pš
 = 
GPIO_PIN_3
;

248 
	`HAL_GPIO_In™
(
GPIOG
, &
GPIO_In™u»
);

251 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_uart.c

9 
	~"b¥.h
"

10 
	~"şi_maš.h
"

11 
	~"u£¾ib_queue.h
"

13 
UART_HªdËTy³Def
 
	gCLI_UARTx_HªdËr
;

14 
UART_HªdËTy³Def
 
	gRFID_UARTx_HªdËr
;

16 vŞ©
ušt8_t
 
	gCLI_RX_Bufãr
[1];

17 vŞ©
ušt8_t
 
	gRFID_RX_Bufãr
[1];

19 
Queue
 *
	gpCliRecvQue
;

20 
Queue
 *
	gpRfidRecvQue
;

22 
št8_t
 
	$»adRecvQue
(
Queue
 *
q
, 
ušt8_t
 *
ch
, 
ušt16_t
 
time_out
)

24 
	`xSem­hÜeTake
(
q
->
xHªdËMu‹xQue
, 100);

25 
time_out
)

27 if((
q
->
	`isEm±y
(q)è!ğ
QUE_TRUE
)

29 
q
->
	`DeEËm
(q, 
ch
);

30 
	`xSem­hÜeGive
(
q
->
xHªdËMu‹xQue
);

33 
time_out
--;

35 
	`xSem­hÜeGive
(
q
->
xHªdËMu‹xQue
);

36  (
št8_t
) - 1;

37 
	}
}

39 
	$b¥_U¬t_In™
()

41 
pCliRecvQue
 = 
	`QueueC»©e
(
CLI_QUEUE_SIZE
);

42 
pRfidRecvQue
 = 
	`QueueC»©e
(
RFID_QUEUE_SIZE
);

44 
CLI_UARTx_HªdËr
.
In¡ªû
 = 
CLI_USARTx_BASE
;

45 
CLI_UARTx_HªdËr
.
In™
.
BaudR©e
 = 
CLI_USARTx_BAUDRATE
;

46 
CLI_UARTx_HªdËr
.
In™
.
WÜdL’gth
 = 
UART_WORDLENGTH_8B
;

47 
CLI_UARTx_HªdËr
.
In™
.
StİB™s
 = 
UART_STOPBITS_1
;

48 
CLI_UARTx_HªdËr
.
In™
.
P¬™y
 = 
UART_PARITY_NONE
;

49 
CLI_UARTx_HªdËr
.
In™
.
Mode
 = 
UART_MODE_TX_RX
;

50 
CLI_UARTx_HªdËr
.
In™
.
HwFlowC
 = 
UART_HWCONTROL_NONE
;

51 
CLI_UARTx_HªdËr
.
In™
.
Ov”Sam¶šg
 = 
UART_OVERSAMPLING_16
;

52 
	`HAL_UART_In™
(&
CLI_UARTx_HªdËr
);

53 
	`HAL_UART_Reûive_IT
(&
CLI_UARTx_HªdËr
, (
ušt8_t
 *)
CLI_RX_Bufãr
, 1);

55 
RFID_UARTx_HªdËr
.
In¡ªû
 = 
RFID_USARTx_BASE
;

56 
RFID_UARTx_HªdËr
.
In™
.
BaudR©e
 = 
RFID_USARTx_BAUDRATE
;

57 
RFID_UARTx_HªdËr
.
In™
.
WÜdL’gth
 = 
UART_WORDLENGTH_8B
;

58 
RFID_UARTx_HªdËr
.
In™
.
StİB™s
 = 
UART_STOPBITS_1
;

59 
RFID_UARTx_HªdËr
.
In™
.
P¬™y
 = 
UART_PARITY_NONE
;

60 
RFID_UARTx_HªdËr
.
In™
.
Mode
 = 
UART_MODE_TX_RX
;

61 
RFID_UARTx_HªdËr
.
In™
.
HwFlowC
 = 
UART_HWCONTROL_NONE
;

62 
RFID_UARTx_HªdËr
.
In™
.
Ov”Sam¶šg
 = 
UART_OVERSAMPLING_16
;

63 
	`HAL_UART_In™
(&
RFID_UARTx_HªdËr
);

64 
	`HAL_UART_Reûive_IT
(&
RFID_UARTx_HªdËr
, (
ušt8_t
 *)
RFID_RX_Bufãr
, 1);

65 
	}
}

67 
	$HAL_UART_M¥In™
(
UART_HªdËTy³Def
 *
hu¬t
)

69 
GPIO_In™Ty³Def
 
GPIO_In™SŒuù
;

71 if(
hu¬t
->
In¡ªû
 =ğ
USART1
)

73 
	`__HAL_RCC_GPIOA_CLK_ENABLE
();

74 
	`__HAL_RCC_USART1_CLK_ENABLE
();

76 
GPIO_In™SŒuù
.
Pš
 = 
GPIO_PIN_9
;

77 
GPIO_In™SŒuù
.
Mode
 = 
GPIO_MODE_AF_PP
;

78 
GPIO_In™SŒuù
.
PuÎ
 = 
GPIO_PULLUP
;

79 
GPIO_In™SŒuù
.
S³ed
 = 
GPIO_SPEED_FAST
;

80 
GPIO_In™SŒuù
.
AÉ”Ç‹
 = 
GPIO_AF7_USART1
;

81 
	`HAL_GPIO_In™
(
GPIOA
, &
GPIO_In™SŒuù
);

83 
GPIO_In™SŒuù
.
Pš
 = 
GPIO_PIN_10
;

84 
	`HAL_GPIO_In™
(
GPIOA
, &
GPIO_In™SŒuù
);

86 
	`HAL_NVIC_EÇbËIRQ
(
USART1_IRQn
);

87 
	`HAL_NVIC_S‘PriÜ™y
(
USART1_IRQn
, 
b¥USART1_P»em±PriÜ™y
, 
b¥USART1_SubPriÜ™y
);

90 if(
hu¬t
->
In¡ªû
 =ğ
USART2
)

92 
	`__HAL_RCC_GPIOA_CLK_ENABLE
();

93 
	`__HAL_RCC_USART2_CLK_ENABLE
();

95 
GPIO_In™SŒuù
.
Pš
 = 
GPIO_PIN_2
;

96 
GPIO_In™SŒuù
.
Mode
 = 
GPIO_MODE_AF_PP
;

97 
GPIO_In™SŒuù
.
PuÎ
 = 
GPIO_PULLUP
;

98 
GPIO_In™SŒuù
.
S³ed
 = 
GPIO_SPEED_FAST
;

99 
GPIO_In™SŒuù
.
AÉ”Ç‹
 = 
GPIO_AF7_USART2
;

100 
	`HAL_GPIO_In™
(
GPIOA
, &
GPIO_In™SŒuù
);

102 
GPIO_In™SŒuù
.
Pš
 = 
GPIO_PIN_3
;

103 
	`HAL_GPIO_In™
(
GPIOA
, &
GPIO_In™SŒuù
);

105 
	`HAL_NVIC_EÇbËIRQ
(
USART2_IRQn
);

106 
	`HAL_NVIC_S‘PriÜ™y
(
USART2_IRQn
, 
b¥USART2_P»em±PriÜ™y
, 
b¥USART2_SubPriÜ™y
);

108 if(
hu¬t
->
In¡ªû
 =ğ
USART3
)

110 
	`__HAL_RCC_GPIOB_CLK_ENABLE
();

111 
	`__HAL_RCC_USART3_CLK_ENABLE
();

113 
GPIO_In™SŒuù
.
Pš
 = 
GPIO_PIN_10
;

114 
GPIO_In™SŒuù
.
Mode
 = 
GPIO_MODE_AF_PP
;

115 
GPIO_In™SŒuù
.
PuÎ
 = 
GPIO_PULLUP
;

116 
GPIO_In™SŒuù
.
S³ed
 = 
GPIO_SPEED_FAST
;

117 
GPIO_In™SŒuù
.
AÉ”Ç‹
 = 
GPIO_AF7_USART3
;

118 
	`HAL_GPIO_In™
(
GPIOB
, &
GPIO_In™SŒuù
);

120 
GPIO_In™SŒuù
.
Pš
 = 
GPIO_PIN_11
;

121 
	`HAL_GPIO_In™
(
GPIOB
, &
GPIO_In™SŒuù
);

123 
	`HAL_NVIC_EÇbËIRQ
(
USART3_IRQn
);

124 
	`HAL_NVIC_S‘PriÜ™y
(
USART3_IRQn
, 
b¥USART3_P»em±PriÜ™y
, 
b¥USART3_SubPriÜ™y
);

126 
	}
}

127 
	gCLI_USARTx_IRQHªdËr


129 
UBa£Ty³_t
 
	guxSavedIÁ”ru±Stus
;

130 
	guxSavedIÁ”ru±Stus
 = 
skENTER_CRITICAL_FROM_ISR
();

132 
HAL_UART_IRQHªdËr
(&
CLI_UARTx_HªdËr
);

134 
skEXIT_CRITICAL_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

137 
	gRFID_USARTx_IRQHªdËr


139 
UBa£Ty³_t
 
	guxSavedIÁ”ru±Stus
;

140 
	guxSavedIÁ”ru±Stus
 = 
skENTER_CRITICAL_FROM_ISR
();

142 
HAL_UART_IRQHªdËr
(&
RFID_UARTx_HªdËr
);

144 
skEXIT_CRITICAL_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

154 
	$HAL_UART_TxC¶tC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

156 
	}
}

167 
	$HAL_UART_RxC¶tC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

169 
Ba£Ty³_t
 
xHigh”PriÜ™yTaskWok’Cli
 = 
pdFALSE
;

170 
Ba£Ty³_t
 
xHigh”PriÜ™yTaskWok’Rfid
 = 
pdFALSE
;

171 if(
hu¬t
->
In¡ªû
 =ğ
CLI_USARTx_BASE
)

173 if(
	`HAL_UART_Reûive_IT
(&
CLI_UARTx_HªdËr
, (
ušt8_t
 *)
CLI_RX_Bufãr
, 1è=ğ
HAL_OK
)

175 
	`xSem­hÜeTakeFromISR
(
pCliRecvQue
->
xHªdËMu‹xQue
, &
xHigh”PriÜ™yTaskWok’Cli
);

176 
pCliRecvQue
->
	`EnEËm
ÕCliRecvQue, 
CLI_RX_Bufãr
[0]);

177 
	`xSem­hÜeGiveFromISR
(
pCliRecvQue
->
xHªdËMu‹xQue
, &
xHigh”PriÜ™yTaskWok’Cli
);

178 
	`pÜtYIELD_FROM_ISR
Ğ
xHigh”PriÜ™yTaskWok’Cli
 );

181 if(
hu¬t
->
In¡ªû
 =ğ
RFID_USARTx_BASE
)

183 if(
	`HAL_UART_Reûive_IT
(&
RFID_UARTx_HªdËr
, (
ušt8_t
 *)
RFID_RX_Bufãr
, 1è=ğ
HAL_OK
)

185 
	`xSem­hÜeTakeFromISR
(
pRfidRecvQue
->
xHªdËMu‹xQue
, &
xHigh”PriÜ™yTaskWok’Rfid
);

186 
pRfidRecvQue
->
	`EnEËm
ÕRfidRecvQue, 
RFID_RX_Bufãr
[0]);

187 
	`xSem­hÜeGiveFromISR
(
pRfidRecvQue
->
xHªdËMu‹xQue
, &
xHigh”PriÜ™yTaskWok’Rfid
);

188 
	`pÜtYIELD_FROM_ISR
Ğ
xHigh”PriÜ™yTaskWok’Rfid
 );

191 
	}
}

201 
	#THROW_USART_ERR
(
DEV
, 
ERR
, 
LEVEL
èif(
hu¬t
->
In¡ªû
 =ğDEV##
_USARTx_BASE
) \

203 if(
hu¬t
->
E¼ÜCode
 =ğ
HAL_USART_ERROR_
##
ERR
) \

205 
	`ThrowE¼ÜCode
(
defDevID_RFID
, 
ERR_
##
DEV
##
_
##
ERR
, 
LEVEL
); \

207 }

	)

208 
	$HAL_UART_E¼ÜC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

210 
	`THROW_USART_ERR
(
RFID
, 
PE
, 
ERR_LEVEL_TIPS
);

211 
	`THROW_USART_ERR
(
RFID
, 
NE
, 
ERR_LEVEL_TIPS
);

212 
	`THROW_USART_ERR
(
RFID
, 
FE
, 
ERR_LEVEL_TIPS
);

213 
	`THROW_USART_ERR
(
RFID
, 
ORE
, 
ERR_LEVEL_TIPS
);

214 
	`THROW_USART_ERR
(
RFID
, 
DMA
, 
ERR_LEVEL_TIPS
);

215 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_user_lib.c

1 
	~"b¥.h
"

2 
	~<ùy³.h
>

3 
	~<¡ršg.h
>

6 cÚ¡ 
ušt8_t
 
	gs_CRCHi
[] = {

35 cÚ¡ 
ušt8_t
 
	gs_CRCLo
[] = {

72 
	$¡r_Ën
(*
_¡r
)

74 
Ën
 = 0;

76 *
_¡r
++è
Ën
++;

77  
Ën
;

78 
	}
}

89 
	$¡r_ıy
(*
_r
, *
_¤c
)

93 *
_r
++ = *
_¤c
;

95 *
_¤c
++);

96 
	}
}

107 
	$¡r_cmp
(* 
s1
, * 
s2
)

109 (*
s1
!=0è&& (*
s2
!=0) && (*s1==*s2))

111 
s1
++;

112 
s2
++;

114  *
s1
 - *
s2
;

115 
	}
}

126 
	$mem_£t
(*
_r
, 
_d©a
, 
_Ën
)

128 
_Ën
--)

130 *
_r
++ = 
_d©a
;

132 
	}
}

144 
	$št_to_¡r
(
_iNumb”
, *
_pBuf
, 
_Ën
)

146 
i
;

147 
iTemp
;

149 ià(
_iNumb”
 < 0)

151 
iTemp
 = -
_iNumb”
;

155 
iTemp
 = 
_iNumb”
;

158 
	`mem_£t
(
_pBuf
, ' ',
_Ën
);

161 
i
 = 0; i < 
_Ën
; i++)

163 
_pBuf
[
_Ën
 - 1 - 
i
] = (
iTemp
 % 10) + '0';

164 
iTemp
 = iTemp / 10;

165 ià(
iTemp
 == 0)

170 
_pBuf
[
_Ën
] = 0;

172 ià(
_iNumb”
 < 0)

174 
i
 = 0; i < 
_Ën
; i++)

176 ià((
_pBuf
[
i
] == ' ') && (_pBuf[i + 1] != ' '))

178 
_pBuf
[
i
] = '-';

183 
	}
}

193 
	$¡r_to_št
(*
_pSŒ
)

195 
æag
;

196 *
p
;

197 
ulIÁ
;

198 
i
;

199 
ucTemp
;

201 
p
 = 
_pSŒ
;

202 ià(*
p
 == '-')

204 
æag
 = 1;

205 
p
++;

209 
æag
 = 0;

212 
ulIÁ
 = 0;

213 
i
 = 0; i < 15; i++)

215 
ucTemp
 = *
p
;

216 ià(
ucTemp
 == '.')

218 
p
++;

219 
ucTemp
 = *
p
;

221 ià((
ucTemp
 >= '0') && (ucTemp <= '9'))

223 
ulIÁ
 = ulIÁ * 10 + (
ucTemp
 - '0');

224 
p
++;

232 ià(
æag
 == 1)

234  -
ulIÁ
;

236  
ulIÁ
;

237 
	}
}

249 
ušt16_t
 
	$BEBufToUšt16
(
ušt8_t
 *
_pBuf
)

251  (((
ušt16_t
)
_pBuf
[0] << 8) | _pBuf[1]);

252 
	}
}

262 
ušt16_t
 
	$LEBufToUšt16
(
ušt8_t
 *
_pBuf
)

264  (((
ušt16_t
)
_pBuf
[1] << 8) | _pBuf[0]);

265 
	}
}

278 
ušt32_t
 
	$BEBufToUšt32
(
ušt8_t
 *
_pBuf
)

280  (((
ušt32_t
)
_pBuf
[0] << 24) | ((uint32_t)_pBuf[1] << 16) | ((uint32_t)_pBuf[2] << 8) | _pBuf[3]);

281 
	}
}

291 
ušt32_t
 
	$LEBufToUšt32
(
ušt8_t
 *
_pBuf
)

293  (((
ušt32_t
)
_pBuf
[3] << 24) | ((uint32_t)_pBuf[2] << 16) | ((uint32_t)_pBuf[1] << 8) | _pBuf[0]);

294 
	}
}

312 
ušt16_t
 
	$CRC16_Modbus
(
ušt8_t
 *
_pBuf
, 
ušt16_t
 
_usL’
)

314 
ušt8_t
 
ucCRCHi
 = 0xFF;

315 
ušt8_t
 
ucCRCLo
 = 0xFF;

316 
ušt16_t
 
usIndex
;

318 
_usL’
--)

320 
usIndex
 = 
ucCRCHi
 ^ *
_pBuf
++;

321 
ucCRCHi
 = 
ucCRCLo
 ^ 
s_CRCHi
[
usIndex
];

322 
ucCRCLo
 = 
s_CRCLo
[
usIndex
];

324  ((
ušt16_t
)
ucCRCHi
 << 8 | 
ucCRCLo
);

325 
	}
}

336 
št32_t
 
	$CaculTwoPošt
(
št32_t
 
x1
, iÁ32_ˆ
y1
, iÁ32_ˆ
x2
, iÁ32_ˆ
y2
, iÁ32_ˆ
x
)

338  
y1
 + ((
št64_t
)(
y2
 - y1è* (
x
 - 
x1
)è/ (
x2
 - x1);

339 
	}
}

350 
	$BcdToCh¬
(
ušt8_t
 
_bcd
)

352 ià(
_bcd
 < 10)

354  
_bcd
 + '0';

356 ià(
_bcd
 < 16)

358  
_bcd
 + 'A';

364 
	}
}

376 
	$HexToAsşl
(
ušt8_t
 * 
_pHex
, *
_pAscii
, 
ušt16_t
 
_BšBy‹s
)

378 
ušt16_t
 
i
;

380 ià(
_BšBy‹s
 == 0)

382 
_pAscii
[0] = 0;

386 
i
 = 0; i < 
_BšBy‹s
; i++)

388 
_pAscii
[3 * 
i
] = 
	`BcdToCh¬
(
_pHex
[i] >> 4);

389 
_pAscii
[3 * 
i
 + 1] = 
	`BcdToCh¬
(
_pHex
[i] & 0x0F);

390 
_pAscii
[3 * 
i
 + 2] = ' ';

392 
_pAscii
[3 * (
i
 - 1) + 2] = 0;

394 
	}
}

404 
ušt32_t
 
	$AsciiToUšt32
(*
pAscii
)

406 
i
;

407 
bTemp
;

408 
bIsHex
;

409 
bL’
;

410 
bZ”oL’
;

411 
ušt32_t
 
lResuÉ
;

412 
ušt32_t
 
lB™V®ue
;

415 
bIsHex
 = 0;

416 ià((
pAscii
[0] == '0') && ((pAscii[1] == 'x') || (pAscii[1] == 'X')))

418 
bIsHex
=1;

421 
lResuÉ
=0;

423 ià(
bIsHex
 == 0)

426 
lB™V®ue
=1;

429 
i
 = 0; i < 8; i++)

431 
bTemp
 = 
pAscii
[
i
];

432 ià(
bTemp
 != '0')

435 
bZ”oL’
 = 
i
;

437 
i
 = 0; i < 10; i++)

439 ià((
pAscii
[
i
] < '0') || (pAscii[i] > '9'))

441 
lB™V®ue
 =†BitValue * 10;

443 
bL’
 = 
i
;

444 
lB™V®ue
 =†BitValue / 10;

445 ià(
lB™V®ue
 == 0)

446 
lB™V®ue
=1;

447 
i
 = 
bZ”oL’
; i < 
bL’
; i++)

449 
lResuÉ
 +ğ(
pAscii
[
i
] - '0'è* 
lB™V®ue
;

450 
lB™V®ue
 /= 10;

456 
lB™V®ue
=1;

459 
i
 = 0; i < 8; i++)

461 
bTemp
 = 
pAscii
[
i
 + 2];

462 if(
bTemp
!='0')

465 
bZ”oL’
 = 
i
;

466 ; 
i
 < 8; i++)

468 
bTemp
=
pAscii
[
i
+2];

469 ià(((
bTemp
 >= 'A') && (bTemp <= 'F')) ||

470 ((
bTemp
>='a')&&(bTemp<='f')) ||

471 ((
bTemp
>='0')&&(bTemp<='9')) )

473 
lB™V®ue
=lBitValue * 16;

480 
lB™V®ue
 =†BitValue / 16;

481 ià(
lB™V®ue
 == 0)

482 
lB™V®ue
 = 1;

483 
bL’
 = 
i
;

484 
i
 = 
bZ”oL’
; i < 
bL’
; i++)

486 
bTemp
 = 
pAscii
[
i
 + 2];

487 ià((
bTemp
 >= 'A') && (bTemp <= 'F'))

489 
bTemp
 -= 0x37;

491 ià((
bTemp
 >= 'a') && (bTemp <= 'f'))

493 
bTemp
 -= 0x57;

495 ià((
bTemp
 >= '0') && (bTemp <= '9'))

497 
bTemp
 -= '0';

499 
lResuÉ
 +ğ
bTemp
*
lB™V®ue
;

500 
lB™V®ue
 /= 16;

503  
lResuÉ
;

504 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\bsp\src\retarget.c

1 
	~"b¥.h
"

2 
	~"x´štf.h
"

3 
UART_HªdËTy³Def
 
CLI_UARTx_HªdËr
;

5 
Sem­hÜeHªdË_t
 
	gx´štfMu‹x
 = 
NULL
;

7 
	$myputc
(
ušt8_t
 
ch
)

9 (
CLI_USARTx_BASE
->
SR
&0X40)==0);

10 
CLI_USARTx_BASE
->
DR
 = 
ch
;

11 
	}
}

13 
	$»rg‘_š™
()

15 
x´štfMu‹x
 = 
	`xSem­hÜeC»©eMu‹x
();

17 if(
x´štfMu‹x
 =ğ
NULL
)

21 
	`xdev_out
(
myputc
);

22 
	}
}

24 
	$´štf_§ã
(*
fÜm©
, ...)

26 
buf_¡r
[200 + 1];

27 
va_li¡
 
v_¬gs
;

30 
	`va_¡¬t
(
v_¬gs
, 
fÜm©
);

31 ()
	`v¢´štf
((*)&
buf_¡r
[0],

32 (
size_t
 ) (
buf_¡r
),

33 (cÚ¡ *è
fÜm©
,

34 
v_¬gs
);

35 
	`va_’d
(
v_¬gs
);

37 
	`xSem­hÜeTake
(
x´štfMu‹x
, 
pÜtMAX_DELAY
);

38 
	`x´štf
("%s", 
buf_¡r
);

39 
	`xSem­hÜeGive
(
x´štfMu‹x
);

40 
	}
}

46 #ifdeà
__GNUC__


49 
	#PUTCHAR_PROTOTYPE
 
	`__io_putch¬
(
ch
)

	)

51 
	#PUTCHAR_PROTOTYPE
 
	`åutc
(
ch
, 
FILE
 *
f
)

	)

54 #´agm¨
impÜt
(
__u£_no_£miho¡šg_swi
)

56 
	s__FILE


58 
	mhªdË
;

60 
FILE
 
	g__¡dout
;

61 
FILE
 
	g__¡dš
;

62 
FILE
 
	g__¡d”r
;

63 #ifdeà
__GNUC__


64 
	$_wr™e
 (
fd
, *
±r
, 
Ën
)

66 
i
 = 0;

67 
ušt8_t
 
ch
;

68 *
±r
 && (
i
 < 
Ën
))

70 
	`myputc
(*
±r
);

71 
i
++;

72 
±r
++;

74  
i
;

75 
	}
}

82 
	$åutc
(
ch
, 
FILE
 *
f
)

89 
	`myputc
(
ch
);

91  
ch
;

92 
	}
}

94 
	$fg‘c
(
FILE
 *
f
)

96 
ch
;

97 
	`HAL_UART_Reûive
(&
CLI_UARTx_HªdËr
, (
ušt8_t
 *)&
ch
, 1, 1000);

98  
ch
;

99 
	}
}

101 
	$ã¼Ü
(
FILE
 *
f
)

103  
EOF
;

104 
	}
}

109 
	$_‰ywrch
(
ch
)

111 
‹mpch
 = 
ch
;

112 
	`HAL_UART_T¿nsm™
(&
CLI_UARTx_HªdËr
, (
ušt8_t
 *)&
‹mpch
, 1, 0xFFFF);

113 
	}
}

115 
	$_sys_ex™
(
x
)

117 
x
 = x;

118 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\device\inc\RFIDReader_mt626.h

8 #iâdeà
__RFIDREADER_MT626_H


9 
	#__RFIDREADER_MT626_H


	)

11 
	~"¡m32f4xx.h
"

14 
	#MT626_CMD_MAX
 10

15 
	#MT626_SENDBUFF_MAX
 100

16 
	#MT626_RECVBUFF_MAX
 100

17 

	)

19 
	#MT626_CMD_STX
 0x02

	)

20 
	#MT626_CMD_ETX
 0x03

	)

21 
	#MT626_CMD_TYPE
 0x34

	)

24 
	#MT626_FIND_CMD
 0

25 
	#MT626_READ_UID_CMD
 1

26 
	#MT626_AUTH_KEYA_CMD
 2

27 
	#MT626_AUTH_KEYB_CMD
 3

28 
	#MT626_READ_CMD
 4

29 
	#MT626_WRITE_CMD
 5

30 
	#MT626_CHANGE_KEY_CMD
 6

31 
	#MT626_INC_CMD
 7

32 
	#MT626_DEC_CMD
 8

33 
	#MT626_INIT_CMD
 9

34 

	)

36 
	#MT_STATE_Y
 0x59

37 
	#MT_STATE_N
 0x4E

38 
	#MT_STATE_AUTH_ERR
 0x33

39 
	#MT_STATE_SECTOR_ERR
 0x31

40 
	#MT_STATE_DATA_ERR
 0x34

41 

	)

45 
	mMT_SUCCEED
,

46 
	mMT_NOTAG
,

47 
	mMT_LOGIN_SUCCEED
,

48 
	mMT_LOGIN_FAIL
,

49 
	mMT_READ_FAIL
,

50 
	mMT_WRITE_FAIL
,

51 
	mMT_SET_KEY_FAIL
,

52 
	mMT_NOT_AUTH
,

53 
	mMT_CARD_HALTED
,

54 
	mMT_COM_FAIL
,

55 
	mMT_FAIL


56 } 
	tMT_RESULT
;

64 (*
	tpMT626_MAKE_PROC
è(*
	tpObj
, 
	tušt8_t
 
	tucS’dID
, ušt8_ˆ*
	tpO±iÚD©a
, 
	tušt32_t
 
	tuiO±iÚL’
, ušt32_ˆ*
	tpucS’dL’gth
);

65 (*
	tpMT626_ANALY_PROC
è(*
	tpObj
, 
	tušt8_t
 
	tucS’dID
, 
	tušt32_t
 
	tuiRecvL’
);

67 
	s_MT626CMD


69 
ušt8_t
 
ucP¬am
;

70 
ušt16_t
 
usL’ght
;

71 
ušt8_t
 
ucRecvdO±D©a
[16];

72 
ušt32_t
 
uiRecvdO±L’
;

74 
pMT626_MAKE_PROC
 
makeProc
;

75 
pMT626_ANALY_PROC
 
ª®yProc
;

77 } 
	tMT626CMD_t
;

79 
	s_MT626COM


81 
MT626CMD_t
 *
pMT626CMD
[
MT626_CMD_MAX
];

82 
ušt8_t
 *
pucS’dBufãr
;

83 
ušt8_t
 *
pucRecvBufãr
;

84 
	`MT_RESULT
 (*
£ndCommªd
)(*
pObj
, 
ušt8_t
 
ucS’dID
, 
ušt32_t
 
ucS’dL’ght
);

85 
	`MT_RESULT
 (*
»cvRe¥Ú£
)(*
pObj
, 
ušt8_t
 
ucS’dID
, 
ušt32_t
 *
pucRecvdL’
);

86 (*
d–‘eCOM
)(*
pObj
);

87 } 
	tMT626COM_t
;

89 
	`T¿nsToMT626
(*
pObj
, 
ušt8_t
 
ucS’dID
, ušt8_ˆ*
pucO±iÚD©a
, 
ušt32_t
 
uiO±iÚL’
);

90 
MT626COM_t
 *
	`MT626COMC»©e
();

	@D:\Documents\Projects\chargersdk\src\drivers\device\inc\buzzer.h

8 #iâdeà 
__BUZZER_H


9 
	#__BUZZER_H


	)

	@D:\Documents\Projects\chargersdk\src\drivers\device\inc\card_m1.h

8 #iâdeà 
__CARD_M1_H


9 
	#__CARD_M1_H


	)

11 
	s__C¬dInfo


13 
ušt8_t
 
	mucUID
[4];

14 
ušt8_t
 
	mucSN
[8];

15 
ušt8_t
 
	mucOwedOrd”


16 }
	tC¬dInfo_t
;

	@D:\Documents\Projects\chargersdk\src\drivers\device\inc\led.h

8 #iâdeà 
__LED_H


9 
	#__LED_H


	)

	@D:\Documents\Projects\chargersdk\src\drivers\device\src\RFIDReader_mt626.c

8 
	~<¡dlib.h
>

9 
	~<¡ršg.h
>

10 
	~"RFIDR—d”_mt626.h
"

11 
	~"b¥_u¬t.h
"

14 
UART_HªdËTy³Def
 
RFID_UARTx_HªdËr
;

15 
Queue
 *
pRfidRecvQue
;

16 
HAL_StusTy³Def
 
HAL_UART_T¿nsm™
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 *
pD©a
, 
ušt16_t
 
Size
, 
ušt32_t
 
Timeout
);

17 
vTaskD–ay
ĞcÚ¡ 
TickTy³_t
 
xTicksToD–ay
 );

25 
	$MT626D–ayMS
(
ušt32_t
 
ms
)

27 
	`vTaskD–ay
(
ms
);

28 
	}
}

37 
ušt8_t
 
	$v”ifBCC
(
ušt8_t
 *
d©a
, 
ušt32_t
 
Ën
)

39 
ušt8_t
 
out
 = 0;

40 
ušt32_t
 
i
;

41 
i
 = 0; i < 
Ën
; i++)

43 
out
 ^ğ
d©a
[
i
];

45  
out
;

46 
	}
}

56 
MT_RESULT
 
	$£ndCommªd
(*
pObj
, 
ušt8_t
 
ucS’dID
, 
ušt32_t
 
ucS’dL’gth
)

58 cÚ¡ 
ušt32_t
 
ucTimeOutMS
 = 1000, 
uiTryTimes
 = 3;

59 
ušt32_t
 
ucFaedCouÁs
;

60 
MT626COM_t
 *
pMT626COMObj
;

61 
ušt8_t
 *
pucS’dBufãr
;

62 
HAL_StusTy³Def
 
h®_»s
;

64 
ucFaedCouÁs
 = 0;

65 
pMT626COMObj
 = (
MT626COM_t
 *)
pObj
;

66 
pucS’dBufãr
 = 
pMT626COMObj
 ->pucSendBuffer;

70 
h®_»s
 = 
	`HAL_UART_T¿nsm™
(&
RFID_UARTx_HªdËr
, 
pucS’dBufãr
, 
ucS’dL’gth
, 0xFFFF);

71 if(
h®_»s
 !ğ
HAL_OK
)

73 
ucFaedCouÁs
++;

74 
	`MT626D–ayMS
(
ucTimeOutMS
);

77 
h®_»s
 !ğ
HAL_OK
 && 
ucFaedCouÁs
 < 
uiTryTimes
);

78 if(
h®_»s
 !ğ
HAL_OK
 || 
ucFaedCouÁs
 =ğ
uiTryTimes
)

80  
MT_COM_FAIL
;

84  
MT_SUCCEED
;

87 
	}
}

96 
MT_RESULT
 
	$»cvR—dEx
(*
pObj
, 
ušt32_t
 *
puiRecvdL’
)

98 
ušt8_t
 
ch
;

99 
ušt32_t
 
i
;

100 
MT626COM_t
 *
pMT626COM
;

102 
pMT626COM
 = (
MT626COM_t
 *)
pObj
;

103 
ch
 = 0;

104 
i
 = 0;

106 
	`»adRecvQue
(
pRfidRecvQue
, &
ch
, 1) == 0)

108 
pMT626COM
->
pucRecvBufãr
[
i
] = 
ch
;

109 
i
++;

111 if(
i
 > 0)

113 *
puiRecvdL’
 = 
i
;

114  
MT_SUCCEED
;

118  
MT_FAIL
;

121 
	}
}

131 
MT_RESULT
 
	$»cvRe¥Ú£
(*
pObj
, 
ušt8_t
 
ucS’dID
, 
ušt32_t
 *
puiRecvdL’
)

133 
ušt8_t
 *
pucRecvBufãr
;

134 
ušt8_t
 
ucRecvdBCC
, 
ucC®cBCC
;

135 
MT_RESULT
 
»s
;

137 
ucRecvdBCC
 = 0;

139 
pucRecvBufãr
 = ((
MT626COM_t
 *)
pObj
)->pucRecvBuffer;

141 
	`»cvR—dEx
(
pObj
, 
puiRecvdL’
);

142 if(*
puiRecvdL’
 == 0)

144  
MT_COM_FAIL
;

147 
ucS’dID
)

149 
MT626_FIND_CMD
:

150 if(*
puiRecvdL’
 == 8)

152 
»s
 = 
MT_SUCCEED
;

156 
»s
 = 
MT_COM_FAIL
;

159 
MT626_READ_UID_CMD
:

160 if(*
puiRecvdL’
 == 12)

162 
»s
 = 
MT_SUCCEED
;

166 
»s
 = 
MT_COM_FAIL
;

169 
MT626_AUTH_KEYA_CMD
:

170 
MT626_AUTH_KEYB_CMD
:

171 
MT626_CHANGE_KEY_CMD
:

172 if(*
puiRecvdL’
 == 9)

174 
»s
 = 
MT_SUCCEED
;

178 
»s
 = 
MT_COM_FAIL
;

181 
MT626_READ_CMD
:

182 
MT626_WRITE_CMD
:

183 if(*
puiRecvdL’
 == 26)

185 
»s
 = 
MT_SUCCEED
;

187 if(*
puiRecvdL’
 == 10)

189 
»s
 = 
MT_SUCCEED
;

193 
»s
 = 
MT_COM_FAIL
;

197 
MT626_INC_CMD
:

198 
MT626_DEC_CMD
:

199 
MT626_INIT_CMD
:

200 if(*
puiRecvdL’
 == 10)

202 
»s
 = 
MT_SUCCEED
;

206 
»s
 = 
MT_COM_FAIL
;

210 if(
»s
 =ğ
MT_SUCCEED
)

212 
ucRecvdBCC
 = 
pucRecvBufãr
[*
puiRecvdL’
 - 1];

213 
ucC®cBCC
 = 
	`v”ifBCC
(
pucRecvBufãr
, *
puiRecvdL’
 - 1);

214 if(
ucRecvdBCC
 =ğ
ucC®cBCC
)

216  
MT_SUCCEED
;

220  
MT_COM_FAIL
;

225  
MT_COM_FAIL
;

227 
	}
}

239 
	$makeStdCmd
(*
pObj
, 
ušt8_t
 
ucS’dID
, ušt8_ˆ*
pucO±iÚD©a
, 
ušt32_t
 
uiO±iÚL’
, ušt32_ˆ*
pucS’dL’gth
)

241 
ušt8_t
 *
pucS’dBufãr
;

242 
ušt8_t
 
ucOff£t
, 
bcc
;

243 
MT626CMD_t
 *
pMT626CMDObj
;

244 
ušt8_t
 
i
;

246 
pMT626CMDObj
 = ((
MT626COM_t
 *)
pObj
)->
pMT626CMD
[
ucS’dID
];

247 
pucS’dBufãr
 = ((
MT626COM_t
 *)
pObj
)->pucSendBuffer;

248 
ucOff£t
 = 0;

249 
pucS’dBufãr
[
ucOff£t
++] = 
MT626_CMD_STX
;

250 
pucS’dBufãr
[
ucOff£t
++] = (
ušt8_t
)(
pMT626CMDObj
 -> 
usL’ght
 >> 8);

251 
pucS’dBufãr
[
ucOff£t
++] = (
ušt8_t
)(
pMT626CMDObj
 -> 
usL’ght
);

252 
pucS’dBufãr
[
ucOff£t
++] = 
MT626_CMD_TYPE
;

253 
pucS’dBufãr
[
ucOff£t
++] = 
pMT626CMDObj
 ->
ucP¬am
;

254 if(
uiO±iÚL’
 > 0 && 
pucO±iÚD©a
 !ğ
NULL
)

256 
i
 = 0; i < 
uiO±iÚL’
; i++)

258 
pucS’dBufãr
[
ucOff£t
++] = 
pucO±iÚD©a
[
i
];

261 
pucS’dBufãr
[
ucOff£t
++] = 
MT626_CMD_ETX
;

262 
bcc
 = 
	`v”ifBCC
(
pucS’dBufãr
, 
ucOff£t
);

263 
pucS’dBufãr
[
ucOff£t
++] = 
bcc
;

265 *
pucS’dL’gth
 = 
ucOff£t
;

268 
	}
}

278 
	$ª®yStdRes
(*
pObj
, 
ušt8_t
 
ucS’dID
, 
ušt32_t
 
uiRecvL’
)

280 
ušt8_t
 *
pucRecvdCMD
;

281 
ušt8_t
 
ucS‹
;

283 
pucRecvdCMD
 = ((
MT626COM_t
 *)
pObj
)->
pucRecvBufãr
;

284 
ucS‹
 = 
MT_STATE_N
;

286 
ucS’dID
)

288 
MT626_FIND_CMD
:

289 
ucS‹
 = 
pucRecvdCMD
[5];

292 
MT626_AUTH_KEYA_CMD
:

293 
MT626_AUTH_KEYB_CMD
:

294 
MT626_CHANGE_KEY_CMD
:

295 
ucS‹
 = 
pucRecvdCMD
[6];

298 
MT626_INC_CMD
:

299 
MT626_DEC_CMD
:

300 
MT626_INIT_CMD
:

301 
ucS‹
 = 
pucRecvdCMD
[7];

307  
ucS‹
;

308 
	}
}

318 
	$ª®yRWRes
(*
pObj
, 
ušt8_t
 
ucS’dID
, 
ušt32_t
 
uiRecvL’
)

320 
MT626COM_t
 *
pMT626COMObj
;

321 
MT626CMD_t
 *
pMT626CMDObj
;

322 
ušt8_t
 *
pucRecvdCMD
;

323 
ušt8_t
 
ucS‹
;

324 
ušt32_t
 
i
;

326 
pMT626COMObj
 = (
MT626COM_t
 *)
pObj
;

327 
pMT626CMDObj
 = 
pMT626COMObj
->
pMT626CMD
[
ucS’dID
];

328 
pucRecvdCMD
 = 
pMT626COMObj
->
pucRecvBufãr
;

330 
ucS’dID
)

332 
MT626_READ_UID_CMD
:

333 
ucS‹
 = 
pucRecvdCMD
[5];

334 
pMT626CMDObj
->
uiRecvdO±L’
 = 4;

336 
MT626_READ_CMD
:

337 
MT626_WRITE_CMD
:

338 
ucS‹
 = 
pucRecvdCMD
[7];

339 if(
ucS‹
 =ğ
MT_STATE_Y
)

341 
pMT626CMDObj
->
uiRecvdO±L’
 = 16;

345  
ucS‹
;

349  
ucS‹
;

351 
i
 = 0; i < 
pMT626CMDObj
->
uiRecvdO±L’
; i++)

353 
pMT626CMDObj
 ->
ucRecvdO±D©a
[
i
] = 
pucRecvdCMD
[(
uiRecvL’
 - 2 -…MT626CMDObj->
uiRecvdO±L’
) + i];

356  
ucS‹
;

357 
	}
}

368 
	$T¿nsToMT626
(*
pObj
, 
ušt8_t
 
ucS’dID
, ušt8_ˆ*
pucO±iÚD©a
, 
ušt32_t
 
uiO±iÚL’
)

370 cÚ¡ 
ušt32_t
 
ucTimeOutMS
 = 5000, 
uiTryTimes
 = 3;

371 
ušt32_t
 
ucFaedCouÁs
;

372 
MT626COM_t
 *
pMT626COMObj
;

373 
MT626CMD_t
 *
pMT626CMDObj
;

374 
ušt32_t
 
ucS’dL’gth
, 
ucRcvdL’gth
;

375 
MT_RESULT
 
»s
 ;

377 
ucFaedCouÁs
 = 0;

379 
pMT626COMObj
 = (
MT626COM_t
 *)
pObj
;

380 
pMT626CMDObj
 = 
pMT626COMObj
->
pMT626CMD
[
ucS’dID
];

382 
pMT626CMDObj
 ->
	`makeProc
(
pMT626COMObj
, 
ucS’dID
, 
pucO±iÚD©a
, 
uiO±iÚL’
, &
ucS’dL’gth
);

385 
»s
 = 
pMT626COMObj
 ->
	`£ndCommªd
ÕMT626COMObj, 
ucS’dID
, 
ucS’dL’gth
);

386 if(
»s
 !ğ
MT_SUCCEED
)

388  
MT_COM_FAIL
;

390 
	`MT626D–ayMS
(100);

391 
»s
 = 
pMT626COMObj
 ->
	`»cvRe¥Ú£
ÕMT626COMObj, 
ucS’dID
, &
ucRcvdL’gth
);

392 if(
»s
 !ğ
MT_SUCCEED
)

394 
ucFaedCouÁs
++;

395 
	`MT626D–ayMS
(
ucTimeOutMS
);

398 
»s
 !ğ
MT_SUCCEED
 && 
ucFaedCouÁs
 < 
uiTryTimes
);

399 if(
»s
 !ğ
MT_SUCCEED
 || 
ucFaedCouÁs
 =ğ
uiTryTimes
)

401  
MT_COM_FAIL
;

404  
pMT626CMDObj
->
	`ª®yProc
(
pMT626COMObj
, 
ucS’dID
, 
ucRcvdL’gth
);

405 
	}
}

416 
MT626CMD_t
 *
	$MT626CMDC»©e
(
ušt8_t
 
ucP¬am
, 
ušt16_t
 
usL’ght
, 
pMT626_MAKE_PROC
 
makeProc
, 
pMT626_ANALY_PROC
 
ª®yProc
)

418 
MT626CMD_t
 *
pMT626CMD
 = (MT626CMD_ˆ*)
	`m®loc
((MT626CMD_t));

419 if(
pMT626CMD
 =ğ
NULL
)

421  
NULL
;

423 
pMT626CMD
->
ucP¬am
 = ucParam;

424 
pMT626CMD
->
usL’ght
 = usLenght;

425 
pMT626CMD
->
makeProc
 = makeProc;

426 
pMT626CMD
->
ª®yProc
 =‡nalyProc;

428  
pMT626CMD
;

429 
	}
}

437 
	$d–‘eCOM
(*
pObj
)

439 
i
;

440 
MT626COM_t
 *
pMT626COMObj
;

442 
pMT626COMObj
 = (
MT626COM_t
 *)
pObj
;

443 
i
 = 0; i < 
MT626_CMD_MAX
; i++)

445 if(
pMT626COMObj
->
pMT626CMD
[
i
] !ğ
NULL
)

447 
	`ä“
(
pMT626COMObj
->
pMT626CMD
[
i
]);

450 
	`ä“
(
pMT626COMObj
 ->
pucRecvBufãr
);

451 
	`ä“
(
pMT626COMObj
 ->
pucS’dBufãr
);

452 
	`ä“
(
pMT626COMObj
);

453 
	}
}

462 
MT626COM_t
 *
	$MT626COMC»©e
()

464 
i
;

465 
MT626COM_t
 *
pMT626
 = (MT626COM_ˆ*)
	`m®loc
((MT626COM_t));

466 if(
pMT626
 =ğ
NULL
)

468  
NULL
;

471 
i
 = 0; i < 
MT626_CMD_MAX
; i++)

473 
pMT626
->
pMT626CMD
[
i
] = 
NULL
;

475 
pMT626
->
pMT626CMD
[
MT626_FIND_CMD
] = 
	`MT626CMDC»©e
(0x30, 0x02, 
makeStdCmd
, 
ª®yStdRes
);

476 
pMT626
->
pMT626CMD
[
MT626_READ_UID_CMD
] = 
	`MT626CMDC»©e
(0x31, 0x02, 
makeStdCmd
, 
ª®yRWRes
);

477 
pMT626
->
pMT626CMD
[
MT626_AUTH_KEYA_CMD
] = 
	`MT626CMDC»©e
(0x32, 0x09, 
makeStdCmd
, 
ª®yStdRes
);

478 
pMT626
->
pMT626CMD
[
MT626_AUTH_KEYB_CMD
] = 
	`MT626CMDC»©e
(0x39, 0x09, 
makeStdCmd
, 
ª®yStdRes
);

479 
pMT626
->
pMT626CMD
[
MT626_READ_CMD
] = 
	`MT626CMDC»©e
(0x33, 0x04, 
makeStdCmd
, 
ª®yRWRes
);

480 
pMT626
->
pMT626CMD
[
MT626_WRITE_CMD
] = 
	`MT626CMDC»©e
(0x34, 0x14, 
makeStdCmd
, 
ª®yRWRes
);

481 
pMT626
->
pMT626CMD
[
MT626_CHANGE_KEY_CMD
] = 
	`MT626CMDC»©e
(0x35, 0x09, 
makeStdCmd
, 
ª®yStdRes
);

482 
pMT626
->
pMT626CMD
[
MT626_INC_CMD
] = 
	`MT626CMDC»©e
(0x37, 0x08, 
makeStdCmd
, 
ª®yStdRes
);

483 
pMT626
->
pMT626CMD
[
MT626_DEC_CMD
] = 
	`MT626CMDC»©e
(0x38, 0x08, 
makeStdCmd
, 
ª®yStdRes
);

484 
pMT626
->
pMT626CMD
[
MT626_INIT_CMD
] = 
	`MT626CMDC»©e
(0x36, 0x08, 
makeStdCmd
, 
ª®yStdRes
);

486 
pMT626
 ->
»cvRe¥Ú£
 =„ecvResponse;

487 
pMT626
 ->
£ndCommªd
 = sendCommand;

488 
pMT626
 ->
d–‘eCOM
 = deleteCOM;

490 
pMT626
->
pucS’dBufãr
 = (
ušt8_t
 *)
	`m®loc
(
MT626_SENDBUFF_MAX
 * (uint8_t));

491 
	`mem£t
(
pMT626
->
pucS’dBufãr
, 0, 
MT626_SENDBUFF_MAX
);

492 
pMT626
->
pucRecvBufãr
 = (
ušt8_t
 *)
	`m®loc
(
MT626_RECVBUFF_MAX
 * (uint8_t));

493 
	`mem£t
(
pMT626
->
pucRecvBufãr
, 0, 
MT626_RECVBUFF_MAX
);

495  
pMT626
;

496 
	}
}

498 
	$‹¡mt626
()

500 
MT626COM_t
 *
pmt626com
;

501 
¡©e
, 
i
;

502 
ušt8_t
 *
´ecvdD©a
;

503 
ušt8_t
 
ucS’dD©a
[16] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,

506 
ušt32_t
 
uiRecvdO±L’
;

508 
pmt626com
 = 
	`MT626COMC»©e
();

509 
´ecvdD©a
 = 
NULL
;

510 
uiRecvdO±L’
 = 0;

515 
¡©e
 = 
	`T¿nsToMT626
(
pmt626com
, 
MT626_FIND_CMD
, 
NULL
, 0);

516 if(
¡©e
 =ğ
MT_STATE_Y
)

519 
	`x´štf
("Find card.\n ");

521 if(
¡©e
 =ğ
MT_STATE_N
)

523 
	`x´štf
("No card.\n");

528 
¡©e
 = 
	`T¿nsToMT626
(
pmt626com
, 
MT626_READ_UID_CMD
, 
NULL
, 0);

529 if(
¡©e
 =ğ
MT_STATE_Y
)

532 
uiRecvdO±L’
 = 
pmt626com
->
pMT626CMD
[
MT626_READ_UID_CMD
]->uiRecvdOptLen;

533 
´ecvdD©a
 = (
ušt8_t
 *)
	`m®loc
(
uiRecvdO±L’
 * (uint8_t));

534 
i
 = 0; i < 
uiRecvdO±L’
; i++)

536 
´ecvdD©a
[
i
] = 
pmt626com
->
pMT626CMD
[
MT626_READ_UID_CMD
]->
ucRecvdO±D©a
[i];

539 
	`x´štf
("UID = ");

540 
i
 = 0; i < 
uiRecvdO±L’
; i++)

542 
	`x´štf
("%x",
´ecvdD©a
[
i
]);

544 
	`x´štf
("\n");

546 
	`ä“
(
´ecvdD©a
);

548 if(
¡©e
 =ğ
MT_STATE_N
)

554 
¡©e
 = 
	`T¿nsToMT626
(
pmt626com
, 
MT626_WRITE_CMD
, 
ucS’dD©a
, (ucSendData));

555 if(
¡©e
 =ğ
MT_STATE_Y
)

558 
uiRecvdO±L’
 = 
pmt626com
->
pMT626CMD
[
MT626_WRITE_CMD
]->uiRecvdOptLen;

559 
´ecvdD©a
 = (
ušt8_t
 *)
	`m®loc
(
uiRecvdO±L’
 * (uint8_t));

560 
i
 = 0; i < 
uiRecvdO±L’
; i++)

562 
´ecvdD©a
[
i
] = 
pmt626com
->
pMT626CMD
[
MT626_WRITE_CMD
]->
ucRecvdO±D©a
[i];

566 
	`ä“
(
´ecvdD©a
);

568 if(
¡©e
 =ğ
MT_STATE_N
)

573 
	`vTaskD–ay
(500);

575 
pmt626com
->
	`d–‘eCOM
(pmt626com);

576 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\device\src\buzzer.c

8 
	~"b¥.h
"

9 
	~"buzz”.h
"

	@D:\Documents\Projects\chargersdk\src\drivers\device\src\card_m1.c

8 
	~"šşudes.h
"

9 
ušt64_t
 
	gm1_KeyTem¶©e
[16][2]= {

	@D:\Documents\Projects\chargersdk\src\drivers\device\src\led.c

8 
	~"b¥.h
"

9 
	~"Ëd.h
"

12 
	$LedOn
()

15 
	}
}

17 
	$LedOff
()

20 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\CMSIS\Device\ST\STM32F4xx\Source\Templates\system_stm32f4xx.c

67 
	~"¡m32f4xx.h
"

69 #ià!
defšed
 (
HSE_VALUE
)

70 
	#HSE_VALUE
 ((
ušt32_t
)25000000è

	)

73 #ià!
defšed
 (
HSI_VALUE
)

74 
	#HSI_VALUE
 ((
ušt32_t
)16000000è

	)

95 #ià
defšed
(
STM32F405xx
è|| defšed(
STM32F415xx
è|| defšed(
STM32F407xx
è|| defšed(
STM32F417xx
)\

96 || 
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)\

97 || 
defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
è|| defšed(
STM32F412Zx
è|| 
	$defšed
(
STM32F412Vx
)

100 
STM32F412Zx
 || 
STM32F412Vx
 */

102 #ià
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)\

103 || 
	`defšed
(
STM32F446xx
è|| defšed(
STM32F469xx
è|| 
	$defšed
(
STM32F479xx
)

106 
STM32F479xx
 */

111 
	#VECT_TAB_OFFSET
 0x00

	)

138 
ušt32_t
 
Sy¡emCÜeClock
 = 180000000;

139 cÚ¡ 
ušt8_t
 
AHBP»scTabË
[16] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 6, 7, 8, 9
	}
};

149 #ià
defšed
 (
DATA_IN_ExtSRAM
è|| defšed (
DATA_IN_ExtSDRAM
)

150 
Sy¡emIn™_ExtMemC
();

168 
	$Sy¡emIn™
()

171 #ià(
__FPU_PRESENT
 =ğ1è&& (
__FPU_USED
 == 1)

172 
SCB
->
CPACR
 |= ((3UL << 10*2)|(3UL << 11*2));

176 
RCC
->
CR
 |ğ(
ušt32_t
)0x00000001;

179 
RCC
->
CFGR
 = 0x00000000;

182 
RCC
->
CR
 &ğ(
ušt32_t
)0xFEF6FFFF;

185 
RCC
->
PLLCFGR
 = 0x24003010;

188 
RCC
->
CR
 &ğ(
ušt32_t
)0xFFFBFFFF;

191 
RCC
->
CIR
 = 0x00000000;

193 #ià
	`defšed
 (
DATA_IN_ExtSRAM
è|| defšed (
DATA_IN_ExtSDRAM
)

194 
	`Sy¡emIn™_ExtMemC
();

198 #ifdeà
VECT_TAB_SRAM


199 
SCB
->
VTOR
 = 
SRAM_BASE
 | 
VECT_TAB_OFFSET
;

201 
SCB
->
VTOR
 = 
FLASH_BASE
 | 
VECT_TAB_OFFSET
;

203 
	}
}

241 
	$Sy¡emCÜeClockUpd©e
()

243 
ušt32_t
 
tmp
 = 0, 
¶lvco
 = 0, 
¶Í
 = 2, 
¶lsourû
 = 0, 
¶lm
 = 2;

246 
tmp
 = 
RCC
->
CFGR
 & 
RCC_CFGR_SWS
;

248 
tmp
)

251 
Sy¡emCÜeClock
 = 
HSI_VALUE
;

254 
Sy¡emCÜeClock
 = 
HSE_VALUE
;

261 
¶lsourû
 = (
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
) >> 22;

262 
¶lm
 = 
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
;

264 ià(
¶lsourû
 != 0)

267 
¶lvco
 = (
HSE_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
) >> 6);

272 
¶lvco
 = (
HSI_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
) >> 6);

275 
¶Í
 = (((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLP
) >>16) + 1 ) *2;

276 
Sy¡emCÜeClock
 = 
¶lvco
/
¶Í
;

279 
Sy¡emCÜeClock
 = 
HSI_VALUE
;

284 
tmp
 = 
AHBP»scTabË
[((
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
) >> 4)];

286 
Sy¡emCÜeClock
 >>ğ
tmp
;

287 
	}
}

289 #ià
defšed
 (
DATA_IN_ExtSRAM
è&& defšed (
DATA_IN_ExtSDRAM
)

290 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
) ||\

291 
defšed
(
STM32F469xx
è|| 
	$defšed
(
STM32F479xx
)

300 
	$Sy¡emIn™_ExtMemC
()

302 
__IO
 
ušt32_t
 
tmp
 = 0x00;

304 
ušt32_t
 
tm´eg
 = 0, 
timeout
 = 0xFFFF;

305 
__IO
 
ušt32_t
 
šdex
;

308 
RCC
->
AHB1ENR
 |= 0x000001F8;

311 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB1ENR
, 
RCC_AHB1ENR_GPIOCEN
);

314 
GPIOD
->
AFR
[0] = 0x00CCC0CC;

315 
GPIOD
->
AFR
[1] = 0xCCCCCCCC;

317 
GPIOD
->
MODER
 = 0xAAAA0A8A;

319 
GPIOD
->
OSPEEDR
 = 0xFFFF0FCF;

321 
GPIOD
->
OTYPER
 = 0x00000000;

323 
GPIOD
->
PUPDR
 = 0x00000000;

326 
GPIOE
->
AFR
[0] = 0xC00CC0CC;

327 
GPIOE
->
AFR
[1] = 0xCCCCCCCC;

329 
GPIOE
->
MODER
 = 0xAAAA828A;

331 
GPIOE
->
OSPEEDR
 = 0xFFFFC3CF;

333 
GPIOE
->
OTYPER
 = 0x00000000;

335 
GPIOE
->
PUPDR
 = 0x00000000;

338 
GPIOF
->
AFR
[0] = 0xCCCCCCCC;

339 
GPIOF
->
AFR
[1] = 0xCCCCCCCC;

341 
GPIOF
->
MODER
 = 0xAA800AAA;

343 
GPIOF
->
OSPEEDR
 = 0xAA800AAA;

345 
GPIOF
->
OTYPER
 = 0x00000000;

347 
GPIOF
->
PUPDR
 = 0x00000000;

350 
GPIOG
->
AFR
[0] = 0xCCCCCCCC;

351 
GPIOG
->
AFR
[1] = 0xCCCCCCCC;

353 
GPIOG
->
MODER
 = 0xAAAAAAAA;

355 
GPIOG
->
OSPEEDR
 = 0xAAAAAAAA;

357 
GPIOG
->
OTYPER
 = 0x00000000;

359 
GPIOG
->
PUPDR
 = 0x00000000;

362 
GPIOH
->
AFR
[0] = 0x00C0CC00;

363 
GPIOH
->
AFR
[1] = 0xCCCCCCCC;

365 
GPIOH
->
MODER
 = 0xAAAA08A0;

367 
GPIOH
->
OSPEEDR
 = 0xAAAA08A0;

369 
GPIOH
->
OTYPER
 = 0x00000000;

371 
GPIOH
->
PUPDR
 = 0x00000000;

374 
GPIOI
->
AFR
[0] = 0xCCCCCCCC;

375 
GPIOI
->
AFR
[1] = 0x00000CC0;

377 
GPIOI
->
MODER
 = 0x0028AAAA;

379 
GPIOI
->
OSPEEDR
 = 0x0028AAAA;

381 
GPIOI
->
OTYPER
 = 0x00000000;

383 
GPIOI
->
PUPDR
 = 0x00000000;

387 
RCC
->
AHB3ENR
 |= 0x00000001;

389 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB3ENR
, 
RCC_AHB3ENR_FMCEN
);

391 
FMC_Bªk5_6
->
SDCR
[0] = 0x000019E4;

392 
FMC_Bªk5_6
->
SDTR
[0] = 0x01115351;

396 
FMC_Bªk5_6
->
SDCMR
 = 0x00000011;

397 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

398 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

400 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

404 
šdex
 = 0; index<1000; index++);

407 
FMC_Bªk5_6
->
SDCMR
 = 0x00000012;

408 
timeout
 = 0xFFFF;

409 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

411 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

415 
FMC_Bªk5_6
->
SDCMR
 = 0x00000073;

416 
timeout
 = 0xFFFF;

417 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

419 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

423 
FMC_Bªk5_6
->
SDCMR
 = 0x00046014;

424 
timeout
 = 0xFFFF;

425 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

427 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

431 
tm´eg
 = 
FMC_Bªk5_6
->
SDRTR
;

432 
FMC_Bªk5_6
->
SDRTR
 = (
tm´eg
 | (0x0000027C<<1));

435 
tm´eg
 = 
FMC_Bªk5_6
->
SDCR
[0];

436 
FMC_Bªk5_6
->
SDCR
[0] = (
tm´eg
 & 0xFFFFFDFF);

438 #ià
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)

440 
FMC_Bªk1
->
BTCR
[2] = 0x00001011;

441 
FMC_Bªk1
->
BTCR
[3] = 0x00000201;

442 
FMC_Bªk1E
->
BWTR
[2] = 0x0fffffff;

444 #ià
	`defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
)

446 
FMC_Bªk1
->
BTCR
[2] = 0x00001091;

447 
FMC_Bªk1
->
BTCR
[3] = 0x00110212;

448 
FMC_Bªk1E
->
BWTR
[2] = 0x0fffffff;

451 ()(
tmp
);

452 
	}
}

454 #–ià
defšed
 (
DATA_IN_ExtSRAM
è|| defšed (
DATA_IN_ExtSDRAM
)

463 
	$Sy¡emIn™_ExtMemC
()

465 
__IO
 
ušt32_t
 
tmp
 = 0x00;

466 #ià
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)\

467 || 
	`defšed
(
STM32F446xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
)

468 #ià
	`defšed
 (
DATA_IN_ExtSDRAM
)

469 
ušt32_t
 
tm´eg
 = 0, 
timeout
 = 0xFFFF;

470 
__IO
 
ušt32_t
 
šdex
;

472 #ià
	`defšed
(
STM32F446xx
)

475 
RCC
->
AHB1ENR
 |= 0x0000007D;

479 
RCC
->
AHB1ENR
 |= 0x000001F8;

482 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB1ENR
, 
RCC_AHB1ENR_GPIOCEN
);

484 #ià
	`defšed
(
STM32F446xx
)

486 
GPIOA
->
AFR
[0] |= 0xC0000000;

487 
GPIOA
->
AFR
[1] |= 0x00000000;

489 
GPIOA
->
MODER
 |= 0x00008000;

491 
GPIOA
->
OSPEEDR
 |= 0x00008000;

493 
GPIOA
->
OTYPER
 |= 0x00000000;

495 
GPIOA
->
PUPDR
 |= 0x00000000;

498 
GPIOC
->
AFR
[0] |= 0x00CC0000;

499 
GPIOC
->
AFR
[1] |= 0x00000000;

501 
GPIOC
->
MODER
 |= 0x00000A00;

503 
GPIOC
->
OSPEEDR
 |= 0x00000A00;

505 
GPIOC
->
OTYPER
 |= 0x00000000;

507 
GPIOC
->
PUPDR
 |= 0x00000000;

511 
GPIOD
->
AFR
[0] = 0x000000CC;

512 
GPIOD
->
AFR
[1] = 0xCC000CCC;

514 
GPIOD
->
MODER
 = 0xA02A000A;

516 
GPIOD
->
OSPEEDR
 = 0xA02A000A;

518 
GPIOD
->
OTYPER
 = 0x00000000;

520 
GPIOD
->
PUPDR
 = 0x00000000;

523 
GPIOE
->
AFR
[0] = 0xC00000CC;

524 
GPIOE
->
AFR
[1] = 0xCCCCCCCC;

526 
GPIOE
->
MODER
 = 0xAAAA800A;

528 
GPIOE
->
OSPEEDR
 = 0xAAAA800A;

530 
GPIOE
->
OTYPER
 = 0x00000000;

532 
GPIOE
->
PUPDR
 = 0x00000000;

535 
GPIOF
->
AFR
[0] = 0xCCCCCCCC;

536 
GPIOF
->
AFR
[1] = 0xCCCCCCCC;

538 
GPIOF
->
MODER
 = 0xAA800AAA;

540 
GPIOF
->
OSPEEDR
 = 0xAA800AAA;

542 
GPIOF
->
OTYPER
 = 0x00000000;

544 
GPIOF
->
PUPDR
 = 0x00000000;

547 
GPIOG
->
AFR
[0] = 0xCCCCCCCC;

548 
GPIOG
->
AFR
[1] = 0xCCCCCCCC;

550 
GPIOG
->
MODER
 = 0xAAAAAAAA;

552 
GPIOG
->
OSPEEDR
 = 0xAAAAAAAA;

554 
GPIOG
->
OTYPER
 = 0x00000000;

556 
GPIOG
->
PUPDR
 = 0x00000000;

558 #ià
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)\

559 || 
	`defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
)

561 
GPIOH
->
AFR
[0] = 0x00C0CC00;

562 
GPIOH
->
AFR
[1] = 0xCCCCCCCC;

564 
GPIOH
->
MODER
 = 0xAAAA08A0;

566 
GPIOH
->
OSPEEDR
 = 0xAAAA08A0;

568 
GPIOH
->
OTYPER
 = 0x00000000;

570 
GPIOH
->
PUPDR
 = 0x00000000;

573 
GPIOI
->
AFR
[0] = 0xCCCCCCCC;

574 
GPIOI
->
AFR
[1] = 0x00000CC0;

576 
GPIOI
->
MODER
 = 0x0028AAAA;

578 
GPIOI
->
OSPEEDR
 = 0x0028AAAA;

580 
GPIOI
->
OTYPER
 = 0x00000000;

582 
GPIOI
->
PUPDR
 = 0x00000000;

587 
RCC
->
AHB3ENR
 |= 0x00000001;

589 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB3ENR
, 
RCC_AHB3ENR_FMCEN
);

592 #ià
	`defšed
(
STM32F446xx
)

593 
FMC_Bªk5_6
->
SDCR
[0] = 0x00001954;

595 
FMC_Bªk5_6
->
SDCR
[0] = 0x000019E4;

597 
FMC_Bªk5_6
->
SDTR
[0] = 0x01115351;

601 
FMC_Bªk5_6
->
SDCMR
 = 0x00000011;

602 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

603 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

605 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

609 
šdex
 = 0; index<1000; index++);

612 
FMC_Bªk5_6
->
SDCMR
 = 0x00000012;

613 
timeout
 = 0xFFFF;

614 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

616 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

620 #ià
	`defšed
(
STM32F446xx
)

621 
FMC_Bªk5_6
->
SDCMR
 = 0x000000F3;

623 
FMC_Bªk5_6
->
SDCMR
 = 0x00000073;

625 
timeout
 = 0xFFFF;

626 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

628 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

632 #ià
	`defšed
(
STM32F446xx
)

633 
FMC_Bªk5_6
->
SDCMR
 = 0x00044014;

635 
FMC_Bªk5_6
->
SDCMR
 = 0x00046014;

637 
timeout
 = 0xFFFF;

638 (
tm´eg
 !ğ0è&& (
timeout
-- > 0))

640 
tm´eg
 = 
FMC_Bªk5_6
->
SDSR
 & 0x00000020;

644 
tm´eg
 = 
FMC_Bªk5_6
->
SDRTR
;

645 #ià
	`defšed
(
STM32F446xx
)

646 
FMC_Bªk5_6
->
SDRTR
 = (
tm´eg
 | (0x0000050C<<1));

648 
FMC_Bªk5_6
->
SDRTR
 = (
tm´eg
 | (0x0000027C<<1));

652 
tm´eg
 = 
FMC_Bªk5_6
->
SDCR
[0];

653 
FMC_Bªk5_6
->
SDCR
[0] = (
tm´eg
 & 0xFFFFFDFF);

657 #ià
	`defšed
(
STM32F405xx
è|| defšed(
STM32F415xx
è|| defšed(
STM32F407xx
è|| defšed(
STM32F417xx
)\

658 || 
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)\

659 || 
	`defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
è|| defšed(
STM32F412Zx
è|| defšed(
STM32F412Vx
)

661 #ià
	`defšed
(
DATA_IN_ExtSRAM
)

664 
RCC
->
AHB1ENR
 |= 0x00000078;

666 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB1ENR
, 
RCC_AHB1ENR_GPIODEN
);

669 
GPIOD
->
AFR
[0] = 0x00CCC0CC;

670 
GPIOD
->
AFR
[1] = 0xCCCCCCCC;

672 
GPIOD
->
MODER
 = 0xAAAA0A8A;

674 
GPIOD
->
OSPEEDR
 = 0xFFFF0FCF;

676 
GPIOD
->
OTYPER
 = 0x00000000;

678 
GPIOD
->
PUPDR
 = 0x00000000;

681 
GPIOE
->
AFR
[0] = 0xC00CC0CC;

682 
GPIOE
->
AFR
[1] = 0xCCCCCCCC;

684 
GPIOE
->
MODER
 = 0xAAAA828A;

686 
GPIOE
->
OSPEEDR
 = 0xFFFFC3CF;

688 
GPIOE
->
OTYPER
 = 0x00000000;

690 
GPIOE
->
PUPDR
 = 0x00000000;

693 
GPIOF
->
AFR
[0] = 0x00CCCCCC;

694 
GPIOF
->
AFR
[1] = 0xCCCC0000;

696 
GPIOF
->
MODER
 = 0xAA000AAA;

698 
GPIOF
->
OSPEEDR
 = 0xFF000FFF;

700 
GPIOF
->
OTYPER
 = 0x00000000;

702 
GPIOF
->
PUPDR
 = 0x00000000;

705 
GPIOG
->
AFR
[0] = 0x00CCCCCC;

706 
GPIOG
->
AFR
[1] = 0x000000C0;

708 
GPIOG
->
MODER
 = 0x00085AAA;

710 
GPIOG
->
OSPEEDR
 = 0x000CAFFF;

712 
GPIOG
->
OTYPER
 = 0x00000000;

714 
GPIOG
->
PUPDR
 = 0x00000000;

718 
RCC
->
AHB3ENR
 |= 0x00000001;

720 #ià
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)

722 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB3ENR
, 
RCC_AHB3ENR_FMCEN
);

724 
FMC_Bªk1
->
BTCR
[2] = 0x00001011;

725 
FMC_Bªk1
->
BTCR
[3] = 0x00000201;

726 
FMC_Bªk1E
->
BWTR
[2] = 0x0fffffff;

728 #ià
	`defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
)

730 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB3ENR
, 
RCC_AHB3ENR_FMCEN
);

732 
FMC_Bªk1
->
BTCR
[2] = 0x00001091;

733 
FMC_Bªk1
->
BTCR
[3] = 0x00110212;

734 
FMC_Bªk1E
->
BWTR
[2] = 0x0fffffff;

736 #ià
	`defšed
(
STM32F405xx
è|| defšed(
STM32F415xx
è|| defšed(
STM32F407xx
)|| defšed(
STM32F417xx
)\

737 || 
	`defšed
(
STM32F412Zx
è|| defšed(
STM32F412Vx
)

739 
tmp
 = 
	`READ_BIT
(
RCC
->
AHB3ENR
, 
RCC_AHB3ENR_FSMCEN
);

741 
FSMC_Bªk1
->
BTCR
[2] = 0x00001011;

742 
FSMC_Bªk1
->
BTCR
[3] = 0x00000201;

743 
FSMC_Bªk1E
->
BWTR
[2] = 0x0FFFFFFF;

748 
STM32F429xx
 || 
STM32F439xx
 || 
STM32F469xx
 || 
STM32F479xx
 || 
STM32F412Zx
 || 
STM32F412Vx
 */

749 ()(
tmp
);

750 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Inc\stm32f4xx_hal_conf.h

41 #iâdeà
__STM32F4xx_HAL_CONF_H


42 
	#__STM32F4xx_HAL_CONF_H


	)

44 #ifdeà
__ılu¥lus


55 
	#HAL_MODULE_ENABLED


	)

63 
	#HAL_DMA_MODULE_ENABLED


	)

64 
	#HAL_DMA2D_MODULE_ENABLED


	)

66 
	#HAL_FLASH_MODULE_ENABLED


	)

67 
	#HAL_NAND_MODULE_ENABLED


	)

71 
	#HAL_SDRAM_MODULE_ENABLED


	)

73 
	#HAL_GPIO_MODULE_ENABLED


	)

77 
	#HAL_LTDC_MODULE_ENABLED


	)

79 
	#HAL_PWR_MODULE_ENABLED


	)

81 
	#HAL_RCC_MODULE_ENABLED


	)

83 
	#HAL_RTC_MODULE_ENABLED


	)

88 
	#HAL_UART_MODULE_ENABLED


	)

89 
	#HAL_USART_MODULE_ENABLED


	)

93 
	#HAL_CORTEX_MODULE_ENABLED


	)

107 #ià!
defšed
 (
HSE_VALUE
)

108 
	#HSE_VALUE
 ((
ušt32_t
)25000000Uè

	)

111 #ià!
defšed
 (
HSE_STARTUP_TIMEOUT
)

112 
	#HSE_STARTUP_TIMEOUT
 ((
ušt32_t
)100Uè

	)

120 #ià!
defšed
 (
HSI_VALUE
)

121 
	#HSI_VALUE
 ((
ušt32_t
)16000000Uè

	)

127 #ià!
defšed
 (
LSI_VALUE
)

128 
	#LSI_VALUE
 ((
ušt32_t
)32000Uè

	)

130 
The
 
»®
 
v®ue
 
may
 
v¬y
 
d•’dšg
 
Ú
 
the
 
v¬ŸtiÚs


131 
š
 
vŞge
 
ªd
 
‹m³¿tu»
.*/

135 #ià!
defšed
 (
LSE_VALUE
)

136 
	#LSE_VALUE
 ((
ušt32_t
)32768Uè

	)

139 #ià!
defšed
 (
LSE_STARTUP_TIMEOUT
)

140 
	#LSE_STARTUP_TIMEOUT
 ((
ušt32_t
)5000Uè

	)

148 #ià!
defšed
 (
EXTERNAL_CLOCK_VALUE
)

149 
	#EXTERNAL_CLOCK_VALUE
 ((
ušt32_t
)12288000Uè

	)

159 
	#VDD_VALUE
 ((
ušt32_t
)3300Uè

	)

160 
	#TICK_INT_PRIORITY
 ((
ušt32_t
)0x0FUè

	)

161 
	#USE_RTOS
 0U

	)

162 
	#PREFETCH_ENABLE
 1U

	)

163 
	#INSTRUCTION_CACHE_ENABLE
 1U

	)

164 
	#DATA_CACHE_ENABLE
 1U

	)

178 
	#MAC_ADDR0
 2U

	)

179 
	#MAC_ADDR1
 0U

	)

180 
	#MAC_ADDR2
 0U

	)

181 
	#MAC_ADDR3
 0U

	)

182 
	#MAC_ADDR4
 0U

	)

183 
	#MAC_ADDR5
 0U

	)

186 
	#ETH_RX_BUF_SIZE
 
ETH_MAX_PACKET_SIZE


	)

187 
	#ETH_TX_BUF_SIZE
 
ETH_MAX_PACKET_SIZE


	)

188 
	#ETH_RXBUFNB
 ((
ušt32_t
)4Uè

	)

189 
	#ETH_TXBUFNB
 ((
ušt32_t
)4Uè

	)

194 
	#DP83848_PHY_ADDRESS
 0x01U

	)

196 
	#PHY_RESET_DELAY
 ((
ušt32_t
)0x000000FFU)

	)

198 
	#PHY_CONFIG_DELAY
 ((
ušt32_t
)0x00000FFFU)

	)

200 
	#PHY_READ_TO
 ((
ušt32_t
)0x0000FFFFU)

	)

201 
	#PHY_WRITE_TO
 ((
ušt32_t
)0x0000FFFFU)

	)

205 
	#PHY_BCR
 ((
ušt16_t
)0x0000Uè

	)

206 
	#PHY_BSR
 ((
ušt16_t
)0x0001Uè

	)

208 
	#PHY_RESET
 ((
ušt16_t
)0x8000Uè

	)

209 
	#PHY_LOOPBACK
 ((
ušt16_t
)0x4000Uè

	)

210 
	#PHY_FULLDUPLEX_100M
 ((
ušt16_t
)0x2100Uè

	)

211 
	#PHY_HALFDUPLEX_100M
 ((
ušt16_t
)0x2000Uè

	)

212 
	#PHY_FULLDUPLEX_10M
 ((
ušt16_t
)0x0100Uè

	)

213 
	#PHY_HALFDUPLEX_10M
 ((
ušt16_t
)0x0000Uè

	)

214 
	#PHY_AUTONEGOTIATION
 ((
ušt16_t
)0x1000Uè

	)

215 
	#PHY_RESTART_AUTONEGOTIATION
 ((
ušt16_t
)0x0200Uè

	)

216 
	#PHY_POWERDOWN
 ((
ušt16_t
)0x0800Uè

	)

217 
	#PHY_ISOLATE
 ((
ušt16_t
)0x0400Uè

	)

219 
	#PHY_AUTONEGO_COMPLETE
 ((
ušt16_t
)0x0020Uè

	)

220 
	#PHY_LINKED_STATUS
 ((
ušt16_t
)0x0004Uè

	)

221 
	#PHY_JABBER_DETECTION
 ((
ušt16_t
)0x0002Uè

	)

225 
	#PHY_SR
 ((
ušt16_t
)0x0010Uè

	)

226 
	#PHY_MICR
 ((
ušt16_t
)0x0011Uè

	)

227 
	#PHY_MISR
 ((
ušt16_t
)0x0012Uè

	)

229 
	#PHY_LINK_STATUS
 ((
ušt16_t
)0x0001Uè

	)

230 
	#PHY_SPEED_STATUS
 ((
ušt16_t
)0x0002Uè

	)

231 
	#PHY_DUPLEX_STATUS
 ((
ušt16_t
)0x0004Uè

	)

233 
	#PHY_MICR_INT_EN
 ((
ušt16_t
)0x0002Uè

	)

234 
	#PHY_MICR_INT_OE
 ((
ušt16_t
)0x0001Uè

	)

236 
	#PHY_MISR_LINK_INT_EN
 ((
ušt16_t
)0x0020Uè

	)

237 
	#PHY_LINK_INTERRUPT
 ((
ušt16_t
)0x2000Uè

	)

246 
	#USE_SPI_CRC
 1U

	)

253 #ifdeà
HAL_RCC_MODULE_ENABLED


254 
	~"¡m32f4xx_h®_rcc.h
"

257 #ifdeà
HAL_GPIO_MODULE_ENABLED


258 
	~"¡m32f4xx_h®_gpio.h
"

261 #ifdeà
HAL_DMA_MODULE_ENABLED


262 
	~"¡m32f4xx_h®_dma.h
"

265 #ifdeà
HAL_CORTEX_MODULE_ENABLED


266 
	~"¡m32f4xx_h®_cÜ‹x.h
"

269 #ifdeà
HAL_ADC_MODULE_ENABLED


270 
	~"¡m32f4xx_h®_adc.h
"

273 #ifdeà
HAL_CAN_MODULE_ENABLED


274 
	~"¡m32f4xx_h®_ÿn.h
"

277 #ifdeà
HAL_CRC_MODULE_ENABLED


278 
	~"¡m32f4xx_h®_üc.h
"

281 #ifdeà
HAL_CRYP_MODULE_ENABLED


282 
	~"¡m32f4xx_h®_üyp.h
"

285 #ifdeà
HAL_DMA2D_MODULE_ENABLED


286 
	~"¡m32f4xx_h®_dma2d.h
"

289 #ifdeà
HAL_DAC_MODULE_ENABLED


290 
	~"¡m32f4xx_h®_dac.h
"

293 #ifdeà
HAL_DCMI_MODULE_ENABLED


294 
	~"¡m32f4xx_h®_dcmi.h
"

297 #ifdeà
HAL_ETH_MODULE_ENABLED


298 
	~"¡m32f4xx_h®_‘h.h
"

301 #ifdeà
HAL_FLASH_MODULE_ENABLED


302 
	~"¡m32f4xx_h®_æash.h
"

305 #ifdeà
HAL_SRAM_MODULE_ENABLED


306 
	~"¡m32f4xx_h®_¤am.h
"

309 #ifdeà
HAL_NOR_MODULE_ENABLED


310 
	~"¡m32f4xx_h®_nÜ.h
"

313 #ifdeà
HAL_NAND_MODULE_ENABLED


314 
	~"¡m32f4xx_h®_Çnd.h
"

317 #ifdeà
HAL_PCCARD_MODULE_ENABLED


318 
	~"¡m32f4xx_h®_pcÿrd.h
"

321 #ifdeà
HAL_SDRAM_MODULE_ENABLED


322 
	~"¡m32f4xx_h®_sd¿m.h
"

325 #ifdeà
HAL_HASH_MODULE_ENABLED


326 
	~"¡m32f4xx_h®_hash.h
"

329 #ifdeà
HAL_I2C_MODULE_ENABLED


330 
	~"¡m32f4xx_h®_i2c.h
"

333 #ifdeà
HAL_I2S_MODULE_ENABLED


334 
	~"¡m32f4xx_h®_i2s.h
"

337 #ifdeà
HAL_IWDG_MODULE_ENABLED


338 
	~"¡m32f4xx_h®_iwdg.h
"

341 #ifdeà
HAL_LTDC_MODULE_ENABLED


342 
	~"¡m32f4xx_h®_Édc.h
"

345 #ifdeà
HAL_PWR_MODULE_ENABLED


346 
	~"¡m32f4xx_h®_pwr.h
"

349 #ifdeà
HAL_RNG_MODULE_ENABLED


350 
	~"¡m32f4xx_h®_ºg.h
"

353 #ifdeà
HAL_RTC_MODULE_ENABLED


354 
	~"¡m32f4xx_h®_¹c.h
"

357 #ifdeà
HAL_SAI_MODULE_ENABLED


358 
	~"¡m32f4xx_h®_§i.h
"

361 #ifdeà
HAL_SD_MODULE_ENABLED


362 
	~"¡m32f4xx_h®_sd.h
"

365 #ifdeà
HAL_SPI_MODULE_ENABLED


366 
	~"¡m32f4xx_h®_¥i.h
"

369 #ifdeà
HAL_TIM_MODULE_ENABLED


370 
	~"¡m32f4xx_h®_tim.h
"

373 #ifdeà
HAL_UART_MODULE_ENABLED


374 
	~"¡m32f4xx_h®_u¬t.h
"

377 #ifdeà
HAL_USART_MODULE_ENABLED


378 
	~"¡m32f4xx_h®_u§¹.h
"

381 #ifdeà
HAL_IRDA_MODULE_ENABLED


382 
	~"¡m32f4xx_h®_œda.h
"

385 #ifdeà
HAL_SMARTCARD_MODULE_ENABLED


386 
	~"¡m32f4xx_h®_sm¬tÿrd.h
"

389 #ifdeà
HAL_WWDG_MODULE_ENABLED


390 
	~"¡m32f4xx_h®_wwdg.h
"

393 #ifdeà
HAL_PCD_MODULE_ENABLED


394 
	~"¡m32f4xx_h®_pcd.h
"

397 #ifdeà
HAL_HCD_MODULE_ENABLED


398 
	~"¡m32f4xx_h®_hcd.h
"

401 #ifdeà
HAL_DSI_MODULE_ENABLED


402 
	~"¡m32f4xx_h®_dsi.h
"

405 #ifdeà
HAL_QSPI_MODULE_ENABLED


406 
	~"¡m32f4xx_h®_q¥i.h
"

409 #ifdeà
HAL_CEC_MODULE_ENABLED


410 
	~"¡m32f4xx_h®_ûc.h
"

413 #ifdeà
HAL_FMPI2C_MODULE_ENABLED


414 
	~"¡m32f4xx_h®_fmpi2c.h
"

417 #ifdeà
HAL_SPDIFRX_MODULE_ENABLED


418 
	~"¡m32f4xx_h®_¥diäx.h
"

421 #ifdeà
HAL_DFSDM_MODULE_ENABLED


422 
	~"¡m32f4xx_h®_dfsdm.h
"

425 #ifdeà
HAL_LPTIM_MODULE_ENABLED


426 
	~"¡m32f4xx_h®_Ítim.h
"

430 #ifdeà 
USE_FULL_ASSERT


439 
	#as£¹_·¿m
(
ex´
è(Óx´è? ()0 : 
	`as£¹_çed
((
ušt8_t
 *)
__FILE__
, 
__LINE__
))

	)

441 
as£¹_çed
(
ušt8_t
* 
fe
, 
ušt32_t
 
lše
);

443 
	#as£¹_·¿m
(
ex´
è(()0)

	)

447 #ifdeà
__ılu¥lus


	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal.c

54 
	~"¡m32f4xx_h®.h
"

73 
	#__STM32F4xx_HAL_VERSION_MAIN
 (0x01è

	)

74 
	#__STM32F4xx_HAL_VERSION_SUB1
 (0x05è

	)

75 
	#__STM32F4xx_HAL_VERSION_SUB2
 (0x02è

	)

76 
	#__STM32F4xx_HAL_VERSION_RC
 (0x00è

	)

77 
	#__STM32F4xx_HAL_VERSION
 ((
__STM32F4xx_HAL_VERSION_MAIN
 << 24U)\

78 |(
__STM32F4xx_HAL_VERSION_SUB1
 << 16U)\

79 |(
__STM32F4xx_HAL_VERSION_SUB2
 << 8U )\

80 |(
__STM32F4xx_HAL_VERSION_RC
))

	)

82 
	#IDCODE_DEVID_MASK
 ((
ušt32_t
)0x00000FFFU)

	)

85 
	#SYSCFG_OFFSET
 (
SYSCFG_BASE
 - 
PERIPH_BASE
)

	)

88 
	#MEMRMP_OFFSET
 
SYSCFG_OFFSET


	)

89 
	#UFB_MODE_BIT_NUMBER
 
	`POSITION_VAL
(
SYSCFG_MEMRMP_UFB_MODE
)

	)

90 
	#UFB_MODE_BB
 (
ušt32_t
)(
PERIPH_BB_BASE
 + (
MEMRMP_OFFSET
 * 32Uè+ (
UFB_MODE_BIT_NUMBER
 * 4U))

	)

94 
	#CMPCR_OFFSET
 (
SYSCFG_OFFSET
 + 0x20U)

	)

95 
	#CMP_PD_BIT_NUMBER
 
	`POSITION_VAL
(
SYSCFG_CMPCR_CMP_PD
)

	)

96 
	#CMPCR_CMP_PD_BB
 (
ušt32_t
)(
PERIPH_BB_BASE
 + (
CMPCR_OFFSET
 * 32Uè+ (
CMP_PD_BIT_NUMBER
 * 4U))

	)

106 
__IO
 
ušt32_t
 
	guwTick
;

167 
HAL_StusTy³Def
 
	$HAL_In™
()

170 #ià(
INSTRUCTION_CACHE_ENABLE
 != 0U)

171 
	`__HAL_FLASH_INSTRUCTION_CACHE_ENABLE
();

174 #ià(
DATA_CACHE_ENABLE
 != 0U)

175 
	`__HAL_FLASH_DATA_CACHE_ENABLE
();

178 #ià(
PREFETCH_ENABLE
 != 0U)

179 
	`__HAL_FLASH_PREFETCH_BUFFER_ENABLE
();

183 
	`HAL_NVIC_S‘PriÜ™yGroupšg
(
NVIC_PRIORITYGROUP_4
);

186 
	`HAL_In™Tick
(
TICK_INT_PRIORITY
);

189 
	`HAL_M¥In™
();

192  
HAL_OK
;

193 
	}
}

200 
HAL_StusTy³Def
 
	$HAL_DeIn™
()

203 
	`__HAL_RCC_APB1_FORCE_RESET
();

204 
	`__HAL_RCC_APB1_RELEASE_RESET
();

206 
	`__HAL_RCC_APB2_FORCE_RESET
();

207 
	`__HAL_RCC_APB2_RELEASE_RESET
();

209 
	`__HAL_RCC_AHB1_FORCE_RESET
();

210 
	`__HAL_RCC_AHB1_RELEASE_RESET
();

212 
	`__HAL_RCC_AHB2_FORCE_RESET
();

213 
	`__HAL_RCC_AHB2_RELEASE_RESET
();

215 
	`__HAL_RCC_AHB3_FORCE_RESET
();

216 
	`__HAL_RCC_AHB3_RELEASE_RESET
();

219 
	`HAL_M¥DeIn™
();

222  
HAL_OK
;

223 
	}
}

229 
__w—k
 
	$HAL_M¥In™
()

234 
	}
}

240 
__w—k
 
	$HAL_M¥DeIn™
()

245 
	}
}

263 
__w—k
 
HAL_StusTy³Def
 
	$HAL_In™Tick
(
ušt32_t
 
TickPriÜ™y
)

266 
	`HAL_SYSTICK_CÚfig
(
Sy¡emCÜeClock
/1000U);

269 
	`HAL_NVIC_S‘PriÜ™y
(
SysTick_IRQn
, 
TickPriÜ™y
 ,0U);

272  
HAL_OK
;

273 
	}
}

311 
__w—k
 
	$HAL_IncTick
()

313 
uwTick
++;

314 
	}
}

322 
__w—k
 
ušt32_t
 
	$HAL_G‘Tick
()

324  
uwTick
;

325 
	}
}

338 
__w—k
 
	$HAL_D–ay
(
__IO
 
ušt32_t
 
D–ay
)

340 
ušt32_t
 
tick¡¬t
 = 0U;

341 
tick¡¬t
 = 
	`HAL_G‘Tick
();

342 (
	`HAL_G‘Tick
(è- 
tick¡¬t
è< 
D–ay
)

345 
	}
}

357 
__w—k
 
	$HAL_Su¥’dTick
()

360 
SysTick
->
CTRL
 &ğ~
SysTick_CTRL_TICKINT_Msk
;

361 
	}
}

373 
__w—k
 
	$HAL_ResumeTick
()

376 
SysTick
->
CTRL
 |ğ
SysTick_CTRL_TICKINT_Msk
;

377 
	}
}

383 
ušt32_t
 
	$HAL_G‘H®V”siÚ
()

385  
__STM32F4xx_HAL_VERSION
;

386 
	}
}

392 
ušt32_t
 
	$HAL_G‘REVID
()

394 ((
DBGMCU
->
IDCODE
) >> 16U);

395 
	}
}

401 
ušt32_t
 
	$HAL_G‘DEVID
()

403 ((
DBGMCU
->
IDCODE
è& 
IDCODE_DEVID_MASK
);

404 
	}
}

410 
	$HAL_DBGMCU_EÇbËDBGSË•Mode
()

412 
	`SET_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_SLEEP
);

413 
	}
}

419 
	$HAL_DBGMCU_Di§bËDBGSË•Mode
()

421 
	`CLEAR_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_SLEEP
);

422 
	}
}

428 
	$HAL_DBGMCU_EÇbËDBGStİMode
()

430 
	`SET_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STOP
);

431 
	}
}

437 
	$HAL_DBGMCU_Di§bËDBGStİMode
()

439 
	`CLEAR_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STOP
);

440 
	}
}

446 
	$HAL_DBGMCU_EÇbËDBGSndbyMode
()

448 
	`SET_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STANDBY
);

449 
	}
}

455 
	$HAL_DBGMCU_Di§bËDBGSndbyMode
()

457 
	`CLEAR_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STANDBY
);

458 
	}
}

466 
	$HAL_EÇbËCom³n§tiÚC–l
()

468 *(
__IO
 
ušt32_t
 *)
CMPCR_CMP_PD_BB
 = (ušt32_t)
ENABLE
;

469 
	}
}

477 
	$HAL_Di§bËCom³n§tiÚC–l
()

479 *(
__IO
 
ušt32_t
 *)
CMPCR_CMP_PD_BB
 = (ušt32_t)
DISABLE
;

480 
	}
}

482 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
)|| defšed(
STM32F439xx
) ||\

483 
defšed
(
STM32F469xx
è|| 
	$defšed
(
STM32F479xx
)

494 
	$HAL_EÇbËMemÜySw­pšgBªk
()

496 *(
__IO
 
ušt32_t
 *)
UFB_MODE_BB
 = (ušt32_t)
ENABLE
;

497 
	}
}

509 
	$HAL_Di§bËMemÜySw­pšgBªk
()

512 *(
__IO
 
ušt32_t
 *)
UFB_MODE_BB
 = (ušt32_t)
DISABLE
;

513 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_cortex.c

101 
	~"¡m32f4xx_h®.h
"

112 #ifdeà
HAL_CORTEX_MODULE_ENABLED


161 
	$HAL_NVIC_S‘PriÜ™yGroupšg
(
ušt32_t
 
PriÜ™yGroup
)

164 
	`as£¹_·¿m
(
	`IS_NVIC_PRIORITY_GROUP
(
PriÜ™yGroup
));

167 
	`NVIC_S‘PriÜ™yGroupšg
(
PriÜ™yGroup
);

168 
	}
}

183 
	$HAL_NVIC_S‘PriÜ™y
(
IRQn_Ty³
 
IRQn
, 
ušt32_t
 
P»em±PriÜ™y
, ušt32_ˆ
SubPriÜ™y
)

185 
ušt32_t
 
´iÜ™ygroup
 = 0x00U;

188 
	`as£¹_·¿m
(
	`IS_NVIC_SUB_PRIORITY
(
SubPriÜ™y
));

189 
	`as£¹_·¿m
(
	`IS_NVIC_PREEMPTION_PRIORITY
(
P»em±PriÜ™y
));

191 
´iÜ™ygroup
 = 
	`NVIC_G‘PriÜ™yGroupšg
();

193 
	`NVIC_S‘PriÜ™y
(
IRQn
, 
	`NVIC_EncodePriÜ™y
(
´iÜ™ygroup
, 
P»em±PriÜ™y
, 
SubPriÜ™y
));

194 
	}
}

205 
	$HAL_NVIC_EÇbËIRQ
(
IRQn_Ty³
 
IRQn
)

208 
	`as£¹_·¿m
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

211 
	`NVIC_EÇbËIRQ
(
IRQn
);

212 
	}
}

221 
	$HAL_NVIC_Di§bËIRQ
(
IRQn_Ty³
 
IRQn
)

224 
	`as£¹_·¿m
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

227 
	`NVIC_Di§bËIRQ
(
IRQn
);

228 
	}
}

234 
	$HAL_NVIC_Sy¡emRe£t
()

237 
	`NVIC_Sy¡emRe£t
();

238 
	}
}

247 
ušt32_t
 
	$HAL_SYSTICK_CÚfig
(
ušt32_t
 
TicksNumb
)

249  
	`SysTick_CÚfig
(
TicksNumb
);

250 
	}
}

271 #ià(
__MPU_PRESENT
 == 1U)

278 
	$HAL_MPU_CÚfigRegiÚ
(
MPU_RegiÚ_In™Ty³Def
 *
MPU_In™
)

281 
	`as£¹_·¿m
(
	`IS_MPU_REGION_NUMBER
(
MPU_In™
->
Numb”
));

282 
	`as£¹_·¿m
(
	`IS_MPU_REGION_ENABLE
(
MPU_In™
->
EÇbË
));

285 
MPU
->
RNR
 = 
MPU_In™
->
Numb”
;

287 ià((
MPU_In™
->
EÇbË
è!ğ
RESET
)

290 
	`as£¹_·¿m
(
	`IS_MPU_INSTRUCTION_ACCESS
(
MPU_In™
->
Di§bËExec
));

291 
	`as£¹_·¿m
(
	`IS_MPU_REGION_PERMISSION_ATTRIBUTE
(
MPU_In™
->
AcûssP”missiÚ
));

292 
	`as£¹_·¿m
(
	`IS_MPU_TEX_LEVEL
(
MPU_In™
->
Ty³ExtF›ld
));

293 
	`as£¹_·¿m
(
	`IS_MPU_ACCESS_SHAREABLE
(
MPU_In™
->
IsSh¬—bË
));

294 
	`as£¹_·¿m
(
	`IS_MPU_ACCESS_CACHEABLE
(
MPU_In™
->
IsCach—bË
));

295 
	`as£¹_·¿m
(
	`IS_MPU_ACCESS_BUFFERABLE
(
MPU_In™
->
IsBufã¿bË
));

296 
	`as£¹_·¿m
(
	`IS_MPU_SUB_REGION_DISABLE
(
MPU_In™
->
SubRegiÚDi§bË
));

297 
	`as£¹_·¿m
(
	`IS_MPU_REGION_SIZE
(
MPU_In™
->
Size
));

299 
MPU
->
RBAR
 = 
MPU_In™
->
Ba£Add»ss
;

300 
MPU
->
RASR
 = ((
ušt32_t
)
MPU_In™
->
Di§bËExec
 << 
MPU_RASR_XN_Pos
) |

301 ((
ušt32_t
)
MPU_In™
->
AcûssP”missiÚ
 << 
MPU_RASR_AP_Pos
) |

302 ((
ušt32_t
)
MPU_In™
->
Ty³ExtF›ld
 << 
MPU_RASR_TEX_Pos
) |

303 ((
ušt32_t
)
MPU_In™
->
IsSh¬—bË
 << 
MPU_RASR_S_Pos
) |

304 ((
ušt32_t
)
MPU_In™
->
IsCach—bË
 << 
MPU_RASR_C_Pos
) |

305 ((
ušt32_t
)
MPU_In™
->
IsBufã¿bË
 << 
MPU_RASR_B_Pos
) |

306 ((
ušt32_t
)
MPU_In™
->
SubRegiÚDi§bË
 << 
MPU_RASR_SRD_Pos
) |

307 ((
ušt32_t
)
MPU_In™
->
Size
 << 
MPU_RASR_SIZE_Pos
) |

308 ((
ušt32_t
)
MPU_In™
->
EÇbË
 << 
MPU_RASR_ENABLE_Pos
);

312 
MPU
->
RBAR
 = 0x00U;

313 
MPU
->
RASR
 = 0x00U;

315 
	}
}

322 
ušt32_t
 
	$HAL_NVIC_G‘PriÜ™yGroupšg
()

325  
	`NVIC_G‘PriÜ™yGroupšg
();

326 
	}
}

349 
	$HAL_NVIC_G‘PriÜ™y
(
IRQn_Ty³
 
IRQn
, 
ušt32_t
 
PriÜ™yGroup
, ušt32_ˆ*
pP»em±PriÜ™y
, ušt32_ˆ*
pSubPriÜ™y
)

352 
	`as£¹_·¿m
(
	`IS_NVIC_PRIORITY_GROUP
(
PriÜ™yGroup
));

354 
	`NVIC_DecodePriÜ™y
(
	`NVIC_G‘PriÜ™y
(
IRQn
), 
PriÜ™yGroup
, 
pP»em±PriÜ™y
, 
pSubPriÜ™y
);

355 
	}
}

364 
	$HAL_NVIC_S‘P’dšgIRQ
(
IRQn_Ty³
 
IRQn
)

367 
	`as£¹_·¿m
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

370 
	`NVIC_S‘P’dšgIRQ
(
IRQn
);

371 
	}
}

382 
ušt32_t
 
	$HAL_NVIC_G‘P’dšgIRQ
(
IRQn_Ty³
 
IRQn
)

385 
	`as£¹_·¿m
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

388  
	`NVIC_G‘P’dšgIRQ
(
IRQn
);

389 
	}
}

398 
	$HAL_NVIC_CË¬P’dšgIRQ
(
IRQn_Ty³
 
IRQn
)

401 
	`as£¹_·¿m
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

404 
	`NVIC_CË¬P’dšgIRQ
(
IRQn
);

405 
	}
}

415 
ušt32_t
 
	$HAL_NVIC_G‘Aùive
(
IRQn_Ty³
 
IRQn
)

418 
	`as£¹_·¿m
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

421  
	`NVIC_G‘Aùive
(
IRQn
);

422 
	}
}

432 
	$HAL_SYSTICK_CLKSourûCÚfig
(
ušt32_t
 
CLKSourû
)

435 
	`as£¹_·¿m
(
	`IS_SYSTICK_CLK_SOURCE
(
CLKSourû
));

436 ià(
CLKSourû
 =ğ
SYSTICK_CLKSOURCE_HCLK
)

438 
SysTick
->
CTRL
 |ğ
SYSTICK_CLKSOURCE_HCLK
;

442 
SysTick
->
CTRL
 &ğ~
SYSTICK_CLKSOURCE_HCLK
;

444 
	}
}

450 
	$HAL_SYSTICK_IRQHªdËr
()

452 
	`HAL_SYSTICK_C®lback
();

453 
	}
}

459 
__w—k
 
	$HAL_SYSTICK_C®lback
()

464 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_crc.c

63 
	~"¡m32f4xx_h®.h
"

73 #ifdeà
HAL_CRC_MODULE_ENABLED


112 
HAL_StusTy³Def
 
	$HAL_CRC_In™
(
CRC_HªdËTy³Def
 *
hüc
)

115 if(
hüc
 =ğ
NULL
)

117  
HAL_ERROR
;

121 
	`as£¹_·¿m
(
	`IS_CRC_ALL_INSTANCE
(
hüc
->
In¡ªû
));

123 if(
hüc
->
S‹
 =ğ
HAL_CRC_STATE_RESET
)

126 
hüc
->
Lock
 = 
HAL_UNLOCKED
;

128 
	`HAL_CRC_M¥In™
(
hüc
);

132 
hüc
->
S‹
 = 
HAL_CRC_STATE_BUSY
;

135 
hüc
->
S‹
 = 
HAL_CRC_STATE_READY
;

138  
HAL_OK
;

139 
	}
}

147 
HAL_StusTy³Def
 
	$HAL_CRC_DeIn™
(
CRC_HªdËTy³Def
 *
hüc
)

150 if(
hüc
 =ğ
NULL
)

152  
HAL_ERROR
;

156 
	`as£¹_·¿m
(
	`IS_CRC_ALL_INSTANCE
(
hüc
->
In¡ªû
));

159 
hüc
->
S‹
 = 
HAL_CRC_STATE_BUSY
;

162 
	`HAL_CRC_M¥DeIn™
(
hüc
);

165 
hüc
->
S‹
 = 
HAL_CRC_STATE_RESET
;

168 
	`__HAL_UNLOCK
(
hüc
);

171  
HAL_OK
;

172 
	}
}

180 
__w—k
 
	$HAL_CRC_M¥In™
(
CRC_HªdËTy³Def
 *
hüc
)

183 
	`UNUSED
(
hüc
);

187 
	}
}

195 
__w—k
 
	$HAL_CRC_M¥DeIn™
(
CRC_HªdËTy³Def
 *
hüc
)

198 
	`UNUSED
(
hüc
);

202 
	}
}

234 
ušt32_t
 
	$HAL_CRC_AccumuÏ‹
(
CRC_HªdËTy³Def
 *
hüc
, 
ušt32_t
 
pBufãr
[], ušt32_ˆ
BufãrL’gth
)

236 
ušt32_t
 
šdex
 = 0U;

239 
	`__HAL_LOCK
(
hüc
);

242 
hüc
->
S‹
 = 
HAL_CRC_STATE_BUSY
;

245 
šdex
 = 0U; index < 
BufãrL’gth
; index++)

247 
hüc
->
In¡ªû
->
DR
 = 
pBufãr
[
šdex
];

251 
hüc
->
S‹
 = 
HAL_CRC_STATE_READY
;

254 
	`__HAL_UNLOCK
(
hüc
);

257  
hüc
->
In¡ªû
->
DR
;

258 
	}
}

269 
ušt32_t
 
	$HAL_CRC_C®cuÏ‹
(
CRC_HªdËTy³Def
 *
hüc
, 
ušt32_t
 
pBufãr
[], ušt32_ˆ
BufãrL’gth
)

271 
ušt32_t
 
šdex
 = 0U;

274 
	`__HAL_LOCK
(
hüc
);

277 
hüc
->
S‹
 = 
HAL_CRC_STATE_BUSY
;

280 
	`__HAL_CRC_DR_RESET
(
hüc
);

283 
šdex
 = 0U; index < 
BufãrL’gth
; index++)

285 
hüc
->
In¡ªû
->
DR
 = 
pBufãr
[
šdex
];

289 
hüc
->
S‹
 = 
HAL_CRC_STATE_READY
;

292 
	`__HAL_UNLOCK
(
hüc
);

295  
hüc
->
In¡ªû
->
DR
;

296 
	}
}

324 
HAL_CRC_S‹Ty³Def
 
	$HAL_CRC_G‘S‹
(
CRC_HªdËTy³Def
 *
hüc
)

326  
hüc
->
S‹
;

327 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_dma.c

119 
	~"¡m32f4xx_h®.h
"

130 #ifdeà
HAL_DMA_MODULE_ENABLED


135 
__IO
 
ušt32_t
 
	mISR
;

136 
__IO
 
ušt32_t
 
	mRe£rved0
;

137 
__IO
 
ušt32_t
 
	mIFCR
;

138 } 
	tDMA_Ba£_Regi¡”s
;

145 
	#HAL_TIMEOUT_DMA_ABORT
 ((
ušt32_t
)5è

	)

154 
DMA_S‘CÚfig
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
D©aL’gth
);

155 
ušt32_t
 
DMA_C®cBa£AndB™shiá
(
DMA_HªdËTy³Def
 *
hdma
);

156 
HAL_StusTy³Def
 
DMA_CheckFifoP¬am
(
DMA_HªdËTy³Def
 *
hdma
);

192 
HAL_StusTy³Def
 
	$HAL_DMA_In™
(
DMA_HªdËTy³Def
 *
hdma
)

194 
ušt32_t
 
tmp
 = 0U;

195 
ušt32_t
 
tick¡¬t
 = 
	`HAL_G‘Tick
();

196 
DMA_Ba£_Regi¡”s
 *
»gs
;

199 if(
hdma
 =ğ
NULL
)

201  
HAL_ERROR
;

205 
	`as£¹_·¿m
(
	`IS_DMA_STREAM_ALL_INSTANCE
(
hdma
->
In¡ªû
));

206 
	`as£¹_·¿m
(
	`IS_DMA_CHANNEL
(
hdma
->
In™
.
ChªÃl
));

207 
	`as£¹_·¿m
(
	`IS_DMA_DIRECTION
(
hdma
->
In™
.
DœeùiÚ
));

208 
	`as£¹_·¿m
(
	`IS_DMA_PERIPHERAL_INC_STATE
(
hdma
->
In™
.
P”hInc
));

209 
	`as£¹_·¿m
(
	`IS_DMA_MEMORY_INC_STATE
(
hdma
->
In™
.
MemInc
));

210 
	`as£¹_·¿m
(
	`IS_DMA_PERIPHERAL_DATA_SIZE
(
hdma
->
In™
.
P”hD©aAlignm’t
));

211 
	`as£¹_·¿m
(
	`IS_DMA_MEMORY_DATA_SIZE
(
hdma
->
In™
.
MemD©aAlignm’t
));

212 
	`as£¹_·¿m
(
	`IS_DMA_MODE
(
hdma
->
In™
.
Mode
));

213 
	`as£¹_·¿m
(
	`IS_DMA_PRIORITY
(
hdma
->
In™
.
PriÜ™y
));

214 
	`as£¹_·¿m
(
	`IS_DMA_FIFO_MODE_STATE
(
hdma
->
In™
.
FIFOMode
));

217 if(
hdma
->
In™
.
FIFOMode
 !ğ
DMA_FIFOMODE_DISABLE
)

219 
	`as£¹_·¿m
(
	`IS_DMA_FIFO_THRESHOLD
(
hdma
->
In™
.
FIFOTh»shŞd
));

220 
	`as£¹_·¿m
(
	`IS_DMA_MEMORY_BURST
(
hdma
->
In™
.
MemBur¡
));

221 
	`as£¹_·¿m
(
	`IS_DMA_PERIPHERAL_BURST
(
hdma
->
In™
.
P”hBur¡
));

225 
	`__HAL_UNLOCK
(
hdma
);

228 
hdma
->
S‹
 = 
HAL_DMA_STATE_BUSY
;

231 
	`__HAL_DMA_DISABLE
(
hdma
);

234 (
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_EN
è!ğ
RESET
)

237 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HAL_TIMEOUT_DMA_ABORT
)

240 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_TIMEOUT
;

243 
hdma
->
S‹
 = 
HAL_DMA_STATE_TIMEOUT
;

245  
HAL_TIMEOUT
;

250 
tmp
 = 
hdma
->
In¡ªû
->
CR
;

253 
tmp
 &ğ((
ušt32_t
)~(
DMA_SxCR_CHSEL
 | 
DMA_SxCR_MBURST
 | 
DMA_SxCR_PBURST
 | \

254 
DMA_SxCR_PL
 | 
DMA_SxCR_MSIZE
 | 
DMA_SxCR_PSIZE
 | \

255 
DMA_SxCR_MINC
 | 
DMA_SxCR_PINC
 | 
DMA_SxCR_CIRC
 | \

256 
DMA_SxCR_DIR
 | 
DMA_SxCR_CT
 | 
DMA_SxCR_DBM
));

259 
tmp
 |ğ
hdma
->
In™
.
ChªÃl
 | hdma->In™.
DœeùiÚ
 |

260 
hdma
->
In™
.
P”hInc
 | hdma->In™.
MemInc
 |

261 
hdma
->
In™
.
P”hD©aAlignm’t
 | hdma->In™.
MemD©aAlignm’t
 |

262 
hdma
->
In™
.
Mode
 | hdma->In™.
PriÜ™y
;

265 if(
hdma
->
In™
.
FIFOMode
 =ğ
DMA_FIFOMODE_ENABLE
)

268 
tmp
 |ğ
hdma
->
In™
.
MemBur¡
 | hdma->In™.
P”hBur¡
;

272 
hdma
->
In¡ªû
->
CR
 = 
tmp
;

275 
tmp
 = 
hdma
->
In¡ªû
->
FCR
;

278 
tmp
 &ğ(
ušt32_t
)~(
DMA_SxFCR_DMDIS
 | 
DMA_SxFCR_FTH
);

281 
tmp
 |ğ
hdma
->
In™
.
FIFOMode
;

284 if(
hdma
->
In™
.
FIFOMode
 =ğ
DMA_FIFOMODE_ENABLE
)

287 
tmp
 |ğ
hdma
->
In™
.
FIFOTh»shŞd
;

289 if(
	`DMA_CheckFifoP¬am
(
hdma
è!ğ
HAL_OK
)

292 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_PARAM
;

295 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

297  
HAL_ERROR
;

302 
hdma
->
In¡ªû
->
FCR
 = 
tmp
;

306 
»gs
 = (
DMA_Ba£_Regi¡”s
 *)
	`DMA_C®cBa£AndB™shiá
(
hdma
);

309 
»gs
->
IFCR
 = 0x3FU << 
hdma
->
SŒ—mIndex
;

312 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NONE
;

315 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

317  
HAL_OK
;

318 
	}
}

326 
HAL_StusTy³Def
 
	$HAL_DMA_DeIn™
(
DMA_HªdËTy³Def
 *
hdma
)

328 
DMA_Ba£_Regi¡”s
 *
»gs
;

331 if(
hdma
 =ğ
NULL
)

333  
HAL_ERROR
;

337 if(
hdma
->
S‹
 =ğ
HAL_DMA_STATE_BUSY
)

340  
HAL_BUSY
;

344 
	`__HAL_DMA_DISABLE
(
hdma
);

347 
hdma
->
In¡ªû
->
CR
 = 0U;

350 
hdma
->
In¡ªû
->
NDTR
 = 0U;

353 
hdma
->
In¡ªû
->
PAR
 = 0U;

356 
hdma
->
In¡ªû
->
M0AR
 = 0U;

359 
hdma
->
In¡ªû
->
M1AR
 = 0U;

362 
hdma
->
In¡ªû
->
FCR
 = (
ušt32_t
)0x00000021U;

365 
»gs
 = (
DMA_Ba£_Regi¡”s
 *)
	`DMA_C®cBa£AndB™shiá
(
hdma
);

368 
»gs
->
IFCR
 = 0x3FU << 
hdma
->
SŒ—mIndex
;

371 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NONE
;

374 
hdma
->
S‹
 = 
HAL_DMA_STATE_RESET
;

377 
	`__HAL_UNLOCK
(
hdma
);

379  
HAL_OK
;

380 
	}
}

413 
HAL_StusTy³Def
 
	$HAL_DMA_S¹
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
D©aL’gth
)

415 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

418 
	`as£¹_·¿m
(
	`IS_DMA_BUFFER_SIZE
(
D©aL’gth
));

421 
	`__HAL_LOCK
(
hdma
);

423 if(
HAL_DMA_STATE_READY
 =ğ
hdma
->
S‹
)

426 
hdma
->
S‹
 = 
HAL_DMA_STATE_BUSY
;

429 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NONE
;

432 
	`DMA_S‘CÚfig
(
hdma
, 
SrcAdd»ss
, 
D¡Add»ss
, 
D©aL’gth
);

435 
	`__HAL_DMA_ENABLE
(
hdma
);

440 
	`__HAL_UNLOCK
(
hdma
);

443 
¡©us
 = 
HAL_BUSY
;

445  
¡©us
;

446 
	}
}

457 
HAL_StusTy³Def
 
	$HAL_DMA_S¹_IT
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
D©aL’gth
)

459 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

462 
DMA_Ba£_Regi¡”s
 *
»gs
 = (DMA_Ba£_Regi¡” *)
hdma
->
SŒ—mBa£Add»ss
;

465 
	`as£¹_·¿m
(
	`IS_DMA_BUFFER_SIZE
(
D©aL’gth
));

468 
	`__HAL_LOCK
(
hdma
);

470 if(
HAL_DMA_STATE_READY
 =ğ
hdma
->
S‹
)

473 
hdma
->
S‹
 = 
HAL_DMA_STATE_BUSY
;

476 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NONE
;

479 
	`DMA_S‘CÚfig
(
hdma
, 
SrcAdd»ss
, 
D¡Add»ss
, 
D©aL’gth
);

482 
»gs
->
IFCR
 = 0x3FU << 
hdma
->
SŒ—mIndex
;

485 
hdma
->
In¡ªû
->
CR
 |ğ
DMA_IT_TC
 | 
DMA_IT_TE
 | 
DMA_IT_DME
;

486 
hdma
->
In¡ªû
->
FCR
 |ğ
DMA_IT_FE
;

488 if(
hdma
->
XãrH®fC¶tC®lback
 !ğ
NULL
)

490 
hdma
->
In¡ªû
->
CR
 |ğ
DMA_IT_HT
;

494 
	`__HAL_DMA_ENABLE
(
hdma
);

499 
	`__HAL_UNLOCK
(
hdma
);

502 
¡©us
 = 
HAL_BUSY
;

505  
¡©us
;

506 
	}
}

520 
HAL_StusTy³Def
 
	$HAL_DMA_AbÜt
(
DMA_HªdËTy³Def
 *
hdma
)

523 
DMA_Ba£_Regi¡”s
 *
»gs
 = (DMA_Ba£_Regi¡” *)
hdma
->
SŒ—mBa£Add»ss
;

525 
ušt32_t
 
tick¡¬t
 = 
	`HAL_G‘Tick
();

527 if(
hdma
->
S‹
 !ğ
HAL_DMA_STATE_BUSY
)

529 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NO_XFER
;

532 
	`__HAL_UNLOCK
(
hdma
);

534  
HAL_ERROR
;

539 
hdma
->
In¡ªû
->
CR
 &ğ~(
DMA_IT_TC
 | 
DMA_IT_TE
 | 
DMA_IT_DME
);

540 
hdma
->
In¡ªû
->
FCR
 &ğ~(
DMA_IT_FE
);

542 if((
hdma
->
XãrH®fC¶tC®lback
 !ğ
NULL
è|| (hdma->
XãrM1H®fC¶tC®lback
 != NULL))

544 
hdma
->
In¡ªû
->
CR
 &ğ~(
DMA_IT_HT
);

548 
	`__HAL_DMA_DISABLE
(
hdma
);

551 (
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_EN
è!ğ
RESET
)

554 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HAL_TIMEOUT_DMA_ABORT
)

557 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_TIMEOUT
;

560 
	`__HAL_UNLOCK
(
hdma
);

563 
hdma
->
S‹
 = 
HAL_DMA_STATE_TIMEOUT
;

565  
HAL_TIMEOUT
;

570 
»gs
->
IFCR
 = 0x3FU << 
hdma
->
SŒ—mIndex
;

573 
	`__HAL_UNLOCK
(
hdma
);

576 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

578  
HAL_OK
;

579 
	}
}

587 
HAL_StusTy³Def
 
	$HAL_DMA_AbÜt_IT
(
DMA_HªdËTy³Def
 *
hdma
)

589 if(
hdma
->
S‹
 !ğ
HAL_DMA_STATE_BUSY
)

591 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NO_XFER
;

592  
HAL_ERROR
;

597 
hdma
->
S‹
 = 
HAL_DMA_STATE_ABORT
;

600 
	`__HAL_DMA_DISABLE
(
hdma
);

603  
HAL_OK
;

604 
	}
}

617 
HAL_StusTy³Def
 
	$HAL_DMA_PŞlFÜT¿nsãr
(
DMA_HªdËTy³Def
 *
hdma
, 
HAL_DMA_Lev–Com¶‘eTy³Def
 
Com¶‘eLev–
, 
ušt32_t
 
Timeout
)

619 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

620 
ušt32_t
 
mask_ıÉËv–
;

621 
ušt32_t
 
tick¡¬t
 = 
	`HAL_G‘Tick
();

622 
ušt32_t
 
tmpi¤
;

625 
DMA_Ba£_Regi¡”s
 *
»gs
;

627 if(
HAL_DMA_STATE_BUSY
 !ğ
hdma
->
S‹
)

630 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NO_XFER
;

631 
	`__HAL_UNLOCK
(
hdma
);

632  
HAL_ERROR
;

636 ià((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CIRC
è!ğ
RESET
)

638 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NOT_SUPPORTED
;

639  
HAL_ERROR
;

643 if(
Com¶‘eLev–
 =ğ
HAL_DMA_FULL_TRANSFER
)

646 
mask_ıÉËv–
 = 
DMA_FLAG_TCIF0_4
 << 
hdma
->
SŒ—mIndex
;

651 
mask_ıÉËv–
 = 
DMA_FLAG_HTIF0_4
 << 
hdma
->
SŒ—mIndex
;

654 
»gs
 = (
DMA_Ba£_Regi¡”s
 *)
hdma
->
SŒ—mBa£Add»ss
;

655 
tmpi¤
 = 
»gs
->
ISR
;

657 ((
tmpi¤
 & 
mask_ıÉËv–
è=ğ
RESET
è&& ((
hdma
->
E¼ÜCode
 & 
HAL_DMA_ERROR_TE
) == RESET))

660 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

662 if((
Timeout
 =ğ0)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

665 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_TIMEOUT
;

668 
	`__HAL_UNLOCK
(
hdma
);

671 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

673  
HAL_TIMEOUT
;

678 
tmpi¤
 = 
»gs
->
ISR
;

680 if((
tmpi¤
 & (
DMA_FLAG_TEIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

683 
hdma
->
E¼ÜCode
 |ğ
HAL_DMA_ERROR_TE
;

686 
»gs
->
IFCR
 = 
DMA_FLAG_TEIF0_4
 << 
hdma
->
SŒ—mIndex
;

689 if((
tmpi¤
 & (
DMA_FLAG_FEIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

692 
hdma
->
E¼ÜCode
 |ğ
HAL_DMA_ERROR_FE
;

695 
»gs
->
IFCR
 = 
DMA_FLAG_FEIF0_4
 << 
hdma
->
SŒ—mIndex
;

698 if((
tmpi¤
 & (
DMA_FLAG_DMEIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

701 
hdma
->
E¼ÜCode
 |ğ
HAL_DMA_ERROR_DME
;

704 
»gs
->
IFCR
 = 
DMA_FLAG_DMEIF0_4
 << 
hdma
->
SŒ—mIndex
;

708 if(
hdma
->
E¼ÜCode
 !ğ
HAL_DMA_ERROR_NONE
)

710 if((
hdma
->
E¼ÜCode
 & 
HAL_DMA_ERROR_TE
è!ğ
RESET
)

712 
	`HAL_DMA_AbÜt
(
hdma
);

715 
»gs
->
IFCR
 = (
DMA_FLAG_HTIF0_4
 | 
DMA_FLAG_TCIF0_4
è<< 
hdma
->
SŒ—mIndex
;

718 
	`__HAL_UNLOCK
(
hdma
);

721 
hdma
->
S‹
ğ
HAL_DMA_STATE_READY
;

723  
HAL_ERROR
;

729 if(
Com¶‘eLev–
 =ğ
HAL_DMA_FULL_TRANSFER
)

732 
»gs
->
IFCR
 = (
DMA_FLAG_HTIF0_4
 | 
DMA_FLAG_TCIF0_4
è<< 
hdma
->
SŒ—mIndex
;

735 
	`__HAL_UNLOCK
(
hdma
);

737 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

742 
»gs
->
IFCR
 = (
DMA_FLAG_HTIF0_4
è<< 
hdma
->
SŒ—mIndex
;

745  
¡©us
;

746 
	}
}

754 
	$HAL_DMA_IRQHªdËr
(
DMA_HªdËTy³Def
 *
hdma
)

756 
ušt32_t
 
tmpi¤
;

757 
__IO
 
ušt32_t
 
couÁ
 = 0;

758 
ušt32_t
 
timeout
 = 
Sy¡emCÜeClock
 / 9600;

761 
DMA_Ba£_Regi¡”s
 *
»gs
 = (DMA_Ba£_Regi¡” *)
hdma
->
SŒ—mBa£Add»ss
;

763 
tmpi¤
 = 
»gs
->
ISR
;

766 ià((
tmpi¤
 & (
DMA_FLAG_TEIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

768 if(
	`__HAL_DMA_GET_IT_SOURCE
(
hdma
, 
DMA_IT_TE
è!ğ
RESET
)

771 
hdma
->
In¡ªû
->
CR
 &ğ~(
DMA_IT_TE
);

774 
»gs
->
IFCR
 = 
DMA_FLAG_TEIF0_4
 << 
hdma
->
SŒ—mIndex
;

777 
hdma
->
E¼ÜCode
 |ğ
HAL_DMA_ERROR_TE
;

781 ià((
tmpi¤
 & (
DMA_FLAG_FEIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

783 if(
	`__HAL_DMA_GET_IT_SOURCE
(
hdma
, 
DMA_IT_FE
è!ğ
RESET
)

786 
»gs
->
IFCR
 = 
DMA_FLAG_FEIF0_4
 << 
hdma
->
SŒ—mIndex
;

789 
hdma
->
E¼ÜCode
 |ğ
HAL_DMA_ERROR_FE
;

793 ià((
tmpi¤
 & (
DMA_FLAG_DMEIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

795 if(
	`__HAL_DMA_GET_IT_SOURCE
(
hdma
, 
DMA_IT_DME
è!ğ
RESET
)

798 
»gs
->
IFCR
 = 
DMA_FLAG_DMEIF0_4
 << 
hdma
->
SŒ—mIndex
;

801 
hdma
->
E¼ÜCode
 |ğ
HAL_DMA_ERROR_DME
;

805 ià((
tmpi¤
 & (
DMA_FLAG_HTIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

807 if(
	`__HAL_DMA_GET_IT_SOURCE
(
hdma
, 
DMA_IT_HT
è!ğ
RESET
)

810 
»gs
->
IFCR
 = 
DMA_FLAG_HTIF0_4
 << 
hdma
->
SŒ—mIndex
;

813 if(((
hdma
->
In¡ªû
->
CR
è& (
ušt32_t
)(
DMA_SxCR_DBM
)è!ğ
RESET
)

816 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CT
è=ğ
RESET
)

818 if(
hdma
->
XãrH®fC¶tC®lback
 !ğ
NULL
)

821 
hdma
->
	`XãrH®fC¶tC®lback
(hdma);

827 if(
hdma
->
XãrM1H®fC¶tC®lback
 !ğ
NULL
)

830 
hdma
->
	`XãrM1H®fC¶tC®lback
(hdma);

837 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CIRC
è=ğ
RESET
)

840 
hdma
->
In¡ªû
->
CR
 &ğ~(
DMA_IT_HT
);

843 if(
hdma
->
XãrH®fC¶tC®lback
 !ğ
NULL
)

846 
hdma
->
	`XãrH®fC¶tC®lback
(hdma);

852 ià((
tmpi¤
 & (
DMA_FLAG_TCIF0_4
 << 
hdma
->
SŒ—mIndex
)è!ğ
RESET
)

854 if(
	`__HAL_DMA_GET_IT_SOURCE
(
hdma
, 
DMA_IT_TC
è!ğ
RESET
)

857 
»gs
->
IFCR
 = 
DMA_FLAG_TCIF0_4
 << 
hdma
->
SŒ—mIndex
;

859 if(
HAL_DMA_STATE_ABORT
 =ğ
hdma
->
S‹
)

862 
hdma
->
In¡ªû
->
CR
 &ğ~(
DMA_IT_TC
 | 
DMA_IT_TE
 | 
DMA_IT_DME
);

863 
hdma
->
In¡ªû
->
FCR
 &ğ~(
DMA_IT_FE
);

865 if((
hdma
->
XãrH®fC¶tC®lback
 !ğ
NULL
è|| (hdma->
XãrM1H®fC¶tC®lback
 != NULL))

867 
hdma
->
In¡ªû
->
CR
 &ğ~(
DMA_IT_HT
);

871 
»gs
->
IFCR
 = 0x3FU << 
hdma
->
SŒ—mIndex
;

874 
	`__HAL_UNLOCK
(
hdma
);

877 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

879 if(
hdma
->
XãrAbÜtC®lback
 !ğ
NULL
)

881 
hdma
->
	`XãrAbÜtC®lback
(hdma);

886 if(((
hdma
->
In¡ªû
->
CR
è& (
ušt32_t
)(
DMA_SxCR_DBM
)è!ğ
RESET
)

889 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CT
è=ğ
RESET
)

891 if(
hdma
->
XãrM1C¶tC®lback
 !ğ
NULL
)

894 
hdma
->
	`XãrM1C¶tC®lback
(hdma);

900 if(
hdma
->
XãrC¶tC®lback
 !ğ
NULL
)

903 
hdma
->
	`XãrC¶tC®lback
(hdma);

910 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CIRC
è=ğ
RESET
)

913 
hdma
->
In¡ªû
->
CR
 &ğ~(
DMA_IT_TC
);

916 
	`__HAL_UNLOCK
(
hdma
);

919 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

922 if(
hdma
->
XãrC¶tC®lback
 !ğ
NULL
)

925 
hdma
->
	`XãrC¶tC®lback
(hdma);

932 if(
hdma
->
E¼ÜCode
 !ğ
HAL_DMA_ERROR_NONE
)

934 if((
hdma
->
E¼ÜCode
 & 
HAL_DMA_ERROR_TE
è!ğ
RESET
)

936 
hdma
->
S‹
 = 
HAL_DMA_STATE_ABORT
;

939 
	`__HAL_DMA_DISABLE
(
hdma
);

943 ià(++
couÁ
 > 
timeout
)

948 (
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_EN
è!ğ
RESET
);

951 
	`__HAL_UNLOCK
(
hdma
);

954 
hdma
->
S‹
 = 
HAL_DMA_STATE_READY
;

957 if(
hdma
->
XãrE¼ÜC®lback
 !ğ
NULL
)

960 
hdma
->
	`XãrE¼ÜC®lback
(hdma);

963 
	}
}

975 
HAL_StusTy³Def
 
HAL_DMA_Regi¡”C®lback
(
DMA_HªdËTy³Def
 *
hdma
, 
HAL_DMA_C®lbackIDTy³Def
 
C®lbackID
, (* 
pC®lback
)(DMA_HªdËTy³Deà*
_hdma
))

978 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

981 
	`__HAL_LOCK
(
hdma
);

983 if(
HAL_DMA_STATE_READY
 =ğ
hdma
->
S‹
)

985 
C®lbackID
)

987 
HAL_DMA_XFER_CPLT_CB_ID
:

988 
hdma
->
XãrC¶tC®lback
 = 
pC®lback
;

991 
HAL_DMA_XFER_HALFCPLT_CB_ID
:

992 
hdma
->
XãrH®fC¶tC®lback
 = 
pC®lback
;

995 
HAL_DMA_XFER_M1CPLT_CB_ID
:

996 
hdma
->
XãrM1C¶tC®lback
 = 
pC®lback
;

999 
HAL_DMA_XFER_M1HALFCPLT_CB_ID
:

1000 
hdma
->
XãrM1H®fC¶tC®lback
 = 
pC®lback
;

1003 
HAL_DMA_XFER_ERROR_CB_ID
:

1004 
hdma
->
XãrE¼ÜC®lback
 = 
pC®lback
;

1007 
HAL_DMA_XFER_ABORT_CB_ID
:

1008 
hdma
->
XãrAbÜtC®lback
 = 
pC®lback
;

1018 
¡©us
 = 
HAL_ERROR
;

1022 
	`__HAL_UNLOCK
(
hdma
);

1024  
¡©us
;

1025 
	}
}

1035 
HAL_StusTy³Def
 
	$HAL_DMA_UnRegi¡”C®lback
(
DMA_HªdËTy³Def
 *
hdma
, 
HAL_DMA_C®lbackIDTy³Def
 
C®lbackID
)

1037 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

1040 
	`__HAL_LOCK
(
hdma
);

1042 if(
HAL_DMA_STATE_READY
 =ğ
hdma
->
S‹
)

1044 
C®lbackID
)

1046 
HAL_DMA_XFER_CPLT_CB_ID
:

1047 
hdma
->
XãrC¶tC®lback
 = 
NULL
;

1050 
HAL_DMA_XFER_HALFCPLT_CB_ID
:

1051 
hdma
->
XãrH®fC¶tC®lback
 = 
NULL
;

1054 
HAL_DMA_XFER_M1CPLT_CB_ID
:

1055 
hdma
->
XãrM1C¶tC®lback
 = 
NULL
;

1058 
HAL_DMA_XFER_M1HALFCPLT_CB_ID
:

1059 
hdma
->
XãrM1H®fC¶tC®lback
 = 
NULL
;

1062 
HAL_DMA_XFER_ERROR_CB_ID
:

1063 
hdma
->
XãrE¼ÜC®lback
 = 
NULL
;

1066 
HAL_DMA_XFER_ABORT_CB_ID
:

1067 
hdma
->
XãrAbÜtC®lback
 = 
NULL
;

1070 
HAL_DMA_XFER_ALL_CB_ID
:

1071 
hdma
->
XãrC¶tC®lback
 = 
NULL
;

1072 
hdma
->
XãrH®fC¶tC®lback
 = 
NULL
;

1073 
hdma
->
XãrM1C¶tC®lback
 = 
NULL
;

1074 
hdma
->
XãrM1H®fC¶tC®lback
 = 
NULL
;

1075 
hdma
->
XãrE¼ÜC®lback
 = 
NULL
;

1076 
hdma
->
XãrAbÜtC®lback
 = 
NULL
;

1080 
¡©us
 = 
HAL_ERROR
;

1086 
¡©us
 = 
HAL_ERROR
;

1090 
	`__HAL_UNLOCK
(
hdma
);

1092  
¡©us
;

1093 
	}
}

1120 
HAL_DMA_S‹Ty³Def
 
	$HAL_DMA_G‘S‹
(
DMA_HªdËTy³Def
 *
hdma
)

1122  
hdma
->
S‹
;

1123 
	}
}

1131 
ušt32_t
 
	$HAL_DMA_G‘E¼Ü
(
DMA_HªdËTy³Def
 *
hdma
)

1133  
hdma
->
E¼ÜCode
;

1134 
	}
}

1157 
	$DMA_S‘CÚfig
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
D©aL’gth
)

1160 
hdma
->
In¡ªû
->
CR
 &ğ(
ušt32_t
)(~
DMA_SxCR_DBM
);

1163 
hdma
->
In¡ªû
->
NDTR
 = 
D©aL’gth
;

1166 if((
hdma
->
In™
.
DœeùiÚ
è=ğ
DMA_MEMORY_TO_PERIPH
)

1169 
hdma
->
In¡ªû
->
PAR
 = 
D¡Add»ss
;

1172 
hdma
->
In¡ªû
->
M0AR
 = 
SrcAdd»ss
;

1178 
hdma
->
In¡ªû
->
PAR
 = 
SrcAdd»ss
;

1181 
hdma
->
In¡ªû
->
M0AR
 = 
D¡Add»ss
;

1183 
	}
}

1191 
ušt32_t
 
	$DMA_C®cBa£AndB™shiá
(
DMA_HªdËTy³Def
 *
hdma
)

1193 
ušt32_t
 
¡»am_numb”
 = (((ušt32_t)
hdma
->
In¡ªû
 & 0xFFU) - 16U) / 24U;

1196 cÚ¡ 
ušt8_t
 
æagB™shiáOff£t
[8U] = {0U, 6U, 16U, 22U, 0U, 6U, 16U, 22U};

1197 
hdma
->
SŒ—mIndex
 = 
æagB™shiáOff£t
[
¡»am_numb”
];

1199 ià(
¡»am_numb”
 > 3U)

1202 
hdma
->
SŒ—mBa£Add»ss
 = (((
ušt32_t
)hdma->
In¡ªû
 & (uint32_t)(~0x3FFU)) + 4U);

1207 
hdma
->
SŒ—mBa£Add»ss
 = ((
ušt32_t
)hdma->
In¡ªû
 & (uint32_t)(~0x3FFU));

1210  
hdma
->
SŒ—mBa£Add»ss
;

1211 
	}
}

1219 
HAL_StusTy³Def
 
	$DMA_CheckFifoP¬am
(
DMA_HªdËTy³Def
 *
hdma
)

1221 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

1222 
ušt32_t
 
tmp
 = 
hdma
->
In™
.
FIFOTh»shŞd
;

1225 if(
hdma
->
In™
.
MemD©aAlignm’t
 =ğ
DMA_MDATAALIGN_BYTE
)

1227 
tmp
)

1229 
DMA_FIFO_THRESHOLD_1QUARTERFULL
:

1230 if((
hdma
->
In™
.
MemBur¡
 & 
DMA_SxCR_MBURST_1
) == DMA_SxCR_MBURST_1)

1232 
¡©us
 = 
HAL_ERROR
;

1235 
DMA_FIFO_THRESHOLD_HALFFULL
:

1236 if(
hdma
->
In™
.
MemBur¡
 =ğ
DMA_MBURST_INC16
)

1238 
¡©us
 = 
HAL_ERROR
;

1241 
DMA_FIFO_THRESHOLD_3QUARTERSFULL
:

1242 if((
hdma
->
In™
.
MemBur¡
 & 
DMA_SxCR_MBURST_1
) == DMA_SxCR_MBURST_1)

1244 
¡©us
 = 
HAL_ERROR
;

1247 
DMA_FIFO_THRESHOLD_FULL
:

1255 ià(
hdma
->
In™
.
MemD©aAlignm’t
 =ğ
DMA_MDATAALIGN_HALFWORD
)

1257 
tmp
)

1259 
DMA_FIFO_THRESHOLD_1QUARTERFULL
:

1260 
¡©us
 = 
HAL_ERROR
;

1262 
DMA_FIFO_THRESHOLD_HALFFULL
:

1263 ià((
hdma
->
In™
.
MemBur¡
 & 
DMA_SxCR_MBURST_1
) == DMA_SxCR_MBURST_1)

1265 
¡©us
 = 
HAL_ERROR
;

1268 
DMA_FIFO_THRESHOLD_3QUARTERSFULL
:

1269 
¡©us
 = 
HAL_ERROR
;

1271 
DMA_FIFO_THRESHOLD_FULL
:

1272 ià(
hdma
->
In™
.
MemBur¡
 =ğ
DMA_MBURST_INC16
)

1274 
¡©us
 = 
HAL_ERROR
;

1285 
tmp
)

1287 
DMA_FIFO_THRESHOLD_1QUARTERFULL
:

1288 
DMA_FIFO_THRESHOLD_HALFFULL
:

1289 
DMA_FIFO_THRESHOLD_3QUARTERSFULL
:

1290 
¡©us
 = 
HAL_ERROR
;

1292 
DMA_FIFO_THRESHOLD_FULL
:

1293 ià((
hdma
->
In™
.
MemBur¡
 & 
DMA_SxCR_MBURST_1
) == DMA_SxCR_MBURST_1)

1295 
¡©us
 = 
HAL_ERROR
;

1303  
¡©us
;

1304 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_dma2d.c

129 
	~"¡m32f4xx_h®.h
"

140 #ifdeà
HAL_DMA2D_MODULE_ENABLED


142 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
)

153 
	#DMA2D_TIMEOUT_ABORT
 ((
ušt32_t
)1000Uè

	)

154 
	#DMA2D_TIMEOUT_SUSPEND
 ((
ušt32_t
)1000Uè

	)

162 
	#DMA2D_POSITION_FGPFCCR_CS
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_FGPFCCR_CS
è

	)

163 
	#DMA2D_POSITION_BGPFCCR_CS
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_BGPFCCR_CS
è

	)

165 
	#DMA2D_POSITION_FGPFCCR_CCM
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_FGPFCCR_CCM
è

	)

166 
	#DMA2D_POSITION_BGPFCCR_CCM
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_BGPFCCR_CCM
è

	)

168 
	#DMA2D_POSITION_AMTCR_DT
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_AMTCR_DT
è

	)

170 
	#DMA2D_POSITION_FGPFCCR_AM
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_FGPFCCR_AM
è

	)

171 
	#DMA2D_POSITION_BGPFCCR_AM
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_BGPFCCR_AM
è

	)

173 
	#DMA2D_POSITION_FGPFCCR_ALPHA
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_FGPFCCR_ALPHA
è

	)

174 
	#DMA2D_POSITION_BGPFCCR_ALPHA
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_BGPFCCR_ALPHA
è

	)

176 
	#DMA2D_POSITION_NLR_PL
 (
ušt32_t
)
	`POSITION_VAL
(
DMA2D_NLR_PL
è

	)

192 
DMA2D_S‘CÚfig
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
pd©a
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
Width
, ušt32_ˆ
Height
);

225 
HAL_StusTy³Def
 
	$HAL_DMA2D_In™
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

228 if(
hdma2d
 =ğ
NULL
)

230  
HAL_ERROR
;

234 
	`as£¹_·¿m
(
	`IS_DMA2D_ALL_INSTANCE
(
hdma2d
->
In¡ªû
));

235 
	`as£¹_·¿m
(
	`IS_DMA2D_MODE
(
hdma2d
->
In™
.
Mode
));

236 
	`as£¹_·¿m
(
	`IS_DMA2D_CMODE
(
hdma2d
->
In™
.
CŞÜMode
));

237 
	`as£¹_·¿m
(
	`IS_DMA2D_OFFSET
(
hdma2d
->
In™
.
OuutOff£t
));

239 if(
hdma2d
->
S‹
 =ğ
HAL_DMA2D_STATE_RESET
)

242 
hdma2d
->
Lock
 = 
HAL_UNLOCKED
;

244 
	`HAL_DMA2D_M¥In™
(
hdma2d
);

248 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

251 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_MODE
, hdma2d->
In™
.
Mode
);

254 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
OPFCCR
, 
DMA2D_OPFCCR_CM
, hdma2d->
In™
.
CŞÜMode
);

257 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
OOR
, 
DMA2D_OOR_LO
, hdma2d->
In™
.
OuutOff£t
);

260 
hdma2d
->
E¼ÜCode
 = 
HAL_DMA2D_ERROR_NONE
;

263 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

265  
HAL_OK
;

266 
	}
}

276 
HAL_StusTy³Def
 
	$HAL_DMA2D_DeIn™
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

279 if(
hdma2d
 =ğ
NULL
)

281  
HAL_ERROR
;

286 ià(
	`__HAL_RCC_DMA2D_IS_CLK_ENABLED
())

289 ià((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_START
) == DMA2D_CR_START)

291 ià(
	`HAL_DMA2D_AbÜt
(
hdma2d
è!ğ
HAL_OK
)

294  
HAL_ERROR
;

300 ià((
hdma2d
->
In¡ªû
->
BGPFCCR
 & 
DMA2D_BGPFCCR_START
) == DMA2D_BGPFCCR_START)

302 ià(
	`HAL_DMA2D_CLUTLßdšg_AbÜt
(
hdma2d
, 0Uè!ğ
HAL_OK
)

305  
HAL_ERROR
;

311 ià((
hdma2d
->
In¡ªû
->
FGPFCCR
 & 
DMA2D_FGPFCCR_START
) == DMA2D_FGPFCCR_START)

313 ià(
	`HAL_DMA2D_CLUTLßdšg_AbÜt
(
hdma2d
, 1Uè!ğ
HAL_OK
)

316  
HAL_ERROR
;

324 
	`HAL_DMA2D_M¥DeIn™
(
hdma2d
);

327 
hdma2d
->
In¡ªû
->
CR
 = 0U;

328 
hdma2d
->
In¡ªû
->
FGOR
 = 0U;

329 
hdma2d
->
In¡ªû
->
BGOR
 = 0U;

330 
hdma2d
->
In¡ªû
->
FGPFCCR
 = 0U;

331 
hdma2d
->
In¡ªû
->
BGPFCCR
 = 0U;

332 
hdma2d
->
In¡ªû
->
OPFCCR
 = 0U;

335 
hdma2d
->
E¼ÜCode
 = 
HAL_DMA2D_ERROR_NONE
;

338 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_RESET
;

341 
	`__HAL_UNLOCK
(
hdma2d
);

343  
HAL_OK
;

344 
	}
}

352 
__w—k
 
	$HAL_DMA2D_M¥In™
(
DMA2D_HªdËTy³Def
* 
hdma2d
)

355 
	`UNUSED
(
hdma2d
);

360 
	}
}

368 
__w—k
 
	$HAL_DMA2D_M¥DeIn™
(
DMA2D_HªdËTy³Def
* 
hdma2d
)

371 
	`UNUSED
(
hdma2d
);

376 
	}
}

429 
HAL_StusTy³Def
 
	$HAL_DMA2D_S¹
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
pd©a
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
Width
, ušt32_ˆ
Height
)

432 
	`as£¹_·¿m
(
	`IS_DMA2D_LINE
(
Height
));

433 
	`as£¹_·¿m
(
	`IS_DMA2D_PIXEL
(
Width
));

436 
	`__HAL_LOCK
(
hdma2d
);

439 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

442 
	`DMA2D_S‘CÚfig
(
hdma2d
, 
pd©a
, 
D¡Add»ss
, 
Width
, 
Height
);

445 
	`__HAL_DMA2D_ENABLE
(
hdma2d
);

447  
HAL_OK
;

448 
	}
}

463 
HAL_StusTy³Def
 
	$HAL_DMA2D_S¹_IT
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
pd©a
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
Width
, ušt32_ˆ
Height
)

466 
	`as£¹_·¿m
(
	`IS_DMA2D_LINE
(
Height
));

467 
	`as£¹_·¿m
(
	`IS_DMA2D_PIXEL
(
Width
));

470 
	`__HAL_LOCK
(
hdma2d
);

473 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

476 
	`DMA2D_S‘CÚfig
(
hdma2d
, 
pd©a
, 
D¡Add»ss
, 
Width
, 
Height
);

479 
	`__HAL_DMA2D_ENABLE_IT
(
hdma2d
, 
DMA2D_IT_TC
|
DMA2D_IT_TE
|
DMA2D_IT_CE
);

482 
	`__HAL_DMA2D_ENABLE
(
hdma2d
);

484  
HAL_OK
;

485 
	}
}

498 
HAL_StusTy³Def
 
	$HAL_DMA2D_BËndšgS¹
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
SrcAdd»ss1
, ušt32_ˆ
SrcAdd»ss2
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
Width
, ušt32_ˆ
Height
)

501 
	`as£¹_·¿m
(
	`IS_DMA2D_LINE
(
Height
));

502 
	`as£¹_·¿m
(
	`IS_DMA2D_PIXEL
(
Width
));

505 
	`__HAL_LOCK
(
hdma2d
);

508 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

511 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
BGMAR
, 
SrcAdd»ss2
);

514 
	`DMA2D_S‘CÚfig
(
hdma2d
, 
SrcAdd»ss1
, 
D¡Add»ss
, 
Width
, 
Height
);

517 
	`__HAL_DMA2D_ENABLE
(
hdma2d
);

519  
HAL_OK
;

520 
	}
}

533 
HAL_StusTy³Def
 
	$HAL_DMA2D_BËndšgS¹_IT
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
SrcAdd»ss1
, ušt32_ˆ
SrcAdd»ss2
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
Width
, ušt32_ˆ
Height
)

536 
	`as£¹_·¿m
(
	`IS_DMA2D_LINE
(
Height
));

537 
	`as£¹_·¿m
(
	`IS_DMA2D_PIXEL
(
Width
));

540 
	`__HAL_LOCK
(
hdma2d
);

543 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

546 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
BGMAR
, 
SrcAdd»ss2
);

549 
	`DMA2D_S‘CÚfig
(
hdma2d
, 
SrcAdd»ss1
, 
D¡Add»ss
, 
Width
, 
Height
);

552 
	`__HAL_DMA2D_ENABLE_IT
(
hdma2d
, 
DMA2D_IT_TC
|
DMA2D_IT_TE
|
DMA2D_IT_CE
);

555 
	`__HAL_DMA2D_ENABLE
(
hdma2d
);

557  
HAL_OK
;

558 
	}
}

566 
HAL_StusTy³Def
 
	$HAL_DMA2D_AbÜt
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

568 
ušt32_t
 
tick¡¬t
 = 0U;

574 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_ABORT
|
DMA2D_CR_START
, DMA2D_CR_ABORT);

577 
tick¡¬t
 = 
	`HAL_G‘Tick
();

580 (
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_START
è!ğ
RESET
)

582 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
DMA2D_TIMEOUT_ABORT
)

585 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TIMEOUT
;

588 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_TIMEOUT
;

591 
	`__HAL_UNLOCK
(
hdma2d
);

593  
HAL_TIMEOUT
;

598 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_TC
|
DMA2D_IT_TE
|
DMA2D_IT_CE
);

601 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

604 
	`__HAL_UNLOCK
(
hdma2d
);

606  
HAL_OK
;

607 
	}
}

615 
HAL_StusTy³Def
 
	$HAL_DMA2D_Su¥’d
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

617 
ušt32_t
 
tick¡¬t
 = 0U;

623 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_SUSP
|
DMA2D_CR_START
, DMA2D_CR_SUSP);

626 
tick¡¬t
 = 
	`HAL_G‘Tick
();

629 ((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_SUSP
) != DMA2D_CR_SUSP) \

630 && ((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_START
) == DMA2D_CR_START))

632 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
DMA2D_TIMEOUT_SUSPEND
)

635 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TIMEOUT
;

638 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_TIMEOUT
;

640  
HAL_TIMEOUT
;

645 ià((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_START
è!ğ
RESET
)

647 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_SUSPEND
;

653 
	`CLEAR_BIT
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_SUSP
);

656  
HAL_OK
;

657 
	}
}

665 
HAL_StusTy³Def
 
	$HAL_DMA2D_Resume
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

668 if((
hdma2d
->
In¡ªû
->
CR
 & (
DMA2D_CR_SUSP
 | 
DMA2D_CR_START
)) == (DMA2D_CR_SUSP | DMA2D_CR_START))

671 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

678 
	`CLEAR_BIT
(
hdma2d
->
In¡ªû
->
CR
, (
DMA2D_CR_SUSP
|
DMA2D_CR_START
));

680  
HAL_OK
;

681 
	}
}

692 
HAL_StusTy³Def
 
	$HAL_DMA2D_EÇbËCLUT
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
Lay”Idx
)

695 
	`as£¹_·¿m
(
	`IS_DMA2D_LAYER
(
Lay”Idx
));

698 
	`__HAL_LOCK
(
hdma2d
);

701 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

703 if(
Lay”Idx
 == 0U)

706 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
BGPFCCR
, 
DMA2D_BGPFCCR_START
);

711 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
FGPFCCR
, 
DMA2D_FGPFCCR_START
);

714  
HAL_OK
;

715 
	}
}

729 
HAL_StusTy³Def
 
	$HAL_DMA2D_CLUTLßd
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
DMA2D_CLUTCfgTy³Def
 
CLUTCfg
, 
ušt32_t
 
Lay”Idx
)

732 
	`as£¹_·¿m
(
	`IS_DMA2D_LAYER
(
Lay”Idx
));

733 
	`as£¹_·¿m
(
	`IS_DMA2D_CLUT_CM
(
CLUTCfg
.
CLUTCŞÜMode
));

734 
	`as£¹_·¿m
(
	`IS_DMA2D_CLUT_SIZE
(
CLUTCfg
.
Size
));

737 
	`__HAL_LOCK
(
hdma2d
);

740 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

743 if(
Lay”Idx
 == 0U)

746 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
BGCMAR
, (
ušt32_t
)
CLUTCfg
.
pCLUT
);

749 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
BGPFCCR
, (
DMA2D_BGPFCCR_CS
 | 
DMA2D_BGPFCCR_CCM
),

750 ((
CLUTCfg
.
Size
 << 
DMA2D_POSITION_BGPFCCR_CS
è| (CLUTCfg.
CLUTCŞÜMode
 << 
DMA2D_POSITION_BGPFCCR_CCM
)));

753 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
BGPFCCR
, 
DMA2D_BGPFCCR_START
);

759 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
FGCMAR
, (
ušt32_t
)
CLUTCfg
.
pCLUT
);

762 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
FGPFCCR
, (
DMA2D_FGPFCCR_CS
 | 
DMA2D_FGPFCCR_CCM
),

763 ((
CLUTCfg
.
Size
 << 
DMA2D_POSITION_BGPFCCR_CS
è| (CLUTCfg.
CLUTCŞÜMode
 << 
DMA2D_POSITION_FGPFCCR_CCM
)));

766 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
FGPFCCR
, 
DMA2D_FGPFCCR_START
);

769  
HAL_OK
;

770 
	}
}

783 
HAL_StusTy³Def
 
	$HAL_DMA2D_CLUTLßd_IT
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
DMA2D_CLUTCfgTy³Def
 
CLUTCfg
, 
ušt32_t
 
Lay”Idx
)

786 
	`as£¹_·¿m
(
	`IS_DMA2D_LAYER
(
Lay”Idx
));

787 
	`as£¹_·¿m
(
	`IS_DMA2D_CLUT_CM
(
CLUTCfg
.
CLUTCŞÜMode
));

788 
	`as£¹_·¿m
(
	`IS_DMA2D_CLUT_SIZE
(
CLUTCfg
.
Size
));

791 
	`__HAL_LOCK
(
hdma2d
);

794 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

797 if(
Lay”Idx
 == 0U)

800 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
BGCMAR
, (
ušt32_t
)
CLUTCfg
.
pCLUT
);

803 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
BGPFCCR
, (
DMA2D_BGPFCCR_CS
 | 
DMA2D_BGPFCCR_CCM
),

804 ((
CLUTCfg
.
Size
 << 
DMA2D_POSITION_BGPFCCR_CS
è| (CLUTCfg.
CLUTCŞÜMode
 << 
DMA2D_POSITION_BGPFCCR_CCM
)));

807 
	`__HAL_DMA2D_ENABLE_IT
(
hdma2d
, 
DMA2D_IT_CTC
 | 
DMA2D_IT_TE
 | 
DMA2D_IT_CE
 |
DMA2D_IT_CAE
);

810 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
BGPFCCR
, 
DMA2D_BGPFCCR_START
);

816 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
FGCMAR
, (
ušt32_t
)
CLUTCfg
.
pCLUT
);

819 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
FGPFCCR
, (
DMA2D_FGPFCCR_CS
 | 
DMA2D_FGPFCCR_CCM
),

820 ((
CLUTCfg
.
Size
 << 
DMA2D_POSITION_BGPFCCR_CS
è| (CLUTCfg.
CLUTCŞÜMode
 << 
DMA2D_POSITION_FGPFCCR_CCM
)));

823 
	`__HAL_DMA2D_ENABLE_IT
(
hdma2d
, 
DMA2D_IT_CTC
 | 
DMA2D_IT_TE
 | 
DMA2D_IT_CE
 |
DMA2D_IT_CAE
);

826 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
FGPFCCR
, 
DMA2D_FGPFCCR_START
);

829  
HAL_OK
;

830 
	}
}

841 
HAL_StusTy³Def
 
	$HAL_DMA2D_CLUTLßdšg_AbÜt
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
Lay”Idx
)

843 
ušt32_t
 
tick¡¬t
 = 0U;

844 
__IO
 
ušt32_t
 * 
»g
 = &(
hdma2d
->
In¡ªû
->
BGPFCCR
);

847 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_ABORT
);

850 if(
Lay”Idx
 == 1)

852 
»g
 = &(
hdma2d
->
In¡ªû
->
FGPFCCR
);

856 
tick¡¬t
 = 
	`HAL_G‘Tick
();

859 (*
»g
 & 
DMA2D_BGPFCCR_START
è!ğ
RESET
)

861 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
DMA2D_TIMEOUT_ABORT
)

864 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TIMEOUT
;

867 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_TIMEOUT
;

870 
	`__HAL_UNLOCK
(
hdma2d
);

872  
HAL_TIMEOUT
;

877 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_CTC
 | 
DMA2D_IT_TE
 | 
DMA2D_IT_CE
 |
DMA2D_IT_CAE
);

880 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

883 
	`__HAL_UNLOCK
(
hdma2d
);

885  
HAL_OK
;

886 
	}
}

897 
HAL_StusTy³Def
 
	$HAL_DMA2D_CLUTLßdšg_Su¥’d
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
Lay”Idx
)

899 
ušt32_t
 
tick¡¬t
 = 0U;

900 
__IO
 
ušt32_t
 * 
»g
 = &(
hdma2d
->
In¡ªû
->
BGPFCCR
);

903 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_SUSP
);

906 if(
Lay”Idx
 == 1U)

908 
»g
 = &(
hdma2d
->
In¡ªû
->
FGPFCCR
);

912 
tick¡¬t
 = 
	`HAL_G‘Tick
();

915 ((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_SUSP
) != DMA2D_CR_SUSP) \

916 && ((*
»g
 & 
DMA2D_BGPFCCR_START
) == DMA2D_BGPFCCR_START))

918 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
DMA2D_TIMEOUT_SUSPEND
)

921 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TIMEOUT
;

924 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_TIMEOUT
;

926  
HAL_TIMEOUT
;

931 ià((*
»g
 & 
DMA2D_BGPFCCR_START
è!ğ
RESET
)

933 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_SUSPEND
;

939 
	`CLEAR_BIT
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_SUSP
);

942  
HAL_OK
;

943 
	}
}

954 
HAL_StusTy³Def
 
	$HAL_DMA2D_CLUTLßdšg_Resume
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
Lay”Idx
)

957 if(
Lay”Idx
 == 0U)

960 ià(((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_SUSP
) == DMA2D_CR_SUSP)

961 && ((
hdma2d
->
In¡ªû
->
BGPFCCR
 & 
DMA2D_BGPFCCR_START
) == DMA2D_BGPFCCR_START))

964 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

970 ià(((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_SUSP
) == DMA2D_CR_SUSP)

971 && ((
hdma2d
->
In¡ªû
->
FGPFCCR
 & 
DMA2D_FGPFCCR_START
) == DMA2D_FGPFCCR_START))

974 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

979 
	`CLEAR_BIT
(
hdma2d
->
In¡ªû
->
CR
, 
DMA2D_CR_SUSP
);

981  
HAL_OK
;

982 
	}
}

991 
HAL_StusTy³Def
 
	$HAL_DMA2D_PŞlFÜT¿nsãr
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
Timeout
)

993 
ušt32_t
 
tick¡¬t
 = 0U;

994 
__IO
 
ušt32_t
 
i¤æags
 = 0x0U;

997 if((
hdma2d
->
In¡ªû
->
CR
 & 
DMA2D_CR_START
è!ğ
RESET
)

1000 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1002 
	`__HAL_DMA2D_GET_FLAG
(
hdma2d
, 
DMA2D_FLAG_TC
è=ğ
RESET
)

1004 
i¤æags
 = 
	`READ_REG
(
hdma2d
->
In¡ªû
->
ISR
);

1005 ià((
i¤æags
 & (
DMA2D_FLAG_CE
|
DMA2D_FLAG_TE
)è!ğ
RESET
)

1007 ià((
i¤æags
 & 
DMA2D_FLAG_CE
è!ğ
RESET
)

1009 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_CE
;

1011 ià((
i¤æags
 & 
DMA2D_FLAG_TE
è!ğ
RESET
)

1013 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TE
;

1016 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_CE
 | 
DMA2D_FLAG_TE
);

1019 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_ERROR
;

1022 
	`__HAL_UNLOCK
(
hdma2d
);

1024  
HAL_ERROR
;

1027 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1029 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

1032 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TIMEOUT
;

1035 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_TIMEOUT
;

1038 
	`__HAL_UNLOCK
(
hdma2d
);

1040  
HAL_TIMEOUT
;

1046 ià(((
hdma2d
->
In¡ªû
->
FGPFCCR
 & 
DMA2D_FGPFCCR_START
è!ğ
RESET
) ||

1047 ((
hdma2d
->
In¡ªû
->
BGPFCCR
 & 
DMA2D_BGPFCCR_START
è!ğ
RESET
))

1050 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1052 
	`__HAL_DMA2D_GET_FLAG
(
hdma2d
, 
DMA2D_FLAG_CTC
è=ğ
RESET
)

1054 
i¤æags
 = 
	`READ_REG
(
hdma2d
->
In¡ªû
->
ISR
);

1055 ià((
i¤æags
 & (
DMA2D_FLAG_CAE
|
DMA2D_FLAG_CE
|
DMA2D_FLAG_TE
)è!ğ
RESET
)

1057 ià((
i¤æags
 & 
DMA2D_FLAG_CAE
è!ğ
RESET
)

1059 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_CAE
;

1061 ià((
i¤æags
 & 
DMA2D_FLAG_CE
è!ğ
RESET
)

1063 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_CE
;

1065 ià((
i¤æags
 & 
DMA2D_FLAG_TE
è!ğ
RESET
)

1067 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TE
;

1070 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_CAE
 | 
DMA2D_FLAG_CE
 | 
DMA2D_FLAG_TE
);

1073 
hdma2d
->
S‹
ğ
HAL_DMA2D_STATE_ERROR
;

1076 
	`__HAL_UNLOCK
(
hdma2d
);

1078  
HAL_ERROR
;

1081 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1083 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

1086 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TIMEOUT
;

1089 
hdma2d
->
S‹
ğ
HAL_DMA2D_STATE_TIMEOUT
;

1092 
	`__HAL_UNLOCK
(
hdma2d
);

1094  
HAL_TIMEOUT
;

1101 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_TC
|
DMA2D_FLAG_CTC
);

1104 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1107 
	`__HAL_UNLOCK
(
hdma2d
);

1109  
HAL_OK
;

1110 
	}
}

1117 
	$HAL_DMA2D_IRQHªdËr
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

1119 
ušt32_t
 
i¤æags
 = 
	`READ_REG
(
hdma2d
->
In¡ªû
->
ISR
);

1120 
ušt32_t
 
üæags
 = 
	`READ_REG
(
hdma2d
->
In¡ªû
->
CR
);

1123 ià((
i¤æags
 & 
DMA2D_FLAG_TE
è!ğ
RESET
)

1125 ià((
üæags
 & 
DMA2D_IT_TE
è!ğ
RESET
)

1128 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_TE
);

1131 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_TE
;

1134 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_TE
);

1137 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_ERROR
;

1140 
	`__HAL_UNLOCK
(
hdma2d
);

1142 if(
hdma2d
->
XãrE¼ÜC®lback
 !ğ
NULL
)

1145 
hdma2d
->
	`XãrE¼ÜC®lback
(hdma2d);

1150 ià((
i¤æags
 & 
DMA2D_FLAG_CE
è!ğ
RESET
)

1152 ià((
üæags
 & 
DMA2D_IT_CE
è!ğ
RESET
)

1155 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_CE
);

1158 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_CE
);

1161 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_CE
;

1164 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_ERROR
;

1167 
	`__HAL_UNLOCK
(
hdma2d
);

1169 if(
hdma2d
->
XãrE¼ÜC®lback
 !ğ
NULL
)

1172 
hdma2d
->
	`XãrE¼ÜC®lback
(hdma2d);

1177 ià((
i¤æags
 & 
DMA2D_FLAG_CAE
è!ğ
RESET
)

1179 ià((
üæags
 & 
DMA2D_IT_CAE
è!ğ
RESET
)

1182 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_CAE
);

1185 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_CAE
);

1188 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_CAE
;

1191 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_ERROR
;

1194 
	`__HAL_UNLOCK
(
hdma2d
);

1196 if(
hdma2d
->
XãrE¼ÜC®lback
 !ğ
NULL
)

1199 
hdma2d
->
	`XãrE¼ÜC®lback
(hdma2d);

1204 ià((
i¤æags
 & 
DMA2D_FLAG_TW
è!ğ
RESET
)

1206 ià((
üæags
 & 
DMA2D_IT_TW
è!ğ
RESET
)

1209 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_TW
);

1212 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_TW
);

1215 
	`HAL_DMA2D_LšeEv’tC®lback
(
hdma2d
);

1219 ià((
i¤æags
 & 
DMA2D_FLAG_TC
è!ğ
RESET
)

1221 ià((
üæags
 & 
DMA2D_IT_TC
è!ğ
RESET
)

1224 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_TC
);

1227 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_TC
);

1230 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_NONE
;

1233 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1236 
	`__HAL_UNLOCK
(
hdma2d
);

1238 if(
hdma2d
->
XãrC¶tC®lback
 !ğ
NULL
)

1241 
hdma2d
->
	`XãrC¶tC®lback
(hdma2d);

1246 ià((
i¤æags
 & 
DMA2D_FLAG_CTC
è!ğ
RESET
)

1248 ià((
üæags
 & 
DMA2D_IT_CTC
è!ğ
RESET
)

1251 
	`__HAL_DMA2D_DISABLE_IT
(
hdma2d
, 
DMA2D_IT_CTC
);

1254 
	`__HAL_DMA2D_CLEAR_FLAG
(
hdma2d
, 
DMA2D_FLAG_CTC
);

1257 
hdma2d
->
E¼ÜCode
 |ğ
HAL_DMA2D_ERROR_NONE
;

1260 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1263 
	`__HAL_UNLOCK
(
hdma2d
);

1266 
	`HAL_DMA2D_CLUTLßdšgC¶tC®lback
(
hdma2d
);

1269 
	}
}

1277 
__w—k
 
	$HAL_DMA2D_LšeEv’tC®lback
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

1280 
	`UNUSED
(
hdma2d
);

1285 
	}
}

1293 
__w—k
 
	$HAL_DMA2D_CLUTLßdšgC¶tC®lback
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

1296 
	`UNUSED
(
hdma2d
);

1301 
	}
}

1335 
HAL_StusTy³Def
 
	$HAL_DMA2D_CÚfigLay”
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
Lay”Idx
)

1337 
DMA2D_Lay”CfgTy³Def
 *
pLay”Cfg
 = &
hdma2d
->
Lay”Cfg
[
Lay”Idx
];

1338 
ušt32_t
 
»gV®ue
 = 0U;

1341 
	`as£¹_·¿m
(
	`IS_DMA2D_LAYER
(
Lay”Idx
));

1342 
	`as£¹_·¿m
(
	`IS_DMA2D_OFFSET
(
pLay”Cfg
->
IÅutOff£t
));

1343 if(
hdma2d
->
In™
.
Mode
 !ğ
DMA2D_R2M
)

1345 
	`as£¹_·¿m
(
	`IS_DMA2D_INPUT_COLOR_MODE
(
pLay”Cfg
->
IÅutCŞÜMode
));

1346 if(
hdma2d
->
In™
.
Mode
 !ğ
DMA2D_M2M
)

1348 
	`as£¹_·¿m
(
	`IS_DMA2D_ALPHA_MODE
(
pLay”Cfg
->
AÍhaMode
));

1353 
	`__HAL_LOCK
(
hdma2d
);

1356 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

1361 ià((
pLay”Cfg
->
IÅutCŞÜMode
 =ğ
DMA2D_INPUT_A4
è|| (pLay”Cfg->IÅutCŞÜMod=ğ
DMA2D_INPUT_A8
))

1363 
»gV®ue
 = 
pLay”Cfg
->
IÅutCŞÜMode
 | (pLay”Cfg->
AÍhaMode
 << 
DMA2D_POSITION_BGPFCCR_AM
è| (pLay”Cfg->
IÅutAÍha
 & 
DMA2D_BGPFCCR_ALPHA
);

1367 
»gV®ue
 = 
pLay”Cfg
->
IÅutCŞÜMode
 | (pLay”Cfg->
AÍhaMode
 << 
DMA2D_POSITION_BGPFCCR_AM
è| (pLay”Cfg->
IÅutAÍha
 << 
DMA2D_POSITION_BGPFCCR_ALPHA
);

1371 if(
Lay”Idx
 == 0)

1374 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
BGPFCCR
, (
DMA2D_BGPFCCR_CM
 | 
DMA2D_BGPFCCR_AM
 | 
DMA2D_BGPFCCR_ALPHA
), 
»gV®ue
);

1377 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
BGOR
, 
pLay”Cfg
->
IÅutOff£t
);

1380 ià((
pLay”Cfg
->
IÅutCŞÜMode
 =ğ
DMA2D_INPUT_A4
è|| (pLay”Cfg->IÅutCŞÜMod=ğ
DMA2D_INPUT_A8
))

1382 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
BGCOLR
, 
pLay”Cfg
->
IÅutAÍha
 & (
DMA2D_BGCOLR_BLUE
|
DMA2D_BGCOLR_GREEN
|
DMA2D_BGCOLR_RED
));

1389 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
FGPFCCR
, (
DMA2D_BGPFCCR_CM
 | 
DMA2D_BGPFCCR_AM
 | 
DMA2D_BGPFCCR_ALPHA
), 
»gV®ue
);

1392 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
FGOR
, 
pLay”Cfg
->
IÅutOff£t
);

1395 ià((
pLay”Cfg
->
IÅutCŞÜMode
 =ğ
DMA2D_INPUT_A4
è|| (pLay”Cfg->IÅutCŞÜMod=ğ
DMA2D_INPUT_A8
))

1397 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
FGCOLR
, 
pLay”Cfg
->
IÅutAÍha
 & (
DMA2D_FGCOLR_BLUE
|
DMA2D_FGCOLR_GREEN
|
DMA2D_FGCOLR_RED
));

1401 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1404 
	`__HAL_UNLOCK
(
hdma2d
);

1406  
HAL_OK
;

1407 
	}
}

1420 
HAL_StusTy³Def
 
	$HAL_DMA2D_CÚfigCLUT
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
DMA2D_CLUTCfgTy³Def
 
CLUTCfg
, 
ušt32_t
 
Lay”Idx
)

1423 
	`as£¹_·¿m
(
	`IS_DMA2D_LAYER
(
Lay”Idx
));

1424 
	`as£¹_·¿m
(
	`IS_DMA2D_CLUT_CM
(
CLUTCfg
.
CLUTCŞÜMode
));

1425 
	`as£¹_·¿m
(
	`IS_DMA2D_CLUT_SIZE
(
CLUTCfg
.
Size
));

1428 
	`__HAL_LOCK
(
hdma2d
);

1431 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

1434 if(
Lay”Idx
 == 0U)

1437 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
BGCMAR
, (
ušt32_t
)
CLUTCfg
.
pCLUT
);

1440 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
BGPFCCR
, (
DMA2D_BGPFCCR_CS
 | 
DMA2D_BGPFCCR_CCM
),

1441 ((
CLUTCfg
.
Size
 << 
DMA2D_POSITION_BGPFCCR_CS
è| (CLUTCfg.
CLUTCŞÜMode
 << 
DMA2D_POSITION_BGPFCCR_CCM
)));

1447 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
FGCMAR
, (
ušt32_t
)
CLUTCfg
.
pCLUT
);

1450 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
FGPFCCR
, (
DMA2D_FGPFCCR_CS
 | 
DMA2D_FGPFCCR_CCM
),

1451 ((
CLUTCfg
.
Size
 << 
DMA2D_POSITION_BGPFCCR_CS
è| (CLUTCfg.
CLUTCŞÜMode
 << 
DMA2D_POSITION_FGPFCCR_CCM
)));

1455 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1458 
	`__HAL_UNLOCK
(
hdma2d
);

1460  
HAL_OK
;

1461 
	}
}

1473 
HAL_StusTy³Def
 
	$HAL_DMA2D_Prog¿mLšeEv’t
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
Lše
)

1476 
	`as£¹_·¿m
(
	`IS_DMA2D_LINEWATERMARK
(
Lše
));

1478 ià(
Lše
 > 
DMA2D_LWR_LW
)

1480  
HAL_ERROR
;

1485 
	`__HAL_LOCK
(
hdma2d
);

1488 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

1491 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
LWR
, 
Lše
);

1494 
	`__HAL_DMA2D_ENABLE_IT
(
hdma2d
, 
DMA2D_IT_TW
);

1497 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1500 
	`__HAL_UNLOCK
(
hdma2d
);

1502  
HAL_OK
;

1504 
	}
}

1511 
HAL_StusTy³Def
 
	$HAL_DMA2D_EÇbËD—dTime
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

1514 
	`__HAL_LOCK
(
hdma2d
);

1516 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

1519 
	`SET_BIT
(
hdma2d
->
In¡ªû
->
AMTCR
, 
DMA2D_AMTCR_EN
);

1521 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1524 
	`__HAL_UNLOCK
(
hdma2d
);

1526  
HAL_OK
;

1527 
	}
}

1534 
HAL_StusTy³Def
 
	$HAL_DMA2D_Di§bËD—dTime
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

1537 
	`__HAL_LOCK
(
hdma2d
);

1539 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

1542 
	`CLEAR_BIT
(
hdma2d
->
In¡ªû
->
AMTCR
, 
DMA2D_AMTCR_EN
);

1544 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1547 
	`__HAL_UNLOCK
(
hdma2d
);

1549  
HAL_OK
;

1550 
	}
}

1560 
HAL_StusTy³Def
 
	$HAL_DMA2D_CÚfigD—dTime
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt8_t
 
D—dTime
)

1563 
	`__HAL_LOCK
(
hdma2d
);

1565 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_BUSY
;

1568 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
AMTCR
, 
DMA2D_AMTCR_DT
, (((
ušt32_t
è
D—dTime
è<< 
DMA2D_POSITION_AMTCR_DT
));

1570 
hdma2d
->
S‹
 = 
HAL_DMA2D_STATE_READY
;

1573 
	`__HAL_UNLOCK
(
hdma2d
);

1575  
HAL_OK
;

1576 
	}
}

1604 
HAL_DMA2D_S‹Ty³Def
 
	$HAL_DMA2D_G‘S‹
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

1606  
hdma2d
->
S‹
;

1607 
	}
}

1615 
ušt32_t
 
	$HAL_DMA2D_G‘E¼Ü
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

1617  
hdma2d
->
E¼ÜCode
;

1618 
	}
}

1642 
	$DMA2D_S‘CÚfig
(
DMA2D_HªdËTy³Def
 *
hdma2d
, 
ušt32_t
 
pd©a
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
Width
, ušt32_ˆ
Height
)

1644 
ušt32_t
 
tmp
 = 0U;

1645 
ušt32_t
 
tmp1
 = 0U;

1646 
ušt32_t
 
tmp2
 = 0U;

1647 
ušt32_t
 
tmp3
 = 0U;

1648 
ušt32_t
 
tmp4
 = 0U;

1651 
	`MODIFY_REG
(
hdma2d
->
In¡ªû
->
NLR
, (
DMA2D_NLR_NL
|
DMA2D_NLR_PL
), (
Height
| (
Width
 << 
DMA2D_POSITION_NLR_PL
)));

1654 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
OMAR
, 
D¡Add»ss
);

1657 ià(
hdma2d
->
In™
.
Mode
 =ğ
DMA2D_R2M
)

1659 
tmp1
 = 
pd©a
 & 
DMA2D_OCOLR_ALPHA_1
;

1660 
tmp2
 = 
pd©a
 & 
DMA2D_OCOLR_RED_1
;

1661 
tmp3
 = 
pd©a
 & 
DMA2D_OCOLR_GREEN_1
;

1662 
tmp4
 = 
pd©a
 & 
DMA2D_OCOLR_BLUE_1
;

1665 ià(
hdma2d
->
In™
.
CŞÜMode
 =ğ
DMA2D_OUTPUT_ARGB8888
)

1667 
tmp
 = (
tmp3
 | 
tmp2
 | 
tmp1
| 
tmp4
);

1669 ià(
hdma2d
->
In™
.
CŞÜMode
 =ğ
DMA2D_OUTPUT_RGB888
)

1671 
tmp
 = (
tmp3
 | 
tmp2
 | 
tmp4
);

1673 ià(
hdma2d
->
In™
.
CŞÜMode
 =ğ
DMA2D_OUTPUT_RGB565
)

1675 
tmp2
 = (tmp2 >> 19U);

1676 
tmp3
 = (tmp3 >> 10U);

1677 
tmp4
 = (tmp4 >> 3U);

1678 
tmp
 = ((
tmp3
 << 5Uè| (
tmp2
 << 11Uè| 
tmp4
);

1680 ià(
hdma2d
->
In™
.
CŞÜMode
 =ğ
DMA2D_OUTPUT_ARGB1555
)

1682 
tmp1
 = (tmp1 >> 31U);

1683 
tmp2
 = (tmp2 >> 19U);

1684 
tmp3
 = (tmp3 >> 11U);

1685 
tmp4
 = (tmp4 >> 3U);

1686 
tmp
 = ((
tmp3
 << 5Uè| (
tmp2
 << 10Uè| (
tmp1
 << 15Uè| 
tmp4
);

1690 
tmp1
 = (tmp1 >> 28U);

1691 
tmp2
 = (tmp2 >> 20U);

1692 
tmp3
 = (tmp3 >> 12U);

1693 
tmp4
 = (tmp4 >> 4U);

1694 
tmp
 = ((
tmp3
 << 4Uè| (
tmp2
 << 8Uè| (
tmp1
 << 12Uè| 
tmp4
);

1697 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
OCOLR
, 
tmp
);

1702 
	`WRITE_REG
(
hdma2d
->
In¡ªû
->
FGMAR
, 
pd©a
);

1704 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_dma_ex.c

58 
	~"¡m32f4xx_h®.h
"

69 #ifdeà
HAL_DMA_MODULE_ENABLED


79 
DMA_MuÉiBufãrS‘CÚfig
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
D©aL’gth
);

119 
HAL_StusTy³Def
 
	$HAL_DMAEx_MuÉiBufãrS¹
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
SecÚdMemAdd»ss
, ušt32_ˆ
D©aL’gth
)

121 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

124 
	`as£¹_·¿m
(
	`IS_DMA_BUFFER_SIZE
(
D©aL’gth
));

127 ià(
hdma
->
In™
.
DœeùiÚ
 =ğ
DMA_MEMORY_TO_MEMORY
)

129 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NOT_SUPPORTED
;

130 
¡©us
 = 
HAL_ERROR
;

135 
	`__HAL_LOCK
(
hdma
);

137 if(
HAL_DMA_STATE_READY
 =ğ
hdma
->
S‹
)

140 
hdma
->
S‹
 = 
HAL_DMA_STATE_BUSY
;

143 
hdma
->
In¡ªû
->
CR
 |ğ(
ušt32_t
)
DMA_SxCR_DBM
;

146 
hdma
->
In¡ªû
->
M1AR
 = 
SecÚdMemAdd»ss
;

149 
	`DMA_MuÉiBufãrS‘CÚfig
(
hdma
, 
SrcAdd»ss
, 
D¡Add»ss
, 
D©aL’gth
);

152 
	`__HAL_DMA_ENABLE
(
hdma
);

157 
¡©us
 = 
HAL_BUSY
;

160  
¡©us
;

161 
	}
}

173 
HAL_StusTy³Def
 
	$HAL_DMAEx_MuÉiBufãrS¹_IT
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
SecÚdMemAdd»ss
, ušt32_ˆ
D©aL’gth
)

175 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

178 
	`as£¹_·¿m
(
	`IS_DMA_BUFFER_SIZE
(
D©aL’gth
));

181 ià(
hdma
->
In™
.
DœeùiÚ
 =ğ
DMA_MEMORY_TO_MEMORY
)

183 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NOT_SUPPORTED
;

184  
HAL_ERROR
;

188 ià((
NULL
 =ğ
hdma
->
XãrC¶tC®lback
è|| (NULL =ğhdma->
XãrM1C¶tC®lback
è|| (NULL =ğhdma->
XãrE¼ÜC®lback
))

190 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_PARAM
;

191  
HAL_ERROR
;

195 
	`__HAL_LOCK
(
hdma
);

197 if(
HAL_DMA_STATE_READY
 =ğ
hdma
->
S‹
)

200 
hdma
->
S‹
 = 
HAL_DMA_STATE_BUSY
;

203 
hdma
->
E¼ÜCode
 = 
HAL_DMA_ERROR_NONE
;

206 
hdma
->
In¡ªû
->
CR
 |ğ(
ušt32_t
)
DMA_SxCR_DBM
;

209 
hdma
->
In¡ªû
->
M1AR
 = 
SecÚdMemAdd»ss
;

212 
	`DMA_MuÉiBufãrS‘CÚfig
(
hdma
, 
SrcAdd»ss
, 
D¡Add»ss
, 
D©aL’gth
);

215 
	`__HAL_DMA_CLEAR_FLAG
 (
hdma
, 
	`__HAL_DMA_GET_TC_FLAG_INDEX
(hdma));

216 
	`__HAL_DMA_CLEAR_FLAG
 (
hdma
, 
	`__HAL_DMA_GET_HT_FLAG_INDEX
(hdma));

217 
	`__HAL_DMA_CLEAR_FLAG
 (
hdma
, 
	`__HAL_DMA_GET_TE_FLAG_INDEX
(hdma));

218 
	`__HAL_DMA_CLEAR_FLAG
 (
hdma
, 
	`__HAL_DMA_GET_DME_FLAG_INDEX
(hdma));

219 
	`__HAL_DMA_CLEAR_FLAG
 (
hdma
, 
	`__HAL_DMA_GET_FE_FLAG_INDEX
(hdma));

222 
hdma
->
In¡ªû
->
CR
 |ğ
DMA_IT_TC
 | 
DMA_IT_TE
 | 
DMA_IT_DME
;

223 
hdma
->
In¡ªû
->
FCR
 |ğ
DMA_IT_FE
;

225 if((
hdma
->
XãrH®fC¶tC®lback
 !ğ
NULL
è|| (hdma->
XãrM1H®fC¶tC®lback
 != NULL))

227 
hdma
->
In¡ªû
->
CR
 |ğ
DMA_IT_HT
;

231 
	`__HAL_DMA_ENABLE
(
hdma
);

236 
	`__HAL_UNLOCK
(
hdma
);

239 
¡©us
 = 
HAL_BUSY
;

241  
¡©us
;

242 
	}
}

258 
HAL_StusTy³Def
 
	$HAL_DMAEx_ChªgeMemÜy
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
Add»ss
, 
HAL_DMA_MemÜyTy³Def
 
memÜy
)

260 if(
memÜy
 =ğ
MEMORY0
)

263 
hdma
->
In¡ªû
->
M0AR
 = 
Add»ss
;

268 
hdma
->
In¡ªû
->
M1AR
 = 
Add»ss
;

271  
HAL_OK
;

272 
	}
}

295 
	$DMA_MuÉiBufãrS‘CÚfig
(
DMA_HªdËTy³Def
 *
hdma
, 
ušt32_t
 
SrcAdd»ss
, ušt32_ˆ
D¡Add»ss
, ušt32_ˆ
D©aL’gth
)

298 
hdma
->
In¡ªû
->
NDTR
 = 
D©aL’gth
;

301 if((
hdma
->
In™
.
DœeùiÚ
è=ğ
DMA_MEMORY_TO_PERIPH
)

304 
hdma
->
In¡ªû
->
PAR
 = 
D¡Add»ss
;

307 
hdma
->
In¡ªû
->
M0AR
 = 
SrcAdd»ss
;

313 
hdma
->
In¡ªû
->
PAR
 = 
SrcAdd»ss
;

316 
hdma
->
In¡ªû
->
M0AR
 = 
D¡Add»ss
;

318 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_gpio.c

126 
	~"¡m32f4xx_h®.h
"

137 #ifdeà
HAL_GPIO_MODULE_ENABLED


144 
	#GPIO_MODE
 ((
ušt32_t
)0x00000003U)

	)

145 
	#EXTI_MODE
 ((
ušt32_t
)0x10000000U)

	)

146 
	#GPIO_MODE_IT
 ((
ušt32_t
)0x00010000U)

	)

147 
	#GPIO_MODE_EVT
 ((
ušt32_t
)0x00020000U)

	)

148 
	#RISING_EDGE
 ((
ušt32_t
)0x00100000U)

	)

149 
	#FALLING_EDGE
 ((
ušt32_t
)0x00200000U)

	)

150 
	#GPIO_OUTPUT_TYPE
 ((
ušt32_t
)0x00000010U)

	)

152 
	#GPIO_NUMBER
 ((
ušt32_t
)16U)

	)

189 
	$HAL_GPIO_In™
(
GPIO_Ty³Def
 *
GPIOx
, 
GPIO_In™Ty³Def
 *
GPIO_In™
)

191 
ušt32_t
 
pos™iÚ
;

192 
ušt32_t
 
iİos™iÚ
 = 0x00U;

193 
ušt32_t
 
iocu¼’t
 = 0x00U;

194 
ušt32_t
 
‹mp
 = 0x00U;

197 
	`as£¹_·¿m
(
	`IS_GPIO_ALL_INSTANCE
(
GPIOx
));

198 
	`as£¹_·¿m
(
	`IS_GPIO_PIN
(
GPIO_In™
->
Pš
));

199 
	`as£¹_·¿m
(
	`IS_GPIO_MODE
(
GPIO_In™
->
Mode
));

200 
	`as£¹_·¿m
(
	`IS_GPIO_PULL
(
GPIO_In™
->
PuÎ
));

203 
pos™iÚ
 = 0U;…os™iÚ < 
GPIO_NUMBER
;…osition++)

206 
iİos™iÚ
 = ((
ušt32_t
)0x01Uè<< 
pos™iÚ
;

208 
iocu¼’t
 = (
ušt32_t
)(
GPIO_In™
->
Pš
è& 
iİos™iÚ
;

210 if(
iocu¼’t
 =ğ
iİos™iÚ
)

214 if((
GPIO_In™
->
Mode
 =ğ
GPIO_MODE_AF_PP
è|| (GPIO_In™->Mod=ğ
GPIO_MODE_AF_OD
))

217 
	`as£¹_·¿m
(
	`IS_GPIO_AF
(
GPIO_In™
->
AÉ”Ç‹
));

219 
‹mp
 = 
GPIOx
->
AFR
[
pos™iÚ
 >> 3U];

220 
‹mp
 &ğ~((
ušt32_t
)0xFU << ((ušt32_t)(
pos™iÚ
 & (uint32_t)0x07U) * 4U)) ;

221 
‹mp
 |ğ((
ušt32_t
)(
GPIO_In™
->
AÉ”Ç‹
è<< (((ušt32_t)
pos™iÚ
 & (uint32_t)0x07U) * 4U));

222 
GPIOx
->
AFR
[
pos™iÚ
 >> 3U] = 
‹mp
;

226 
‹mp
 = 
GPIOx
->
MODER
;

227 
‹mp
 &ğ~(
GPIO_MODER_MODER0
 << (
pos™iÚ
 * 2U));

228 
‹mp
 |ğ((
GPIO_In™
->
Mode
 & 
GPIO_MODE
è<< (
pos™iÚ
 * 2U));

229 
GPIOx
->
MODER
 = 
‹mp
;

232 if((
GPIO_In™
->
Mode
 =ğ
GPIO_MODE_OUTPUT_PP
è|| (GPIO_In™->Mod=ğ
GPIO_MODE_AF_PP
) ||

233 (
GPIO_In™
->
Mode
 =ğ
GPIO_MODE_OUTPUT_OD
è|| (GPIO_In™->Mod=ğ
GPIO_MODE_AF_OD
))

236 
	`as£¹_·¿m
(
	`IS_GPIO_SPEED
(
GPIO_In™
->
S³ed
));

238 
‹mp
 = 
GPIOx
->
OSPEEDR
;

239 
‹mp
 &ğ~(
GPIO_OSPEEDER_OSPEEDR0
 << (
pos™iÚ
 * 2U));

240 
‹mp
 |ğ(
GPIO_In™
->
S³ed
 << (
pos™iÚ
 * 2U));

241 
GPIOx
->
OSPEEDR
 = 
‹mp
;

244 
‹mp
 = 
GPIOx
->
OTYPER
;

245 
‹mp
 &ğ~(
GPIO_OTYPER_OT_0
 << 
pos™iÚ
) ;

246 
‹mp
 |ğ(((
GPIO_In™
->
Mode
 & 
GPIO_OUTPUT_TYPE
è>> 4Uè<< 
pos™iÚ
);

247 
GPIOx
->
OTYPER
 = 
‹mp
;

251 
‹mp
 = 
GPIOx
->
PUPDR
;

252 
‹mp
 &ğ~(
GPIO_PUPDR_PUPDR0
 << (
pos™iÚ
 * 2U));

253 
‹mp
 |ğ((
GPIO_In™
->
PuÎ
è<< (
pos™iÚ
 * 2U));

254 
GPIOx
->
PUPDR
 = 
‹mp
;

258 if((
GPIO_In™
->
Mode
 & 
EXTI_MODE
) == EXTI_MODE)

261 
	`__HAL_RCC_SYSCFG_CLK_ENABLE
();

263 
‹mp
 = 
SYSCFG
->
EXTICR
[
pos™iÚ
 >> 2U];

264 
‹mp
 &ğ~(((
ušt32_t
)0x0FUè<< (4U * (
pos™iÚ
 & 0x03U)));

265 
‹mp
 |ğ((
ušt32_t
)(
	`GPIO_GET_INDEX
(
GPIOx
)è<< (4U * (
pos™iÚ
 & 0x03U)));

266 
SYSCFG
->
EXTICR
[
pos™iÚ
 >> 2U] = 
‹mp
;

269 
‹mp
 = 
EXTI
->
IMR
;

270 
‹mp
 &ğ~((
ušt32_t
)
iocu¼’t
);

271 if((
GPIO_In™
->
Mode
 & 
GPIO_MODE_IT
) == GPIO_MODE_IT)

273 
‹mp
 |ğ
iocu¼’t
;

275 
EXTI
->
IMR
 = 
‹mp
;

277 
‹mp
 = 
EXTI
->
EMR
;

278 
‹mp
 &ğ~((
ušt32_t
)
iocu¼’t
);

279 if((
GPIO_In™
->
Mode
 & 
GPIO_MODE_EVT
) == GPIO_MODE_EVT)

281 
‹mp
 |ğ
iocu¼’t
;

283 
EXTI
->
EMR
 = 
‹mp
;

286 
‹mp
 = 
EXTI
->
RTSR
;

287 
‹mp
 &ğ~((
ušt32_t
)
iocu¼’t
);

288 if((
GPIO_In™
->
Mode
 & 
RISING_EDGE
) == RISING_EDGE)

290 
‹mp
 |ğ
iocu¼’t
;

292 
EXTI
->
RTSR
 = 
‹mp
;

294 
‹mp
 = 
EXTI
->
FTSR
;

295 
‹mp
 &ğ~((
ušt32_t
)
iocu¼’t
);

296 if((
GPIO_In™
->
Mode
 & 
FALLING_EDGE
) == FALLING_EDGE)

298 
‹mp
 |ğ
iocu¼’t
;

300 
EXTI
->
FTSR
 = 
‹mp
;

304 
	}
}

314 
	$HAL_GPIO_DeIn™
(
GPIO_Ty³Def
 *
GPIOx
, 
ušt32_t
 
GPIO_Pš
)

316 
ušt32_t
 
pos™iÚ
;

317 
ušt32_t
 
iİos™iÚ
 = 0x00U;

318 
ušt32_t
 
iocu¼’t
 = 0x00U;

319 
ušt32_t
 
tmp
 = 0x00U;

322 
	`as£¹_·¿m
(
	`IS_GPIO_ALL_INSTANCE
(
GPIOx
));

325 
pos™iÚ
 = 0U;…os™iÚ < 
GPIO_NUMBER
;…osition++)

328 
iİos™iÚ
 = ((
ušt32_t
)0x01Uè<< 
pos™iÚ
;

330 
iocu¼’t
 = (
GPIO_Pš
è& 
iİos™iÚ
;

332 if(
iocu¼’t
 =ğ
iİos™iÚ
)

336 
GPIOx
->
MODER
 &ğ~(
GPIO_MODER_MODER0
 << (
pos™iÚ
 * 2U));

339 
GPIOx
->
AFR
[
pos™iÚ
 >> 3U] &ğ~((
ušt32_t
)0xFU << ((uint32_t)(position & (uint32_t)0x07U) * 4U)) ;

342 
GPIOx
->
OSPEEDR
 &ğ~(
GPIO_OSPEEDER_OSPEEDR0
 << (
pos™iÚ
 * 2U));

345 
GPIOx
->
OTYPER
 &ğ~(
GPIO_OTYPER_OT_0
 << 
pos™iÚ
) ;

348 
GPIOx
->
PUPDR
 &ğ~(
GPIO_PUPDR_PUPDR0
 << (
pos™iÚ
 * 2U));

351 
tmp
 = 
SYSCFG
->
EXTICR
[
pos™iÚ
 >> 2U];

352 
tmp
 &ğ(((
ušt32_t
)0x0FUè<< (4U * (
pos™iÚ
 & 0x03U)));

353 if(
tmp
 =ğ((
ušt32_t
)(
	`GPIO_GET_INDEX
(
GPIOx
)è<< (4U * (
pos™iÚ
 & 0x03U))))

356 
tmp
 = ((
ušt32_t
)0x0FUè<< (4U * (
pos™iÚ
 & 0x03U));

357 
SYSCFG
->
EXTICR
[
pos™iÚ
 >> 2U] &ğ~
tmp
;

360 
EXTI
->
IMR
 &ğ~((
ušt32_t
)
iocu¼’t
);

361 
EXTI
->
EMR
 &ğ~((
ušt32_t
)
iocu¼’t
);

364 
EXTI
->
RTSR
 &ğ~((
ušt32_t
)
iocu¼’t
);

365 
EXTI
->
FTSR
 &ğ~((
ušt32_t
)
iocu¼’t
);

369 
	}
}

395 
GPIO_PšS‹
 
	$HAL_GPIO_R—dPš
(
GPIO_Ty³Def
* 
GPIOx
, 
ušt16_t
 
GPIO_Pš
)

397 
GPIO_PšS‹
 
b™¡©us
;

400 
	`as£¹_·¿m
(
	`IS_GPIO_PIN
(
GPIO_Pš
));

402 if((
GPIOx
->
IDR
 & 
GPIO_Pš
è!ğ(
ušt32_t
)
GPIO_PIN_RESET
)

404 
b™¡©us
 = 
GPIO_PIN_SET
;

408 
b™¡©us
 = 
GPIO_PIN_RESET
;

410  
b™¡©us
;

411 
	}
}

430 
	$HAL_GPIO_Wr™ePš
(
GPIO_Ty³Def
* 
GPIOx
, 
ušt16_t
 
GPIO_Pš
, 
GPIO_PšS‹
 
PšS‹
)

433 
	`as£¹_·¿m
(
	`IS_GPIO_PIN
(
GPIO_Pš
));

434 
	`as£¹_·¿m
(
	`IS_GPIO_PIN_ACTION
(
PšS‹
));

436 if(
PšS‹
 !ğ
GPIO_PIN_RESET
)

438 
GPIOx
->
BSRR
 = 
GPIO_Pš
;

442 
GPIOx
->
BSRR
 = (
ušt32_t
)
GPIO_Pš
 << 16U;

444 
	}
}

453 
	$HAL_GPIO_ToggËPš
(
GPIO_Ty³Def
* 
GPIOx
, 
ušt16_t
 
GPIO_Pš
)

456 
	`as£¹_·¿m
(
	`IS_GPIO_PIN
(
GPIO_Pš
));

458 
GPIOx
->
ODR
 ^ğ
GPIO_Pš
;

459 
	}
}

472 
HAL_StusTy³Def
 
	$HAL_GPIO_LockPš
(
GPIO_Ty³Def
* 
GPIOx
, 
ušt16_t
 
GPIO_Pš
)

474 
__IO
 
ušt32_t
 
tmp
 = 
GPIO_LCKR_LCKK
;

477 
	`as£¹_·¿m
(
	`IS_GPIO_PIN
(
GPIO_Pš
));

480 
tmp
 |ğ
GPIO_Pš
;

482 
GPIOx
->
LCKR
 = 
tmp
;

484 
GPIOx
->
LCKR
 = 
GPIO_Pš
;

486 
GPIOx
->
LCKR
 = 
tmp
;

488 
tmp
 = 
GPIOx
->
LCKR
;

490 if((
GPIOx
->
LCKR
 & 
GPIO_LCKR_LCKK
è!ğ
RESET
)

492  
HAL_OK
;

496  
HAL_ERROR
;

498 
	}
}

505 
	$HAL_GPIO_EXTI_IRQHªdËr
(
ušt16_t
 
GPIO_Pš
)

508 if(
	`__HAL_GPIO_EXTI_GET_IT
(
GPIO_Pš
è!ğ
RESET
)

510 
	`__HAL_GPIO_EXTI_CLEAR_IT
(
GPIO_Pš
);

511 
	`HAL_GPIO_EXTI_C®lback
(
GPIO_Pš
);

513 
	}
}

520 
__w—k
 
	$HAL_GPIO_EXTI_C®lback
(
ušt16_t
 
GPIO_Pš
)

523 
	`UNUSED
(
GPIO_Pš
);

527 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_ltdc.c

113 
	~"¡m32f4xx_h®.h
"

123 #ifdeà
HAL_LTDC_MODULE_ENABLED


125 #ià
defšed
(
STM32F429xx
è|| defšed(
STM32F439xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
)

132 
LTDC_S‘CÚfig
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
, 
ušt32_t
 
Lay”Idx
);

161 
HAL_StusTy³Def
 
	$HAL_LTDC_In™
(
LTDC_HªdËTy³Def
 *
hÉdc
)

163 
ušt32_t
 
tmp
 = 0U, 
tmp1
 = 0U;

166 if(
hÉdc
 =ğ
NULL
)

168  
HAL_ERROR
;

172 
	`as£¹_·¿m
(
	`IS_LTDC_ALL_INSTANCE
(
hÉdc
->
In¡ªû
));

173 
	`as£¹_·¿m
(
	`IS_LTDC_HSYNC
(
hÉdc
->
In™
.
HÜizÚlSync
));

174 
	`as£¹_·¿m
(
	`IS_LTDC_VSYNC
(
hÉdc
->
In™
.
V”tiÿlSync
));

175 
	`as£¹_·¿m
(
	`IS_LTDC_AHBP
(
hÉdc
->
In™
.
AccumuÏ‹dHBP
));

176 
	`as£¹_·¿m
(
	`IS_LTDC_AVBP
(
hÉdc
->
In™
.
AccumuÏ‹dVBP
));

177 
	`as£¹_·¿m
(
	`IS_LTDC_AAH
(
hÉdc
->
In™
.
AccumuÏ‹dAùiveH
));

178 
	`as£¹_·¿m
(
	`IS_LTDC_AAW
(
hÉdc
->
In™
.
AccumuÏ‹dAùiveW
));

179 
	`as£¹_·¿m
(
	`IS_LTDC_TOTALH
(
hÉdc
->
In™
.
TÙ®Heigh
));

180 
	`as£¹_·¿m
(
	`IS_LTDC_TOTALW
(
hÉdc
->
In™
.
TÙ®Width
));

181 
	`as£¹_·¿m
(
	`IS_LTDC_HSPOL
(
hÉdc
->
In™
.
HSPŞ¬™y
));

182 
	`as£¹_·¿m
(
	`IS_LTDC_VSPOL
(
hÉdc
->
In™
.
VSPŞ¬™y
));

183 
	`as£¹_·¿m
(
	`IS_LTDC_DEPOL
(
hÉdc
->
In™
.
DEPŞ¬™y
));

184 
	`as£¹_·¿m
(
	`IS_LTDC_PCPOL
(
hÉdc
->
In™
.
PCPŞ¬™y
));

186 if(
hÉdc
->
S‹
 =ğ
HAL_LTDC_STATE_RESET
)

189 
hÉdc
->
Lock
 = 
HAL_UNLOCKED
;

191 
	`HAL_LTDC_M¥In™
(
hÉdc
);

195 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

198 
hÉdc
->
In¡ªû
->
GCR
 &ğ~(
LTDC_GCR_HSPOL
 | 
LTDC_GCR_VSPOL
 | 
LTDC_GCR_DEPOL
 | 
LTDC_GCR_PCPOL
);

199 
hÉdc
->
In¡ªû
->
GCR
 |ğ(
ušt32_t
)(hÉdc->
In™
.
HSPŞ¬™y
 | hÉdc->In™.
VSPŞ¬™y
 | \

200 
hÉdc
->
In™
.
DEPŞ¬™y
 | hÉdc->In™.
PCPŞ¬™y
);

203 
hÉdc
->
In¡ªû
->
SSCR
 &ğ~(
LTDC_SSCR_VSH
 | 
LTDC_SSCR_HSW
);

204 
tmp
 = (
hÉdc
->
In™
.
HÜizÚlSync
 << 16U);

205 
hÉdc
->
In¡ªû
->
SSCR
 |ğ(
tmp
 | hÉdc->
In™
.
V”tiÿlSync
);

208 
hÉdc
->
In¡ªû
->
BPCR
 &ğ~(
LTDC_BPCR_AVBP
 | 
LTDC_BPCR_AHBP
);

209 
tmp
 = (
hÉdc
->
In™
.
AccumuÏ‹dHBP
 << 16U);

210 
hÉdc
->
In¡ªû
->
BPCR
 |ğ(
tmp
 | hÉdc->
In™
.
AccumuÏ‹dVBP
);

213 
hÉdc
->
In¡ªû
->
AWCR
 &ğ~(
LTDC_AWCR_AAH
 | 
LTDC_AWCR_AAW
);

214 
tmp
 = (
hÉdc
->
In™
.
AccumuÏ‹dAùiveW
 << 16U);

215 
hÉdc
->
In¡ªû
->
AWCR
 |ğ(
tmp
 | hÉdc->
In™
.
AccumuÏ‹dAùiveH
);

218 
hÉdc
->
In¡ªû
->
TWCR
 &ğ~(
LTDC_TWCR_TOTALH
 | 
LTDC_TWCR_TOTALW
);

219 
tmp
 = (
hÉdc
->
In™
.
TÙ®Width
 << 16U);

220 
hÉdc
->
In¡ªû
->
TWCR
 |ğ(
tmp
 | hÉdc->
In™
.
TÙ®Heigh
);

223 
tmp
 = ((
ušt32_t
)(
hÉdc
->
In™
.
BackcŞÜ
.
G»’
) << 8U);

224 
tmp1
 = ((
ušt32_t
)(
hÉdc
->
In™
.
BackcŞÜ
.
Red
) << 16U);

225 
hÉdc
->
In¡ªû
->
BCCR
 &ğ~(
LTDC_BCCR_BCBLUE
 | 
LTDC_BCCR_BCGREEN
 | 
LTDC_BCCR_BCRED
);

226 
hÉdc
->
In¡ªû
->
BCCR
 |ğ(
tmp1
 | 
tmp
 | hÉdc->
In™
.
BackcŞÜ
.
Blue
);

229 
	`__HAL_LTDC_ENABLE_IT
(
hÉdc
, 
LTDC_IT_TE
);

232 
	`__HAL_LTDC_ENABLE_IT
(
hÉdc
, 
LTDC_IT_FU
);

235 
	`__HAL_LTDC_ENABLE
(
hÉdc
);

238 
hÉdc
->
E¼ÜCode
 = 
HAL_LTDC_ERROR_NONE
;

241 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

243  
HAL_OK
;

244 
	}
}

254 
HAL_StusTy³Def
 
	$HAL_LTDC_DeIn™
(
LTDC_HªdËTy³Def
 *
hÉdc
)

257 
	`HAL_LTDC_M¥DeIn™
(
hÉdc
);

260 
hÉdc
->
E¼ÜCode
 = 
HAL_LTDC_ERROR_NONE
;

263 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_RESET
;

266 
	`__HAL_UNLOCK
(
hÉdc
);

268  
HAL_OK
;

269 
	}
}

277 
__w—k
 
	$HAL_LTDC_M¥In™
(
LTDC_HªdËTy³Def
* 
hÉdc
)

280 
	`UNUSED
(
hÉdc
);

284 
	}
}

292 
__w—k
 
	$HAL_LTDC_M¥DeIn™
(
LTDC_HªdËTy³Def
* 
hÉdc
)

295 
	`UNUSED
(
hÉdc
);

299 
	}
}

324 
	$HAL_LTDC_IRQHªdËr
(
LTDC_HªdËTy³Def
 *
hÉdc
)

327 if(
	`__HAL_LTDC_GET_FLAG
(
hÉdc
, 
LTDC_FLAG_TE
è!ğ
RESET
)

329 if(
	`__HAL_LTDC_GET_IT_SOURCE
(
hÉdc
, 
LTDC_IT_TE
è!ğ
RESET
)

332 
	`__HAL_LTDC_DISABLE_IT
(
hÉdc
, 
LTDC_IT_TE
);

335 
	`__HAL_LTDC_CLEAR_FLAG
(
hÉdc
, 
LTDC_FLAG_TE
);

338 
hÉdc
->
E¼ÜCode
 |ğ
HAL_LTDC_ERROR_TE
;

341 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_ERROR
;

344 
	`__HAL_UNLOCK
(
hÉdc
);

347 
	`HAL_LTDC_E¼ÜC®lback
(
hÉdc
);

351 if(
	`__HAL_LTDC_GET_FLAG
(
hÉdc
, 
LTDC_FLAG_FU
è!ğ
RESET
)

353 if(
	`__HAL_LTDC_GET_IT_SOURCE
(
hÉdc
, 
LTDC_IT_FU
è!ğ
RESET
)

356 
	`__HAL_LTDC_DISABLE_IT
(
hÉdc
, 
LTDC_IT_FU
);

359 
	`__HAL_LTDC_CLEAR_FLAG
(
hÉdc
, 
LTDC_FLAG_FU
);

362 
hÉdc
->
E¼ÜCode
 |ğ
HAL_LTDC_ERROR_FU
;

365 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_ERROR
;

368 
	`__HAL_UNLOCK
(
hÉdc
);

371 
	`HAL_LTDC_E¼ÜC®lback
(
hÉdc
);

375 if(
	`__HAL_LTDC_GET_FLAG
(
hÉdc
, 
LTDC_FLAG_LI
è!ğ
RESET
)

377 if(
	`__HAL_LTDC_GET_IT_SOURCE
(
hÉdc
, 
LTDC_IT_LI
è!ğ
RESET
)

380 
	`__HAL_LTDC_DISABLE_IT
(
hÉdc
, 
LTDC_IT_LI
);

383 
	`__HAL_LTDC_CLEAR_FLAG
(
hÉdc
, 
LTDC_FLAG_LI
);

386 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

389 
	`__HAL_UNLOCK
(
hÉdc
);

392 
	`HAL_LTDC_LšeEv’tC®lback
(
hÉdc
);

396 if(
	`__HAL_LTDC_GET_FLAG
(
hÉdc
, 
LTDC_FLAG_RR
è!ğ
RESET
)

398 if(
	`__HAL_LTDC_GET_IT_SOURCE
(
hÉdc
, 
LTDC_IT_RR
è!ğ
RESET
)

401 
	`__HAL_LTDC_DISABLE_IT
(
hÉdc
, 
LTDC_IT_RR
);

404 
	`__HAL_LTDC_CLEAR_FLAG
(
hÉdc
, 
LTDC_FLAG_RR
);

407 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

410 
	`__HAL_UNLOCK
(
hÉdc
);

413 
	`HAL_LTDC_R–ßdEv’tC®lback
(
hÉdc
);

416 
	}
}

424 
__w—k
 
	$HAL_LTDC_E¼ÜC®lback
(
LTDC_HªdËTy³Def
 *
hÉdc
)

427 
	`UNUSED
(
hÉdc
);

431 
	}
}

439 
__w—k
 
	$HAL_LTDC_LšeEv’tC®lback
(
LTDC_HªdËTy³Def
 *
hÉdc
)

442 
	`UNUSED
(
hÉdc
);

447 
	}
}

455 
__w—k
 
	$HAL_LTDC_R–ßdEv’tC®lback
(
LTDC_HªdËTy³Def
 *
hÉdc
)

458 
	`UNUSED
(
hÉdc
);

463 
	}
}

505 
HAL_StusTy³Def
 
	$HAL_LTDC_CÚfigLay”
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
, 
ušt32_t
 
Lay”Idx
)

508 
	`__HAL_LOCK
(
hÉdc
);

511 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

514 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

515 
	`as£¹_·¿m
(
	`IS_LTDC_PIXEL_FORMAT
(
pLay”Cfg
->
Pix–FÜm©
));

516 
	`as£¹_·¿m
(
	`IS_LTDC_BLENDING_FACTOR1
(
pLay”Cfg
->
BËndšgFaùÜ1
));

517 
	`as£¹_·¿m
(
	`IS_LTDC_BLENDING_FACTOR2
(
pLay”Cfg
->
BËndšgFaùÜ2
));

518 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGST
(
pLay”Cfg
->
WšdowX0
));

519 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGSP
(
pLay”Cfg
->
WšdowX1
));

520 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGST
(
pLay”Cfg
->
WšdowY0
));

521 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGSP
(
pLay”Cfg
->
WšdowY1
));

522 
	`as£¹_·¿m
(
	`IS_LTDC_ALPHA
(
pLay”Cfg
->
AÍha0
));

523 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLL
(
pLay”Cfg
->
ImageWidth
));

524 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLNBR
(
pLay”Cfg
->
ImageHeight
));

527 
hÉdc
->
Lay”Cfg
[
Lay”Idx
] = *
pLay”Cfg
;

530 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

533 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

536 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

539 
	`__HAL_UNLOCK
(
hÉdc
);

541  
HAL_OK
;

542 
	}
}

554 
HAL_StusTy³Def
 
	$HAL_LTDC_CÚfigCŞÜKeyšg
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
RGBV®ue
, ušt32_ˆ
Lay”Idx
)

557 
	`__HAL_LOCK
(
hÉdc
);

560 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

563 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

566 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CKCR
 &ğ~(
LTDC_LxCKCR_CKBLUE
 | 
LTDC_LxCKCR_CKGREEN
 | 
LTDC_LxCKCR_CKRED
);

567 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CKCR
 = 
RGBV®ue
;

570 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

573 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

576 
	`__HAL_UNLOCK
(
hÉdc
);

578  
HAL_OK
;

579 
	}
}

592 
HAL_StusTy³Def
 
	$HAL_LTDC_CÚfigCLUT
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 *
pCLUT
, ušt32_ˆ
CLUTSize
, ušt32_ˆ
Lay”Idx
)

594 
ušt32_t
 
tmp
 = 0U;

595 
ušt32_t
 
couÁ”
 = 0U;

596 
ušt32_t
 
pcouÁ”
 = 0U;

599 
	`__HAL_LOCK
(
hÉdc
);

602 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

605 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

607 
couÁ”
 = 0U; (couÁ” < 
CLUTSize
); counter++)

609 if(
hÉdc
->
Lay”Cfg
[
Lay”Idx
].
Pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_AL44
)

611 
tmp
 = (((
couÁ”
 + 16U*couÁ”è<< 24Uè| ((
ušt32_t
)(*
pCLUT
) & 0xFFU) | ((uint32_t)(*pCLUT) & 0xFF00U) | ((uint32_t)(*pCLUT) & 0xFF0000U));

615 
tmp
 = ((
couÁ”
 << 24Uè| ((
ušt32_t
)(*
pCLUT
) & 0xFFU) | ((uint32_t)(*pCLUT) & 0xFF00U) | ((uint32_t)(*pCLUT) & 0xFF0000U));

617 
pcouÁ”
 = (
ušt32_t
)
pCLUT
 + (*pCLUT);

618 
pCLUT
 = (
ušt32_t
 *)
pcouÁ”
;

621 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CLUTWR
 = 
tmp
;

625 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

628 
	`__HAL_UNLOCK
(
hÉdc
);

630  
HAL_OK
;

631 
	}
}

642 
HAL_StusTy³Def
 
	$HAL_LTDC_EÇbËCŞÜKeyšg
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

645 
	`__HAL_LOCK
(
hÉdc
);

648 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

651 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

654 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 |ğ(
ušt32_t
)
LTDC_LxCR_COLKEN
;

657 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

660 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

663 
	`__HAL_UNLOCK
(
hÉdc
);

665  
HAL_OK
;

666 
	}
}

677 
HAL_StusTy³Def
 
	$HAL_LTDC_Di§bËCŞÜKeyšg
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

680 
	`__HAL_LOCK
(
hÉdc
);

683 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

686 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

689 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 &ğ~(
ušt32_t
)
LTDC_LxCR_COLKEN
;

692 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

695 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

698 
	`__HAL_UNLOCK
(
hÉdc
);

700  
HAL_OK
;

701 
	}
}

712 
HAL_StusTy³Def
 
	$HAL_LTDC_EÇbËCLUT
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

716 
	`__HAL_LOCK
(
hÉdc
);

719 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

722 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

725 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 |ğ(
ušt32_t
)
LTDC_LxCR_CLUTEN
;

728 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

731 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

734 
	`__HAL_UNLOCK
(
hÉdc
);

736  
HAL_OK
;

737 
	}
}

748 
HAL_StusTy³Def
 
	$HAL_LTDC_Di§bËCLUT
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

752 
	`__HAL_LOCK
(
hÉdc
);

755 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

758 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

761 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 &ğ~(
ušt32_t
)
LTDC_LxCR_CLUTEN
;

764 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

767 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

770 
	`__HAL_UNLOCK
(
hÉdc
);

772  
HAL_OK
;

773 
	}
}

782 
HAL_StusTy³Def
 
	$HAL_LTDC_EÇbËD™h”
(
LTDC_HªdËTy³Def
 *
hÉdc
)

785 
	`__HAL_LOCK
(
hÉdc
);

788 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

791 
LTDC
->
GCR
 |ğ(
ušt32_t
)
LTDC_GCR_DTEN
;

794 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

797 
	`__HAL_UNLOCK
(
hÉdc
);

799  
HAL_OK
;

800 
	}
}

809 
HAL_StusTy³Def
 
	$HAL_LTDC_Di§bËD™h”
(
LTDC_HªdËTy³Def
 *
hÉdc
)

812 
	`__HAL_LOCK
(
hÉdc
);

815 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

818 
LTDC
->
GCR
 &ğ~(
ušt32_t
)
LTDC_GCR_DTEN
;

821 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

824 
	`__HAL_UNLOCK
(
hÉdc
);

826  
HAL_OK
;

827 
	}
}

840 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘WšdowSize
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
XSize
, ušt32_ˆ
YSize
, ušt32_ˆ
Lay”Idx
)

842 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

845 
	`__HAL_LOCK
(
hÉdc
);

848 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

851 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

854 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

855 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGST
(
pLay”Cfg
->
WšdowX0
));

856 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGSP
(
pLay”Cfg
->
WšdowX1
));

857 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGST
(
pLay”Cfg
->
WšdowY0
));

858 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGSP
(
pLay”Cfg
->
WšdowY1
));

859 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLL
(
XSize
));

860 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLNBR
(
YSize
));

863 
pLay”Cfg
->
WšdowX0
 = 0U;

864 
pLay”Cfg
->
WšdowX1
 = 
XSize
 +…Lay”Cfg->
WšdowX0
;

867 
pLay”Cfg
->
WšdowY0
 = 0U;

868 
pLay”Cfg
->
WšdowY1
 = 
YSize
 +…Lay”Cfg->
WšdowY0
;

871 
pLay”Cfg
->
ImageWidth
 = 
XSize
;

874 
pLay”Cfg
->
ImageHeight
 = 
YSize
;

877 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

880 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

883 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

886 
	`__HAL_UNLOCK
(
hÉdc
);

888  
HAL_OK
;

889 
	}
}

902 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘WšdowPos™iÚ
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
X0
, ušt32_ˆ
Y0
, ušt32_ˆ
Lay”Idx
)

904 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

907 
	`__HAL_LOCK
(
hÉdc
);

910 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

913 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

916 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

917 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGST
(
pLay”Cfg
->
WšdowX0
));

918 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGSP
(
pLay”Cfg
->
WšdowX1
));

919 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGST
(
pLay”Cfg
->
WšdowY0
));

920 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGSP
(
pLay”Cfg
->
WšdowY1
));

923 
pLay”Cfg
->
WšdowX0
 = 
X0
;

924 
pLay”Cfg
->
WšdowX1
 = 
X0
 +…Lay”Cfg->
ImageWidth
;

927 
pLay”Cfg
->
WšdowY0
 = 
Y0
;

928 
pLay”Cfg
->
WšdowY1
 = 
Y0
 +…Lay”Cfg->
ImageHeight
;

931 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

934 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

937 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

940 
	`__HAL_UNLOCK
(
hÉdc
);

942  
HAL_OK
;

943 
	}
}

955 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘Pix–FÜm©
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Pix–fÜm©
, ušt32_ˆ
Lay”Idx
)

957 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

960 
	`__HAL_LOCK
(
hÉdc
);

963 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

966 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

967 
	`as£¹_·¿m
(
	`IS_LTDC_PIXEL_FORMAT
(
Pix–fÜm©
));

970 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

973 
pLay”Cfg
->
Pix–FÜm©
 = 
Pix–fÜm©
;

976 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

979 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

982 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

985 
	`__HAL_UNLOCK
(
hÉdc
);

987  
HAL_OK
;

988 
	}
}

1000 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘AÍha
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
AÍha
, ušt32_ˆ
Lay”Idx
)

1002 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

1005 
	`__HAL_LOCK
(
hÉdc
);

1008 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1011 
	`as£¹_·¿m
(
	`IS_LTDC_ALPHA
(
AÍha
));

1012 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1015 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

1018 
pLay”Cfg
->
AÍha
 = Alpha;

1021 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1024 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

1027 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1030 
	`__HAL_UNLOCK
(
hÉdc
);

1032  
HAL_OK
;

1033 
	}
}

1044 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘Add»ss
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Add»ss
, ušt32_ˆ
Lay”Idx
)

1046 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

1049 
	`__HAL_LOCK
(
hÉdc
);

1052 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1055 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1058 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

1061 
pLay”Cfg
->
FBS¹Ad»ss
 = 
Add»ss
;

1064 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1067 
hÉdc
->
In¡ªû
->
SRCR
 = 
LTDC_SRCR_IMR
;

1070 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1073 
	`__HAL_UNLOCK
(
hÉdc
);

1075  
HAL_OK
;

1076 
	}
}

1091 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘P™ch
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
LšeP™chInPix–s
, ušt32_ˆ
Lay”Idx
)

1093 
ušt32_t
 
tmp
 = 0U;

1094 
ušt32_t
 
p™chUpd©e
 = 0U;

1095 
ušt32_t
 
pix–FÜm©
 = 0U;

1098 
	`__HAL_LOCK
(
hÉdc
);

1101 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1104 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1107 
pix–FÜm©
 = 
hÉdc
->
Lay”Cfg
[
Lay”Idx
].
Pix–FÜm©
;

1109 if(
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB8888
)

1111 
tmp
 = 4U;

1113 ià(
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_RGB888
)

1115 
tmp
 = 3U;

1117 if((
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB4444
) || \

1118 (
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_RGB565
) || \

1119 (
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB1555
) || \

1120 (
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_AL88
))

1122 
tmp
 = 2U;

1126 
tmp
 = 1U;

1129 
p™chUpd©e
 = ((
LšeP™chInPix–s
 * 
tmp
) << 16U);

1132 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLR
 &ğ~
LTDC_LxCFBLR_CFBP
;

1135 
LTDC
->
SRCR
 |ğ
LTDC_SRCR_IMR
;

1138 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLR
 |ğ
p™chUpd©e
;

1141 
LTDC
->
SRCR
 |ğ
LTDC_SRCR_IMR
;

1144 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1147 
	`__HAL_UNLOCK
(
hÉdc
);

1149  
HAL_OK
;

1150 
	}
}

1159 
HAL_StusTy³Def
 
	$HAL_LTDC_Prog¿mLšeEv’t
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lše
)

1162 
	`__HAL_LOCK
(
hÉdc
);

1165 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1168 
	`as£¹_·¿m
(
	`IS_LTDC_LIPOS
(
Lše
));

1171 
	`__HAL_LTDC_ENABLE_IT
(
hÉdc
, 
LTDC_IT_LI
);

1174 
LTDC
->
LIPCR
 = (
ušt32_t
)
Lše
;

1177 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1180 
	`__HAL_UNLOCK
(
hÉdc
);

1182  
HAL_OK
;

1183 
	}
}

1194 
HAL_StusTy³Def
 
	$HAL_LTDC_R–aod
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
R–ßdTy³
)

1196 
	`as£¹_·¿m
(
	`IS_LTDC_RELAOD
(
R–ßdTy³
));

1199 
	`__HAL_LOCK
(
hÉdc
);

1202 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1205 
	`__HAL_LTDC_ENABLE_IT
(
hÉdc
, 
LTDC_IT_RR
);

1208 
hÉdc
->
In¡ªû
->
SRCR
 = 
R–ßdTy³
;

1211 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1214 
	`__HAL_UNLOCK
(
hÉdc
);

1216  
HAL_OK
;

1217 
	}
}

1232 
HAL_StusTy³Def
 
	$HAL_LTDC_CÚfigLay”_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
, 
ušt32_t
 
Lay”Idx
)

1235 
	`__HAL_LOCK
(
hÉdc
);

1238 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1241 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1242 
	`as£¹_·¿m
(
	`IS_LTDC_PIXEL_FORMAT
(
pLay”Cfg
->
Pix–FÜm©
));

1243 
	`as£¹_·¿m
(
	`IS_LTDC_BLENDING_FACTOR1
(
pLay”Cfg
->
BËndšgFaùÜ1
));

1244 
	`as£¹_·¿m
(
	`IS_LTDC_BLENDING_FACTOR2
(
pLay”Cfg
->
BËndšgFaùÜ2
));

1245 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGST
(
pLay”Cfg
->
WšdowX0
));

1246 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGSP
(
pLay”Cfg
->
WšdowX1
));

1247 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGST
(
pLay”Cfg
->
WšdowY0
));

1248 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGSP
(
pLay”Cfg
->
WšdowY1
));

1249 
	`as£¹_·¿m
(
	`IS_LTDC_ALPHA
(
pLay”Cfg
->
AÍha0
));

1250 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLL
(
pLay”Cfg
->
ImageWidth
));

1251 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLNBR
(
pLay”Cfg
->
ImageHeight
));

1254 
hÉdc
->
Lay”Cfg
[
Lay”Idx
] = *
pLay”Cfg
;

1257 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1262 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1265 
	`__HAL_UNLOCK
(
hÉdc
);

1267  
HAL_OK
;

1268 
	}
}

1282 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘WšdowSize_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
XSize
, ušt32_ˆ
YSize
, ušt32_ˆ
Lay”Idx
)

1284 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

1287 
	`__HAL_LOCK
(
hÉdc
);

1290 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1293 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

1296 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1297 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGST
(
pLay”Cfg
->
WšdowX0
));

1298 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGSP
(
pLay”Cfg
->
WšdowX1
));

1299 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGST
(
pLay”Cfg
->
WšdowY0
));

1300 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGSP
(
pLay”Cfg
->
WšdowY1
));

1301 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLL
(
XSize
));

1302 
	`as£¹_·¿m
(
	`IS_LTDC_CFBLNBR
(
YSize
));

1305 
pLay”Cfg
->
WšdowX0
 = 0;

1306 
pLay”Cfg
->
WšdowX1
 = 
XSize
 +…Lay”Cfg->
WšdowX0
;

1309 
pLay”Cfg
->
WšdowY0
 = 0;

1310 
pLay”Cfg
->
WšdowY1
 = 
YSize
 +…Lay”Cfg->
WšdowY0
;

1313 
pLay”Cfg
->
ImageWidth
 = 
XSize
;

1316 
pLay”Cfg
->
ImageHeight
 = 
YSize
;

1319 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1324 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1327 
	`__HAL_UNLOCK
(
hÉdc
);

1329  
HAL_OK
;

1330 
	}
}

1344 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘WšdowPos™iÚ_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
X0
, ušt32_ˆ
Y0
, ušt32_ˆ
Lay”Idx
)

1346 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

1349 
	`__HAL_LOCK
(
hÉdc
);

1352 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1355 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

1358 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1359 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGST
(
pLay”Cfg
->
WšdowX0
));

1360 
	`as£¹_·¿m
(
	`IS_LTDC_HCONFIGSP
(
pLay”Cfg
->
WšdowX1
));

1361 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGST
(
pLay”Cfg
->
WšdowY0
));

1362 
	`as£¹_·¿m
(
	`IS_LTDC_VCONFIGSP
(
pLay”Cfg
->
WšdowY1
));

1365 
pLay”Cfg
->
WšdowX0
 = 
X0
;

1366 
pLay”Cfg
->
WšdowX1
 = 
X0
 +…Lay”Cfg->
ImageWidth
;

1369 
pLay”Cfg
->
WšdowY0
 = 
Y0
;

1370 
pLay”Cfg
->
WšdowY1
 = 
Y0
 +…Lay”Cfg->
ImageHeight
;

1373 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1378 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1381 
	`__HAL_UNLOCK
(
hÉdc
);

1383  
HAL_OK
;

1384 
	}
}

1397 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘Pix–FÜm©_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Pix–fÜm©
, ušt32_ˆ
Lay”Idx
)

1399 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

1402 
	`__HAL_LOCK
(
hÉdc
);

1405 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1408 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1409 
	`as£¹_·¿m
(
	`IS_LTDC_PIXEL_FORMAT
(
Pix–fÜm©
));

1412 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

1415 
pLay”Cfg
->
Pix–FÜm©
 = 
Pix–fÜm©
;

1418 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1423 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1426 
	`__HAL_UNLOCK
(
hÉdc
);

1428  
HAL_OK
;

1429 
	}
}

1442 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘AÍha_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
AÍha
, ušt32_ˆ
Lay”Idx
)

1444 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

1447 
	`__HAL_LOCK
(
hÉdc
);

1450 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1453 
	`as£¹_·¿m
(
	`IS_LTDC_ALPHA
(
AÍha
));

1454 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1457 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

1460 
pLay”Cfg
->
AÍha
 = Alpha;

1463 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1468 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1471 
	`__HAL_UNLOCK
(
hÉdc
);

1473  
HAL_OK
;

1474 
	}
}

1487 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘Add»ss_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Add»ss
, ušt32_ˆ
Lay”Idx
)

1489 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
;

1492 
	`__HAL_LOCK
(
hÉdc
);

1495 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1498 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1501 
pLay”Cfg
 = &
hÉdc
->
Lay”Cfg
[
Lay”Idx
];

1504 
pLay”Cfg
->
FBS¹Ad»ss
 = 
Add»ss
;

1507 
	`LTDC_S‘CÚfig
(
hÉdc
, 
pLay”Cfg
, 
Lay”Idx
);

1512 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1515 
	`__HAL_UNLOCK
(
hÉdc
);

1517  
HAL_OK
;

1518 
	}
}

1534 
HAL_StusTy³Def
 
	$HAL_LTDC_S‘P™ch_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
LšeP™chInPix–s
, ušt32_ˆ
Lay”Idx
)

1536 
ušt32_t
 
tmp
 = 0;

1537 
ušt32_t
 
p™chUpd©e
 = 0;

1538 
ušt32_t
 
pix–FÜm©
 = 0;

1541 
	`__HAL_LOCK
(
hÉdc
);

1544 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1547 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1550 
pix–FÜm©
 = 
hÉdc
->
Lay”Cfg
[
Lay”Idx
].
Pix–FÜm©
;

1552 if(
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB8888
)

1554 
tmp
 = 4;

1556 ià(
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_RGB888
)

1558 
tmp
 = 3;

1560 if((
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB4444
) || \

1561 (
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_RGB565
) || \

1562 (
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB1555
) || \

1563 (
pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_AL88
))

1565 
tmp
 = 2;

1569 
tmp
 = 1;

1572 
p™chUpd©e
 = ((
LšeP™chInPix–s
 * 
tmp
) << 16);

1575 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLR
 &ğ~
LTDC_LxCFBLR_CFBP
;

1578 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLR
 |ğ
p™chUpd©e
;

1583 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1586 
	`__HAL_UNLOCK
(
hÉdc
);

1588  
HAL_OK
;

1589 
	}
}

1603 
HAL_StusTy³Def
 
	$HAL_LTDC_CÚfigCŞÜKeyšg_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
RGBV®ue
, ušt32_ˆ
Lay”Idx
)

1606 
	`__HAL_LOCK
(
hÉdc
);

1609 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1612 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1615 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CKCR
 &ğ~(
LTDC_LxCKCR_CKBLUE
 | 
LTDC_LxCKCR_CKGREEN
 | 
LTDC_LxCKCR_CKRED
);

1616 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CKCR
 = 
RGBV®ue
;

1621 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1624 
	`__HAL_UNLOCK
(
hÉdc
);

1626  
HAL_OK
;

1627 
	}
}

1639 
HAL_StusTy³Def
 
	$HAL_LTDC_EÇbËCŞÜKeyšg_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

1642 
	`__HAL_LOCK
(
hÉdc
);

1645 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1648 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1651 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 |ğ(
ušt32_t
)
LTDC_LxCR_COLKEN
;

1656 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1659 
	`__HAL_UNLOCK
(
hÉdc
);

1661  
HAL_OK
;

1662 
	}
}

1674 
HAL_StusTy³Def
 
	$HAL_LTDC_Di§bËCŞÜKeyšg_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

1677 
	`__HAL_LOCK
(
hÉdc
);

1680 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1683 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1686 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 &ğ~(
ušt32_t
)
LTDC_LxCR_COLKEN
;

1691 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1694 
	`__HAL_UNLOCK
(
hÉdc
);

1696  
HAL_OK
;

1697 
	}
}

1709 
HAL_StusTy³Def
 
	$HAL_LTDC_EÇbËCLUT_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

1713 
	`__HAL_LOCK
(
hÉdc
);

1716 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1719 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1722 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 |ğ(
ušt32_t
)
LTDC_LxCR_CLUTEN
;

1727 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1730 
	`__HAL_UNLOCK
(
hÉdc
);

1732  
HAL_OK
;

1733 
	}
}

1745 
HAL_StusTy³Def
 
	$HAL_LTDC_Di§bËCLUT_NoR–ßd
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
ušt32_t
 
Lay”Idx
)

1749 
	`__HAL_LOCK
(
hÉdc
);

1752 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_BUSY
;

1755 
	`as£¹_·¿m
(
	`IS_LTDC_LAYER
(
Lay”Idx
));

1758 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 &ğ~(
ušt32_t
)
LTDC_LxCR_CLUTEN
;

1763 
hÉdc
->
S‹
 = 
HAL_LTDC_STATE_READY
;

1766 
	`__HAL_UNLOCK
(
hÉdc
);

1768  
HAL_OK
;

1769 
	}
}

1797 
HAL_LTDC_S‹Ty³Def
 
	$HAL_LTDC_G‘S‹
(
LTDC_HªdËTy³Def
 *
hÉdc
)

1799  
hÉdc
->
S‹
;

1800 
	}
}

1808 
ušt32_t
 
	$HAL_LTDC_G‘E¼Ü
(
LTDC_HªdËTy³Def
 *
hÉdc
)

1810  
hÉdc
->
E¼ÜCode
;

1811 
	}
}

1826 
	$LTDC_S‘CÚfig
(
LTDC_HªdËTy³Def
 *
hÉdc
, 
LTDC_Lay”CfgTy³Def
 *
pLay”Cfg
, 
ušt32_t
 
Lay”Idx
)

1828 
ušt32_t
 
tmp
 = 0U;

1829 
ušt32_t
 
tmp1
 = 0U;

1830 
ušt32_t
 
tmp2
 = 0U;

1833 
tmp
 = ((
pLay”Cfg
->
WšdowX1
 + ((
hÉdc
->
In¡ªû
->
BPCR
 & 
LTDC_BPCR_AHBP
) >> 16U)) << 16U);

1834 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
WHPCR
 &ğ~(
LTDC_LxWHPCR_WHSTPOS
 | 
LTDC_LxWHPCR_WHSPPOS
);

1835 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
WHPCR
 = ((
pLay”Cfg
->
WšdowX0
 + ((hÉdc->
In¡ªû
->
BPCR
 & 
LTDC_BPCR_AHBP
è>> 16Uè+ 1Uè| 
tmp
);

1838 
tmp
 = ((
pLay”Cfg
->
WšdowY1
 + (
hÉdc
->
In¡ªû
->
BPCR
 & 
LTDC_BPCR_AVBP
)) << 16U);

1839 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
WVPCR
 &ğ~(
LTDC_LxWVPCR_WVSTPOS
 | 
LTDC_LxWVPCR_WVSPPOS
);

1840 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
WVPCR
 = ((
pLay”Cfg
->
WšdowY0
 + (hÉdc->
In¡ªû
->
BPCR
 & 
LTDC_BPCR_AVBP
è+ 1Uè| 
tmp
);

1843 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
PFCR
 &ğ~(
LTDC_LxPFCR_PF
);

1844 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
PFCR
 = (
pLay”Cfg
->
Pix–FÜm©
);

1847 
tmp
 = ((
ušt32_t
)(
pLay”Cfg
->
BackcŞÜ
.
G»’
) << 8U);

1848 
tmp1
 = ((
ušt32_t
)(
pLay”Cfg
->
BackcŞÜ
.
Red
) << 16U);

1849 
tmp2
 = (
pLay”Cfg
->
AÍha0
 << 24U);

1850 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
DCCR
 &ğ~(
LTDC_LxDCCR_DCBLUE
 | 
LTDC_LxDCCR_DCGREEN
 | 
LTDC_LxDCCR_DCRED
 | 
LTDC_LxDCCR_DCALPHA
);

1851 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
DCCR
 = (
pLay”Cfg
->
BackcŞÜ
.
Blue
 | 
tmp
 | 
tmp1
 | 
tmp2
);

1854 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CACR
 &ğ~(
LTDC_LxCACR_CONSTA
);

1855 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CACR
 = (
pLay”Cfg
->
AÍha
);

1858 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
BFCR
 &ğ~(
LTDC_LxBFCR_BF2
 | 
LTDC_LxBFCR_BF1
);

1859 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
BFCR
 = (
pLay”Cfg
->
BËndšgFaùÜ1
 |…Lay”Cfg->
BËndšgFaùÜ2
);

1862 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBAR
 &ğ~(
LTDC_LxCFBAR_CFBADD
);

1863 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBAR
 = (
pLay”Cfg
->
FBS¹Ad»ss
);

1865 if(
pLay”Cfg
->
Pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB8888
)

1867 
tmp
 = 4U;

1869 ià(
pLay”Cfg
->
Pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_RGB888
)

1871 
tmp
 = 3U;

1873 if((
pLay”Cfg
->
Pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB4444
) || \

1874 (
pLay”Cfg
->
Pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_RGB565
) || \

1875 (
pLay”Cfg
->
Pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_ARGB1555
) || \

1876 (
pLay”Cfg
->
Pix–FÜm©
 =ğ
LTDC_PIXEL_FORMAT_AL88
))

1878 
tmp
 = 2U;

1882 
tmp
 = 1U;

1886 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLR
 &ğ~(
LTDC_LxCFBLR_CFBLL
 | 
LTDC_LxCFBLR_CFBP
);

1887 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLR
 = (((
pLay”Cfg
->
ImageWidth
 * 
tmp
è<< 16Uè| ((ÕLay”Cfg->
WšdowX1
 -…Lay”Cfg->
WšdowX0
) *mp) + 3U));

1890 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLNR
 &ğ~(
LTDC_LxCFBLNR_CFBLNBR
);

1891 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CFBLNR
 = (
pLay”Cfg
->
ImageHeight
);

1894 
	`LTDC_LAYER
(
hÉdc
, 
Lay”Idx
)->
CR
 |ğ(
ušt32_t
)
LTDC_LxCR_LEN
;

1895 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_ltdc_ex.c

39 
	~"¡m32f4xx_h®.h
"

49 #ifdeà
HAL_LTDC_MODULE_ENABLED


75 #ià
defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
)

86 
HAL_StusTy³Def
 
	$HAL_LTDC_SŒuùIn™FromVideoCÚfig
(
LTDC_HªdËTy³Def
* 
hÉdc
, 
DSI_VidCfgTy³Def
 *
VidCfg
)

96 
hÉdc
->
In™
.
DEPŞ¬™y
 = (
VidCfg
->DEPŞ¬™y =ğ
DSI_DATA_ENABLE_ACTIVE_HIGH
è? 
LTDC_DEPOLARITY_AL
 : 
LTDC_DEPOLARITY_AH
;

97 
hÉdc
->
In™
.
VSPŞ¬™y
 = (
VidCfg
->VSPŞ¬™y =ğ
DSI_VSYNC_ACTIVE_HIGH
è? 
LTDC_VSPOLARITY_AL
 : 
LTDC_VSPOLARITY_AH
;

98 
hÉdc
->
In™
.
HSPŞ¬™y
 = (
VidCfg
->HSPŞ¬™y =ğ
DSI_HSYNC_ACTIVE_HIGH
è? 
LTDC_HSPOLARITY_AL
 : 
LTDC_HSPOLARITY_AH
;

106 
hÉdc
->
In™
.
V”tiÿlSync
 = 
VidCfg
->
V”tiÿlSyncAùive
 - 1U;

107 
hÉdc
->
In™
.
AccumuÏ‹dVBP
 = 
VidCfg
->
V”tiÿlSyncAùive
 + VidCfg->
V”tiÿlBackPÜch
 - 1U;

108 
hÉdc
->
In™
.
AccumuÏ‹dAùiveH
 = 
VidCfg
->
V”tiÿlSyncAùive
 + VidCfg->
V”tiÿlBackPÜch
 + VidCfg->
V”tiÿlAùive
 - 1U;

109 
hÉdc
->
In™
.
TÙ®Heigh
 = 
VidCfg
->
V”tiÿlSyncAùive
 + VidCfg->
V”tiÿlBackPÜch
 + VidCfg->
V”tiÿlAùive
 + VidCfg->
V”tiÿlFrÚtPÜch
 - 1U;

111  
HAL_OK
;

112 
	}
}

124 
HAL_StusTy³Def
 
	$HAL_LTDC_SŒuùIn™FromAd­‹dCommªdCÚfig
(
LTDC_HªdËTy³Def
* 
hÉdc
, 
DSI_CmdCfgTy³Def
 *
CmdCfg
)

134 
hÉdc
->
In™
.
DEPŞ¬™y
 = (
CmdCfg
->DEPŞ¬™y =ğ
DSI_DATA_ENABLE_ACTIVE_HIGH
è? 
LTDC_DEPOLARITY_AL
 : 
LTDC_DEPOLARITY_AH
;

135 
hÉdc
->
In™
.
VSPŞ¬™y
 = (
CmdCfg
->VSPŞ¬™y =ğ
DSI_VSYNC_ACTIVE_HIGH
è? 
LTDC_VSPOLARITY_AL
 : 
LTDC_VSPOLARITY_AH
;

136 
hÉdc
->
In™
.
HSPŞ¬™y
 = (
CmdCfg
->HSPŞ¬™y =ğ
DSI_HSYNC_ACTIVE_HIGH
è? 
LTDC_HSPOLARITY_AL
 : 
LTDC_HSPOLARITY_AH
;

143  
HAL_OK
;

144 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_nand.c

86 
	~"¡m32f4xx_h®.h
"

93 #ifdeà
HAL_NAND_MODULE_ENABLED


95 #ià
defšed
(
STM32F405xx
è|| defšed(
STM32F415xx
è|| defšed(
STM32F407xx
è|| defšed(
STM32F417xx
) ||\

96 
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
) ||\

97 
defšed
(
STM32F446xx
è|| defšed(
STM32F469xx
è|| 
	$defšed
(
STM32F479xx
)

152 
HAL_StusTy³Def
 
	$HAL_NAND_In™
(
NAND_HªdËTy³Def
 *
hÇnd
, 
FMC_NAND_PCC_TimšgTy³Def
 *
ComS·û_Timšg
, FMC_NAND_PCC_TimšgTy³Deà*
A‰S·û_Timšg
)

155 if(
hÇnd
 =ğ
NULL
)

157  
HAL_ERROR
;

160 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_RESET
)

163 
hÇnd
->
Lock
 = 
HAL_UNLOCKED
;

165 
	`HAL_NAND_M¥In™
(
hÇnd
);

169 
	`FMC_NAND_In™
(
hÇnd
->
In¡ªû
, &(hÇnd->
In™
));

172 
	`FMC_NAND_CommÚS·û_Timšg_In™
(
hÇnd
->
In¡ªû
, 
ComS·û_Timšg
, hÇnd->
In™
.
NªdBªk
);

175 
	`FMC_NAND_A‰ribu‹S·û_Timšg_In™
(
hÇnd
->
In¡ªû
, 
A‰S·û_Timšg
, hÇnd->
In™
.
NªdBªk
);

178 
	`__FMC_NAND_ENABLE
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
);

181 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

183  
HAL_OK
;

184 
	}
}

192 
HAL_StusTy³Def
 
	$HAL_NAND_DeIn™
(
NAND_HªdËTy³Def
 *
hÇnd
)

195 
	`HAL_NAND_M¥DeIn™
(
hÇnd
);

198 
	`FMC_NAND_DeIn™
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
);

201 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_RESET
;

204 
	`__HAL_UNLOCK
(
hÇnd
);

206  
HAL_OK
;

207 
	}
}

215 
__w—k
 
	$HAL_NAND_M¥In™
(
NAND_HªdËTy³Def
 *
hÇnd
)

218 
	`UNUSED
(
hÇnd
);

222 
	}
}

230 
__w—k
 
	$HAL_NAND_M¥DeIn™
(
NAND_HªdËTy³Def
 *
hÇnd
)

233 
	`UNUSED
(
hÇnd
);

237 
	}
}

246 
	$HAL_NAND_IRQHªdËr
(
NAND_HªdËTy³Def
 *
hÇnd
)

249 if(
	`__FMC_NAND_GET_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_RISING_EDGE
))

252 
	`HAL_NAND_ITC®lback
(
hÇnd
);

255 
	`__FMC_NAND_CLEAR_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_RISING_EDGE
);

259 if(
	`__FMC_NAND_GET_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_LEVEL
))

262 
	`HAL_NAND_ITC®lback
(
hÇnd
);

265 
	`__FMC_NAND_CLEAR_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_LEVEL
);

269 if(
	`__FMC_NAND_GET_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_FALLING_EDGE
))

272 
	`HAL_NAND_ITC®lback
(
hÇnd
);

275 
	`__FMC_NAND_CLEAR_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_FALLING_EDGE
);

279 if(
	`__FMC_NAND_GET_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_FEMPT
))

282 
	`HAL_NAND_ITC®lback
(
hÇnd
);

285 
	`__FMC_NAND_CLEAR_FLAG
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
, 
FMC_FLAG_FEMPT
);

288 
	}
}

296 
__w—k
 
	$HAL_NAND_ITC®lback
(
NAND_HªdËTy³Def
 *
hÇnd
)

299 
	`UNUSED
(
hÇnd
);

303 
	}
}

331 
HAL_StusTy³Def
 
	$HAL_NAND_R—d_ID
(
NAND_HªdËTy³Def
 *
hÇnd
, 
NAND_IDTy³Def
 *
pNAND_ID
)

333 
__IO
 
ušt32_t
 
d©a
 = 0U;

334 
ušt32_t
 
deviûadd»ss
 = 0U;

337 
	`__HAL_LOCK
(
hÇnd
);

340 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

342  
HAL_BUSY
;

346 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

348 
deviûadd»ss
 = 
NAND_DEVICE1
;

352 
deviûadd»ss
 = 
NAND_DEVICE2
;

356 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

359 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_READID
;

360 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)) = 0x00U;

363 
d©a
 = *(
__IO
 
ušt32_t
 *)
deviûadd»ss
;

366 
pNAND_ID
->
Mak”_Id
 = 
	`ADDR_1ST_CYCLE
(
d©a
);

367 
pNAND_ID
->
Deviû_Id
 = 
	`ADDR_2ND_CYCLE
(
d©a
);

368 
pNAND_ID
->
Thœd_Id
 = 
	`ADDR_3RD_CYCLE
(
d©a
);

369 
pNAND_ID
->
Fou¹h_Id
 = 
	`ADDR_4TH_CYCLE
(
d©a
);

372 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

375 
	`__HAL_UNLOCK
(
hÇnd
);

377  
HAL_OK
;

378 
	}
}

386 
HAL_StusTy³Def
 
	$HAL_NAND_Re£t
(
NAND_HªdËTy³Def
 *
hÇnd
)

388 
ušt32_t
 
deviûadd»ss
 = 0U;

391 
	`__HAL_LOCK
(
hÇnd
);

394 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

396  
HAL_BUSY
;

400 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

402 
deviûadd»ss
 = 
NAND_DEVICE1
;

406 
deviûadd»ss
 = 
NAND_DEVICE2
;

410 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

413 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)) = 0xFFU;

417 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

420 
	`__HAL_UNLOCK
(
hÇnd
);

422  
HAL_OK
;

424 
	}
}

435 
HAL_StusTy³Def
 
	$HAL_NAND_R—d_Page
(
NAND_HªdËTy³Def
 *
hÇnd
, 
NAND_Add»ssTy³Def
 *
pAdd»ss
, 
ušt8_t
 *
pBufãr
, 
ušt32_t
 
NumPageToR—d
)

437 
__IO
 
ušt32_t
 
šdex
 = 0U;

438 
ušt32_t
 
deviûadd»ss
 = 0U, 
size
 = 0U, 
num·ge¤—d
 = 0U, 
add»ss¡©us
 = 
NAND_VALID_ADDRESS
;

439 
NAND_Add»ssTy³Def
 
Çndadd»ss
;

440 
ušt32_t
 
add»ssoff£t
 = 0U;

443 
	`__HAL_LOCK
(
hÇnd
);

446 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

448  
HAL_BUSY
;

452 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

454 
deviûadd»ss
 = 
NAND_DEVICE1
;

458 
deviûadd»ss
 = 
NAND_DEVICE2
;

462 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

465 
Çndadd»ss
.
Block
 = 
pAdd»ss
->Block;

466 
Çndadd»ss
.
Page
 = 
pAdd»ss
->Page;

467 
Çndadd»ss
.
ZÚe
 = 
pAdd»ss
->Zone;

470 (
NumPageToR—d
 !ğ0Uè&& (
add»ss¡©us
 =ğ
NAND_VALID_ADDRESS
))

473 
size
 = 
hÇnd
->
Info
.
PageSize
 + ((hÇnd->Info.PageSizeè* 
num·ge¤—d
);

476 
add»ssoff£t
 = 
	`ARRAY_ADDRESS
(&
Çndadd»ss
, 
hÇnd
);

479 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_AREA_A
;

481 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)) = 0x00U;

482 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_1ST_CYCLE
(
add»ssoff£t
);

483 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_2ND_CYCLE
(
add»ssoff£t
);

484 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_3RD_CYCLE
(
add»ssoff£t
);

487 if(
hÇnd
->
Info
.
BlockNbr
 >= 1024U)

489 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_4TH_CYCLE
(
add»ssoff£t
);

492 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_AREA_TRUE1
;

495 ; 
šdex
 < 
size
; index++)

497 *(
ušt8_t
 *)
pBufãr
++ = *(ušt8_ˆ*)
deviûadd»ss
;

501 
num·ge¤—d
++;

504 
NumPageToR—d
--;

507 
add»ss¡©us
 = 
	`HAL_NAND_Add»ss_Inc
(
hÇnd
, &
Çndadd»ss
);

511 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

514 
	`__HAL_UNLOCK
(
hÇnd
);

516  
HAL_OK
;

518 
	}
}

529 
HAL_StusTy³Def
 
	$HAL_NAND_Wr™e_Page
(
NAND_HªdËTy³Def
 *
hÇnd
, 
NAND_Add»ssTy³Def
 *
pAdd»ss
, 
ušt8_t
 *
pBufãr
, 
ušt32_t
 
NumPageToWr™e
)

531 
__IO
 
ušt32_t
 
šdex
 = 0U;

532 
ušt32_t
 
tick¡¬t
 = 0U;

533 
ušt32_t
 
deviûadd»ss
 = 0U , 
size
 = 0U, 
num·geswr™‹n
 = 0U, 
add»ss¡©us
 = 
NAND_VALID_ADDRESS
;

534 
NAND_Add»ssTy³Def
 
Çndadd»ss
;

535 
ušt32_t
 
add»ssoff£t
 = 0U;

538 
	`__HAL_LOCK
(
hÇnd
);

541 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

543  
HAL_BUSY
;

547 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

549 
deviûadd»ss
 = 
NAND_DEVICE1
;

553 
deviûadd»ss
 = 
NAND_DEVICE2
;

557 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

560 
Çndadd»ss
.
Block
 = 
pAdd»ss
->Block;

561 
Çndadd»ss
.
Page
 = 
pAdd»ss
->Page;

562 
Çndadd»ss
.
ZÚe
 = 
pAdd»ss
->Zone;

565 (
NumPageToWr™e
 !ğ0Uè&& (
add»ss¡©us
 =ğ
NAND_VALID_ADDRESS
))

568 
size
 = 
hÇnd
->
Info
.
PageSize
 + ((hÇnd->Info.PageSizeè* 
num·geswr™‹n
);

571 
add»ssoff£t
 = 
	`ARRAY_ADDRESS
(&
Çndadd»ss
, 
hÇnd
);

574 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_AREA_A
;

575 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_WRITE0
;

577 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)) = 0x00U;

578 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_1ST_CYCLE
(
add»ssoff£t
);

579 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_2ND_CYCLE
(
add»ssoff£t
);

580 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_3RD_CYCLE
(
add»ssoff£t
);

583 if(
hÇnd
->
Info
.
BlockNbr
 >= 1024U)

585 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_4TH_CYCLE
(
add»ssoff£t
);

589 ; 
šdex
 < 
size
; index++)

591 *(
__IO
 
ušt8_t
 *)
deviûadd»ss
 = *(ušt8_ˆ*)
pBufãr
++;

594 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_WRITE_TRUE1
;

597 
tick¡¬t
 = 
	`HAL_G‘Tick
();

600 
	`HAL_NAND_R—d_Stus
(
hÇnd
è!ğ
NAND_READY
)

602 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
NAND_WRITE_TIMEOUT
)

604  
HAL_TIMEOUT
;

609 
num·geswr™‹n
++;

612 
NumPageToWr™e
--;

615 
add»ss¡©us
 = 
	`HAL_NAND_Add»ss_Inc
(
hÇnd
, &
Çndadd»ss
);

619 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

622 
	`__HAL_UNLOCK
(
hÇnd
);

624  
HAL_OK
;

625 
	}
}

636 
HAL_StusTy³Def
 
	$HAL_NAND_R—d_S·»A»a
(
NAND_HªdËTy³Def
 *
hÇnd
, 
NAND_Add»ssTy³Def
 *
pAdd»ss
, 
ušt8_t
 *
pBufãr
, 
ušt32_t
 
NumS·»A»aToR—d
)

638 
__IO
 
ušt32_t
 
šdex
 = 0U;

639 
ušt32_t
 
deviûadd»ss
 = 0U, 
size
 = 0U, 
num_¥¬e_¬—_»ad
 = 0U, 
add»ss¡©us
 = 
NAND_VALID_ADDRESS
;

640 
NAND_Add»ssTy³Def
 
Çndadd»ss
;

641 
ušt32_t
 
add»ssoff£t
 = 0U;

644 
	`__HAL_LOCK
(
hÇnd
);

647 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

649  
HAL_BUSY
;

653 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

655 
deviûadd»ss
 = 
NAND_DEVICE1
;

659 
deviûadd»ss
 = 
NAND_DEVICE2
;

663 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

666 
Çndadd»ss
.
Block
 = 
pAdd»ss
->Block;

667 
Çndadd»ss
.
Page
 = 
pAdd»ss
->Page;

668 
Çndadd»ss
.
ZÚe
 = 
pAdd»ss
->Zone;

671 (
NumS·»A»aToR—d
 !ğ0Uè&& (
add»ss¡©us
 =ğ
NAND_VALID_ADDRESS
))

674 
size
 = (
hÇnd
->
Info
.
S·»A»aSize
è+ ((hÇnd->Info.S·»A»aSizeè* 
num_¥¬e_¬—_»ad
);

677 
add»ssoff£t
 = 
	`ARRAY_ADDRESS
(&
Çndadd»ss
, 
hÇnd
);

680 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_AREA_C
;

682 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)) = 0x00U;

683 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_1ST_CYCLE
(
add»ssoff£t
);

684 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_2ND_CYCLE
(
add»ssoff£t
);

685 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_3RD_CYCLE
(
add»ssoff£t
);

688 if(
hÇnd
->
Info
.
BlockNbr
 >= 1024U)

690 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_4TH_CYCLE
(
add»ssoff£t
);

693 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_AREA_TRUE1
;

696 ; 
šdex
 < 
size
; index++)

698 *(
ušt8_t
 *)
pBufãr
++ = *(ušt8_ˆ*)
deviûadd»ss
;

702 
num_¥¬e_¬—_»ad
++;

705 
NumS·»A»aToR—d
--;

708 
add»ss¡©us
 = 
	`HAL_NAND_Add»ss_Inc
(
hÇnd
, &
Çndadd»ss
);

712 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

715 
	`__HAL_UNLOCK
(
hÇnd
);

717  
HAL_OK
;

718 
	}
}

729 
HAL_StusTy³Def
 
	$HAL_NAND_Wr™e_S·»A»a
(
NAND_HªdËTy³Def
 *
hÇnd
, 
NAND_Add»ssTy³Def
 *
pAdd»ss
, 
ušt8_t
 *
pBufãr
, 
ušt32_t
 
NumS·»A»aTowr™e
)

731 
__IO
 
ušt32_t
 
šdex
 = 0U;

732 
ušt32_t
 
tick¡¬t
 = 0U;

733 
ušt32_t
 
deviûadd»ss
 = 0U, 
size
 = 0U, 
num_¥¬e_¬—_wr™‹n
 = 0U, 
add»ss¡©us
 = 
NAND_VALID_ADDRESS
;

734 
NAND_Add»ssTy³Def
 
Çndadd»ss
;

735 
ušt32_t
 
add»ssoff£t
 = 0U;

738 
	`__HAL_LOCK
(
hÇnd
);

741 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

743  
HAL_BUSY
;

747 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

749 
deviûadd»ss
 = 
NAND_DEVICE1
;

753 
deviûadd»ss
 = 
NAND_DEVICE2
;

757 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

760 
Çndadd»ss
.
Block
 = 
pAdd»ss
->Block;

761 
Çndadd»ss
.
Page
 = 
pAdd»ss
->Page;

762 
Çndadd»ss
.
ZÚe
 = 
pAdd»ss
->Zone;

765 (
NumS·»A»aTowr™e
 !ğ0Uè&& (
add»ss¡©us
 =ğ
NAND_VALID_ADDRESS
))

768 
size
 = (
hÇnd
->
Info
.
S·»A»aSize
è+ ((hÇnd->Info.S·»A»aSizeè* 
num_¥¬e_¬—_wr™‹n
);

771 
add»ssoff£t
 = 
	`ARRAY_ADDRESS
(&
Çndadd»ss
, 
hÇnd
);

774 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_AREA_C
;

775 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_WRITE0
;

777 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)) = 0x00U;

778 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_1ST_CYCLE
(
add»ssoff£t
);

779 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_2ND_CYCLE
(
add»ssoff£t
);

780 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_3RD_CYCLE
(
add»ssoff£t
);

783 if(
hÇnd
->
Info
.
BlockNbr
 >= 1024U)

785 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_4TH_CYCLE
(
add»ssoff£t
);

789 ; 
šdex
 < 
size
; index++)

791 *(
__IO
 
ušt8_t
 *)
deviûadd»ss
 = *(ušt8_ˆ*)
pBufãr
++;

794 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_WRITE_TRUE1
;

797 
tick¡¬t
 = 
	`HAL_G‘Tick
();

800 
	`HAL_NAND_R—d_Stus
(
hÇnd
è!ğ
NAND_READY
)

802 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
NAND_WRITE_TIMEOUT
)

804  
HAL_TIMEOUT
;

809 
num_¥¬e_¬—_wr™‹n
++;

812 
NumS·»A»aTowr™e
--;

815 
add»ss¡©us
 = 
	`HAL_NAND_Add»ss_Inc
(
hÇnd
, &
Çndadd»ss
);

819 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

822 
	`__HAL_UNLOCK
(
hÇnd
);

824  
HAL_OK
;

825 
	}
}

834 
HAL_StusTy³Def
 
	$HAL_NAND_E¿£_Block
(
NAND_HªdËTy³Def
 *
hÇnd
, 
NAND_Add»ssTy³Def
 *
pAdd»ss
)

836 
ušt32_t
 
deviûadd»ss
 = 0U;

837 
ušt32_t
 
tick¡¬t
 = 0U;

840 
	`__HAL_LOCK
(
hÇnd
);

843 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

845  
HAL_BUSY
;

849 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

851 
deviûadd»ss
 = 
NAND_DEVICE1
;

855 
deviûadd»ss
 = 
NAND_DEVICE2
;

859 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

862 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_ERASE0
;

864 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_1ST_CYCLE
(
	`ARRAY_ADDRESS
(
pAdd»ss
, 
hÇnd
));

865 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_2ND_CYCLE
(
	`ARRAY_ADDRESS
(
pAdd»ss
, 
hÇnd
));

866 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_3RD_CYCLE
(
	`ARRAY_ADDRESS
(
pAdd»ss
, 
hÇnd
));

869 if(
hÇnd
->
Info
.
BlockNbr
 >= 1024U)

871 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
ADDR_AREA
)èğ
	`ADDR_4TH_CYCLE
(
	`ARRAY_ADDRESS
(
pAdd»ss
, 
hÇnd
));

874 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_ERASE1
;

877 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

880 
tick¡¬t
 = 
	`HAL_G‘Tick
();

883 
	`HAL_NAND_R—d_Stus
(
hÇnd
è!ğ
NAND_READY
)

885 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
NAND_WRITE_TIMEOUT
)

888 
	`__HAL_UNLOCK
(
hÇnd
);

890  
HAL_TIMEOUT
;

895 
	`__HAL_UNLOCK
(
hÇnd
);

897  
HAL_OK
;

898 
	}
}

906 
ušt32_t
 
	$HAL_NAND_R—d_Stus
(
NAND_HªdËTy³Def
 *
hÇnd
)

908 
ušt32_t
 
d©a
 = 0U;

909 
ušt32_t
 
deviûadd»ss
 = 0U;

912 if(
hÇnd
->
In™
.
NªdBªk
 =ğ
FMC_NAND_BANK2
)

914 
deviûadd»ss
 = 
NAND_DEVICE1
;

918 
deviûadd»ss
 = 
NAND_DEVICE2
;

922 *(
__IO
 
ušt8_t
 *)((
ušt32_t
)(
deviûadd»ss
 | 
CMD_AREA
)èğ
NAND_CMD_STATUS
;

925 
d©a
 = *(
__IO
 
ušt8_t
 *)
deviûadd»ss
;

928 if((
d©a
 & 
NAND_ERROR
) == NAND_ERROR)

930  
NAND_ERROR
;

932 if((
d©a
 & 
NAND_READY
) == NAND_READY)

934  
NAND_READY
;

937  
NAND_BUSY
;

938 
	}
}

949 
ušt32_t
 
	$HAL_NAND_Add»ss_Inc
(
NAND_HªdËTy³Def
 *
hÇnd
, 
NAND_Add»ssTy³Def
 *
pAdd»ss
)

951 
ušt32_t
 
¡©us
 = 
NAND_VALID_ADDRESS
;

954 
pAdd»ss
->
Page
++;

957 if(
pAdd»ss
->
Page
 =ğ
hÇnd
->
Info
.
BlockSize
)

959 
pAdd»ss
->
Page
 = 0U;

960 
pAdd»ss
->
Block
++;

962 if(
pAdd»ss
->
Block
 =ğ
hÇnd
->
Info
.
ZÚeSize
)

964 
pAdd»ss
->
Block
 = 0U;

965 
pAdd»ss
->
ZÚe
++;

967 if(
pAdd»ss
->
ZÚe
 =ğ(
hÇnd
->
Info
.
ZÚeSize
/ hÇnd->Info.
BlockNbr
))

969 
¡©us
 = 
NAND_INVALID_ADDRESS
;

974  (
¡©us
);

975 
	}
}

1002 
HAL_StusTy³Def
 
	$HAL_NAND_ECC_EÇbË
(
NAND_HªdËTy³Def
 *
hÇnd
)

1005 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

1007  
HAL_BUSY
;

1011 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

1014 
	`FMC_NAND_ECC_EÇbË
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
);

1017 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

1019  
HAL_OK
;

1020 
	}
}

1028 
HAL_StusTy³Def
 
	$HAL_NAND_ECC_Di§bË
(
NAND_HªdËTy³Def
 *
hÇnd
)

1031 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

1033  
HAL_BUSY
;

1037 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

1040 
	`FMC_NAND_ECC_Di§bË
(
hÇnd
->
In¡ªû
, hÇnd->
In™
.
NªdBªk
);

1043 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

1045  
HAL_OK
;

1046 
	}
}

1056 
HAL_StusTy³Def
 
	$HAL_NAND_G‘ECC
(
NAND_HªdËTy³Def
 *
hÇnd
, 
ušt32_t
 *
ECCv®
, ušt32_ˆ
Timeout
)

1058 
HAL_StusTy³Def
 
¡©us
 = 
HAL_OK
;

1061 if(
hÇnd
->
S‹
 =ğ
HAL_NAND_STATE_BUSY
)

1063  
HAL_BUSY
;

1067 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_BUSY
;

1070 
¡©us
 = 
	`FMC_NAND_G‘ECC
(
hÇnd
->
In¡ªû
, 
ECCv®
, hÇnd->
In™
.
NªdBªk
, 
Timeout
);

1073 
hÇnd
->
S‹
 = 
HAL_NAND_STATE_READY
;

1075  
¡©us
;

1076 
	}
}

1104 
HAL_NAND_S‹Ty³Def
 
	$HAL_NAND_G‘S‹
(
NAND_HªdËTy³Def
 *
hÇnd
)

1106  
hÇnd
->
S‹
;

1107 
	}
}

1122 
	gSTM32F427xx
 || 
	gSTM32F437xx
 || 
	gSTM32F429xx
 || 
	gSTM32F439xx
 ||\

1123 
	gSTM32F446xx
 || 
	gSTM32F469xx
 || 
	gSTM32F479xx
 */

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_pwr.c

44 
	~"¡m32f4xx_h®.h
"

55 #ifdeà
HAL_PWR_MODULE_ENABLED


66 
	#PVD_MODE_IT
 ((
ušt32_t
)0x00010000U)

	)

67 
	#PVD_MODE_EVT
 ((
ušt32_t
)0x00020000U)

	)

68 
	#PVD_RISING_EDGE
 ((
ušt32_t
)0x00000001U)

	)

69 
	#PVD_FALLING_EDGE
 ((
ušt32_t
)0x00000002U)

	)

110 
	$HAL_PWR_DeIn™
()

112 
	`__HAL_RCC_PWR_FORCE_RESET
();

113 
	`__HAL_RCC_PWR_RELEASE_RESET
();

114 
	}
}

123 
	$HAL_PWR_EÇbËBkUpAcûss
()

125 *(
__IO
 
ušt32_t
 *è
CR_DBP_BB
 = (ušt32_t)
ENABLE
;

126 
	}
}

135 
	$HAL_PWR_Di§bËBkUpAcûss
()

137 *(
__IO
 
ušt32_t
 *è
CR_DBP_BB
 = (ušt32_t)
DISABLE
;

138 
	}
}

270 
	$HAL_PWR_CÚfigPVD
(
PWR_PVDTy³Def
 *
sCÚfigPVD
)

273 
	`as£¹_·¿m
(
	`IS_PWR_PVD_LEVEL
(
sCÚfigPVD
->
PVDLev–
));

274 
	`as£¹_·¿m
(
	`IS_PWR_PVD_MODE
(
sCÚfigPVD
->
Mode
));

277 
	`MODIFY_REG
(
PWR
->
CR
, 
PWR_CR_PLS
, 
sCÚfigPVD
->
PVDLev–
);

280 
	`__HAL_PWR_PVD_EXTI_DISABLE_EVENT
();

281 
	`__HAL_PWR_PVD_EXTI_DISABLE_IT
();

282 
	`__HAL_PWR_PVD_EXTI_DISABLE_RISING_EDGE
();

283 
	`__HAL_PWR_PVD_EXTI_DISABLE_FALLING_EDGE
();

286 if((
sCÚfigPVD
->
Mode
 & 
PVD_MODE_IT
) == PVD_MODE_IT)

288 
	`__HAL_PWR_PVD_EXTI_ENABLE_IT
();

292 if((
sCÚfigPVD
->
Mode
 & 
PVD_MODE_EVT
) == PVD_MODE_EVT)

294 
	`__HAL_PWR_PVD_EXTI_ENABLE_EVENT
();

298 if((
sCÚfigPVD
->
Mode
 & 
PVD_RISING_EDGE
) == PVD_RISING_EDGE)

300 
	`__HAL_PWR_PVD_EXTI_ENABLE_RISING_EDGE
();

303 if((
sCÚfigPVD
->
Mode
 & 
PVD_FALLING_EDGE
) == PVD_FALLING_EDGE)

305 
	`__HAL_PWR_PVD_EXTI_ENABLE_FALLING_EDGE
();

307 
	}
}

313 
	$HAL_PWR_EÇbËPVD
()

315 *(
__IO
 
ušt32_t
 *è
CR_PVDE_BB
 = (ušt32_t)
ENABLE
;

316 
	}
}

322 
	$HAL_PWR_Di§bËPVD
()

324 *(
__IO
 
ušt32_t
 *è
CR_PVDE_BB
 = (ušt32_t)
DISABLE
;

325 
	}
}

336 
	$HAL_PWR_EÇbËWakeUpPš
(
ušt32_t
 
WakeUpPšx
)

339 
	`as£¹_·¿m
(
	`IS_PWR_WAKEUP_PIN
(
WakeUpPšx
));

342 
	`SET_BIT
(
PWR
->
CSR
, 
WakeUpPšx
);

343 
	}
}

354 
	$HAL_PWR_Di§bËWakeUpPš
(
ušt32_t
 
WakeUpPšx
)

357 
	`as£¹_·¿m
(
	`IS_PWR_WAKEUP_PIN
(
WakeUpPšx
));

360 
	`CLEAR_BIT
(
PWR
->
CSR
, 
WakeUpPšx
);

361 
	}
}

383 
	$HAL_PWR_EÁ”SLEEPMode
(
ušt32_t
 
ReguÏtÜ
, 
ušt8_t
 
SLEEPEÁry
)

386 
	`as£¹_·¿m
(
	`IS_PWR_REGULATOR
(
ReguÏtÜ
));

387 
	`as£¹_·¿m
(
	`IS_PWR_SLEEP_ENTRY
(
SLEEPEÁry
));

390 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

393 if(
SLEEPEÁry
 =ğ
PWR_SLEEPENTRY_WFI
)

396 
	`__WFI
();

401 
	`__SEV
();

402 
	`__WFE
();

403 
	`__WFE
();

405 
	}
}

426 
	$HAL_PWR_EÁ”STOPMode
(
ušt32_t
 
ReguÏtÜ
, 
ušt8_t
 
STOPEÁry
)

429 
	`as£¹_·¿m
(
	`IS_PWR_REGULATOR
(
ReguÏtÜ
));

430 
	`as£¹_·¿m
(
	`IS_PWR_STOP_ENTRY
(
STOPEÁry
));

433 
	`MODIFY_REG
(
PWR
->
CR
, (
PWR_CR_PDDS
 | 
PWR_CR_LPDS
), 
ReguÏtÜ
);

436 
	`SET_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

439 if(
STOPEÁry
 =ğ
PWR_STOPENTRY_WFI
)

442 
	`__WFI
();

447 
	`__SEV
();

448 
	`__WFE
();

449 
	`__WFE
();

452 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

453 
	}
}

465 
	$HAL_PWR_EÁ”STANDBYMode
()

468 
	`SET_BIT
(
PWR
->
CR
, 
PWR_CR_PDDS
);

471 
	`SET_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

474 #ià
	`defšed
 ( 
__CC_ARM
)

475 
	`__fÜû_¡Ües
();

478 
	`__WFI
();

479 
	}
}

486 
	$HAL_PWR_PVD_IRQHªdËr
()

489 if(
	`__HAL_PWR_PVD_EXTI_GET_FLAG
(è!ğ
RESET
)

492 
	`HAL_PWR_PVDC®lback
();

495 
	`__HAL_PWR_PVD_EXTI_CLEAR_FLAG
();

497 
	}
}

503 
__w—k
 
	$HAL_PWR_PVDC®lback
()

508 
	}
}

518 
	$HAL_PWR_EÇbËSË•OnEx™
()

521 
	`SET_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SLEEPONEXIT_Msk
));

522 
	}
}

530 
	$HAL_PWR_Di§bËSË•OnEx™
()

533 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SLEEPONEXIT_Msk
));

534 
	}
}

542 
	$HAL_PWR_EÇbËSEVOnP’d
()

545 
	`SET_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SEVONPEND_Msk
));

546 
	}
}

554 
	$HAL_PWR_Di§bËSEVOnP’d
()

557 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
ušt32_t
)
SCB_SCR_SEVONPEND_Msk
));

558 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_pwr_ex.c

43 
	~"¡m32f4xx_h®.h
"

54 #ifdeà
HAL_PWR_MODULE_ENABLED


61 
	#PWR_OVERDRIVE_TIMEOUT_VALUE
 1000U

	)

62 
	#PWR_UDERDRIVE_TIMEOUT_VALUE
 1000U

	)

63 
	#PWR_BKPREG_TIMEOUT_VALUE
 1000U

	)

64 
	#PWR_VOSRDY_TIMEOUT_VALUE
 1000U

	)

161 
HAL_StusTy³Def
 
	$HAL_PWREx_EÇbËBkUpReg
()

163 
ušt32_t
 
tick¡¬t
 = 0U;

165 *(
__IO
 
ušt32_t
 *è
CSR_BRE_BB
 = (ušt32_t)
ENABLE
;

168 
tick¡¬t
 = 
	`HAL_G‘Tick
();

171 
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_BRR
è=ğ
RESET
)

173 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PWR_BKPREG_TIMEOUT_VALUE
)

175  
HAL_TIMEOUT
;

178  
HAL_OK
;

179 
	}
}

185 
HAL_StusTy³Def
 
	$HAL_PWREx_Di§bËBkUpReg
()

187 
ušt32_t
 
tick¡¬t
 = 0U;

189 *(
__IO
 
ušt32_t
 *è
CSR_BRE_BB
 = (ušt32_t)
DISABLE
;

192 
tick¡¬t
 = 
	`HAL_G‘Tick
();

195 
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_BRR
è!ğ
RESET
)

197 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PWR_BKPREG_TIMEOUT_VALUE
)

199  
HAL_TIMEOUT
;

202  
HAL_OK
;

203 
	}
}

209 
	$HAL_PWREx_EÇbËFÏshPow”Down
()

211 *(
__IO
 
ušt32_t
 *è
CR_FPDS_BB
 = (ušt32_t)
ENABLE
;

212 
	}
}

218 
	$HAL_PWREx_Di§bËFÏshPow”Down
()

220 *(
__IO
 
ušt32_t
 *è
CR_FPDS_BB
 = (ušt32_t)
DISABLE
;

221 
	}
}

231 
ušt32_t
 
	$HAL_PWREx_G‘VŞgeRªge
()

233  (
PWR
->
CR
 & 
PWR_CR_VOS
);

234 
	}
}

236 #ià
defšed
(
STM32F405xx
è|| defšed(
STM32F415xx
è|| defšed(
STM32F407xx
è|| defšed(
STM32F417xx
)

252 
HAL_StusTy³Def
 
	$HAL_PWREx_CÚŒŞVŞgeSÿlšg
(
ušt32_t
 
VŞgeSÿlšg
)

254 
ušt32_t
 
tick¡¬t
 = 0U;

256 
	`as£¹_·¿m
(
	`IS_PWR_VOLTAGE_SCALING_RANGE
(
VŞgeSÿlšg
));

259 
	`__HAL_RCC_PWR_CLK_ENABLE
();

262 
	`__HAL_PWR_VOLTAGESCALING_CONFIG
(
VŞgeSÿlšg
);

265 
tick¡¬t
 = 
	`HAL_G‘Tick
();

266 (
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_VOSRDY
è=ğ
RESET
))

268 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PWR_VOSRDY_TIMEOUT_VALUE
)

270  
HAL_TIMEOUT
;

274  
HAL_OK
;

275 
	}
}

277 #–ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
) || \

278 
defšed
(
STM32F401xC
è|| defšed(
STM32F401xE
è|| defšed(
STM32F410Tx
è|| defšed(
STM32F410Cx
) || \

279 
defšed
(
STM32F410Rx
è|| defšed(
STM32F411xE
è|| defšed(
STM32F446xx
è|| defšed(
STM32F469xx
) || \

280 
defšed
(
STM32F479xx
è|| defšed(
STM32F412Zx
è|| defšed(
STM32F412Vx
è|| defšed(
STM32F412Rx
) || \

281 
	$defšed
(
STM32F412Cx
)

308 
HAL_StusTy³Def
 
	$HAL_PWREx_CÚŒŞVŞgeSÿlšg
(
ušt32_t
 
VŞgeSÿlšg
)

310 
ušt32_t
 
tick¡¬t
 = 0U;

312 
	`as£¹_·¿m
(
	`IS_PWR_VOLTAGE_SCALING_RANGE
(
VŞgeSÿlšg
));

315 
	`__HAL_RCC_PWR_CLK_ENABLE
();

318 if(
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è!ğ
RCC_CFGR_SWS_PLL
)

321 
	`__HAL_RCC_PLL_DISABLE
();

324 
tick¡¬t
 = 
	`HAL_G‘Tick
();

326 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è!ğ
RESET
)

328 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

330  
HAL_TIMEOUT
;

335 
	`__HAL_PWR_VOLTAGESCALING_CONFIG
(
VŞgeSÿlšg
);

338 
	`__HAL_RCC_PLL_ENABLE
();

341 
tick¡¬t
 = 
	`HAL_G‘Tick
();

343 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è=ğ
RESET
)

345 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

347  
HAL_TIMEOUT
;

352 
tick¡¬t
 = 
	`HAL_G‘Tick
();

353 (
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_VOSRDY
è=ğ
RESET
))

355 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PWR_VOSRDY_TIMEOUT_VALUE
)

357  
HAL_TIMEOUT
;

363  
HAL_ERROR
;

366  
HAL_OK
;

367 
	}
}

370 #ià
defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
)

375 
	$HAL_PWREx_EÇbËWakeUpPšPŞ¬™yRisšgEdge
()

377 *(
__IO
 
ušt32_t
 *è
CSR_WUPP_BB
 = (ušt32_t)
DISABLE
;

378 
	}
}

384 
	$HAL_PWREx_EÇbËWakeUpPšPŞ¬™yF®lšgEdge
()

386 *(
__IO
 
ušt32_t
 *è
CSR_WUPP_BB
 = (ušt32_t)
ENABLE
;

387 
	}
}

390 #ià
defšed
(
STM32F401xC
è|| defšed(
STM32F401xE
è|| defšed(
STM32F410Tx
è|| defšed(
STM32F410Cx
è|| defšed(
STM32F410Rx
) ||\

391 
defšed
(
STM32F411xE
è|| defšed(
STM32F412Zx
è|| defšed(
STM32F412Vx
è|| defšed(
STM32F412Rx
è|| 
	$defšed
(
STM32F412Cx
)

397 
	$HAL_PWREx_EÇbËMašReguÏtÜLowVŞge
()

399 *(
__IO
 
ušt32_t
 *è
CR_MRLVDS_BB
 = (ušt32_t)
ENABLE
;

400 
	}
}

407 
	$HAL_PWREx_Di§bËMašReguÏtÜLowVŞge
()

409 *(
__IO
 
ušt32_t
 *è
CR_MRLVDS_BB
 = (ušt32_t)
DISABLE
;

410 
	}
}

417 
	$HAL_PWREx_EÇbËLowReguÏtÜLowVŞge
()

419 *(
__IO
 
ušt32_t
 *è
CR_LPLVDS_BB
 = (ušt32_t)
ENABLE
;

420 
	}
}

427 
	$HAL_PWREx_Di§bËLowReguÏtÜLowVŞge
()

429 *(
__IO
 
ušt32_t
 *è
CR_LPLVDS_BB
 = (ušt32_t)
DISABLE
;

430 
	}
}

434 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
) ||\

435 
defšed
(
STM32F446xx
è|| defšed(
STM32F469xx
è|| 
	$defšed
(
STM32F479xx
)

447 
HAL_StusTy³Def
 
	$HAL_PWREx_EÇbËOv”Drive
()

449 
ušt32_t
 
tick¡¬t
 = 0U;

451 
	`__HAL_RCC_PWR_CLK_ENABLE
();

454 
	`__HAL_PWR_OVERDRIVE_ENABLE
();

457 
tick¡¬t
 = 
	`HAL_G‘Tick
();

459 !
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_ODRDY
))

461 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
è> 
PWR_OVERDRIVE_TIMEOUT_VALUE
)

463  
HAL_TIMEOUT
;

468 
	`__HAL_PWR_OVERDRIVESWITCHING_ENABLE
();

471 
tick¡¬t
 = 
	`HAL_G‘Tick
();

473 !
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_ODSWRDY
))

475 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PWR_OVERDRIVE_TIMEOUT_VALUE
)

477  
HAL_TIMEOUT
;

480  
HAL_OK
;

481 
	}
}

494 
HAL_StusTy³Def
 
	$HAL_PWREx_Di§bËOv”Drive
()

496 
ušt32_t
 
tick¡¬t
 = 0U;

498 
	`__HAL_RCC_PWR_CLK_ENABLE
();

501 
	`__HAL_PWR_OVERDRIVESWITCHING_DISABLE
();

504 
tick¡¬t
 = 
	`HAL_G‘Tick
();

506 
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_ODSWRDY
))

508 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
è> 
PWR_OVERDRIVE_TIMEOUT_VALUE
)

510  
HAL_TIMEOUT
;

515 
	`__HAL_PWR_OVERDRIVE_DISABLE
();

518 
tick¡¬t
 = 
	`HAL_G‘Tick
();

520 
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_ODRDY
))

522 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
è> 
PWR_OVERDRIVE_TIMEOUT_VALUE
)

524  
HAL_TIMEOUT
;

528  
HAL_OK
;

529 
	}
}

570 
HAL_StusTy³Def
 
	$HAL_PWREx_EÁ”Und”DriveSTOPMode
(
ušt32_t
 
ReguÏtÜ
, 
ušt8_t
 
STOPEÁry
)

572 
ušt32_t
 
tm´eg1
 = 0U;

573 
ušt32_t
 
tick¡¬t
 = 0U;

576 
	`as£¹_·¿m
(
	`IS_PWR_REGULATOR_UNDERDRIVE
(
ReguÏtÜ
));

577 
	`as£¹_·¿m
(
	`IS_PWR_STOP_ENTRY
(
STOPEÁry
));

580 
	`__HAL_RCC_PWR_CLK_ENABLE
();

583 
	`__HAL_PWR_CLEAR_ODRUDR_FLAG
();

586 
	`__HAL_PWR_UNDERDRIVE_ENABLE
();

589 
tick¡¬t
 = 
	`HAL_G‘Tick
();

592 
	`__HAL_PWR_GET_FLAG
(
PWR_FLAG_UDRDY
))

594 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
è> 
PWR_UDERDRIVE_TIMEOUT_VALUE
)

596  
HAL_TIMEOUT
;

601 
tm´eg1
 = 
PWR
->
CR
;

603 
tm´eg1
 &ğ(
ušt32_t
)~(
PWR_CR_PDDS
 | 
PWR_CR_LPDS
 | 
PWR_CR_LPUDS
 | 
PWR_CR_MRUDS
);

606 
tm´eg1
 |ğ
ReguÏtÜ
;

609 
PWR
->
CR
 = 
tm´eg1
;

612 
SCB
->
SCR
 |ğ
SCB_SCR_SLEEPDEEP_Msk
;

615 if(
STOPEÁry
 =ğ
PWR_SLEEPENTRY_WFI
)

618 
	`__WFI
();

623 
	`__WFE
();

626 
SCB
->
SCR
 &ğ(
ušt32_t
)~((ušt32_t)
SCB_SCR_SLEEPDEEP_Msk
);

628  
HAL_OK
;

629 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rcc.c

87 
	~"¡m32f4xx_h®.h
"

98 #ifdeà
HAL_RCC_MODULE_ENABLED


105 
	#CLOCKSWITCH_TIMEOUT_VALUE
 ((
ušt32_t
)5000Uè

	)

108 
	#__MCO1_CLK_ENABLE
(è
	`__HAL_RCC_GPIOA_CLK_ENABLE
()

	)

109 
	#MCO1_GPIO_PORT
 
GPIOA


	)

110 
	#MCO1_PIN
 
GPIO_PIN_8


	)

112 
	#__MCO2_CLK_ENABLE
(è
	`__HAL_RCC_GPIOC_CLK_ENABLE
()

	)

113 
	#MCO2_GPIO_PORT
 
GPIOC


	)

114 
	#MCO2_PIN
 
GPIO_PIN_9


	)

123 cÚ¡ 
ušt8_t
 
	gAPBAHBP»scTabË
[16] = {0U, 0U, 0U, 0U, 1U, 2U, 3U, 4U, 1U, 2U, 3U, 4U, 6U, 7U, 8U, 9U};

223 
__w—k
 
	$HAL_RCC_DeIn™
()

224 {
	}
}

240 
__w—k
 
HAL_StusTy³Def
 
	$HAL_RCC_OscCÚfig
(
RCC_OscIn™Ty³Def
 *
RCC_OscIn™SŒuù
)

242 
ušt32_t
 
tick¡¬t
 = 0U;

245 
	`as£¹_·¿m
(
	`IS_RCC_OSCILLATORTYPE
(
RCC_OscIn™SŒuù
->
OscÏtÜTy³
));

247 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_HSE
) == RCC_OSCILLATORTYPE_HSE)

250 
	`as£¹_·¿m
(
	`IS_RCC_HSE
(
RCC_OscIn™SŒuù
->
HSES‹
));

252 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_HSE
) ||\

253 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLL
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSE
)))

255 if((
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
è!ğ
RESET
è&& (
RCC_OscIn™SŒuù
->
HSES‹
 =ğ
RCC_HSE_OFF
))

257  
HAL_ERROR
;

263 
	`__HAL_RCC_HSE_CONFIG
(
RCC_OscIn™SŒuù
->
HSES‹
);

266 if((
RCC_OscIn™SŒuù
->
HSES‹
è!ğ
RCC_HSE_OFF
)

269 
tick¡¬t
 = 
	`HAL_G‘Tick
();

272 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
è=ğ
RESET
)

274 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSE_TIMEOUT_VALUE
)

276  
HAL_TIMEOUT
;

283 
tick¡¬t
 = 
	`HAL_G‘Tick
();

286 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
è!ğ
RESET
)

288 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSE_TIMEOUT_VALUE
)

290  
HAL_TIMEOUT
;

297 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_HSI
) == RCC_OSCILLATORTYPE_HSI)

300 
	`as£¹_·¿m
(
	`IS_RCC_HSI
(
RCC_OscIn™SŒuù
->
HSIS‹
));

301 
	`as£¹_·¿m
(
	`IS_RCC_CALIBRATION_VALUE
(
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
));

304 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_HSI
) ||\

305 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLL
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSI
)))

308 if((
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
è!ğ
RESET
è&& (
RCC_OscIn™SŒuù
->
HSIS‹
 !ğ
RCC_HSI_ON
))

310  
HAL_ERROR
;

316 
	`__HAL_RCC_HSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
);

322 if((
RCC_OscIn™SŒuù
->
HSIS‹
)!ğ
RCC_HSI_OFF
)

325 
	`__HAL_RCC_HSI_ENABLE
();

328 
tick¡¬t
 = 
	`HAL_G‘Tick
();

331 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
è=ğ
RESET
)

333 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSI_TIMEOUT_VALUE
)

335  
HAL_TIMEOUT
;

340 
	`__HAL_RCC_HSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
);

345 
	`__HAL_RCC_HSI_DISABLE
();

348 
tick¡¬t
 = 
	`HAL_G‘Tick
();

351 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
è!ğ
RESET
)

353 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSI_TIMEOUT_VALUE
)

355  
HAL_TIMEOUT
;

362 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_LSI
) == RCC_OSCILLATORTYPE_LSI)

365 
	`as£¹_·¿m
(
	`IS_RCC_LSI
(
RCC_OscIn™SŒuù
->
LSIS‹
));

368 if((
RCC_OscIn™SŒuù
->
LSIS‹
)!ğ
RCC_LSI_OFF
)

371 
	`__HAL_RCC_LSI_ENABLE
();

374 
tick¡¬t
 = 
	`HAL_G‘Tick
();

377 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSIRDY
è=ğ
RESET
)

379 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
LSI_TIMEOUT_VALUE
)

381  
HAL_TIMEOUT
;

388 
	`__HAL_RCC_LSI_DISABLE
();

391 
tick¡¬t
 = 
	`HAL_G‘Tick
();

394 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSIRDY
è!ğ
RESET
)

396 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
LSI_TIMEOUT_VALUE
)

398  
HAL_TIMEOUT
;

404 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_LSE
) == RCC_OSCILLATORTYPE_LSE)

407 
	`as£¹_·¿m
(
	`IS_RCC_LSE
(
RCC_OscIn™SŒuù
->
LSES‹
));

410 
	`__HAL_RCC_PWR_CLK_ENABLE
();

413 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

416 
tick¡¬t
 = 
	`HAL_G‘Tick
();

418 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

420 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

422  
HAL_TIMEOUT
;

427 
	`__HAL_RCC_LSE_CONFIG
(
RCC_OscIn™SŒuù
->
LSES‹
);

429 if((
RCC_OscIn™SŒuù
->
LSES‹
è!ğ
RCC_LSE_OFF
)

432 
tick¡¬t
 = 
	`HAL_G‘Tick
();

435 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

437 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

439  
HAL_TIMEOUT
;

446 
tick¡¬t
 = 
	`HAL_G‘Tick
();

449 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è!ğ
RESET
)

451 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

453  
HAL_TIMEOUT
;

460 
	`as£¹_·¿m
(
	`IS_RCC_PLL
(
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
));

461 ià((
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
è!ğ
RCC_PLL_NONE
)

464 if(
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è!ğ
RCC_CFGR_SWS_PLL
)

466 if((
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
è=ğ
RCC_PLL_ON
)

469 
	`as£¹_·¿m
(
	`IS_RCC_PLLSOURCE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLSourû
));

470 
	`as£¹_·¿m
(
	`IS_RCC_PLLM_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLM
));

471 
	`as£¹_·¿m
(
	`IS_RCC_PLLN_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLN
));

472 
	`as£¹_·¿m
(
	`IS_RCC_PLLP_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLP
));

473 
	`as£¹_·¿m
(
	`IS_RCC_PLLQ_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLQ
));

476 
	`__HAL_RCC_PLL_DISABLE
();

479 
tick¡¬t
 = 
	`HAL_G‘Tick
();

482 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è!ğ
RESET
)

484 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

486  
HAL_TIMEOUT
;

491 
	`WRITE_REG
(
RCC
->
PLLCFGR
, (
RCC_OscIn™SŒuù
->
PLL
.
PLLSourû
 | \

492 
RCC_OscIn™SŒuù
->
PLL
.
PLLM
 | \

493 (
RCC_OscIn™SŒuù
->
PLL
.
PLLN
 << 
	`POSITION_VAL
(
RCC_PLLCFGR_PLLN
)) | \

494 (((
RCC_OscIn™SŒuù
->
PLL
.
PLLP
 >> 1Uè- 1Uè<< 
	`POSITION_VAL
(
RCC_PLLCFGR_PLLP
)) | \

495 (
RCC_OscIn™SŒuù
->
PLL
.
PLLQ
 << 
	`POSITION_VAL
(
RCC_PLLCFGR_PLLQ
))));

497 
	`__HAL_RCC_PLL_ENABLE
();

500 
tick¡¬t
 = 
	`HAL_G‘Tick
();

503 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è=ğ
RESET
)

505 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

507  
HAL_TIMEOUT
;

514 
	`__HAL_RCC_PLL_DISABLE
();

517 
tick¡¬t
 = 
	`HAL_G‘Tick
();

520 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è!ğ
RESET
)

522 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

524  
HAL_TIMEOUT
;

531  
HAL_ERROR
;

534  
HAL_OK
;

535 
	}
}

562 
HAL_StusTy³Def
 
	$HAL_RCC_ClockCÚfig
(
RCC_ClkIn™Ty³Def
 *
RCC_ClkIn™SŒuù
, 
ušt32_t
 
FL©’cy
)

564 
ušt32_t
 
tick¡¬t
 = 0U;

567 
	`as£¹_·¿m
(
	`IS_RCC_CLOCKTYPE
(
RCC_ClkIn™SŒuù
->
ClockTy³
));

568 
	`as£¹_·¿m
(
	`IS_FLASH_LATENCY
(
FL©’cy
));

575 if(
FL©’cy
 > (
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
))

578 
	`__HAL_FLASH_SET_LATENCY
(
FL©’cy
);

582 if((
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
è!ğ
FL©’cy
)

584  
HAL_ERROR
;

589 if(((
RCC_ClkIn™SŒuù
->
ClockTy³
è& 
RCC_CLOCKTYPE_HCLK
) == RCC_CLOCKTYPE_HCLK)

591 
	`as£¹_·¿m
(
	`IS_RCC_HCLK
(
RCC_ClkIn™SŒuù
->
AHBCLKDivid”
));

592 
	`MODIFY_REG
(
RCC
->
CFGR
, 
RCC_CFGR_HPRE
, 
RCC_ClkIn™SŒuù
->
AHBCLKDivid”
);

596 if(((
RCC_ClkIn™SŒuù
->
ClockTy³
è& 
RCC_CLOCKTYPE_SYSCLK
) == RCC_CLOCKTYPE_SYSCLK)

598 
	`as£¹_·¿m
(
	`IS_RCC_SYSCLKSOURCE
(
RCC_ClkIn™SŒuù
->
SYSCLKSourû
));

601 if(
RCC_ClkIn™SŒuù
->
SYSCLKSourû
 =ğ
RCC_SYSCLKSOURCE_HSE
)

604 if(
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
è=ğ
RESET
)

606  
HAL_ERROR
;

610 if((
RCC_ClkIn™SŒuù
->
SYSCLKSourû
 =ğ
RCC_SYSCLKSOURCE_PLLCLK
) ||

611 (
RCC_ClkIn™SŒuù
->
SYSCLKSourû
 =ğ
RCC_SYSCLKSOURCE_PLLRCLK
))

614 if(
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è=ğ
RESET
)

616  
HAL_ERROR
;

623 if(
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
è=ğ
RESET
)

625  
HAL_ERROR
;

629 
	`__HAL_RCC_SYSCLK_CONFIG
(
RCC_ClkIn™SŒuù
->
SYSCLKSourû
);

631 
tick¡¬t
 = 
	`HAL_G‘Tick
();

633 if(
RCC_ClkIn™SŒuù
->
SYSCLKSourû
 =ğ
RCC_SYSCLKSOURCE_HSE
)

635 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è!ğ
RCC_SYSCLKSOURCE_STATUS_HSE
)

637 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

639  
HAL_TIMEOUT
;

643 if(
RCC_ClkIn™SŒuù
->
SYSCLKSourû
 =ğ
RCC_SYSCLKSOURCE_PLLCLK
)

645 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è!ğ
RCC_SYSCLKSOURCE_STATUS_PLLCLK
)

647 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

649  
HAL_TIMEOUT
;

653 if(
RCC_ClkIn™SŒuù
->
SYSCLKSourû
 =ğ
RCC_SYSCLKSOURCE_PLLRCLK
)

655 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è!ğ
RCC_SYSCLKSOURCE_STATUS_PLLRCLK
)

657 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

659  
HAL_TIMEOUT
;

665 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è!ğ
RCC_SYSCLKSOURCE_STATUS_HSI
)

667 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

669  
HAL_TIMEOUT
;

676 if(
FL©’cy
 < (
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
))

679 
	`__HAL_FLASH_SET_LATENCY
(
FL©’cy
);

683 if((
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
è!ğ
FL©’cy
)

685  
HAL_ERROR
;

690 if(((
RCC_ClkIn™SŒuù
->
ClockTy³
è& 
RCC_CLOCKTYPE_PCLK1
) == RCC_CLOCKTYPE_PCLK1)

692 
	`as£¹_·¿m
(
	`IS_RCC_PCLK
(
RCC_ClkIn™SŒuù
->
APB1CLKDivid”
));

693 
	`MODIFY_REG
(
RCC
->
CFGR
, 
RCC_CFGR_PPRE1
, 
RCC_ClkIn™SŒuù
->
APB1CLKDivid”
);

697 if(((
RCC_ClkIn™SŒuù
->
ClockTy³
è& 
RCC_CLOCKTYPE_PCLK2
) == RCC_CLOCKTYPE_PCLK2)

699 
	`as£¹_·¿m
(
	`IS_RCC_PCLK
(
RCC_ClkIn™SŒuù
->
APB2CLKDivid”
));

700 
	`MODIFY_REG
(
RCC
->
CFGR
, 
RCC_CFGR_PPRE2
, ((
RCC_ClkIn™SŒuù
->
APB2CLKDivid”
) << 3U));

704 
Sy¡emCÜeClock
 = 
	`HAL_RCC_G‘SysClockF»q
(è>> 
APBAHBP»scTabË
[(
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
)>> 
	`POSITION_VAL
(RCC_CFGR_HPRE)];

707 
	`HAL_In™Tick
 (
TICK_INT_PRIORITY
);

709  
HAL_OK
;

710 
	}
}

760 
	$HAL_RCC_MCOCÚfig
(
ušt32_t
 
RCC_MCOx
, ušt32_ˆ
RCC_MCOSourû
, ušt32_ˆ
RCC_MCODiv
)

762 
GPIO_In™Ty³Def
 
GPIO_In™SŒuù
;

764 
	`as£¹_·¿m
(
	`IS_RCC_MCO
(
RCC_MCOx
));

765 
	`as£¹_·¿m
(
	`IS_RCC_MCODIV
(
RCC_MCODiv
));

767 if(
RCC_MCOx
 =ğ
RCC_MCO1
)

769 
	`as£¹_·¿m
(
	`IS_RCC_MCO1SOURCE
(
RCC_MCOSourû
));

772 
	`__MCO1_CLK_ENABLE
();

775 
GPIO_In™SŒuù
.
Pš
 = 
MCO1_PIN
;

776 
GPIO_In™SŒuù
.
Mode
 = 
GPIO_MODE_AF_PP
;

777 
GPIO_In™SŒuù
.
S³ed
 = 
GPIO_SPEED_FREQ_VERY_HIGH
;

778 
GPIO_In™SŒuù
.
PuÎ
 = 
GPIO_NOPULL
;

779 
GPIO_In™SŒuù
.
AÉ”Ç‹
 = 
GPIO_AF0_MCO
;

780 
	`HAL_GPIO_In™
(
MCO1_GPIO_PORT
, &
GPIO_In™SŒuù
);

783 
	`MODIFY_REG
(
RCC
->
CFGR
, (
RCC_CFGR_MCO1
 | 
RCC_CFGR_MCO1PRE
), (
RCC_MCOSourû
 | 
RCC_MCODiv
));

786 #ià
	`defšed
(
RCC_CFGR_MCO1EN
)

787 
	`__HAL_RCC_MCO1_ENABLE
();

790 #ià
	`defšed
(
RCC_CFGR_MCO2
)

793 
	`as£¹_·¿m
(
	`IS_RCC_MCO2SOURCE
(
RCC_MCOSourû
));

796 
	`__MCO2_CLK_ENABLE
();

799 
GPIO_In™SŒuù
.
Pš
 = 
MCO2_PIN
;

800 
GPIO_In™SŒuù
.
Mode
 = 
GPIO_MODE_AF_PP
;

801 
GPIO_In™SŒuù
.
S³ed
 = 
GPIO_SPEED_FREQ_VERY_HIGH
;

802 
GPIO_In™SŒuù
.
PuÎ
 = 
GPIO_NOPULL
;

803 
GPIO_In™SŒuù
.
AÉ”Ç‹
 = 
GPIO_AF0_MCO
;

804 
	`HAL_GPIO_In™
(
MCO2_GPIO_PORT
, &
GPIO_In™SŒuù
);

807 
	`MODIFY_REG
(
RCC
->
CFGR
, (
RCC_CFGR_MCO2
 | 
RCC_CFGR_MCO2PRE
), (
RCC_MCOSourû
 | (
RCC_MCODiv
 << 3U)));

810 #ià
	`defšed
(
RCC_CFGR_MCO2EN
)

811 
	`__HAL_RCC_MCO2_ENABLE
();

815 
	}
}

826 
	$HAL_RCC_EÇbËCSS
()

828 *(
__IO
 
ušt32_t
 *è
RCC_CR_CSSON_BB
 = (ušt32_t)
ENABLE
;

829 
	}
}

835 
	$HAL_RCC_Di§bËCSS
()

837 *(
__IO
 
ušt32_t
 *è
RCC_CR_CSSON_BB
 = (ušt32_t)
DISABLE
;

838 
	}
}

870 
__w—k
 
ušt32_t
 
	$HAL_RCC_G‘SysClockF»q
()

872 
ušt32_t
 
¶lm
 = 0U, 
¶lvco
 = 0U, 
¶Í
 = 0U;

873 
ušt32_t
 
sysşockäeq
 = 0U;

876 
RCC
->
CFGR
 & 
RCC_CFGR_SWS
)

878 
RCC_CFGR_SWS_HSI
:

880 
sysşockäeq
 = 
HSI_VALUE
;

883 
RCC_CFGR_SWS_HSE
:

885 
sysşockäeq
 = 
HSE_VALUE
;

888 
RCC_CFGR_SWS_PLL
:

892 
¶lm
 = 
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
;

893 if(
	`__HAL_RCC_GET_PLL_OSCSOURCE
(è!ğ
RCC_PLLSOURCE_HSI
)

896 
¶lvco
 = ((
HSE_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN)));

901 
¶lvco
 = ((
HSI_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN)));

903 
¶Í
 = ((((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLP
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLP)) + 1U) *2U);

905 
sysşockäeq
 = 
¶lvco
/
¶Í
;

910 
sysşockäeq
 = 
HSI_VALUE
;

914  
sysşockäeq
;

915 
	}
}

926 
ušt32_t
 
	$HAL_RCC_G‘HCLKF»q
()

928  
Sy¡emCÜeClock
;

929 
	}
}

937 
ušt32_t
 
	$HAL_RCC_G‘PCLK1F»q
()

940  (
	`HAL_RCC_G‘HCLKF»q
(è>> 
APBAHBP»scTabË
[(
RCC
->
CFGR
 & 
RCC_CFGR_PPRE1
)>> 
	`POSITION_VAL
(RCC_CFGR_PPRE1)]);

941 
	}
}

949 
ušt32_t
 
	$HAL_RCC_G‘PCLK2F»q
()

952  (
	`HAL_RCC_G‘HCLKF»q
()>> 
APBAHBP»scTabË
[(
RCC
->
CFGR
 & 
RCC_CFGR_PPRE2
)>> 
	`POSITION_VAL
(RCC_CFGR_PPRE2)]);

953 
	}
}

962 
__w—k
 
	$HAL_RCC_G‘OscCÚfig
(
RCC_OscIn™Ty³Def
 *
RCC_OscIn™SŒuù
)

965 
RCC_OscIn™SŒuù
->
OscÏtÜTy³
 = 
RCC_OSCILLATORTYPE_HSE
 | 
RCC_OSCILLATORTYPE_HSI
 | 
RCC_OSCILLATORTYPE_LSE
 | 
RCC_OSCILLATORTYPE_LSI
;

968 if((
RCC
->
CR
 &
RCC_CR_HSEBYP
) == RCC_CR_HSEBYP)

970 
RCC_OscIn™SŒuù
->
HSES‹
 = 
RCC_HSE_BYPASS
;

972 if((
RCC
->
CR
 &
RCC_CR_HSEON
) == RCC_CR_HSEON)

974 
RCC_OscIn™SŒuù
->
HSES‹
 = 
RCC_HSE_ON
;

978 
RCC_OscIn™SŒuù
->
HSES‹
 = 
RCC_HSE_OFF
;

982 if((
RCC
->
CR
 &
RCC_CR_HSION
) == RCC_CR_HSION)

984 
RCC_OscIn™SŒuù
->
HSIS‹
 = 
RCC_HSI_ON
;

988 
RCC_OscIn™SŒuù
->
HSIS‹
 = 
RCC_HSI_OFF
;

991 
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
 = (
ušt32_t
)((
RCC
->
CR
 &
RCC_CR_HSITRIM
è>> 
	`POSITION_VAL
(RCC_CR_HSITRIM));

994 if((
RCC
->
BDCR
 &
RCC_BDCR_LSEBYP
) == RCC_BDCR_LSEBYP)

996 
RCC_OscIn™SŒuù
->
LSES‹
 = 
RCC_LSE_BYPASS
;

998 if((
RCC
->
BDCR
 &
RCC_BDCR_LSEON
) == RCC_BDCR_LSEON)

1000 
RCC_OscIn™SŒuù
->
LSES‹
 = 
RCC_LSE_ON
;

1004 
RCC_OscIn™SŒuù
->
LSES‹
 = 
RCC_LSE_OFF
;

1008 if((
RCC
->
CSR
 &
RCC_CSR_LSION
) == RCC_CSR_LSION)

1010 
RCC_OscIn™SŒuù
->
LSIS‹
 = 
RCC_LSI_ON
;

1014 
RCC_OscIn™SŒuù
->
LSIS‹
 = 
RCC_LSI_OFF
;

1018 if((
RCC
->
CR
 &
RCC_CR_PLLON
) == RCC_CR_PLLON)

1020 
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
 = 
RCC_PLL_ON
;

1024 
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
 = 
RCC_PLL_OFF
;

1026 
RCC_OscIn™SŒuù
->
PLL
.
PLLSourû
 = (
ušt32_t
)(
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
);

1027 
RCC_OscIn™SŒuù
->
PLL
.
PLLM
 = (
ušt32_t
)(
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
);

1028 
RCC_OscIn™SŒuù
->
PLL
.
PLLN
 = (
ušt32_t
)((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN));

1029 
RCC_OscIn™SŒuù
->
PLL
.
PLLP
 = (
ušt32_t
)((((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLP
è+ 
RCC_PLLCFGR_PLLP_0
è<< 1Uè>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLP));

1030 
RCC_OscIn™SŒuù
->
PLL
.
PLLQ
 = (
ušt32_t
)((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLQ
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLQ));

1031 
	}
}

1041 
	$HAL_RCC_G‘ClockCÚfig
(
RCC_ClkIn™Ty³Def
 *
RCC_ClkIn™SŒuù
, 
ušt32_t
 *
pFL©’cy
)

1044 
RCC_ClkIn™SŒuù
->
ClockTy³
 = 
RCC_CLOCKTYPE_SYSCLK
 | 
RCC_CLOCKTYPE_HCLK
 | 
RCC_CLOCKTYPE_PCLK1
 | 
RCC_CLOCKTYPE_PCLK2
;

1047 
RCC_ClkIn™SŒuù
->
SYSCLKSourû
 = (
ušt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_SW
);

1050 
RCC_ClkIn™SŒuù
->
AHBCLKDivid”
 = (
ušt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
);

1053 
RCC_ClkIn™SŒuù
->
APB1CLKDivid”
 = (
ušt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_PPRE1
);

1056 
RCC_ClkIn™SŒuù
->
APB2CLKDivid”
 = (
ušt32_t
)((
RCC
->
CFGR
 & 
RCC_CFGR_PPRE2
) >> 3U);

1059 *
pFL©’cy
 = (
ušt32_t
)(
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
);

1060 
	}
}

1067 
	$HAL_RCC_NMI_IRQHªdËr
()

1070 if(
	`__HAL_RCC_GET_IT
(
RCC_IT_CSS
))

1073 
	`HAL_RCC_CSSC®lback
();

1076 
	`__HAL_RCC_CLEAR_IT
(
RCC_IT_CSS
);

1078 
	}
}

1084 
__w—k
 
	$HAL_RCC_CSSC®lback
()

1089 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rcc_ex.c

43 
	~"¡m32f4xx_h®.h
"

54 #ifdeà
HAL_RCC_MODULE_ENABLED


91 #ià
defšed
(
STM32F405xx
è|| defšed(
STM32F415xx
è|| defšed(
STM32F407xx
è|| defšed(
STM32F417xx
) || \

92 
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
) || \

93 
defšed
(
STM32F401xC
è|| defšed(
STM32F401xE
è|| defšed(
STM32F411xE
è|| defšed(
STM32F446xx
) || \

94 
defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
è|| defšed(
STM32F412Zx
è|| defšed(
STM32F412Vx
) || \

95 
defšed
(
STM32F412Rx
è|| 
	$defšed
(
STM32F412Cx
)

109 
	$HAL_RCC_DeIn™
()

112 
	`SET_BIT
(
RCC
->
CR
, 
RCC_CR_HSION
 | 
RCC_CR_HSITRIM_4
);

115 
	`CLEAR_REG
(
RCC
->
CFGR
);

118 
	`CLEAR_BIT
(
RCC
->
CR
, 
RCC_CR_HSEON
 | 
RCC_CR_CSSON
 | 
RCC_CR_PLLON
| 
RCC_CR_PLLI2SON
);

121 
	`CLEAR_REG
(
RCC
->
PLLCFGR
);

122 
	`SET_BIT
(
RCC
->
PLLCFGR
, 
RCC_PLLCFGR_PLLM_4
 | 
RCC_PLLCFGR_PLLN_6
 | 
RCC_PLLCFGR_PLLN_7
 | 
RCC_PLLCFGR_PLLQ_2
);

125 
	`CLEAR_REG
(
RCC
->
PLLI2SCFGR
);

126 
	`SET_BIT
(
RCC
->
PLLI2SCFGR
, 
RCC_PLLI2SCFGR_PLLI2SN_6
 | 
RCC_PLLI2SCFGR_PLLI2SN_7
 | 
RCC_PLLI2SCFGR_PLLI2SR_1
);

129 
	`CLEAR_BIT
(
RCC
->
CR
, 
RCC_CR_HSEBYP
);

132 
	`CLEAR_REG
(
RCC
->
CIR
);

135 
Sy¡emCÜeClock
 = 
HSI_VALUE
;

136 
	}
}

138 
	gSTM32F401xC
 || 
	gSTM32F401xE
 || 
	gSTM32F411xE
 || 
	gSTM32F446xx
 || 
	gSTM32F469xx
 || 
	gSTM32F479xx
 || 
	gSTM32F412Zx
 || 
	gSTM32F412Vx
 ||

139 
	gSTM32F412Rx
 || 
	gSTM32F412Cx
 */

141 #ià
defšed
(
STM32F410Tx
è|| defšed(
STM32F410Cx
è|| defšed(
STM32F410Rx
)

155 
	$HAL_RCC_DeIn™
()

158 
	`SET_BIT
(
RCC
->
CR
, 
RCC_CR_HSION
 | 
RCC_CR_HSITRIM_4
);

161 
	`CLEAR_REG
(
RCC
->
CFGR
);

164 
	`CLEAR_BIT
(
RCC
->
CR
, 
RCC_CR_HSEON
 | 
RCC_CR_CSSON
 | 
RCC_CR_PLLON
);

167 
	`CLEAR_REG
(
RCC
->
PLLCFGR
);

168 
	`SET_BIT
(
RCC
->
PLLCFGR
, 
RCC_PLLCFGR_PLLR_1
 | 
RCC_PLLCFGR_PLLM_4
 | 
RCC_PLLCFGR_PLLN_6
 | 
RCC_PLLCFGR_PLLN_7
 | 
RCC_PLLCFGR_PLLQ_2
);

171 
	`CLEAR_BIT
(
RCC
->
CR
, 
RCC_CR_HSEBYP
);

174 
	`CLEAR_REG
(
RCC
->
CIR
);

177 
Sy¡emCÜeClock
 = 
HSI_VALUE
;

178 
	}
}

181 #ià
defšed
(
STM32F446xx
)

196 
HAL_StusTy³Def
 
	$HAL_RCCEx_P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

198 
ušt32_t
 
tick¡¬t
 = 0U;

199 
ušt32_t
 
tm´eg1
 = 0U;

200 
ušt32_t
 
¶li2¥
 = 0U;

201 
ušt32_t
 
¶li2sq
 = 0U;

202 
ušt32_t
 
¶li2¤
 = 0U;

203 
ušt32_t
 
¶l§
 = 0U;

204 
ušt32_t
 
¶l§iq
 = 0U;

205 
ušt32_t
 
¶li2su£d
 = 0U;

206 
ušt32_t
 
¶l§iu£d
 = 0U;

209 
	`as£¹_·¿m
(
	`IS_RCC_PERIPHCLOCK
(
P”hClkIn™
->
P”hClockS–eùiÚ
));

212 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB1
) == (RCC_PERIPHCLK_I2S_APB1))

215 
	`as£¹_·¿m
(
	`IS_RCC_I2SAPB1CLKSOURCE
(
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
));

218 
	`__HAL_RCC_I2S_APB1_CONFIG
(
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
);

220 if(
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
 =ğ
RCC_I2SAPB1CLKSOURCE_PLLI2S
)

222 
¶li2su£d
 = 1U;

228 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB2
) == (RCC_PERIPHCLK_I2S_APB2))

231 
	`as£¹_·¿m
(
	`IS_RCC_I2SAPB2CLKSOURCE
(
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
));

234 
	`__HAL_RCC_I2S_APB2_CONFIG
(
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
);

236 if(
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
 =ğ
RCC_I2SAPB2CLKSOURCE_PLLI2S
)

238 
¶li2su£d
 = 1U;

244 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI1
) == (RCC_PERIPHCLK_SAI1))

247 
	`as£¹_·¿m
(
	`IS_RCC_SAI1CLKSOURCE
(
P”hClkIn™
->
Sai1ClockS–eùiÚ
));

250 
	`__HAL_RCC_SAI1_CONFIG
(
P”hClkIn™
->
Sai1ClockS–eùiÚ
);

252 if(
P”hClkIn™
->
Sai1ClockS–eùiÚ
 =ğ
RCC_SAI1CLKSOURCE_PLLI2S
)

254 
¶li2su£d
 = 1U;

257 if(
P”hClkIn™
->
Sai1ClockS–eùiÚ
 =ğ
RCC_SAI1CLKSOURCE_PLLSAI
)

259 
¶l§iu£d
 = 1U;

265 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI2
) == (RCC_PERIPHCLK_SAI2))

268 
	`as£¹_·¿m
(
	`IS_RCC_SAI2CLKSOURCE
(
P”hClkIn™
->
Sai2ClockS–eùiÚ
));

271 
	`__HAL_RCC_SAI2_CONFIG
(
P”hClkIn™
->
Sai2ClockS–eùiÚ
);

274 if(
P”hClkIn™
->
Sai2ClockS–eùiÚ
 =ğ
RCC_SAI2CLKSOURCE_PLLI2S
)

276 
¶li2su£d
 = 1U;

279 if(
P”hClkIn™
->
Sai2ClockS–eùiÚ
 =ğ
RCC_SAI2CLKSOURCE_PLLSAI
)

281 
¶l§iu£d
 = 1U;

287 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_RTC
) == (RCC_PERIPHCLK_RTC))

290 
	`as£¹_·¿m
(
	`IS_RCC_RTCCLKSOURCE
(
P”hClkIn™
->
RTCClockS–eùiÚ
));

293 
	`__HAL_RCC_PWR_CLK_ENABLE
();

296 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

299 
tick¡¬t
 = 
	`HAL_G‘Tick
();

301 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

303 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

305  
HAL_TIMEOUT
;

309 
tm´eg1
 = (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
);

310 if((
tm´eg1
 !ğ0x00000000Uè&& (Ñm´eg1è!ğ(
P”hClkIn™
->
RTCClockS–eùiÚ
 & 
RCC_BDCR_RTCSEL
)))

313 
tm´eg1
 = (
RCC
->
BDCR
 & ~(
RCC_BDCR_RTCSEL
));

315 
	`__HAL_RCC_BACKUPRESET_FORCE
();

316 
	`__HAL_RCC_BACKUPRESET_RELEASE
();

318 
RCC
->
BDCR
 = 
tm´eg1
;

321 if(
	`HAL_IS_BIT_SET
(
RCC
->
BDCR
, 
RCC_BDCR_LSEON
))

324 
tick¡¬t
 = 
	`HAL_G‘Tick
();

327 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

329 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

331  
HAL_TIMEOUT
;

336 
	`__HAL_RCC_RTC_CONFIG
(
P”hClkIn™
->
RTCClockS–eùiÚ
);

341 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_TIM
) == (RCC_PERIPHCLK_TIM))

344 
	`__HAL_RCC_TIMCLKPRESCALER
(
P”hClkIn™
->
TIMP»sS–eùiÚ
);

349 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_FMPI2C1
) == RCC_PERIPHCLK_FMPI2C1)

352 
	`as£¹_·¿m
(
	`IS_RCC_FMPI2C1CLKSOURCE
(
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
));

355 
	`__HAL_RCC_FMPI2C1_CONFIG
(
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
);

360 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CEC
) == RCC_PERIPHCLK_CEC)

363 
	`as£¹_·¿m
(
	`IS_RCC_CECCLKSOURCE
(
P”hClkIn™
->
CecClockS–eùiÚ
));

366 
	`__HAL_RCC_CEC_CONFIG
(
P”hClkIn™
->
CecClockS–eùiÚ
);

371 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CLK48
) == RCC_PERIPHCLK_CLK48)

374 
	`as£¹_·¿m
(
	`IS_RCC_CLK48CLKSOURCE
(
P”hClkIn™
->
Clk48ClockS–eùiÚ
));

377 
	`__HAL_RCC_CLK48_CONFIG
(
P”hClkIn™
->
Clk48ClockS–eùiÚ
);

380 if(
P”hClkIn™
->
Clk48ClockS–eùiÚ
 =ğ
RCC_CLK48CLKSOURCE_PLLSAIP
)

382 
¶l§iu£d
 = 1U;

388 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SDIO
) == RCC_PERIPHCLK_SDIO)

391 
	`as£¹_·¿m
(
	`IS_RCC_SDIOCLKSOURCE
(
P”hClkIn™
->
SdioClockS–eùiÚ
));

394 
	`__HAL_RCC_SDIO_CONFIG
(
P”hClkIn™
->
SdioClockS–eùiÚ
);

399 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SPDIFRX
) == RCC_PERIPHCLK_SPDIFRX)

402 
	`as£¹_·¿m
(
	`IS_RCC_SPDIFRXCLKSOURCE
(
P”hClkIn™
->
SpdifClockS–eùiÚ
));

405 
	`__HAL_RCC_SPDIFRX_CONFIG
(
P”hClkIn™
->
SpdifClockS–eùiÚ
);

407 if(
P”hClkIn™
->
SpdifClockS–eùiÚ
 =ğ
RCC_SPDIFRXCLKSOURCE_PLLI2SP
)

409 
¶li2su£d
 = 1U;

417 if((
¶li2su£d
 =ğ1Uè|| (
P”hClkIn™
->
P”hClockS–eùiÚ
 =ğ
RCC_PERIPHCLK_PLLI2S
))

420 
	`__HAL_RCC_PLLI2S_DISABLE
();

422 
tick¡¬t
 = 
	`HAL_G‘Tick
();

424 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è!ğ
RESET
)

426 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

429  
HAL_TIMEOUT
;

434 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SM_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
));

435 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SN_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
));

438 if(((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB1
è=ğRCC_PERIPHCLK_I2S_APB1è&& (P”hClkIn™->
I2sApb1ClockS–eùiÚ
 =ğ
RCC_I2SAPB1CLKSOURCE_PLLI2S
)) ||

439 ((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB2
è=ğRCC_PERIPHCLK_I2S_APB2è&& (P”hClkIn™->
I2sApb2ClockS–eùiÚ
 =ğ
RCC_I2SAPB2CLKSOURCE_PLLI2S
)))

442 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

445 
¶li2¥
 = ((((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SP
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SP)) + 1U) << 1U);

446 
¶li2sq
 = ((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SQ
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SQ));

450 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
, P”hClkIn™->PLLI2S.
PLLI2SN
 , 
¶li2¥
, 
¶li2sq
, P”hClkIn™->PLLI2S.
PLLI2SR
);

454 if(((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI1
è=ğRCC_PERIPHCLK_SAI1è&& (P”hClkIn™->
Sai1ClockS–eùiÚ
 =ğ
RCC_SAI1CLKSOURCE_PLLI2S
)) ||

455 ((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI2
è=ğRCC_PERIPHCLK_SAI2è&& (P”hClkIn™->
Sai2ClockS–eùiÚ
 =ğ
RCC_SAI2CLKSOURCE_PLLI2S
)))

458 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SQ_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
));

460 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2S_DIVQ_VALUE
(
P”hClkIn™
->
PLLI2SDivQ
));

463 
¶li2¥
 = ((((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SP
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SP)) + 1U) << 1U);

464 
¶li2¤
 = ((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

469 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
, P”hClkIn™->PLLI2S.
PLLI2SN
 , 
¶li2¥
, P”hClkIn™->PLLI2S.
PLLI2SQ
, 
¶li2¤
);

472 
	`__HAL_RCC_PLLI2S_PLLSAICLKDIVQ_CONFIG
(
P”hClkIn™
->
PLLI2SDivQ
);

476 if((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SPDIFRX
è=ğRCC_PERIPHCLK_SPDIFRXè&& (P”hClkIn™->
SpdifClockS–eùiÚ
 =ğ
RCC_SPDIFRXCLKSOURCE_PLLI2SP
))

479 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SP_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SP
));

481 
¶li2sq
 = ((((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SP
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SP)) + 1U) << 1U);

482 
¶li2¤
 = ((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

486 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
, P”hClkIn™->PLLI2S.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SP
, 
¶li2sq
, 
¶li2¤
);

490 if((
P”hClkIn™
->
P”hClockS–eùiÚ
 & 
RCC_PERIPHCLK_PLLI2S
) == RCC_PERIPHCLK_PLLI2S)

493 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SP_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SP
));

494 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

495 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SQ_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
));

499 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
, P”hClkIn™->PLLI2S.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SP
, P”hClkIn™->PLLI2S.
PLLI2SQ
, P”hClkIn™->PLLI2S.
PLLI2SR
);

503 
	`__HAL_RCC_PLLI2S_ENABLE
();

505 
tick¡¬t
 = 
	`HAL_G‘Tick
();

507 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è=ğ
RESET
)

509 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

512  
HAL_TIMEOUT
;

520 if(
¶l§iu£d
 == 1U)

523 
	`__HAL_RCC_PLLSAI_DISABLE
();

525 
tick¡¬t
 = 
	`HAL_G‘Tick
();

527 
	`__HAL_RCC_PLLSAI_GET_FLAG
(è!ğ
RESET
)

529 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLSAI_TIMEOUT_VALUE
)

532  
HAL_TIMEOUT
;

537 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIM_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIM
));

538 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIN_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
));

541 if(((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI1
è=ğRCC_PERIPHCLK_SAI1è&& (P”hClkIn™->
Sai1ClockS–eùiÚ
 =ğ
RCC_SAI1CLKSOURCE_PLLSAI
)) ||

542 ((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI2
è=ğRCC_PERIPHCLK_SAI2è&& (P”hClkIn™->
Sai2ClockS–eùiÚ
 =ğ
RCC_SAI2CLKSOURCE_PLLSAI
)))

545 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIQ_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIQ
));

547 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAI_DIVQ_VALUE
(
P”hClkIn™
->
PLLSAIDivQ
));

550 
¶l§
 = ((((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIP
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIP)) + 1U) << 1U);

554 
	`__HAL_RCC_PLLSAI_CONFIG
(
P”hClkIn™
->
PLLSAI
.
PLLSAIM
, P”hClkIn™->PLLSAI.
PLLSAIN
 , 
¶l§
, P”hClkIn™->PLLSAI.
PLLSAIQ
, 0U);

557 
	`__HAL_RCC_PLLSAI_PLLSAICLKDIVQ_CONFIG
(
P”hClkIn™
->
PLLSAIDivQ
);

562 if((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CLK48
è=ğRCC_PERIPHCLK_CLK48è&& (P”hClkIn™->
Clk48ClockS–eùiÚ
 =ğ
RCC_CLK48CLKSOURCE_PLLSAIP
))

565 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIP_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIP
));

567 
¶l§iq
 = ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIQ));

571 
	`__HAL_RCC_PLLSAI_CONFIG
(
P”hClkIn™
->
PLLSAI
.
PLLSAIM
, P”hClkIn™->PLLSAI.
PLLSAIN
 , P”hClkIn™->PLLSAI.
PLLSAIP
, 
¶l§iq
, 0U);

575 
	`__HAL_RCC_PLLSAI_ENABLE
();

577 
tick¡¬t
 = 
	`HAL_G‘Tick
();

579 
	`__HAL_RCC_PLLSAI_GET_FLAG
(è=ğ
RESET
)

581 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLSAI_TIMEOUT_VALUE
)

584  
HAL_TIMEOUT
;

588  
HAL_OK
;

589 
	}
}

598 
	$HAL_RCCEx_G‘P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

600 
ušt32_t
 
‹m´eg
;

603 
P”hClkIn™
->
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_I2S_APB1
 | 
RCC_PERIPHCLK_I2S_APB2
 |\

604 
RCC_PERIPHCLK_SAI1
 | 
RCC_PERIPHCLK_SAI2
 |\

605 
RCC_PERIPHCLK_TIM
 | 
RCC_PERIPHCLK_RTC
 |\

606 
RCC_PERIPHCLK_CEC
 | 
RCC_PERIPHCLK_FMPI2C1
 |\

607 
RCC_PERIPHCLK_CLK48
 | 
RCC_PERIPHCLK_SDIO
 |\

608 
RCC_PERIPHCLK_SPDIFRX
;

611 
P”hClkIn™
->
PLLI2S
.
PLLI2SM
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SM
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SM));

612 
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SN
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SN));

613 
P”hClkIn™
->
PLLI2S
.
PLLI2SP
 = (
ušt32_t
)((((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SP
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SP)) + 1U) << 1U);

614 
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SQ
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SQ));

615 
P”hClkIn™
->
PLLI2S
.
PLLI2SR
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

617 
P”hClkIn™
->
PLLSAI
.
PLLSAIM
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIM
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIM));

618 
P”hClkIn™
->
PLLSAI
.
PLLSAIN
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIN
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIN));

619 
P”hClkIn™
->
PLLSAI
.
PLLSAIP
 = (
ušt32_t
)((((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIP
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIP)) + 1U) << 1U);

620 
P”hClkIn™
->
PLLSAI
.
PLLSAIQ
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIQ));

622 
P”hClkIn™
->
PLLI2SDivQ
 = (
ušt32_t
)((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLI2SDIVQ
è>> 
	`POSITION_VAL
(RCC_DCKCFGR_PLLI2SDIVQ));

623 
P”hClkIn™
->
PLLSAIDivQ
 = (
ušt32_t
)((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLSAIDIVQ
è>> 
	`POSITION_VAL
(RCC_DCKCFGR_PLLSAIDIVQ));

626 
P”hClkIn™
->
Sai1ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_SAI1_SOURCE
();

629 
P”hClkIn™
->
Sai2ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_SAI2_SOURCE
();

632 
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_I2S_APB1_SOURCE
();

635 
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_I2S_APB2_SOURCE
();

638 
‹m´eg
 = (
RCC
->
CFGR
 & 
RCC_CFGR_RTCPRE
);

639 
P”hClkIn™
->
RTCClockS–eùiÚ
 = (
ušt32_t
)((
‹m´eg
è| (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
));

642 
P”hClkIn™
->
CecClockS–eùiÚ
 = 
	`__HAL_RCC_GET_CEC_SOURCE
();

645 
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_FMPI2C1_SOURCE
();

648 
P”hClkIn™
->
Clk48ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_CLK48_SOURCE
();

651 
P”hClkIn™
->
SdioClockS–eùiÚ
 = 
	`__HAL_RCC_GET_SDIO_SOURCE
();

654 
P”hClkIn™
->
SpdifClockS–eùiÚ
 = 
	`__HAL_RCC_GET_SPDIFRX_SOURCE
();

657 ià((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_TIMPRE
è=ğ
RESET
)

659 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_DESACTIVATED
;

663 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_ACTIVATED
;

665 
	}
}

676 
ušt32_t
 
	$HAL_RCCEx_G‘P”hCLKF»q
(
ušt32_t
 
P”hClk
)

678 
ušt32_t
 
tm´eg1
 = 0U;

680 
ušt32_t
 
äequ’cy
 = 0U;

682 
ušt32_t
 
vcošput
 = 0U;

684 
ušt32_t
 
§işocksourû
 = 0U;

685 ià((
P”hClk
 =ğ
RCC_PERIPHCLK_SAI1
è|| (P”hClk =ğ
RCC_PERIPHCLK_SAI2
))

687 
§işocksourû
 = 
RCC
->
DCKCFGR
;

688 
§işocksourû
 &ğ(
RCC_DCKCFGR_SAI1SRC
 | 
RCC_DCKCFGR_SAI2SRC
);

689 
§işocksourû
)

695 if((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLSOURCE_HSI
)

698 
vcošput
 = (
HSI_VALUE
 / (
ušt32_t
)(
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIM
));

703 
vcošput
 = ((
HSE_VALUE
 / (
ušt32_t
)(
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIM
)));

707 
tm´eg1
 = (
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
) >> 24U;

708 
äequ’cy
 = (
vcošput
 * ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIN
è>> 6U))/(
tm´eg1
);

711 
tm´eg1
 = (((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLSAIDIVQ
) >> 8U) + 1U);

712 
äequ’cy
 = f»qu’cy/(
tm´eg1
);

715 
RCC_DCKCFGR_SAI1SRC_0
:

716 
RCC_DCKCFGR_SAI2SRC_0
:

720 if((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLSOURCE_HSI
)

723 
vcošput
 = (
HSI_VALUE
 / (
ušt32_t
)(
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SM
));

728 
vcošput
 = ((
HSE_VALUE
 / (
ušt32_t
)(
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SM
)));

733 
tm´eg1
 = (
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SQ
) >> 24U;

734 
äequ’cy
 = (
vcošput
 * ((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SN
è>> 6U))/(
tm´eg1
);

737 
tm´eg1
 = ((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLI2SDIVQ
) + 1U);

738 
äequ’cy
 = f»qu’cy/(
tm´eg1
);

741 
RCC_DCKCFGR_SAI1SRC_1
:

742 
RCC_DCKCFGR_SAI2SRC_1
:

746 if((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLSOURCE_HSI
)

749 
vcošput
 = (
HSI_VALUE
 / (
ušt32_t
)(
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
));

754 
vcošput
 = ((
HSE_VALUE
 / (
ušt32_t
)(
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
)));

759 
tm´eg1
 = (
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLR
) >> 28U;

760 
äequ’cy
 = (
vcošput
 * ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 6U))/(
tm´eg1
);

763 
RCC_DCKCFGR_SAI1SRC
:

765 
äequ’cy
 = 
EXTERNAL_CLOCK_VALUE
;

768 
RCC_DCKCFGR_SAI2SRC
:

770 if((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLSOURCE_HSI
)

773 
äequ’cy
 = (
ušt32_t
)(
HSI_VALUE
);

778 
äequ’cy
 = (
ušt32_t
)(
HSE_VALUE
);

788  
äequ’cy
;

789 
	}
}

793 #ià
defšed
(
STM32F469xx
è|| defšed(
STM32F479xx
)

808 
HAL_StusTy³Def
 
	$HAL_RCCEx_P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

810 
ušt32_t
 
tick¡¬t
 = 0U;

811 
ušt32_t
 
tm´eg1
 = 0U;

812 
ušt32_t
 
¶l§
 = 0U;

813 
ušt32_t
 
¶l§iq
 = 0U;

814 
ušt32_t
 
¶l§œ
 = 0U;

817 
	`as£¹_·¿m
(
	`IS_RCC_PERIPHCLOCK
(
P”hClkIn™
->
P”hClockS–eùiÚ
));

820 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CLK48
) == RCC_PERIPHCLK_CLK48)

823 
	`as£¹_·¿m
(
	`IS_RCC_CLK48CLKSOURCE
(
P”hClkIn™
->
Clk48ClockS–eùiÚ
));

826 
	`__HAL_RCC_CLK48_CONFIG
(
P”hClkIn™
->
Clk48ClockS–eùiÚ
);

831 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SDIO
) == RCC_PERIPHCLK_SDIO)

834 
	`as£¹_·¿m
(
	`IS_RCC_SDIOCLKSOURCE
(
P”hClkIn™
->
SdioClockS–eùiÚ
));

837 
	`__HAL_RCC_SDIO_CONFIG
(
P”hClkIn™
->
SdioClockS–eùiÚ
);

845 if((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S
) == RCC_PERIPHCLK_I2S) ||

846 (((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLI2S
) == RCC_PERIPHCLK_SAI_PLLI2S) ||

847 (((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_PLLI2S
) == RCC_PERIPHCLK_PLLI2S))

850 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SN_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
));

853 
	`__HAL_RCC_PLLI2S_DISABLE
();

855 
tick¡¬t
 = 
	`HAL_G‘Tick
();

857 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è!ğ
RESET
)

859 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

862  
HAL_TIMEOUT
;

869 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S
) == (RCC_PERIPHCLK_I2S))

872 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

876 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SR
);

882 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLI2S
) == (RCC_PERIPHCLK_SAI_PLLI2S))

885 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SQ_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
));

886 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2S_DIVQ_VALUE
(
P”hClkIn™
->
PLLI2SDivQ
));

889 
tm´eg1
 = ((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

894 
	`__HAL_RCC_PLLI2S_SAICLK_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SQ
 , 
tm´eg1
);

896 
	`__HAL_RCC_PLLI2S_PLLSAICLKDIVQ_CONFIG
(
P”hClkIn™
->
PLLI2SDivQ
);

900 if((
P”hClkIn™
->
P”hClockS–eùiÚ
 & 
RCC_PERIPHCLK_PLLI2S
) == RCC_PERIPHCLK_PLLI2S)

903 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SQ_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
));

904 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

907 
	`__HAL_RCC_PLLI2S_SAICLK_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
, P”hClkIn™->PLLI2S.
PLLI2SQ
, P”hClkIn™->PLLI2S.
PLLI2SR
);

911 
	`__HAL_RCC_PLLI2S_ENABLE
();

913 
tick¡¬t
 = 
	`HAL_G‘Tick
();

915 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è=ğ
RESET
)

917 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

920  
HAL_TIMEOUT
;

930 if((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLSAI
) == RCC_PERIPHCLK_SAI_PLLSAI) ||

931 (((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_LTDC
) == RCC_PERIPHCLK_LTDC) ||

932 ((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CLK48
) == RCC_PERIPHCLK_CLK48) &&

933 (
P”hClkIn™
->
Clk48ClockS–eùiÚ
 =ğ
RCC_CLK48CLKSOURCE_PLLSAIP
)))

936 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIN_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
));

939 
	`__HAL_RCC_PLLSAI_DISABLE
();

941 
tick¡¬t
 = 
	`HAL_G‘Tick
();

943 
	`__HAL_RCC_PLLSAI_GET_FLAG
(è!ğ
RESET
)

945 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLSAI_TIMEOUT_VALUE
)

948  
HAL_TIMEOUT
;

955 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLSAI
) == (RCC_PERIPHCLK_SAI_PLLSAI))

957 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIQ_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIQ
));

958 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAI_DIVQ_VALUE
(
P”hClkIn™
->
PLLSAIDivQ
));

961 
¶l§
 = ((((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIP
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIP)) + 1U) << 1U);

963 
¶l§œ
 = ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIR
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIR));

967 
	`__HAL_RCC_PLLSAI_CONFIG
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
, 
¶l§
, P”hClkIn™->PLLSAI.
PLLSAIQ
, 
¶l§œ
);

969 
	`__HAL_RCC_PLLSAI_PLLSAICLKDIVQ_CONFIG
(
P”hClkIn™
->
PLLSAIDivQ
);

973 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_LTDC
) == (RCC_PERIPHCLK_LTDC))

975 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIR_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIR
));

976 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAI_DIVR_VALUE
(
P”hClkIn™
->
PLLSAIDivR
));

979 
¶l§
 = ((((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIP
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIP)) + 1U) << 1U);

981 
¶l§iq
 = ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIQ));

985 
	`__HAL_RCC_PLLSAI_CONFIG
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
, 
¶l§
, 
¶l§iq
, P”hClkIn™->PLLSAI.
PLLSAIR
);

987 
	`__HAL_RCC_PLLSAI_PLLSAICLKDIVR_CONFIG
(
P”hClkIn™
->
PLLSAIDivR
);

992 if((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CLK48
) == (RCC_PERIPHCLK_CLK48)) &&

993 (
P”hClkIn™
->
Clk48ClockS–eùiÚ
 =ğ
RCC_CLK48CLKSOURCE_PLLSAIP
))

995 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIP_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIP
));

998 
¶l§iq
 = ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIQ));

1000 
¶l§œ
 = ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIR
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIR));

1004 
	`__HAL_RCC_PLLSAI_CONFIG
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
, P”hClkIn™->PLLSAI.
PLLSAIP
, 
¶l§iq
, 
¶l§œ
);

1008 
	`__HAL_RCC_PLLSAI_ENABLE
();

1010 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1012 
	`__HAL_RCC_PLLSAI_GET_FLAG
(è=ğ
RESET
)

1014 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLSAI_TIMEOUT_VALUE
)

1017  
HAL_TIMEOUT
;

1025 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_RTC
) == (RCC_PERIPHCLK_RTC))

1028 
	`as£¹_·¿m
(
	`IS_RCC_RTCCLKSOURCE
(
P”hClkIn™
->
RTCClockS–eùiÚ
));

1031 
	`__HAL_RCC_PWR_CLK_ENABLE
();

1034 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

1037 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1039 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

1041 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

1043  
HAL_TIMEOUT
;

1047 
tm´eg1
 = (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
);

1048 if((
tm´eg1
 !ğ0x00000000Uè&& (Ñm´eg1è!ğ(
P”hClkIn™
->
RTCClockS–eùiÚ
 & 
RCC_BDCR_RTCSEL
)))

1051 
tm´eg1
 = (
RCC
->
BDCR
 & ~(
RCC_BDCR_RTCSEL
));

1053 
	`__HAL_RCC_BACKUPRESET_FORCE
();

1054 
	`__HAL_RCC_BACKUPRESET_RELEASE
();

1056 
RCC
->
BDCR
 = 
tm´eg1
;

1059 if(
	`HAL_IS_BIT_SET
(
RCC
->
BDCR
, 
RCC_BDCR_LSEON
))

1062 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1065 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

1067 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

1069  
HAL_TIMEOUT
;

1074 
	`__HAL_RCC_RTC_CONFIG
(
P”hClkIn™
->
RTCClockS–eùiÚ
);

1079 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_TIM
) == (RCC_PERIPHCLK_TIM))

1081 
	`__HAL_RCC_TIMCLKPRESCALER
(
P”hClkIn™
->
TIMP»sS–eùiÚ
);

1083  
HAL_OK
;

1084 
	}
}

1093 
	$HAL_RCCEx_G‘P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1095 
ušt32_t
 
‹m´eg
;

1098 
P”hClkIn™
->
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_I2S
 | 
RCC_PERIPHCLK_SAI_PLLSAI
 |\

1099 
RCC_PERIPHCLK_SAI_PLLI2S
 | 
RCC_PERIPHCLK_LTDC
 |\

1100 
RCC_PERIPHCLK_TIM
 | 
RCC_PERIPHCLK_RTC
 |\

1101 
RCC_PERIPHCLK_CLK48
 | 
RCC_PERIPHCLK_SDIO
;

1104 
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SN
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SN));

1105 
P”hClkIn™
->
PLLI2S
.
PLLI2SR
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

1106 
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SQ
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SQ));

1108 
P”hClkIn™
->
PLLSAI
.
PLLSAIN
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIN
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIN));

1109 
P”hClkIn™
->
PLLSAI
.
PLLSAIR
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIR
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIR));

1110 
P”hClkIn™
->
PLLSAI
.
PLLSAIQ
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIQ));

1112 
P”hClkIn™
->
PLLI2SDivQ
 = (
ušt32_t
)((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLI2SDIVQ
è>> 
	`POSITION_VAL
(RCC_DCKCFGR_PLLI2SDIVQ));

1113 
P”hClkIn™
->
PLLSAIDivQ
 = (
ušt32_t
)((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLSAIDIVQ
è>> 
	`POSITION_VAL
(RCC_DCKCFGR_PLLSAIDIVQ));

1114 
P”hClkIn™
->
PLLSAIDivR
 = (
ušt32_t
)(
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLSAIDIVR
);

1116 
‹m´eg
 = (
RCC
->
CFGR
 & 
RCC_CFGR_RTCPRE
);

1117 
P”hClkIn™
->
RTCClockS–eùiÚ
 = (
ušt32_t
)((
‹m´eg
è| (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
));

1120 
P”hClkIn™
->
Clk48ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_CLK48_SOURCE
();

1123 
P”hClkIn™
->
SdioClockS–eùiÚ
 = 
	`__HAL_RCC_GET_SDIO_SOURCE
();

1125 ià((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_TIMPRE
è=ğ
RESET
)

1127 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_DESACTIVATED
;

1131 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_ACTIVATED
;

1133 
	}
}

1136 #ià
defšed
(
STM32F412Zx
è|| defšed(
STM32F412Vx
è|| defšed(
STM32F412Rx
è|| defšed(
STM32F412Cx
)

1151 
HAL_StusTy³Def
 
	$HAL_RCCEx_P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1153 
ušt32_t
 
tick¡¬t
 = 0U;

1154 
ušt32_t
 
tm´eg1
 = 0U;

1155 
ušt32_t
 
¶li2sq
 = 0U;

1156 
ušt32_t
 
¶li2su£d
 = 0U;

1159 
	`as£¹_·¿m
(
	`IS_RCC_PERIPHCLOCK
(
P”hClkIn™
->
P”hClockS–eùiÚ
));

1162 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB1
) == (RCC_PERIPHCLK_I2S_APB1))

1165 
	`as£¹_·¿m
(
	`IS_RCC_I2SAPB1CLKSOURCE
(
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
));

1168 
	`__HAL_RCC_I2S_APB1_CONFIG
(
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
);

1170 if(
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
 =ğ
RCC_I2SAPB1CLKSOURCE_PLLI2S
)

1172 
¶li2su£d
 = 1U;

1178 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB2
) == (RCC_PERIPHCLK_I2S_APB2))

1181 
	`as£¹_·¿m
(
	`IS_RCC_I2SAPB2CLKSOURCE
(
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
));

1184 
	`__HAL_RCC_I2S_APB2_CONFIG
(
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
);

1186 if(
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
 =ğ
RCC_I2SAPB2CLKSOURCE_PLLI2S
)

1188 
¶li2su£d
 = 1U;

1194 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_RTC
) == (RCC_PERIPHCLK_RTC))

1197 
	`as£¹_·¿m
(
	`IS_RCC_RTCCLKSOURCE
(
P”hClkIn™
->
RTCClockS–eùiÚ
));

1200 
	`__HAL_RCC_PWR_CLK_ENABLE
();

1203 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

1206 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1208 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

1210 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

1212  
HAL_TIMEOUT
;

1216 
tm´eg1
 = (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
);

1217 if((
tm´eg1
 !ğ0x00000000Uè&& (Ñm´eg1è!ğ(
P”hClkIn™
->
RTCClockS–eùiÚ
 & 
RCC_BDCR_RTCSEL
)))

1220 
tm´eg1
 = (
RCC
->
BDCR
 & ~(
RCC_BDCR_RTCSEL
));

1222 
	`__HAL_RCC_BACKUPRESET_FORCE
();

1223 
	`__HAL_RCC_BACKUPRESET_RELEASE
();

1225 
RCC
->
BDCR
 = 
tm´eg1
;

1228 if(
	`HAL_IS_BIT_SET
(
RCC
->
BDCR
, 
RCC_BDCR_LSEON
))

1231 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1234 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

1236 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

1238  
HAL_TIMEOUT
;

1243 
	`__HAL_RCC_RTC_CONFIG
(
P”hClkIn™
->
RTCClockS–eùiÚ
);

1248 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_TIM
) == (RCC_PERIPHCLK_TIM))

1251 
	`__HAL_RCC_TIMCLKPRESCALER
(
P”hClkIn™
->
TIMP»sS–eùiÚ
);

1256 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_FMPI2C1
) == RCC_PERIPHCLK_FMPI2C1)

1259 
	`as£¹_·¿m
(
	`IS_RCC_FMPI2C1CLKSOURCE
(
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
));

1262 
	`__HAL_RCC_FMPI2C1_CONFIG
(
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
);

1267 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CLK48
) == RCC_PERIPHCLK_CLK48)

1270 
	`as£¹_·¿m
(
	`IS_RCC_CLK48CLKSOURCE
(
P”hClkIn™
->
Clk48ClockS–eùiÚ
));

1273 
	`__HAL_RCC_CLK48_CONFIG
(
P”hClkIn™
->
Clk48ClockS–eùiÚ
);

1276 if(
P”hClkIn™
->
Clk48ClockS–eùiÚ
 =ğ
RCC_CLK48CLKSOURCE_PLLI2SQ
)

1278 
¶li2su£d
 = 1U;

1284 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SDIO
) == RCC_PERIPHCLK_SDIO)

1287 
	`as£¹_·¿m
(
	`IS_RCC_SDIOCLKSOURCE
(
P”hClkIn™
->
SdioClockS–eùiÚ
));

1290 
	`__HAL_RCC_SDIO_CONFIG
(
P”hClkIn™
->
SdioClockS–eùiÚ
);

1297 if((
¶li2su£d
 =ğ1Uè|| (
P”hClkIn™
->
P”hClockS–eùiÚ
 =ğ
RCC_PERIPHCLK_PLLI2S
))

1300 
	`__HAL_RCC_PLLI2S_DISABLE
();

1302 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1304 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è!ğ
RESET
)

1306 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

1309  
HAL_TIMEOUT
;

1314 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SCLKSOURCE
(
P”hClkIn™
->
PLLI2SS–eùiÚ
));

1315 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SM_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
));

1316 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SN_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
));

1318 
	`__HAL_RCC_PLL_I2S_CONFIG
(
P”hClkIn™
->
PLLI2SS–eùiÚ
);

1321 if(((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB1
è=ğRCC_PERIPHCLK_I2S_APB1è&& (P”hClkIn™->
I2sApb1ClockS–eùiÚ
 =ğ
RCC_I2SAPB1CLKSOURCE_PLLI2S
)) ||

1322 ((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S_APB2
è=ğRCC_PERIPHCLK_I2S_APB2è&& (P”hClkIn™->
I2sApb2ClockS–eùiÚ
 =ğ
RCC_I2SAPB2CLKSOURCE_PLLI2S
)) ||

1323 ((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_CLK48
è=ğRCC_PERIPHCLK_CLK48è&& (P”hClkIn™->
Clk48ClockS–eùiÚ
 =ğ
RCC_CLK48CLKSOURCE_PLLI2SQ
)) ||

1324 ((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SDIO
è=ğRCC_PERIPHCLK_SDIOè&& (P”hClkIn™->
SdioClockS–eùiÚ
 =ğ
RCC_SDIOCLKSOURCE_CLK48
è&& (P”hClkIn™->
Clk48ClockS–eùiÚ
 =ğ
RCC_CLK48CLKSOURCE_PLLI2SQ
)))

1327 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

1330 
¶li2sq
 = ((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SQ
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SQ));

1334 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
, P”hClkIn™->PLLI2S.
PLLI2SN
 , 
¶li2sq
, P”hClkIn™->PLLI2S.
PLLI2SR
);

1338 if((
P”hClkIn™
->
P”hClockS–eùiÚ
 & 
RCC_PERIPHCLK_PLLI2S
) == RCC_PERIPHCLK_PLLI2S)

1341 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

1342 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
));

1347 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
, P”hClkIn™->PLLI2S.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SQ
, P”hClkIn™->PLLI2S.
PLLI2SR
);

1351 
	`__HAL_RCC_PLLI2S_ENABLE
();

1353 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1355 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è=ğ
RESET
)

1357 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

1360  
HAL_TIMEOUT
;

1367 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_DFSDM1
) == RCC_PERIPHCLK_DFSDM1)

1370 
	`as£¹_·¿m
(
	`IS_RCC_DFSDM1CLKSOURCE
(
P”hClkIn™
->
Dfsdm1ClockS–eùiÚ
));

1373 
	`__HAL_RCC_DFSDM1_CONFIG
(
P”hClkIn™
->
Dfsdm1ClockS–eùiÚ
);

1378 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_DFSDM1_AUDIO
) == RCC_PERIPHCLK_DFSDM1_AUDIO)

1381 
	`as£¹_·¿m
(
	`IS_RCC_DFSDM1AUDIOCLKSOURCE
(
P”hClkIn™
->
Dfsdm1AudioClockS–eùiÚ
));

1384 
	`__HAL_RCC_DFSDM1AUDIO_CONFIG
(
P”hClkIn™
->
Dfsdm1AudioClockS–eùiÚ
);

1387  
HAL_OK
;

1388 
	}
}

1397 
	$HAL_RCCEx_G‘P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1399 
ušt32_t
 
‹m´eg
;

1402 
P”hClkIn™
->
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_I2S_APB1
 | 
RCC_PERIPHCLK_I2S_APB2
 |\

1403 
RCC_PERIPHCLK_TIM
 | 
RCC_PERIPHCLK_RTC
 |\

1404 
RCC_PERIPHCLK_FMPI2C1
 | 
RCC_PERIPHCLK_CLK48
 |\

1405 
RCC_PERIPHCLK_SDIO
;

1408 
P”hClkIn™
->
PLLI2S
.
PLLI2SM
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SM
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SM));

1409 
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SN
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SN));

1410 
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SQ
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SQ));

1411 
P”hClkIn™
->
PLLI2S
.
PLLI2SR
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

1414 
P”hClkIn™
->
I2sApb1ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_I2S_APB1_SOURCE
();

1417 
P”hClkIn™
->
I2sApb2ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_I2S_APB2_SOURCE
();

1420 
‹m´eg
 = (
RCC
->
CFGR
 & 
RCC_CFGR_RTCPRE
);

1421 
P”hClkIn™
->
RTCClockS–eùiÚ
 = (
ušt32_t
)((
‹m´eg
è| (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
));

1424 
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_FMPI2C1_SOURCE
();

1427 
P”hClkIn™
->
Clk48ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_CLK48_SOURCE
();

1430 
P”hClkIn™
->
SdioClockS–eùiÚ
 = 
	`__HAL_RCC_GET_SDIO_SOURCE
();

1433 ià((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_TIMPRE
è=ğ
RESET
)

1435 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_DESACTIVATED
;

1439 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_ACTIVATED
;

1441 
	}
}

1444 #ià
defšed
(
STM32F410Tx
è|| defšed(
STM32F410Cx
è|| defšed(
STM32F410Rx
)

1457 
HAL_StusTy³Def
 
	$HAL_RCCEx_P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1459 
ušt32_t
 
tick¡¬t
 = 0U;

1460 
ušt32_t
 
tm´eg1
 = 0U;

1463 
	`as£¹_·¿m
(
	`IS_RCC_PERIPHCLOCK
(
P”hClkIn™
->
P”hClockS–eùiÚ
));

1466 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_RTC
) == (RCC_PERIPHCLK_RTC))

1469 
	`as£¹_·¿m
(
	`IS_RCC_RTCCLKSOURCE
(
P”hClkIn™
->
RTCClockS–eùiÚ
));

1472 
	`__HAL_RCC_PWR_CLK_ENABLE
();

1475 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

1478 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1480 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

1482 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

1484  
HAL_TIMEOUT
;

1488 
tm´eg1
 = (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
);

1489 if((
tm´eg1
 !ğ0x00000000Uè&& (Ñm´eg1è!ğ(
P”hClkIn™
->
RTCClockS–eùiÚ
 & 
RCC_BDCR_RTCSEL
)))

1492 
tm´eg1
 = (
RCC
->
BDCR
 & ~(
RCC_BDCR_RTCSEL
));

1494 
	`__HAL_RCC_BACKUPRESET_FORCE
();

1495 
	`__HAL_RCC_BACKUPRESET_RELEASE
();

1497 
RCC
->
BDCR
 = 
tm´eg1
;

1500 if(
	`HAL_IS_BIT_SET
(
RCC
->
BDCR
, 
RCC_BDCR_LSEON
))

1503 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1506 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

1508 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

1510  
HAL_TIMEOUT
;

1515 
	`__HAL_RCC_RTC_CONFIG
(
P”hClkIn™
->
RTCClockS–eùiÚ
);

1520 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_TIM
) == (RCC_PERIPHCLK_TIM))

1522 
	`__HAL_RCC_TIMCLKPRESCALER
(
P”hClkIn™
->
TIMP»sS–eùiÚ
);

1527 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_FMPI2C1
) == RCC_PERIPHCLK_FMPI2C1)

1530 
	`as£¹_·¿m
(
	`IS_RCC_FMPI2C1CLKSOURCE
(
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
));

1533 
	`__HAL_RCC_FMPI2C1_CONFIG
(
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
);

1538 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_LPTIM1
) == RCC_PERIPHCLK_LPTIM1)

1541 
	`as£¹_·¿m
(
	`IS_RCC_LPTIM1CLKSOURCE
(
P”hClkIn™
->
L±im1ClockS–eùiÚ
));

1544 
	`__HAL_RCC_LPTIM1_CONFIG
(
P”hClkIn™
->
L±im1ClockS–eùiÚ
);

1548 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S
) == RCC_PERIPHCLK_I2S)

1551 
	`as£¹_·¿m
(
	`IS_RCC_I2SAPBCLKSOURCE
(
P”hClkIn™
->
I2SClockS–eùiÚ
));

1554 
	`__HAL_RCC_I2S_CONFIG
(
P”hClkIn™
->
I2SClockS–eùiÚ
);

1557  
HAL_OK
;

1558 
	}
}

1567 
	$HAL_RCCEx_G‘P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1569 
ušt32_t
 
‹m´eg
;

1572 
P”hClkIn™
->
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_FMPI2C1
 | 
RCC_PERIPHCLK_LPTIM1
 | 
RCC_PERIPHCLK_TIM
 | 
RCC_PERIPHCLK_RTC
;

1574 
‹m´eg
 = (
RCC
->
CFGR
 & 
RCC_CFGR_RTCPRE
);

1575 
P”hClkIn™
->
RTCClockS–eùiÚ
 = (
ušt32_t
)((
‹m´eg
è| (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
));

1577 ià((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_TIMPRE
è=ğ
RESET
)

1579 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_DESACTIVATED
;

1583 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_ACTIVATED
;

1586 
P”hClkIn™
->
Fmpi2c1ClockS–eùiÚ
 = 
	`__HAL_RCC_GET_FMPI2C1_SOURCE
();

1589 
P”hClkIn™
->
I2SClockS–eùiÚ
 = 
	`__HAL_RCC_GET_I2S_SOURCE
();

1592 
	}
}

1595 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)

1610 
HAL_StusTy³Def
 
	$HAL_RCCEx_P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1612 
ušt32_t
 
tick¡¬t
 = 0U;

1613 
ušt32_t
 
tm´eg1
 = 0U;

1616 
	`as£¹_·¿m
(
	`IS_RCC_PERIPHCLOCK
(
P”hClkIn™
->
P”hClockS–eùiÚ
));

1622 if((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S
) == RCC_PERIPHCLK_I2S) ||

1623 (((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLI2S
) == RCC_PERIPHCLK_SAI_PLLI2S))

1626 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SN_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
));

1629 
	`__HAL_RCC_PLLI2S_DISABLE
();

1631 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1633 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è!ğ
RESET
)

1635 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

1638  
HAL_TIMEOUT
;

1645 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S
) == (RCC_PERIPHCLK_I2S))

1648 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

1652 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SR
);

1658 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLI2S
) == (RCC_PERIPHCLK_SAI_PLLI2S))

1661 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SQ_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
));

1662 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2S_DIVQ_VALUE
(
P”hClkIn™
->
PLLI2SDivQ
));

1665 
tm´eg1
 = ((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

1670 
	`__HAL_RCC_PLLI2S_SAICLK_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SQ
 , 
tm´eg1
);

1672 
	`__HAL_RCC_PLLI2S_PLLSAICLKDIVQ_CONFIG
(
P”hClkIn™
->
PLLI2SDivQ
);

1676 
	`__HAL_RCC_PLLI2S_ENABLE
();

1678 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1680 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è=ğ
RESET
)

1682 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

1685  
HAL_TIMEOUT
;

1695 if((((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLSAI
) == RCC_PERIPHCLK_SAI_PLLSAI) ||

1696 (((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_LTDC
) == RCC_PERIPHCLK_LTDC))

1699 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIN_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
));

1702 
	`__HAL_RCC_PLLSAI_DISABLE
();

1704 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1706 
	`__HAL_RCC_PLLSAI_GET_FLAG
(è!ğ
RESET
)

1708 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLSAI_TIMEOUT_VALUE
)

1711  
HAL_TIMEOUT
;

1718 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_SAI_PLLSAI
) == (RCC_PERIPHCLK_SAI_PLLSAI))

1720 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIQ_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIQ
));

1721 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAI_DIVQ_VALUE
(
P”hClkIn™
->
PLLSAIDivQ
));

1724 
tm´eg1
 = ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIR
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIR));

1728 
	`__HAL_RCC_PLLSAI_CONFIG
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
 , P”hClkIn™->PLLSAI.
PLLSAIQ
, 
tm´eg1
);

1730 
	`__HAL_RCC_PLLSAI_PLLSAICLKDIVQ_CONFIG
(
P”hClkIn™
->
PLLSAIDivQ
);

1734 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_LTDC
) == (RCC_PERIPHCLK_LTDC))

1736 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAIR_VALUE
(
P”hClkIn™
->
PLLSAI
.
PLLSAIR
));

1737 
	`as£¹_·¿m
(
	`IS_RCC_PLLSAI_DIVR_VALUE
(
P”hClkIn™
->
PLLSAIDivR
));

1740 
tm´eg1
 = ((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIQ));

1744 
	`__HAL_RCC_PLLSAI_CONFIG
(
P”hClkIn™
->
PLLSAI
.
PLLSAIN
 , 
tm´eg1
, P”hClkIn™->PLLSAI.
PLLSAIR
);

1746 
	`__HAL_RCC_PLLSAI_PLLSAICLKDIVR_CONFIG
(
P”hClkIn™
->
PLLSAIDivR
);

1749 
	`__HAL_RCC_PLLSAI_ENABLE
();

1751 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1753 
	`__HAL_RCC_PLLSAI_GET_FLAG
(è=ğ
RESET
)

1755 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLSAI_TIMEOUT_VALUE
)

1758  
HAL_TIMEOUT
;

1765 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_RTC
) == (RCC_PERIPHCLK_RTC))

1768 
	`as£¹_·¿m
(
	`IS_RCC_RTCCLKSOURCE
(
P”hClkIn™
->
RTCClockS–eùiÚ
));

1771 
	`__HAL_RCC_PWR_CLK_ENABLE
();

1774 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

1777 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1779 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

1781 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

1783  
HAL_TIMEOUT
;

1787 
tm´eg1
 = (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
);

1788 if((
tm´eg1
 !ğ0x00000000Uè&& (Ñm´eg1è!ğ(
P”hClkIn™
->
RTCClockS–eùiÚ
 & 
RCC_BDCR_RTCSEL
)))

1791 
tm´eg1
 = (
RCC
->
BDCR
 & ~(
RCC_BDCR_RTCSEL
));

1793 
	`__HAL_RCC_BACKUPRESET_FORCE
();

1794 
	`__HAL_RCC_BACKUPRESET_RELEASE
();

1796 
RCC
->
BDCR
 = 
tm´eg1
;

1799 if(
	`HAL_IS_BIT_SET
(
RCC
->
BDCR
, 
RCC_BDCR_LSEON
))

1802 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1805 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

1807 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

1809  
HAL_TIMEOUT
;

1814 
	`__HAL_RCC_RTC_CONFIG
(
P”hClkIn™
->
RTCClockS–eùiÚ
);

1819 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_TIM
) == (RCC_PERIPHCLK_TIM))

1821 
	`__HAL_RCC_TIMCLKPRESCALER
(
P”hClkIn™
->
TIMP»sS–eùiÚ
);

1823  
HAL_OK
;

1824 
	}
}

1833 
	$HAL_RCCEx_G‘P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1835 
ušt32_t
 
‹m´eg
;

1838 
P”hClkIn™
->
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_I2S
 | 
RCC_PERIPHCLK_SAI_PLLSAI
 | 
RCC_PERIPHCLK_SAI_PLLI2S
 | 
RCC_PERIPHCLK_LTDC
 | 
RCC_PERIPHCLK_TIM
 | 
RCC_PERIPHCLK_RTC
;

1841 
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SN
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SN));

1842 
P”hClkIn™
->
PLLI2S
.
PLLI2SR
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

1843 
P”hClkIn™
->
PLLI2S
.
PLLI2SQ
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SQ
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SQ));

1845 
P”hClkIn™
->
PLLSAI
.
PLLSAIN
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIN
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIN));

1846 
P”hClkIn™
->
PLLSAI
.
PLLSAIR
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIR
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIR));

1847 
P”hClkIn™
->
PLLSAI
.
PLLSAIQ
 = (
ušt32_t
)((
RCC
->
PLLSAICFGR
 & 
RCC_PLLSAICFGR_PLLSAIQ
è>> 
	`POSITION_VAL
(RCC_PLLSAICFGR_PLLSAIQ));

1849 
P”hClkIn™
->
PLLI2SDivQ
 = (
ušt32_t
)((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLI2SDIVQ
è>> 
	`POSITION_VAL
(RCC_DCKCFGR_PLLI2SDIVQ));

1850 
P”hClkIn™
->
PLLSAIDivQ
 = (
ušt32_t
)((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLSAIDIVQ
è>> 
	`POSITION_VAL
(RCC_DCKCFGR_PLLSAIDIVQ));

1851 
P”hClkIn™
->
PLLSAIDivR
 = (
ušt32_t
)(
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_PLLSAIDIVR
);

1853 
‹m´eg
 = (
RCC
->
CFGR
 & 
RCC_CFGR_RTCPRE
);

1854 
P”hClkIn™
->
RTCClockS–eùiÚ
 = (
ušt32_t
)((
‹m´eg
è| (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
));

1856 ià((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_TIMPRE
è=ğ
RESET
)

1858 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_DESACTIVATED
;

1862 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_ACTIVATED
;

1864 
	}
}

1868 #ià
defšed
(
STM32F405xx
è|| defšed(
STM32F415xx
è|| defšed(
STM32F407xx
)|| defšed(
STM32F417xx
) ||\

1869 
defšed
(
STM32F401xC
è|| defšed(
STM32F401xE
è|| 
	$defšed
(
STM32F411xE
)

1882 
HAL_StusTy³Def
 
	$HAL_RCCEx_P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

1884 
ušt32_t
 
tick¡¬t
 = 0U;

1885 
ušt32_t
 
tm´eg1
 = 0U;

1888 
	`as£¹_·¿m
(
	`IS_RCC_PERIPHCLOCK
(
P”hClkIn™
->
P”hClockS–eùiÚ
));

1891 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_I2S
) == (RCC_PERIPHCLK_I2S))

1894 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SR_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SR
));

1895 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SN_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
));

1896 #ià
	`defšed
(
STM32F411xE
)

1897 
	`as£¹_·¿m
(
	`IS_RCC_PLLI2SM_VALUE
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
));

1900 
	`__HAL_RCC_PLLI2S_DISABLE
();

1902 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1904 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è!ğ
RESET
)

1906 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

1909  
HAL_TIMEOUT
;

1913 #ià
	`defšed
(
STM32F411xE
)

1917 
	`__HAL_RCC_PLLI2S_I2SCLK_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SM
, P”hClkIn™->PLLI2S.
PLLI2SN
, P”hClkIn™->PLLI2S.
PLLI2SR
);

1922 
	`__HAL_RCC_PLLI2S_CONFIG
(
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 , P”hClkIn™->PLLI2S.
PLLI2SR
);

1926 
	`__HAL_RCC_PLLI2S_ENABLE
();

1928 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1930 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLI2SRDY
è=ğ
RESET
)

1932 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLLI2S_TIMEOUT_VALUE
)

1935  
HAL_TIMEOUT
;

1941 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_RTC
) == (RCC_PERIPHCLK_RTC))

1944 
	`as£¹_·¿m
(
	`IS_RCC_RTCCLKSOURCE
(
P”hClkIn™
->
RTCClockS–eùiÚ
));

1947 
	`__HAL_RCC_PWR_CLK_ENABLE
();

1950 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

1953 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1955 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

1957 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

1959  
HAL_TIMEOUT
;

1963 
tm´eg1
 = (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
);

1964 if((
tm´eg1
 !ğ0x00000000Uè&& (Ñm´eg1è!ğ(
P”hClkIn™
->
RTCClockS–eùiÚ
 & 
RCC_BDCR_RTCSEL
)))

1967 
tm´eg1
 = (
RCC
->
BDCR
 & ~(
RCC_BDCR_RTCSEL
));

1969 
	`__HAL_RCC_BACKUPRESET_FORCE
();

1970 
	`__HAL_RCC_BACKUPRESET_RELEASE
();

1972 
RCC
->
BDCR
 = 
tm´eg1
;

1975 if(
	`HAL_IS_BIT_SET
(
RCC
->
BDCR
, 
RCC_BDCR_LSEON
))

1978 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1981 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

1983 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

1985  
HAL_TIMEOUT
;

1990 
	`__HAL_RCC_RTC_CONFIG
(
P”hClkIn™
->
RTCClockS–eùiÚ
);

1992 #ià
	`defšed
(
STM32F401xC
è|| defšed(
STM32F401xE
è|| defšed(
STM32F411xE
)

1994 if(((
P”hClkIn™
->
P”hClockS–eùiÚ
è& 
RCC_PERIPHCLK_TIM
) == (RCC_PERIPHCLK_TIM))

1996 
	`__HAL_RCC_TIMCLKPRESCALER
(
P”hClkIn™
->
TIMP»sS–eùiÚ
);

1999  
HAL_OK
;

2000 
	}
}

2009 
	$HAL_RCCEx_G‘P”hCLKCÚfig
(
RCC_P”hCLKIn™Ty³Def
 *
P”hClkIn™
)

2011 
ušt32_t
 
‹m´eg
;

2014 
P”hClkIn™
->
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_I2S
 | 
RCC_PERIPHCLK_RTC
;

2017 
P”hClkIn™
->
PLLI2S
.
PLLI2SN
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SN
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SN));

2018 
P”hClkIn™
->
PLLI2S
.
PLLI2SR
 = (
ušt32_t
)((
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SR
è>> 
	`POSITION_VAL
(RCC_PLLI2SCFGR_PLLI2SR));

2019 #ià
	`defšed
(
STM32F411xE
)

2020 
P”hClkIn™
->
PLLI2S
.
PLLI2SM
 = (
ušt32_t
)(
RCC
->
PLLI2SCFGR
 & 
RCC_PLLI2SCFGR_PLLI2SM
);

2023 
‹m´eg
 = (
RCC
->
CFGR
 & 
RCC_CFGR_RTCPRE
);

2024 
P”hClkIn™
->
RTCClockS–eùiÚ
 = (
ušt32_t
)((
‹m´eg
è| (
RCC
->
BDCR
 & 
RCC_BDCR_RTCSEL
));

2026 #ià
	`defšed
(
STM32F401xC
è|| defšed(
STM32F401xE
è|| defšed(
STM32F411xE
)

2028 ià((
RCC
->
DCKCFGR
 & 
RCC_DCKCFGR_TIMPRE
è=ğ
RESET
)

2030 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_DESACTIVATED
;

2034 
P”hClkIn™
->
TIMP»sS–eùiÚ
 = 
RCC_TIMPRES_ACTIVATED
;

2037 
	}
}

2040 #ià
defšed
(
STM32F410Tx
è|| defšed(
STM32F410Cx
è|| defšed(
STM32F410Rx
è|| defšed(
STM32F446xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
è|| defšed(
STM32F412Zx
) ||\

2041 
defšed
(
STM32F412Vx
è|| defšed(
STM32F412Rx
è|| 
	$defšed
(
STM32F412Cx
)

2058 
HAL_StusTy³Def
 
	$HAL_RCC_OscCÚfig
(
RCC_OscIn™Ty³Def
 *
RCC_OscIn™SŒuù
)

2060 
ušt32_t
 
tick¡¬t
 = 0U;

2063 
	`as£¹_·¿m
(
	`IS_RCC_OSCILLATORTYPE
(
RCC_OscIn™SŒuù
->
OscÏtÜTy³
));

2065 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_HSE
) == RCC_OSCILLATORTYPE_HSE)

2068 
	`as£¹_·¿m
(
	`IS_RCC_HSE
(
RCC_OscIn™SŒuù
->
HSES‹
));

2070 #ià
	`defšed
(
STM32F446xx
)

2071 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_HSE
) ||\

2072 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLL
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSE
)) ||\

2073 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLLR
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSE
)))

2075 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_HSE
) ||\

2076 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLL
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSE
)))

2079 if((
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
è!ğ
RESET
è&& (
RCC_OscIn™SŒuù
->
HSES‹
 =ğ
RCC_HSE_OFF
))

2081  
HAL_ERROR
;

2087 
	`__HAL_RCC_HSE_CONFIG
(
RCC_OscIn™SŒuù
->
HSES‹
);

2090 if((
RCC_OscIn™SŒuù
->
HSES‹
è!ğ
RCC_HSE_OFF
)

2093 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2096 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
è=ğ
RESET
)

2098 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSE_TIMEOUT_VALUE
)

2100  
HAL_TIMEOUT
;

2107 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2110 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
è!ğ
RESET
)

2112 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSE_TIMEOUT_VALUE
)

2114  
HAL_TIMEOUT
;

2121 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_HSI
) == RCC_OSCILLATORTYPE_HSI)

2124 
	`as£¹_·¿m
(
	`IS_RCC_HSI
(
RCC_OscIn™SŒuù
->
HSIS‹
));

2125 
	`as£¹_·¿m
(
	`IS_RCC_CALIBRATION_VALUE
(
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
));

2128 #ià
	`defšed
(
STM32F446xx
)

2129 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_HSI
) ||\

2130 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLL
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSI
)) ||\

2131 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLLR
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSI
)))

2133 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_HSI
) ||\

2134 ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è=ğ
RCC_CFGR_SWS_PLL
è&& ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
è=ğ
RCC_PLLCFGR_PLLSRC_HSI
)))

2138 if((
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
è!ğ
RESET
è&& (
RCC_OscIn™SŒuù
->
HSIS‹
 !ğ
RCC_HSI_ON
))

2140  
HAL_ERROR
;

2146 
	`__HAL_RCC_HSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
);

2152 if((
RCC_OscIn™SŒuù
->
HSIS‹
)!ğ
RCC_HSI_OFF
)

2155 
	`__HAL_RCC_HSI_ENABLE
();

2158 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2161 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
è=ğ
RESET
)

2163 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSI_TIMEOUT_VALUE
)

2165  
HAL_TIMEOUT
;

2170 
	`__HAL_RCC_HSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
);

2175 
	`__HAL_RCC_HSI_DISABLE
();

2178 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2181 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
è!ğ
RESET
)

2183 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
HSI_TIMEOUT_VALUE
)

2185  
HAL_TIMEOUT
;

2192 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_LSI
) == RCC_OSCILLATORTYPE_LSI)

2195 
	`as£¹_·¿m
(
	`IS_RCC_LSI
(
RCC_OscIn™SŒuù
->
LSIS‹
));

2198 if((
RCC_OscIn™SŒuù
->
LSIS‹
)!ğ
RCC_LSI_OFF
)

2201 
	`__HAL_RCC_LSI_ENABLE
();

2204 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2207 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSIRDY
è=ğ
RESET
)

2209 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
LSI_TIMEOUT_VALUE
)

2211  
HAL_TIMEOUT
;

2218 
	`__HAL_RCC_LSI_DISABLE
();

2221 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2224 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSIRDY
è!ğ
RESET
)

2226 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
LSI_TIMEOUT_VALUE
)

2228  
HAL_TIMEOUT
;

2234 if(((
RCC_OscIn™SŒuù
->
OscÏtÜTy³
è& 
RCC_OSCILLATORTYPE_LSE
) == RCC_OSCILLATORTYPE_LSE)

2237 
	`as£¹_·¿m
(
	`IS_RCC_LSE
(
RCC_OscIn™SŒuù
->
LSES‹
));

2240 
	`__HAL_RCC_PWR_CLK_ENABLE
();

2243 
PWR
->
CR
 |ğ
PWR_CR_DBP
;

2246 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2248 (
PWR
->
CR
 & 
PWR_CR_DBP
è=ğ
RESET
)

2250 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_DBP_TIMEOUT_VALUE
)

2252  
HAL_TIMEOUT
;

2257 
	`__HAL_RCC_LSE_CONFIG
(
RCC_OscIn™SŒuù
->
LSES‹
);

2259 if((
RCC_OscIn™SŒuù
->
LSES‹
è!ğ
RCC_LSE_OFF
)

2262 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2265 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è=ğ
RESET
)

2267 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

2269  
HAL_TIMEOUT
;

2276 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2279 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
è!ğ
RESET
)

2281 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

2283  
HAL_TIMEOUT
;

2290 
	`as£¹_·¿m
(
	`IS_RCC_PLL
(
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
));

2291 ià((
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
è!ğ
RCC_PLL_NONE
)

2294 if(
	`__HAL_RCC_GET_SYSCLK_SOURCE
(è!ğ
RCC_CFGR_SWS_PLL
)

2296 if((
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
è=ğ
RCC_PLL_ON
)

2299 
	`as£¹_·¿m
(
	`IS_RCC_PLLSOURCE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLSourû
));

2300 
	`as£¹_·¿m
(
	`IS_RCC_PLLM_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLM
));

2301 
	`as£¹_·¿m
(
	`IS_RCC_PLLN_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLN
));

2302 
	`as£¹_·¿m
(
	`IS_RCC_PLLP_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLP
));

2303 
	`as£¹_·¿m
(
	`IS_RCC_PLLQ_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLQ
));

2304 
	`as£¹_·¿m
(
	`IS_RCC_PLLR_VALUE
(
RCC_OscIn™SŒuù
->
PLL
.
PLLR
));

2307 
	`__HAL_RCC_PLL_DISABLE
();

2310 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2313 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è!ğ
RESET
)

2315 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

2317  
HAL_TIMEOUT
;

2322 
	`__HAL_RCC_PLL_CONFIG
(
RCC_OscIn™SŒuù
->
PLL
.
PLLSourû
,

2323 
RCC_OscIn™SŒuù
->
PLL
.
PLLM
,

2324 
RCC_OscIn™SŒuù
->
PLL
.
PLLN
,

2325 
RCC_OscIn™SŒuù
->
PLL
.
PLLP
,

2326 
RCC_OscIn™SŒuù
->
PLL
.
PLLQ
,

2327 
RCC_OscIn™SŒuù
->
PLL
.
PLLR
);

2330 
	`__HAL_RCC_PLL_ENABLE
();

2333 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2336 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è=ğ
RESET
)

2338 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

2340  
HAL_TIMEOUT
;

2347 
	`__HAL_RCC_PLL_DISABLE
();

2350 
tick¡¬t
 = 
	`HAL_G‘Tick
();

2353 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
è!ğ
RESET
)

2355 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
PLL_TIMEOUT_VALUE
)

2357  
HAL_TIMEOUT
;

2364  
HAL_ERROR
;

2367  
HAL_OK
;

2368 
	}
}

2379 
	$HAL_RCC_G‘OscCÚfig
(
RCC_OscIn™Ty³Def
 *
RCC_OscIn™SŒuù
)

2382 
RCC_OscIn™SŒuù
->
OscÏtÜTy³
 = 
RCC_OSCILLATORTYPE_HSE
 | 
RCC_OSCILLATORTYPE_HSI
 | 
RCC_OSCILLATORTYPE_LSE
 | 
RCC_OSCILLATORTYPE_LSI
;

2385 if((
RCC
->
CR
 &
RCC_CR_HSEBYP
) == RCC_CR_HSEBYP)

2387 
RCC_OscIn™SŒuù
->
HSES‹
 = 
RCC_HSE_BYPASS
;

2389 if((
RCC
->
CR
 &
RCC_CR_HSEON
) == RCC_CR_HSEON)

2391 
RCC_OscIn™SŒuù
->
HSES‹
 = 
RCC_HSE_ON
;

2395 
RCC_OscIn™SŒuù
->
HSES‹
 = 
RCC_HSE_OFF
;

2399 if((
RCC
->
CR
 &
RCC_CR_HSION
) == RCC_CR_HSION)

2401 
RCC_OscIn™SŒuù
->
HSIS‹
 = 
RCC_HSI_ON
;

2405 
RCC_OscIn™SŒuù
->
HSIS‹
 = 
RCC_HSI_OFF
;

2408 
RCC_OscIn™SŒuù
->
HSIC®ib¿tiÚV®ue
 = (
ušt32_t
)((
RCC
->
CR
 &
RCC_CR_HSITRIM
è>> 
	`POSITION_VAL
(RCC_CR_HSITRIM));

2411 if((
RCC
->
BDCR
 &
RCC_BDCR_LSEBYP
) == RCC_BDCR_LSEBYP)

2413 
RCC_OscIn™SŒuù
->
LSES‹
 = 
RCC_LSE_BYPASS
;

2415 if((
RCC
->
BDCR
 &
RCC_BDCR_LSEON
) == RCC_BDCR_LSEON)

2417 
RCC_OscIn™SŒuù
->
LSES‹
 = 
RCC_LSE_ON
;

2421 
RCC_OscIn™SŒuù
->
LSES‹
 = 
RCC_LSE_OFF
;

2425 if((
RCC
->
CSR
 &
RCC_CSR_LSION
) == RCC_CSR_LSION)

2427 
RCC_OscIn™SŒuù
->
LSIS‹
 = 
RCC_LSI_ON
;

2431 
RCC_OscIn™SŒuù
->
LSIS‹
 = 
RCC_LSI_OFF
;

2435 if((
RCC
->
CR
 &
RCC_CR_PLLON
) == RCC_CR_PLLON)

2437 
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
 = 
RCC_PLL_ON
;

2441 
RCC_OscIn™SŒuù
->
PLL
.
PLLS‹
 = 
RCC_PLL_OFF
;

2443 
RCC_OscIn™SŒuù
->
PLL
.
PLLSourû
 = (
ušt32_t
)(
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLSRC
);

2444 
RCC_OscIn™SŒuù
->
PLL
.
PLLM
 = (
ušt32_t
)(
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
);

2445 
RCC_OscIn™SŒuù
->
PLL
.
PLLN
 = (
ušt32_t
)((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN));

2446 
RCC_OscIn™SŒuù
->
PLL
.
PLLP
 = (
ušt32_t
)((((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLP
è+ 
RCC_PLLCFGR_PLLP_0
è<< 1Uè>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLP));

2447 
RCC_OscIn™SŒuù
->
PLL
.
PLLQ
 = (
ušt32_t
)((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLQ
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLQ));

2448 
RCC_OscIn™SŒuù
->
PLL
.
PLLR
 = (
ušt32_t
)((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLR
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLR));

2449 
	}
}

2452 #ià
defšed
(
STM32F410Tx
è|| defšed(
STM32F410Cx
è|| defšed(
STM32F410Rx
è|| defšed(
STM32F411xE
è|| defšed(
STM32F446xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
è|| defšed(
STM32F412Zx
) ||\

2453 
defšed
(
STM32F412Vx
è|| defšed(
STM32F412Rx
è|| 
	$defšed
(
STM32F412Cx
)

2465 
	$HAL_RCCEx_S–eùLSEMode
(
ušt8_t
 
Mode
)

2468 
	`as£¹_·¿m
(
	`IS_RCC_LSE_MODE
(
Mode
));

2469 if(
Mode
 =ğ
RCC_LSE_HIGHDRIVE_MODE
)

2471 
	`SET_BIT
(
RCC
->
BDCR
, 
RCC_BDCR_LSEMOD
);

2475 
	`CLEAR_BIT
(
RCC
->
BDCR
, 
RCC_BDCR_LSEMOD
);

2477 
	}
}

2481 #ià
defšed
(
STM32F446xx
)

2515 
ušt32_t
 
	$HAL_RCC_G‘SysClockF»q
()

2517 
ušt32_t
 
¶lm
 = 0U;

2518 
ušt32_t
 
¶lvco
 = 0U;

2519 
ušt32_t
 
¶Í
 = 0U;

2520 
ušt32_t
 
¶Ì
 = 0U;

2521 
ušt32_t
 
sysşockäeq
 = 0U;

2524 
RCC
->
CFGR
 & 
RCC_CFGR_SWS
)

2526 
RCC_CFGR_SWS_HSI
:

2528 
sysşockäeq
 = 
HSI_VALUE
;

2531 
RCC_CFGR_SWS_HSE
:

2533 
sysşockäeq
 = 
HSE_VALUE
;

2536 
RCC_CFGR_SWS_PLL
:

2540 
¶lm
 = 
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
;

2541 if(
	`__HAL_RCC_GET_PLL_OSCSOURCE
(è!ğ
RCC_PLLSOURCE_HSI
)

2544 
¶lvco
 = ((
HSE_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN)));

2549 
¶lvco
 = ((
HSI_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN)));

2551 
¶Í
 = ((((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLP
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLP)) + 1U) *2U);

2553 
sysşockäeq
 = 
¶lvco
/
¶Í
;

2556 
RCC_CFGR_SWS_PLLR
:

2560 
¶lm
 = 
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLM
;

2561 if(
	`__HAL_RCC_GET_PLL_OSCSOURCE
(è!ğ
RCC_PLLSOURCE_HSI
)

2564 
¶lvco
 = ((
HSE_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN)));

2569 
¶lvco
 = ((
HSI_VALUE
 / 
¶lm
è* ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLN
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLN)));

2571 
¶Ì
 = ((
RCC
->
PLLCFGR
 & 
RCC_PLLCFGR_PLLR
è>> 
	`POSITION_VAL
(RCC_PLLCFGR_PLLR));

2573 
sysşockäeq
 = 
¶lvco
/
¶Ì
;

2578 
sysşockäeq
 = 
HSI_VALUE
;

2582  
sysşockäeq
;

2583 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rtc.c

139 
	~"¡m32f4xx_h®.h
"

150 #ifdeà
HAL_RTC_MODULE_ENABLED


203 
HAL_StusTy³Def
 
	$HAL_RTC_In™
(
RTC_HªdËTy³Def
 *
h¹c
)

206 if(
h¹c
 =ğ
NULL
)

208  
HAL_ERROR
;

212 
	`as£¹_·¿m
(
	`IS_RTC_HOUR_FORMAT
(
h¹c
->
In™
.
HourFÜm©
));

213 
	`as£¹_·¿m
(
	`IS_RTC_ASYNCH_PREDIV
(
h¹c
->
In™
.
AsynchP»div
));

214 
	`as£¹_·¿m
(
	`IS_RTC_SYNCH_PREDIV
(
h¹c
->
In™
.
SynchP»div
));

215 
	`as£¹_·¿m
 (
	`IS_RTC_OUTPUT
(
h¹c
->
In™
.
OutPut
));

216 
	`as£¹_·¿m
 (
	`IS_RTC_OUTPUT_POL
(
h¹c
->
In™
.
OutPutPŞ¬™y
));

217 
	`as£¹_·¿m
(
	`IS_RTC_OUTPUT_TYPE
(
h¹c
->
In™
.
OutPutTy³
));

219 if(
h¹c
->
S‹
 =ğ
HAL_RTC_STATE_RESET
)

222 
h¹c
->
Lock
 = 
HAL_UNLOCKED
;

224 
	`HAL_RTC_M¥In™
(
h¹c
);

228 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

231 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

234 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

237 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

240 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

242  
HAL_ERROR
;

247 
h¹c
->
In¡ªû
->
CR
 &ğ((
ušt32_t
)~(
RTC_CR_FMT
 | 
RTC_CR_OSEL
 | 
RTC_CR_POL
));

249 
h¹c
->
In¡ªû
->
CR
 |ğ(
ušt32_t
)(h¹c->
In™
.
HourFÜm©
 | h¹c->In™.
OutPut
 | h¹c->In™.
OutPutPŞ¬™y
);

252 
h¹c
->
In¡ªû
->
PRER
 = (
ušt32_t
)(h¹c->
In™
.
SynchP»div
);

253 
h¹c
->
In¡ªû
->
PRER
 |ğ(
ušt32_t
)(h¹c->
In™
.
AsynchP»div
 << 16U);

256 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)~
RTC_ISR_INIT
;

258 
h¹c
->
In¡ªû
->
TAFCR
 &ğ(
ušt32_t
)~
RTC_TAFCR_ALARMOUTTYPE
;

259 
h¹c
->
In¡ªû
->
TAFCR
 |ğ(
ušt32_t
)(h¹c->
In™
.
OutPutTy³
);

262 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

265 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

267  
HAL_OK
;

269 
	}
}

278 
HAL_StusTy³Def
 
	$HAL_RTC_DeIn™
(
RTC_HªdËTy³Def
 *
h¹c
)

280 
ušt32_t
 
tick¡¬t
 = 0U;

283 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

286 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

289 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

292 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

295 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

297  
HAL_ERROR
;

302 
h¹c
->
In¡ªû
->
TR
 = (
ušt32_t
)0x00000000U;

303 
h¹c
->
In¡ªû
->
DR
 = (
ušt32_t
)0x00002101U;

305 
h¹c
->
In¡ªû
->
CR
 &ğ(
ušt32_t
)0x00000007U;

308 
tick¡¬t
 = 
	`HAL_G‘Tick
();

311 ((
h¹c
->
In¡ªû
->
ISR
è& 
RTC_ISR_WUTWF
è=ğ(
ušt32_t
)
RESET
)

313 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

316 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

319 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

321  
HAL_TIMEOUT
;

326 
h¹c
->
In¡ªû
->
CR
 &ğ(
ušt32_t
)0x00000000U;

327 
h¹c
->
In¡ªû
->
WUTR
 = (
ušt32_t
)0x0000FFFFU;

328 
h¹c
->
In¡ªû
->
PRER
 = (
ušt32_t
)0x007F00FFU;

329 
h¹c
->
In¡ªû
->
CALIBR
 = (
ušt32_t
)0x00000000U;

330 
h¹c
->
In¡ªû
->
ALRMAR
 = (
ušt32_t
)0x00000000U;

331 
h¹c
->
In¡ªû
->
ALRMBR
 = (
ušt32_t
)0x00000000U;

332 
h¹c
->
In¡ªû
->
SHIFTR
 = (
ušt32_t
)0x00000000U;

333 
h¹c
->
In¡ªû
->
CALR
 = (
ušt32_t
)0x00000000U;

334 
h¹c
->
In¡ªû
->
ALRMASSR
 = (
ušt32_t
)0x00000000U;

335 
h¹c
->
In¡ªû
->
ALRMBSSR
 = (
ušt32_t
)0x00000000U;

338 
h¹c
->
In¡ªû
->
ISR
 = (
ušt32_t
)0x00000000U;

341 
h¹c
->
In¡ªû
->
TAFCR
 = 0x00000000U;

344 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_BYPSHAD
è=ğ
RESET
)

346 if(
	`HAL_RTC_Wa™FÜSynchro
(
h¹c
è!ğ
HAL_OK
)

349 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

351 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

353  
HAL_ERROR
;

359 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

362 
	`HAL_RTC_M¥DeIn™
(
h¹c
);

364 
h¹c
->
S‹
 = 
HAL_RTC_STATE_RESET
;

367 
	`__HAL_UNLOCK
(
h¹c
);

369  
HAL_OK
;

370 
	}
}

378 
__w—k
 
	$HAL_RTC_M¥In™
(
RTC_HªdËTy³Def
* 
h¹c
)

381 
	`UNUSED
(
h¹c
);

385 
	}
}

393 
__w—k
 
	$HAL_RTC_M¥DeIn™
(
RTC_HªdËTy³Def
* 
h¹c
)

396 
	`UNUSED
(
h¹c
);

400 
	}
}

431 
HAL_StusTy³Def
 
	$HAL_RTC_S‘Time
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_TimeTy³Def
 *
sTime
, 
ušt32_t
 
FÜm©
)

433 
ušt32_t
 
tm´eg
 = 0U;

436 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

437 
	`as£¹_·¿m
(
	`IS_RTC_DAYLIGHT_SAVING
(
sTime
->
DayLightSavšg
));

438 
	`as£¹_·¿m
(
	`IS_RTC_STORE_OPERATION
(
sTime
->
StÜeO³¿tiÚ
));

441 
	`__HAL_LOCK
(
h¹c
);

443 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

445 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

447 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_FMT
è!ğ(
ušt32_t
)
RESET
)

449 
	`as£¹_·¿m
(
	`IS_RTC_HOUR12
(
sTime
->
Hours
));

450 
	`as£¹_·¿m
(
	`IS_RTC_HOURFORMAT12
(
sTime
->
TimeFÜm©
));

454 
sTime
->
TimeFÜm©
 = 0x00U;

455 
	`as£¹_·¿m
(
	`IS_RTC_HOUR24
(
sTime
->
Hours
));

457 
	`as£¹_·¿m
(
	`IS_RTC_MINUTES
(
sTime
->
Mšu‹s
));

458 
	`as£¹_·¿m
(
	`IS_RTC_SECONDS
(
sTime
->
SecÚds
));

460 
tm´eg
 = (
ušt32_t
)(((ušt32_t)
	`RTC_By‹ToBcd2
(
sTime
->
Hours
) << 16U) | \

461 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sTime
->
Mšu‹s
) << 8U) | \

462 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sTime
->
SecÚds
)) | \

463 (((
ušt32_t
)
sTime
->
TimeFÜm©
) << 16U));

467 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_FMT
è!ğ(
ušt32_t
)
RESET
)

469 
tm´eg
 = 
	`RTC_Bcd2ToBy‹
(
sTime
->
Hours
);

470 
	`as£¹_·¿m
(
	`IS_RTC_HOUR12
(
tm´eg
));

471 
	`as£¹_·¿m
(
	`IS_RTC_HOURFORMAT12
(
sTime
->
TimeFÜm©
));

475 
sTime
->
TimeFÜm©
 = 0x00U;

476 
	`as£¹_·¿m
(
	`IS_RTC_HOUR24
(
	`RTC_Bcd2ToBy‹
(
sTime
->
Hours
)));

478 
	`as£¹_·¿m
(
	`IS_RTC_MINUTES
(
	`RTC_Bcd2ToBy‹
(
sTime
->
Mšu‹s
)));

479 
	`as£¹_·¿m
(
	`IS_RTC_SECONDS
(
	`RTC_Bcd2ToBy‹
(
sTime
->
SecÚds
)));

480 
tm´eg
 = (((
ušt32_t
)(
sTime
->
Hours
) << 16U) | \

481 ((
ušt32_t
)(
sTime
->
Mšu‹s
) << 8U) | \

482 ((
ušt32_t
)
sTime
->
SecÚds
) | \

483 ((
ušt32_t
)(
sTime
->
TimeFÜm©
) << 16U));

487 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

490 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

493 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

496 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

499 
	`__HAL_UNLOCK
(
h¹c
);

501  
HAL_ERROR
;

506 
h¹c
->
In¡ªû
->
TR
 = (
ušt32_t
)(
tm´eg
 & 
RTC_TR_RESERVED_MASK
);

509 
h¹c
->
In¡ªû
->
CR
 &ğ(
ušt32_t
)~
RTC_CR_BCK
;

512 
h¹c
->
In¡ªû
->
CR
 |ğ(
ušt32_t
)(
sTime
->
DayLightSavšg
 | sTime->
StÜeO³¿tiÚ
);

515 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)~
RTC_ISR_INIT
;

518 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_BYPSHAD
è=ğ
RESET
)

520 if(
	`HAL_RTC_Wa™FÜSynchro
(
h¹c
è!ğ
HAL_OK
)

523 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

525 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

528 
	`__HAL_UNLOCK
(
h¹c
);

530  
HAL_ERROR
;

535 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

537 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

539 
	`__HAL_UNLOCK
(
h¹c
);

541  
HAL_OK
;

543 
	}
}

563 
HAL_StusTy³Def
 
	$HAL_RTC_G‘Time
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_TimeTy³Def
 *
sTime
, 
ušt32_t
 
FÜm©
)

565 
ušt32_t
 
tm´eg
 = 0U;

568 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

571 
sTime
->
SubSecÚds
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
SSR
);

574 
sTime
->
SecÚdF¿ùiÚ
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
PRER
 & 
RTC_PRER_PREDIV_S
);

577 
tm´eg
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
TR
 & 
RTC_TR_RESERVED_MASK
);

580 
sTime
->
Hours
 = (
ušt8_t
)((
tm´eg
 & (
RTC_TR_HT
 | 
RTC_TR_HU
)) >> 16U);

581 
sTime
->
Mšu‹s
 = (
ušt8_t
)((
tm´eg
 & (
RTC_TR_MNT
 | 
RTC_TR_MNU
)) >>8U);

582 
sTime
->
SecÚds
 = (
ušt8_t
)(
tm´eg
 & (
RTC_TR_ST
 | 
RTC_TR_SU
));

583 
sTime
->
TimeFÜm©
 = (
ušt8_t
)((
tm´eg
 & (
RTC_TR_PM
)) >> 16U);

586 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

589 
sTime
->
Hours
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTime->Hours);

590 
sTime
->
Mšu‹s
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTime->Minutes);

591 
sTime
->
SecÚds
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTime->Seconds);

594  
HAL_OK
;

595 
	}
}

608 
HAL_StusTy³Def
 
	$HAL_RTC_S‘D©e
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_D©eTy³Def
 *
sD©e
, 
ušt32_t
 
FÜm©
)

610 
ušt32_t
 
d©‘m´eg
 = 0U;

613 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

616 
	`__HAL_LOCK
(
h¹c
);

618 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

620 if((
FÜm©
 =ğ
RTC_FORMAT_BIN
è&& ((
sD©e
->
MÚth
 & 0x10U) == 0x10U))

622 
sD©e
->
MÚth
 = (
ušt8_t
)((sDate->Month & (uint8_t)~(0x10U)) + (uint8_t)0x0AU);

625 
	`as£¹_·¿m
(
	`IS_RTC_WEEKDAY
(
sD©e
->
W“kDay
));

627 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

629 
	`as£¹_·¿m
(
	`IS_RTC_YEAR
(
sD©e
->
Y—r
));

630 
	`as£¹_·¿m
(
	`IS_RTC_MONTH
(
sD©e
->
MÚth
));

631 
	`as£¹_·¿m
(
	`IS_RTC_DATE
(
sD©e
->
D©e
));

633 
d©‘m´eg
 = (((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sD©e
->
Y—r
) << 16U) | \

634 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sD©e
->
MÚth
) << 8U) | \

635 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sD©e
->
D©e
)) | \

636 ((
ušt32_t
)
sD©e
->
W“kDay
 << 13U));

640 
	`as£¹_·¿m
(
	`IS_RTC_YEAR
(
	`RTC_Bcd2ToBy‹
(
sD©e
->
Y—r
)));

641 
d©‘m´eg
 = 
	`RTC_Bcd2ToBy‹
(
sD©e
->
MÚth
);

642 
	`as£¹_·¿m
(
	`IS_RTC_MONTH
(
d©‘m´eg
));

643 
d©‘m´eg
 = 
	`RTC_Bcd2ToBy‹
(
sD©e
->
D©e
);

644 
	`as£¹_·¿m
(
	`IS_RTC_DATE
(
d©‘m´eg
));

646 
d©‘m´eg
 = ((((
ušt32_t
)
sD©e
->
Y—r
) << 16U) | \

647 (((
ušt32_t
)
sD©e
->
MÚth
) << 8U) | \

648 ((
ušt32_t
)
sD©e
->
D©e
) | \

649 (((
ušt32_t
)
sD©e
->
W“kDay
) << 13U));

653 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

656 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

659 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

662 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

665 
	`__HAL_UNLOCK
(
h¹c
);

667  
HAL_ERROR
;

672 
h¹c
->
In¡ªû
->
DR
 = (
ušt32_t
)(
d©‘m´eg
 & 
RTC_DR_RESERVED_MASK
);

675 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)~
RTC_ISR_INIT
;

678 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_BYPSHAD
è=ğ
RESET
)

680 if(
	`HAL_RTC_Wa™FÜSynchro
(
h¹c
è!ğ
HAL_OK
)

683 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

685 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

688 
	`__HAL_UNLOCK
(
h¹c
);

690  
HAL_ERROR
;

695 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

697 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
 ;

700 
	`__HAL_UNLOCK
(
h¹c
);

702  
HAL_OK
;

704 
	}
}

720 
HAL_StusTy³Def
 
	$HAL_RTC_G‘D©e
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_D©eTy³Def
 *
sD©e
, 
ušt32_t
 
FÜm©
)

722 
ušt32_t
 
d©‘m´eg
 = 0U;

725 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

728 
d©‘m´eg
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
DR
 & 
RTC_DR_RESERVED_MASK
);

731 
sD©e
->
Y—r
 = (
ušt8_t
)((
d©‘m´eg
 & (
RTC_DR_YT
 | 
RTC_DR_YU
)) >> 16U);

732 
sD©e
->
MÚth
 = (
ušt8_t
)((
d©‘m´eg
 & (
RTC_DR_MT
 | 
RTC_DR_MU
)) >> 8U);

733 
sD©e
->
D©e
 = (
ušt8_t
)(
d©‘m´eg
 & (
RTC_DR_DT
 | 
RTC_DR_DU
));

734 
sD©e
->
W“kDay
 = (
ušt8_t
)((
d©‘m´eg
 & (
RTC_DR_WDU
)) >> 13U);

737 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

740 
sD©e
->
Y—r
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sDate->Year);

741 
sD©e
->
MÚth
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sDate->Month);

742 
sD©e
->
D©e
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sDate->Date);

744  
HAL_OK
;

745 
	}
}

775 
HAL_StusTy³Def
 
	$HAL_RTC_S‘AÏrm
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_AÏrmTy³Def
 *
sAÏrm
, 
ušt32_t
 
FÜm©
)

777 
ušt32_t
 
tick¡¬t
 = 0U;

778 
ušt32_t
 
tm´eg
 = 0U, 
sub£cÚdtm´eg
 = 0U;

781 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

782 
	`as£¹_·¿m
(
	`IS_RTC_ALARM
(
sAÏrm
->
AÏrm
));

783 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_MASK
(
sAÏrm
->
AÏrmMask
));

784 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_SEL
(
sAÏrm
->
AÏrmD©eW“kDayS–
));

785 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_SUB_SECOND_VALUE
(
sAÏrm
->
AÏrmTime
.
SubSecÚds
));

786 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_SUB_SECOND_MASK
(
sAÏrm
->
AÏrmSubSecÚdMask
));

789 
	`__HAL_LOCK
(
h¹c
);

791 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

793 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

795 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_FMT
è!ğ(
ušt32_t
)
RESET
)

797 
	`as£¹_·¿m
(
	`IS_RTC_HOUR12
(
sAÏrm
->
AÏrmTime
.
Hours
));

798 
	`as£¹_·¿m
(
	`IS_RTC_HOURFORMAT12
(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
));

802 
sAÏrm
->
AÏrmTime
.
TimeFÜm©
 = 0x00U;

803 
	`as£¹_·¿m
(
	`IS_RTC_HOUR24
(
sAÏrm
->
AÏrmTime
.
Hours
));

805 
	`as£¹_·¿m
(
	`IS_RTC_MINUTES
(
sAÏrm
->
AÏrmTime
.
Mšu‹s
));

806 
	`as£¹_·¿m
(
	`IS_RTC_SECONDS
(
sAÏrm
->
AÏrmTime
.
SecÚds
));

808 if(
sAÏrm
->
AÏrmD©eW“kDayS–
 =ğ
RTC_ALARMDATEWEEKDAYSEL_DATE
)

810 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
sAÏrm
->
AÏrmD©eW“kDay
));

814 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
sAÏrm
->
AÏrmD©eW“kDay
));

817 
tm´eg
 = (((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmTime
.
Hours
) << 16U) | \

818 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmTime
.
Mšu‹s
) << 8U) | \

819 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmTime
.
SecÚds
)) | \

820 ((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
) << 16U) | \

821 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmD©eW“kDay
) << 24U) | \

822 ((
ušt32_t
)
sAÏrm
->
AÏrmD©eW“kDayS–
) | \

823 ((
ušt32_t
)
sAÏrm
->
AÏrmMask
));

827 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_FMT
è!ğ(
ušt32_t
)
RESET
)

829 
tm´eg
 = 
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
Hours
);

830 
	`as£¹_·¿m
(
	`IS_RTC_HOUR12
(
tm´eg
));

831 
	`as£¹_·¿m
(
	`IS_RTC_HOURFORMAT12
(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
));

835 
sAÏrm
->
AÏrmTime
.
TimeFÜm©
 = 0x00U;

836 
	`as£¹_·¿m
(
	`IS_RTC_HOUR24
(
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
Hours
)));

839 
	`as£¹_·¿m
(
	`IS_RTC_MINUTES
(
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
Mšu‹s
)));

840 
	`as£¹_·¿m
(
	`IS_RTC_SECONDS
(
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
SecÚds
)));

842 if(
sAÏrm
->
AÏrmD©eW“kDayS–
 =ğ
RTC_ALARMDATEWEEKDAYSEL_DATE
)

844 
tm´eg
 = 
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmD©eW“kDay
);

845 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
tm´eg
));

849 
tm´eg
 = 
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmD©eW“kDay
);

850 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
tm´eg
));

853 
tm´eg
 = (((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
Hours
) << 16U) | \

854 ((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
Mšu‹s
) << 8U) | \

855 ((
ušt32_t
è
sAÏrm
->
AÏrmTime
.
SecÚds
) | \

856 ((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
) << 16U) | \

857 ((
ušt32_t
)(
sAÏrm
->
AÏrmD©eW“kDay
) << 24U) | \

858 ((
ušt32_t
)
sAÏrm
->
AÏrmD©eW“kDayS–
) | \

859 ((
ušt32_t
)
sAÏrm
->
AÏrmMask
));

863 
sub£cÚdtm´eg
 = (
ušt32_t
)((ušt32_t)(
sAÏrm
->
AÏrmTime
.
SubSecÚds
è| (ušt32_t)(sAÏrm->
AÏrmSubSecÚdMask
));

866 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

869 if(
sAÏrm
->
AÏrm
 =ğ
RTC_ALARM_A
)

872 
	`__HAL_RTC_ALARMA_DISABLE
(
h¹c
);

875 
	`__HAL_RTC_ALARM_DISABLE_IT
(
h¹c
, 
RTC_IT_ALRA
);

878 
tick¡¬t
 = 
	`HAL_G‘Tick
();

881 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRAWF
è=ğ
RESET
)

883 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

886 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

888 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

891 
	`__HAL_UNLOCK
(
h¹c
);

893  
HAL_TIMEOUT
;

897 
h¹c
->
In¡ªû
->
ALRMAR
 = (
ušt32_t
)
tm´eg
;

899 
h¹c
->
In¡ªû
->
ALRMASSR
 = 
sub£cÚdtm´eg
;

901 
	`__HAL_RTC_ALARMA_ENABLE
(
h¹c
);

906 
	`__HAL_RTC_ALARMB_DISABLE
(
h¹c
);

909 
	`__HAL_RTC_ALARM_DISABLE_IT
(
h¹c
, 
RTC_IT_ALRB
);

912 
tick¡¬t
 = 
	`HAL_G‘Tick
();

915 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRBWF
è=ğ
RESET
)

917 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

920 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

922 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

925 
	`__HAL_UNLOCK
(
h¹c
);

927  
HAL_TIMEOUT
;

931 
h¹c
->
In¡ªû
->
ALRMBR
 = (
ušt32_t
)
tm´eg
;

933 
h¹c
->
In¡ªû
->
ALRMBSSR
 = 
sub£cÚdtm´eg
;

935 
	`__HAL_RTC_ALARMB_ENABLE
(
h¹c
);

939 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

942 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

945 
	`__HAL_UNLOCK
(
h¹c
);

947  
HAL_OK
;

948 
	}
}

961 
HAL_StusTy³Def
 
	$HAL_RTC_S‘AÏrm_IT
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_AÏrmTy³Def
 *
sAÏrm
, 
ušt32_t
 
FÜm©
)

963 
ušt32_t
 
tm´eg
 = 0U, 
sub£cÚdtm´eg
 = 0U;

964 
__IO
 
ušt32_t
 
couÁ
 = 
RTC_TIMEOUT_VALUE
 * (
Sy¡emCÜeClock
 / 32U / 1000U) ;

967 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

968 
	`as£¹_·¿m
(
	`IS_RTC_ALARM
(
sAÏrm
->
AÏrm
));

969 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_MASK
(
sAÏrm
->
AÏrmMask
));

970 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_SEL
(
sAÏrm
->
AÏrmD©eW“kDayS–
));

971 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_SUB_SECOND_VALUE
(
sAÏrm
->
AÏrmTime
.
SubSecÚds
));

972 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_SUB_SECOND_MASK
(
sAÏrm
->
AÏrmSubSecÚdMask
));

975 
	`__HAL_LOCK
(
h¹c
);

977 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

979 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

981 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_FMT
è!ğ(
ušt32_t
)
RESET
)

983 
	`as£¹_·¿m
(
	`IS_RTC_HOUR12
(
sAÏrm
->
AÏrmTime
.
Hours
));

984 
	`as£¹_·¿m
(
	`IS_RTC_HOURFORMAT12
(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
));

988 
sAÏrm
->
AÏrmTime
.
TimeFÜm©
 = 0x00U;

989 
	`as£¹_·¿m
(
	`IS_RTC_HOUR24
(
sAÏrm
->
AÏrmTime
.
Hours
));

991 
	`as£¹_·¿m
(
	`IS_RTC_MINUTES
(
sAÏrm
->
AÏrmTime
.
Mšu‹s
));

992 
	`as£¹_·¿m
(
	`IS_RTC_SECONDS
(
sAÏrm
->
AÏrmTime
.
SecÚds
));

994 if(
sAÏrm
->
AÏrmD©eW“kDayS–
 =ğ
RTC_ALARMDATEWEEKDAYSEL_DATE
)

996 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
sAÏrm
->
AÏrmD©eW“kDay
));

1000 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
sAÏrm
->
AÏrmD©eW“kDay
));

1002 
tm´eg
 = (((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmTime
.
Hours
) << 16U) | \

1003 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmTime
.
Mšu‹s
) << 8U) | \

1004 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmTime
.
SecÚds
)) | \

1005 ((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
) << 16U) | \

1006 ((
ušt32_t
)
	`RTC_By‹ToBcd2
(
sAÏrm
->
AÏrmD©eW“kDay
) << 24U) | \

1007 ((
ušt32_t
)
sAÏrm
->
AÏrmD©eW“kDayS–
) | \

1008 ((
ušt32_t
)
sAÏrm
->
AÏrmMask
));

1012 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_FMT
è!ğ(
ušt32_t
)
RESET
)

1014 
tm´eg
 = 
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
Hours
);

1015 
	`as£¹_·¿m
(
	`IS_RTC_HOUR12
(
tm´eg
));

1016 
	`as£¹_·¿m
(
	`IS_RTC_HOURFORMAT12
(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
));

1020 
sAÏrm
->
AÏrmTime
.
TimeFÜm©
 = 0x00U;

1021 
	`as£¹_·¿m
(
	`IS_RTC_HOUR24
(
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
Hours
)));

1024 
	`as£¹_·¿m
(
	`IS_RTC_MINUTES
(
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
Mšu‹s
)));

1025 
	`as£¹_·¿m
(
	`IS_RTC_SECONDS
(
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmTime
.
SecÚds
)));

1027 if(
sAÏrm
->
AÏrmD©eW“kDayS–
 =ğ
RTC_ALARMDATEWEEKDAYSEL_DATE
)

1029 
tm´eg
 = 
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmD©eW“kDay
);

1030 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
tm´eg
));

1034 
tm´eg
 = 
	`RTC_Bcd2ToBy‹
(
sAÏrm
->
AÏrmD©eW“kDay
);

1035 
	`as£¹_·¿m
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
tm´eg
));

1037 
tm´eg
 = (((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
Hours
) << 16U) | \

1038 ((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
Mšu‹s
) << 8U) | \

1039 ((
ušt32_t
è
sAÏrm
->
AÏrmTime
.
SecÚds
) | \

1040 ((
ušt32_t
)(
sAÏrm
->
AÏrmTime
.
TimeFÜm©
) << 16U) | \

1041 ((
ušt32_t
)(
sAÏrm
->
AÏrmD©eW“kDay
) << 24U) | \

1042 ((
ušt32_t
)
sAÏrm
->
AÏrmD©eW“kDayS–
) | \

1043 ((
ušt32_t
)
sAÏrm
->
AÏrmMask
));

1046 
sub£cÚdtm´eg
 = (
ušt32_t
)((ušt32_t)(
sAÏrm
->
AÏrmTime
.
SubSecÚds
è| (ušt32_t)(sAÏrm->
AÏrmSubSecÚdMask
));

1049 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1052 if(
sAÏrm
->
AÏrm
 =ğ
RTC_ALARM_A
)

1055 
	`__HAL_RTC_ALARMA_DISABLE
(
h¹c
);

1058 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_ALRAF
);

1063 ià(
couÁ
-- == 0)

1066 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1068 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1071 
	`__HAL_UNLOCK
(
h¹c
);

1073  
HAL_TIMEOUT
;

1076 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRAWF
è=ğ
RESET
);

1078 
h¹c
->
In¡ªû
->
ALRMAR
 = (
ušt32_t
)
tm´eg
;

1080 
h¹c
->
In¡ªû
->
ALRMASSR
 = 
sub£cÚdtm´eg
;

1082 
	`__HAL_RTC_ALARMA_ENABLE
(
h¹c
);

1084 
	`__HAL_RTC_ALARM_ENABLE_IT
(
h¹c
,
RTC_IT_ALRA
);

1089 
	`__HAL_RTC_ALARMB_DISABLE
(
h¹c
);

1092 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_ALRBF
);

1097 ià(
couÁ
-- == 0)

1100 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1102 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1105 
	`__HAL_UNLOCK
(
h¹c
);

1107  
HAL_TIMEOUT
;

1110 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRBWF
è=ğ
RESET
);

1112 
h¹c
->
In¡ªû
->
ALRMBR
 = (
ušt32_t
)
tm´eg
;

1114 
h¹c
->
In¡ªû
->
ALRMBSSR
 = 
sub£cÚdtm´eg
;

1116 
	`__HAL_RTC_ALARMB_ENABLE
(
h¹c
);

1118 
	`__HAL_RTC_ALARM_ENABLE_IT
(
h¹c
, 
RTC_IT_ALRB
);

1122 
	`__HAL_RTC_ALARM_EXTI_ENABLE_IT
();

1124 
EXTI
->
RTSR
 |ğ
RTC_EXTI_LINE_ALARM_EVENT
;

1127 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1129 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1132 
	`__HAL_UNLOCK
(
h¹c
);

1134  
HAL_OK
;

1135 
	}
}

1147 
HAL_StusTy³Def
 
	$HAL_RTC_D—ùiv©eAÏrm
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
AÏrm
)

1149 
ušt32_t
 
tick¡¬t
 = 0U;

1152 
	`as£¹_·¿m
(
	`IS_RTC_ALARM
(
AÏrm
));

1155 
	`__HAL_LOCK
(
h¹c
);

1157 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1160 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1162 if(
AÏrm
 =ğ
RTC_ALARM_A
)

1165 
	`__HAL_RTC_ALARMA_DISABLE
(
h¹c
);

1168 
	`__HAL_RTC_ALARM_DISABLE_IT
(
h¹c
, 
RTC_IT_ALRA
);

1171 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1174 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRAWF
è=ğ
RESET
)

1176 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

1179 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1181 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1184 
	`__HAL_UNLOCK
(
h¹c
);

1186  
HAL_TIMEOUT
;

1193 
	`__HAL_RTC_ALARMB_DISABLE
(
h¹c
);

1196 
	`__HAL_RTC_ALARM_DISABLE_IT
(
h¹c
,
RTC_IT_ALRB
);

1199 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1202 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRBWF
è=ğ
RESET
)

1204 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

1207 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1209 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1212 
	`__HAL_UNLOCK
(
h¹c
);

1214  
HAL_TIMEOUT
;

1219 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1221 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1224 
	`__HAL_UNLOCK
(
h¹c
);

1226  
HAL_OK
;

1227 
	}
}

1244 
HAL_StusTy³Def
 
	$HAL_RTC_G‘AÏrm
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_AÏrmTy³Def
 *
sAÏrm
, 
ušt32_t
 
AÏrm
, ušt32_ˆ
FÜm©
)

1246 
ušt32_t
 
tm´eg
 = 0U, 
sub£cÚdtm´eg
 = 0U;

1249 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

1250 
	`as£¹_·¿m
(
	`IS_RTC_ALARM
(
AÏrm
));

1252 if(
AÏrm
 =ğ
RTC_ALARM_A
)

1255 
sAÏrm
->
AÏrm
 = 
RTC_ALARM_A
;

1257 
tm´eg
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
ALRMAR
);

1258 
sub£cÚdtm´eg
 = (
ušt32_t
)((
h¹c
->
In¡ªû
->
ALRMASSR
 ) & 
RTC_ALRMASSR_SS
);

1262 
sAÏrm
->
AÏrm
 = 
RTC_ALARM_B
;

1264 
tm´eg
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
ALRMBR
);

1265 
sub£cÚdtm´eg
 = (
ušt32_t
)((
h¹c
->
In¡ªû
->
ALRMBSSR
è& 
RTC_ALRMBSSR_SS
);

1269 
sAÏrm
->
AÏrmTime
.
Hours
 = (
ušt32_t
)((
tm´eg
 & (
RTC_ALRMAR_HT
 | 
RTC_ALRMAR_HU
)) >> 16U);

1270 
sAÏrm
->
AÏrmTime
.
Mšu‹s
 = (
ušt32_t
)((
tm´eg
 & (
RTC_ALRMAR_MNT
 | 
RTC_ALRMAR_MNU
)) >> 8U);

1271 
sAÏrm
->
AÏrmTime
.
SecÚds
 = (
ušt32_t
)(
tm´eg
 & (
RTC_ALRMAR_ST
 | 
RTC_ALRMAR_SU
));

1272 
sAÏrm
->
AÏrmTime
.
TimeFÜm©
 = (
ušt32_t
)((
tm´eg
 & 
RTC_ALRMAR_PM
) >> 16U);

1273 
sAÏrm
->
AÏrmTime
.
SubSecÚds
 = (
ušt32_t
è
sub£cÚdtm´eg
;

1274 
sAÏrm
->
AÏrmD©eW“kDay
 = (
ušt32_t
)((
tm´eg
 & (
RTC_ALRMAR_DT
 | 
RTC_ALRMAR_DU
)) >> 24U);

1275 
sAÏrm
->
AÏrmD©eW“kDayS–
 = (
ušt32_t
)(
tm´eg
 & 
RTC_ALRMAR_WDSEL
);

1276 
sAÏrm
->
AÏrmMask
 = (
ušt32_t
)(
tm´eg
 & 
RTC_ALARMMASK_ALL
);

1278 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

1280 
sAÏrm
->
AÏrmTime
.
Hours
 = 
	`RTC_Bcd2ToBy‹
(sAlarm->AlarmTime.Hours);

1281 
sAÏrm
->
AÏrmTime
.
Mšu‹s
 = 
	`RTC_Bcd2ToBy‹
(sAlarm->AlarmTime.Minutes);

1282 
sAÏrm
->
AÏrmTime
.
SecÚds
 = 
	`RTC_Bcd2ToBy‹
(sAlarm->AlarmTime.Seconds);

1283 
sAÏrm
->
AÏrmD©eW“kDay
 = 
	`RTC_Bcd2ToBy‹
(sAlarm->AlarmDateWeekDay);

1286  
HAL_OK
;

1287 
	}
}

1295 
	$HAL_RTC_AÏrmIRQHªdËr
(
RTC_HªdËTy³Def
* 
h¹c
)

1297 if(
	`__HAL_RTC_ALARM_GET_IT
(
h¹c
, 
RTC_IT_ALRA
))

1300 if((
ušt32_t
)(
h¹c
->
In¡ªû
->
CR
 & 
RTC_IT_ALRA
è!ğ(ušt32_t)
RESET
)

1303 
	`HAL_RTC_AÏrmAEv’tC®lback
(
h¹c
);

1306 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
h¹c
,
RTC_FLAG_ALRAF
);

1310 if(
	`__HAL_RTC_ALARM_GET_IT
(
h¹c
, 
RTC_IT_ALRB
))

1313 if((
ušt32_t
)(
h¹c
->
In¡ªû
->
CR
 & 
RTC_IT_ALRB
è!ğ(ušt32_t)
RESET
)

1316 
	`HAL_RTCEx_AÏrmBEv’tC®lback
(
h¹c
);

1319 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
h¹c
,
RTC_FLAG_ALRBF
);

1324 
	`__HAL_RTC_ALARM_EXTI_CLEAR_FLAG
();

1327 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1328 
	}
}

1336 
__w—k
 
	$HAL_RTC_AÏrmAEv’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

1339 
	`UNUSED
(
h¹c
);

1343 
	}
}

1352 
HAL_StusTy³Def
 
	$HAL_RTC_PŞlFÜAÏrmAEv’t
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
Timeout
)

1354 
ušt32_t
 
tick¡¬t
 = 0U;

1357 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1359 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRAF
è=ğ
RESET
)

1361 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1363 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

1365 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1366  
HAL_TIMEOUT
;

1372 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_ALRAF
);

1375 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1377  
HAL_OK
;

1378 
	}
}

1414 
HAL_StusTy³Def
 
	$HAL_RTC_Wa™FÜSynchro
(
RTC_HªdËTy³Def
* 
h¹c
)

1416 
ušt32_t
 
tick¡¬t
 = 0U;

1419 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)
RTC_RSF_MASK
;

1422 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1425 (
h¹c
->
In¡ªû
->
ISR
 & 
RTC_ISR_RSF
è=ğ(
ušt32_t
)
RESET
)

1427 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

1429  
HAL_TIMEOUT
;

1433  
HAL_OK
;

1434 
	}
}

1460 
HAL_RTCS‹Ty³Def
 
	$HAL_RTC_G‘S‹
(
RTC_HªdËTy³Def
* 
h¹c
)

1462  
h¹c
->
S‹
;

1463 
	}
}

1477 
HAL_StusTy³Def
 
	$RTC_EÁ”In™Mode
(
RTC_HªdËTy³Def
* 
h¹c
)

1479 
ušt32_t
 
tick¡¬t
 = 0U;

1482 if((
h¹c
->
In¡ªû
->
ISR
 & 
RTC_ISR_INITF
è=ğ(
ušt32_t
)
RESET
)

1485 
h¹c
->
In¡ªû
->
ISR
 = (
ušt32_t
)
RTC_INIT_MASK
;

1488 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1491 (
h¹c
->
In¡ªû
->
ISR
 & 
RTC_ISR_INITF
è=ğ(
ušt32_t
)
RESET
)

1493 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

1495  
HAL_TIMEOUT
;

1500  
HAL_OK
;

1501 
	}
}

1509 
ušt8_t
 
	$RTC_By‹ToBcd2
(
ušt8_t
 
V®ue
)

1511 
ušt32_t
 
bcdhigh
 = 0U;

1513 
V®ue
 >= 10U)

1515 
bcdhigh
++;

1516 
V®ue
 -= 10U;

1519  ((
ušt8_t
)(
bcdhigh
 << 4Uè| 
V®ue
);

1520 
	}
}

1527 
ušt8_t
 
	$RTC_Bcd2ToBy‹
(
ušt8_t
 
V®ue
)

1529 
ušt32_t
 
tmp
 = 0U;

1530 
tmp
 = ((
ušt8_t
)(
V®ue
 & (uint8_t)0xF0U) >> (uint8_t)0x4U) * 10U;

1531  (
tmp
 + (
V®ue
 & (
ušt8_t
)0x0FU));

1532 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rtc_ex.c

100 
	~"¡m32f4xx_h®.h
"

111 #ifdeà
HAL_RTC_MODULE_ENABLED


158 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘TimeSmp
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
TimeSmpEdge
, ušt32_ˆ
RTC_TimeSmpPš
)

160 
ušt32_t
 
tm´eg
 = 0U;

163 
	`as£¹_·¿m
(
	`IS_TIMESTAMP_EDGE
(
TimeSmpEdge
));

164 
	`as£¹_·¿m
(
	`IS_RTC_TIMESTAMP_PIN
(
RTC_TimeSmpPš
));

167 
	`__HAL_LOCK
(
h¹c
);

169 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

172 
tm´eg
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
CR
 & (ušt32_t)~(
RTC_CR_TSEDGE
 | 
RTC_CR_TSE
));

174 
tm´eg
|ğ
TimeSmpEdge
;

177 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

179 
h¹c
->
In¡ªû
->
TAFCR
 &ğ(
ušt32_t
)~
RTC_TAFCR_TSINSEL
;

180 
h¹c
->
In¡ªû
->
TAFCR
 |ğ(
ušt32_t
)(
RTC_TimeSmpPš
);

183 
h¹c
->
In¡ªû
->
CR
 = (
ušt32_t
)
tm´eg
;

185 
	`__HAL_RTC_TIMESTAMP_ENABLE
(
h¹c
);

188 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

191 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

194 
	`__HAL_UNLOCK
(
h¹c
);

196  
HAL_OK
;

197 
	}
}

218 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘TimeSmp_IT
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
TimeSmpEdge
, ušt32_ˆ
RTC_TimeSmpPš
)

220 
ušt32_t
 
tm´eg
 = 0U;

223 
	`as£¹_·¿m
(
	`IS_TIMESTAMP_EDGE
(
TimeSmpEdge
));

224 
	`as£¹_·¿m
(
	`IS_RTC_TIMESTAMP_PIN
(
RTC_TimeSmpPš
));

227 
	`__HAL_LOCK
(
h¹c
);

229 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

232 
tm´eg
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
CR
 & (ušt32_t)~(
RTC_CR_TSEDGE
 | 
RTC_CR_TSE
));

234 
tm´eg
 |ğ
TimeSmpEdge
;

237 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

240 
h¹c
->
In¡ªû
->
CR
 = (
ušt32_t
)
tm´eg
;

242 
h¹c
->
In¡ªû
->
TAFCR
 &ğ(
ušt32_t
)~
RTC_TAFCR_TSINSEL
;

243 
h¹c
->
In¡ªû
->
TAFCR
 |ğ(
ušt32_t
)(
RTC_TimeSmpPš
);

246 
	`__HAL_RTC_TIMESTAMP_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_TSF
);

248 
	`__HAL_RTC_TIMESTAMP_ENABLE
(
h¹c
);

251 
	`__HAL_RTC_TIMESTAMP_ENABLE_IT
(
h¹c
,
RTC_IT_TS
);

254 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_ENABLE_IT
();

256 
EXTI
->
RTSR
 |ğ
RTC_EXTI_LINE_TAMPER_TIMESTAMP_EVENT
;

259 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

261 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

264 
	`__HAL_UNLOCK
(
h¹c
);

266  
HAL_OK
;

267 
	}
}

275 
HAL_StusTy³Def
 
	$HAL_RTCEx_D—ùiv©eTimeSmp
(
RTC_HªdËTy³Def
 *
h¹c
)

277 
ušt32_t
 
tm´eg
 = 0U;

280 
	`__HAL_LOCK
(
h¹c
);

282 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

285 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

288 
	`__HAL_RTC_TIMESTAMP_DISABLE_IT
(
h¹c
, 
RTC_IT_TS
);

291 
tm´eg
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
CR
 & (ušt32_t)~(
RTC_CR_TSEDGE
 | 
RTC_CR_TSE
));

294 
h¹c
->
In¡ªû
->
CR
 = (
ušt32_t
)
tm´eg
;

297 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

299 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

302 
	`__HAL_UNLOCK
(
h¹c
);

304  
HAL_OK
;

305 
	}
}

319 
HAL_StusTy³Def
 
	$HAL_RTCEx_G‘TimeSmp
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_TimeTy³Def
* 
sTimeSmp
, 
RTC_D©eTy³Def
* 
sTimeSmpD©e
, 
ušt32_t
 
FÜm©
)

321 
ušt32_t
 
tm±ime
 = 0U, 
tmpd©e
 = 0U;

324 
	`as£¹_·¿m
(
	`IS_RTC_FORMAT
(
FÜm©
));

327 
tm±ime
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
TSTR
 & 
RTC_TR_RESERVED_MASK
);

328 
tmpd©e
 = (
ušt32_t
)(
h¹c
->
In¡ªû
->
TSDR
 & 
RTC_DR_RESERVED_MASK
);

331 
sTimeSmp
->
Hours
 = (
ušt8_t
)((
tm±ime
 & (
RTC_TR_HT
 | 
RTC_TR_HU
)) >> 16U);

332 
sTimeSmp
->
Mšu‹s
 = (
ušt8_t
)((
tm±ime
 & (
RTC_TR_MNT
 | 
RTC_TR_MNU
)) >> 8U);

333 
sTimeSmp
->
SecÚds
 = (
ušt8_t
)(
tm±ime
 & (
RTC_TR_ST
 | 
RTC_TR_SU
));

334 
sTimeSmp
->
TimeFÜm©
 = (
ušt8_t
)((
tm±ime
 & (
RTC_TR_PM
)) >> 16U);

335 
sTimeSmp
->
SubSecÚds
 = (
ušt32_t
è
h¹c
->
In¡ªû
->
TSSSR
;

338 
sTimeSmpD©e
->
Y—r
 = 0U;

339 
sTimeSmpD©e
->
MÚth
 = (
ušt8_t
)((
tmpd©e
 & (
RTC_DR_MT
 | 
RTC_DR_MU
)) >> 8U);

340 
sTimeSmpD©e
->
D©e
 = (
ušt8_t
)(
tmpd©e
 & (
RTC_DR_DT
 | 
RTC_DR_DU
));

341 
sTimeSmpD©e
->
W“kDay
 = (
ušt8_t
)((
tmpd©e
 & (
RTC_DR_WDU
)) >> 13U);

344 if(
FÜm©
 =ğ
RTC_FORMAT_BIN
)

347 
sTimeSmp
->
Hours
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTimeStamp->Hours);

348 
sTimeSmp
->
Mšu‹s
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTimeStamp->Minutes);

349 
sTimeSmp
->
SecÚds
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTimeStamp->Seconds);

352 
sTimeSmpD©e
->
MÚth
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTimeStampDate->Month);

353 
sTimeSmpD©e
->
D©e
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTimeStampDate->Date);

354 
sTimeSmpD©e
->
W“kDay
 = (
ušt8_t
)
	`RTC_Bcd2ToBy‹
(sTimeStampDate->WeekDay);

358 
	`__HAL_RTC_TIMESTAMP_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_TSF
);

360  
HAL_OK
;

361 
	}
}

371 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘Tam³r
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_Tam³rTy³Def
* 
sTam³r
)

373 
ušt32_t
 
tm´eg
 = 0U;

376 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER
(
sTam³r
->
Tam³r
));

377 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_PIN
(
sTam³r
->
PšS–eùiÚ
));

378 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_TRIGGER
(
sTam³r
->
Trigg”
));

379 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_FILTER
(
sTam³r
->
F‹r
));

380 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_SAMPLING_FREQ
(
sTam³r
->
Sam¶šgF»qu’cy
));

381 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_PRECHARGE_DURATION
(
sTam³r
->
P»ch¬geDu¿tiÚ
));

382 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_PULLUP_STATE
(
sTam³r
->
Tam³rPuÎUp
));

383 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_TIMESTAMPONTAMPER_DETECTION
(
sTam³r
->
TimeSmpOnTam³rD‘eùiÚ
));

386 
	`__HAL_LOCK
(
h¹c
);

388 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

390 if(
sTam³r
->
Trigg”
 !ğ
RTC_TAMPERTRIGGER_RISINGEDGE
)

392 
sTam³r
->
Trigg”
 = (
ušt32_t
)(sTam³r->
Tam³r
 << 1U);

395 
tm´eg
 = ((
ušt32_t
)
sTam³r
->
Tam³r
 | (ušt32_t)sTam³r->
PšS–eùiÚ
 | (ušt32_t)sTam³r->
Trigg”
 |\

396 (
ušt32_t
)
sTam³r
->
F‹r
 | (ušt32_t)sTam³r->
Sam¶šgF»qu’cy
 | (ušt32_t)sTam³r->
P»ch¬geDu¿tiÚ
 |\

397 (
ušt32_t
)
sTam³r
->
Tam³rPuÎUp
 | sTam³r->
TimeSmpOnTam³rD‘eùiÚ
);

399 
h¹c
->
In¡ªû
->
TAFCR
 &ğ(
ušt32_t
)~((ušt32_t)
sTam³r
->
Tam³r
 | (ušt32_t)(sTam³r->Tam³¸<< 1Uè| (ušt32_t)
RTC_TAFCR_TAMPTS
 |\

400 (
ušt32_t
)
RTC_TAFCR_TAMPFREQ
 | (ušt32_t)
RTC_TAFCR_TAMPFLT
 | (ušt32_t)
RTC_TAFCR_TAMPPRCH
 |\

401 (
ušt32_t
)
RTC_TAFCR_TAMPPUDIS
 | (ušt32_t)
RTC_TAFCR_TAMPINSEL
 | (ušt32_t)
RTC_TAFCR_TAMPIE
);

403 
h¹c
->
In¡ªû
->
TAFCR
 |ğ
tm´eg
;

405 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

408 
	`__HAL_UNLOCK
(
h¹c
);

410  
HAL_OK
;

411 
	}
}

421 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘Tam³r_IT
(
RTC_HªdËTy³Def
 *
h¹c
, 
RTC_Tam³rTy³Def
* 
sTam³r
)

423 
ušt32_t
 
tm´eg
 = 0U;

426 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER
(
sTam³r
->
Tam³r
));

427 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_PIN
(
sTam³r
->
PšS–eùiÚ
));

428 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_TRIGGER
(
sTam³r
->
Trigg”
));

429 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_FILTER
(
sTam³r
->
F‹r
));

430 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_SAMPLING_FREQ
(
sTam³r
->
Sam¶šgF»qu’cy
));

431 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_PRECHARGE_DURATION
(
sTam³r
->
P»ch¬geDu¿tiÚ
));

432 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_PULLUP_STATE
(
sTam³r
->
Tam³rPuÎUp
));

433 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER_TIMESTAMPONTAMPER_DETECTION
(
sTam³r
->
TimeSmpOnTam³rD‘eùiÚ
));

436 
	`__HAL_LOCK
(
h¹c
);

438 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

441 if(
sTam³r
->
Trigg”
 !ğ
RTC_TAMPERTRIGGER_RISINGEDGE
)

443 
sTam³r
->
Trigg”
 = (
ušt32_t
)(sTam³r->
Tam³r
 << 1U);

446 
tm´eg
 = ((
ušt32_t
)
sTam³r
->
Tam³r
 | (ušt32_t)sTam³r->
PšS–eùiÚ
 | (ušt32_t)sTam³r->
Trigg”
 |\

447 (
ušt32_t
)
sTam³r
->
F‹r
 | (ušt32_t)sTam³r->
Sam¶šgF»qu’cy
 | (ušt32_t)sTam³r->
P»ch¬geDu¿tiÚ
 |\

448 (
ušt32_t
)
sTam³r
->
Tam³rPuÎUp
 | sTam³r->
TimeSmpOnTam³rD‘eùiÚ
);

450 
h¹c
->
In¡ªû
->
TAFCR
 &ğ(
ušt32_t
)~((ušt32_t)
sTam³r
->
Tam³r
 | (ušt32_t)(sTam³r->Tam³¸<< 1Uè| (ušt32_t)
RTC_TAFCR_TAMPTS
 |\

451 (
ušt32_t
)
RTC_TAFCR_TAMPFREQ
 | (ušt32_t)
RTC_TAFCR_TAMPFLT
 | (ušt32_t)
RTC_TAFCR_TAMPPRCH
 |\

452 (
ušt32_t
)
RTC_TAFCR_TAMPPUDIS
 | (ušt32_t)
RTC_TAFCR_TAMPINSEL
);

454 
h¹c
->
In¡ªû
->
TAFCR
 |ğ
tm´eg
;

457 
h¹c
->
In¡ªû
->
TAFCR
 |ğ(
ušt32_t
)
RTC_TAFCR_TAMPIE
;

459 if(
sTam³r
->
Tam³r
 =ğ
RTC_TAMPER_1
)

462 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_TAMP1F
);

467 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_TAMP2F
);

471 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_ENABLE_IT
();

473 
EXTI
->
RTSR
 |ğ
RTC_EXTI_LINE_TAMPER_TIMESTAMP_EVENT
;

475 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

478 
	`__HAL_UNLOCK
(
h¹c
);

480  
HAL_OK
;

481 
	}
}

491 
HAL_StusTy³Def
 
	$HAL_RTCEx_D—ùiv©eTam³r
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
Tam³r
)

493 
	`as£¹_·¿m
(
	`IS_RTC_TAMPER
(
Tam³r
));

496 
	`__HAL_LOCK
(
h¹c
);

498 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

501 
h¹c
->
In¡ªû
->
TAFCR
 &ğ(
ušt32_t
)~
Tam³r
;

503 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

506 
	`__HAL_UNLOCK
(
h¹c
);

508  
HAL_OK
;

509 
	}
}

517 
	$HAL_RTCEx_Tam³rTimeSmpIRQHªdËr
(
RTC_HªdËTy³Def
 *
h¹c
)

519 if(
	`__HAL_RTC_TIMESTAMP_GET_IT
(
h¹c
, 
RTC_IT_TS
))

522 if((
ušt32_t
)(
h¹c
->
In¡ªû
->
CR
 & 
RTC_IT_TS
è!ğ(ušt32_t)
RESET
)

525 
	`HAL_RTCEx_TimeSmpEv’tC®lback
(
h¹c
);

528 
	`__HAL_RTC_TIMESTAMP_CLEAR_FLAG
(
h¹c
,
RTC_FLAG_TSF
);

533 if(
	`__HAL_RTC_TAMPER_GET_IT
(
h¹c
,
RTC_IT_TAMP1
))

536 if(((
h¹c
->
In¡ªû
->
TAFCR
 & (
RTC_TAFCR_TAMPIE
))è!ğ(
ušt32_t
)
RESET
)

539 
	`HAL_RTCEx_Tam³r1Ev’tC®lback
(
h¹c
);

542 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
h¹c
,
RTC_FLAG_TAMP1F
);

547 if(
	`__HAL_RTC_TAMPER_GET_IT
(
h¹c
, 
RTC_IT_TAMP2
))

550 if(((
h¹c
->
In¡ªû
->
TAFCR
 & 
RTC_TAFCR_TAMPIE
)è!ğ(
ušt32_t
)
RESET
)

553 
	`HAL_RTCEx_Tam³r2Ev’tC®lback
(
h¹c
);

556 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_TAMP2F
);

560 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_CLEAR_FLAG
();

563 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

564 
	}
}

572 
__w—k
 
	$HAL_RTCEx_TimeSmpEv’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

575 
	`UNUSED
(
h¹c
);

579 
	}
}

587 
__w—k
 
	$HAL_RTCEx_Tam³r1Ev’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

590 
	`UNUSED
(
h¹c
);

594 
	}
}

602 
__w—k
 
	$HAL_RTCEx_Tam³r2Ev’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

605 
	`UNUSED
(
h¹c
);

609 
	}
}

618 
HAL_StusTy³Def
 
	$HAL_RTCEx_PŞlFÜTimeSmpEv’t
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
Timeout
)

620 
ušt32_t
 
tick¡¬t
 = 0U;

623 
tick¡¬t
 = 
	`HAL_G‘Tick
();

625 
	`__HAL_RTC_TIMESTAMP_GET_FLAG
(
h¹c
, 
RTC_FLAG_TSF
è=ğ
RESET
)

627 if(
	`__HAL_RTC_TIMESTAMP_GET_FLAG
(
h¹c
, 
RTC_FLAG_TSOVF
è!ğ
RESET
)

630 
	`__HAL_RTC_TIMESTAMP_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_TSOVF
);

633 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

635  
HAL_ERROR
;

638 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

640 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

642 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

643  
HAL_TIMEOUT
;

649 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

651  
HAL_OK
;

652 
	}
}

661 
HAL_StusTy³Def
 
	$HAL_RTCEx_PŞlFÜTam³r1Ev’t
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
Timeout
)

663 
ušt32_t
 
tick¡¬t
 = 0U;

666 
tick¡¬t
 = 
	`HAL_G‘Tick
();

669 
	`__HAL_RTC_TAMPER_GET_FLAG
(
h¹c
, 
RTC_FLAG_TAMP1F
)=ğ
RESET
)

671 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

673 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

675 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

676  
HAL_TIMEOUT
;

682 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
h¹c
,
RTC_FLAG_TAMP1F
);

685 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

687  
HAL_OK
;

688 
	}
}

697 
HAL_StusTy³Def
 
	$HAL_RTCEx_PŞlFÜTam³r2Ev’t
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
Timeout
)

699 
ušt32_t
 
tick¡¬t
 = 0U;

702 
tick¡¬t
 = 
	`HAL_G‘Tick
();

705 
	`__HAL_RTC_TAMPER_GET_FLAG
(
h¹c
, 
RTC_FLAG_TAMP2F
è=ğ
RESET
)

707 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

709 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

711 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

712  
HAL_TIMEOUT
;

718 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
h¹c
,
RTC_FLAG_TAMP2F
);

721 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

723  
HAL_OK
;

724 
	}
}

752 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘WakeUpTim”
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
WakeUpCouÁ”
, ušt32_ˆ
WakeUpClock
)

754 
ušt32_t
 
tick¡¬t
 = 0U;

757 
	`as£¹_·¿m
(
	`IS_RTC_WAKEUP_CLOCK
(
WakeUpClock
));

758 
	`as£¹_·¿m
(
	`IS_RTC_WAKEUP_COUNTER
(
WakeUpCouÁ”
));

761 
	`__HAL_LOCK
(
h¹c
);

763 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

766 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

769 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_WUTE
è!ğ
RESET
)

771 
tick¡¬t
 = 
	`HAL_G‘Tick
();

774 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
h¹c
, 
RTC_FLAG_WUTWF
è=ğ
SET
)

776 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

779 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

781 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

784 
	`__HAL_UNLOCK
(
h¹c
);

786  
HAL_TIMEOUT
;

791 
	`__HAL_RTC_WAKEUPTIMER_DISABLE
(
h¹c
);

793 
tick¡¬t
 = 
	`HAL_G‘Tick
();

796 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
h¹c
, 
RTC_FLAG_WUTWF
è=ğ
RESET
)

798 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

801 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

803 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

806 
	`__HAL_UNLOCK
(
h¹c
);

808  
HAL_TIMEOUT
;

813 
h¹c
->
In¡ªû
->
CR
 &ğ(
ušt32_t
)~
RTC_CR_WUCKSEL
;

816 
h¹c
->
In¡ªû
->
CR
 |ğ(
ušt32_t
)
WakeUpClock
;

819 
h¹c
->
In¡ªû
->
WUTR
 = (
ušt32_t
)
WakeUpCouÁ”
;

822 
	`__HAL_RTC_WAKEUPTIMER_ENABLE
(
h¹c
);

825 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

827 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

830 
	`__HAL_UNLOCK
(
h¹c
);

832  
HAL_OK
;

833 
	}
}

843 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘WakeUpTim”_IT
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
WakeUpCouÁ”
, ušt32_ˆ
WakeUpClock
)

845 
__IO
 
ušt32_t
 
couÁ
;

848 
	`as£¹_·¿m
(
	`IS_RTC_WAKEUP_CLOCK
(
WakeUpClock
));

849 
	`as£¹_·¿m
(
	`IS_RTC_WAKEUP_COUNTER
(
WakeUpCouÁ”
));

852 
	`__HAL_LOCK
(
h¹c
);

854 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

857 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

860 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_WUTE
è!ğ
RESET
)

863 
couÁ
 = 
RTC_TIMEOUT_VALUE
 * (
Sy¡emCÜeClock
 / 32U / 1000U);

866 if(
couÁ
-- == 0U)

869 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

871 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

874 
	`__HAL_UNLOCK
(
h¹c
);

876  
HAL_TIMEOUT
;

879 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
h¹c
, 
RTC_FLAG_WUTWF
è=ğ
SET
);

882 
	`__HAL_RTC_WAKEUPTIMER_DISABLE
(
h¹c
);

885 
couÁ
 = 
RTC_TIMEOUT_VALUE
 * (
Sy¡emCÜeClock
 / 32U / 1000U);

888 if(
couÁ
-- == 0U)

891 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

893 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

896 
	`__HAL_UNLOCK
(
h¹c
);

898  
HAL_TIMEOUT
;

901 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
h¹c
, 
RTC_FLAG_WUTWF
è=ğ
RESET
);

904 
h¹c
->
In¡ªû
->
WUTR
 = (
ušt32_t
)
WakeUpCouÁ”
;

907 
h¹c
->
In¡ªû
->
CR
 &ğ(
ušt32_t
)~
RTC_CR_WUCKSEL
;

910 
h¹c
->
In¡ªû
->
CR
 |ğ(
ušt32_t
)
WakeUpClock
;

913 
	`__HAL_RTC_WAKEUPTIMER_EXTI_ENABLE_IT
();

915 
EXTI
->
RTSR
 |ğ
RTC_EXTI_LINE_WAKEUPTIMER_EVENT
;

918 
	`__HAL_RTC_WAKEUPTIMER_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_WUTF
);

921 
	`__HAL_RTC_WAKEUPTIMER_ENABLE_IT
(
h¹c
,
RTC_IT_WUT
);

924 
	`__HAL_RTC_WAKEUPTIMER_ENABLE
(
h¹c
);

927 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

929 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

932 
	`__HAL_UNLOCK
(
h¹c
);

934  
HAL_OK
;

935 
	}
}

943 
ušt32_t
 
	$HAL_RTCEx_D—ùiv©eWakeUpTim”
(
RTC_HªdËTy³Def
 *
h¹c
)

945 
ušt32_t
 
tick¡¬t
 = 0U;

948 
	`__HAL_LOCK
(
h¹c
);

950 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

953 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

956 
	`__HAL_RTC_WAKEUPTIMER_DISABLE
(
h¹c
);

959 
	`__HAL_RTC_WAKEUPTIMER_DISABLE_IT
(
h¹c
,
RTC_IT_WUT
);

962 
tick¡¬t
 = 
	`HAL_G‘Tick
();

965 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
h¹c
, 
RTC_FLAG_WUTWF
è=ğ
RESET
)

967 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

970 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

972 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

975 
	`__HAL_UNLOCK
(
h¹c
);

977  
HAL_TIMEOUT
;

982 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

984 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

987 
	`__HAL_UNLOCK
(
h¹c
);

989  
HAL_OK
;

990 
	}
}

998 
ušt32_t
 
	$HAL_RTCEx_G‘WakeUpTim”
(
RTC_HªdËTy³Def
 *
h¹c
)

1001  ((
ušt32_t
)(
h¹c
->
In¡ªû
->
WUTR
 & 
RTC_WUTR_WUT
));

1002 
	}
}

1010 
	$HAL_RTCEx_WakeUpTim”IRQHªdËr
(
RTC_HªdËTy³Def
 *
h¹c
)

1012 if(
	`__HAL_RTC_WAKEUPTIMER_GET_IT
(
h¹c
, 
RTC_IT_WUT
))

1015 if((
ušt32_t
)(
h¹c
->
In¡ªû
->
CR
 & 
RTC_IT_WUT
è!ğ(ušt32_t)
RESET
)

1018 
	`HAL_RTCEx_WakeUpTim”Ev’tC®lback
(
h¹c
);

1021 
	`__HAL_RTC_WAKEUPTIMER_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_WUTF
);

1026 
	`__HAL_RTC_WAKEUPTIMER_EXTI_CLEAR_FLAG
();

1029 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1030 
	}
}

1038 
__w—k
 
	$HAL_RTCEx_WakeUpTim”Ev’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

1041 
	`UNUSED
(
h¹c
);

1045 
	}
}

1054 
HAL_StusTy³Def
 
	$HAL_RTCEx_PŞlFÜWakeUpTim”Ev’t
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
Timeout
)

1056 
ušt32_t
 
tick¡¬t
 = 0U;

1059 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1061 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
h¹c
, 
RTC_FLAG_WUTF
è=ğ
RESET
)

1063 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1065 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

1067 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1069  
HAL_TIMEOUT
;

1075 
	`__HAL_RTC_WAKEUPTIMER_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_WUTF
);

1078 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1080  
HAL_OK
;

1081 
	}
}

1124 
	$HAL_RTCEx_BKUPWr™e
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
BackupRegi¡”
, ušt32_ˆ
D©a
)

1126 
ušt32_t
 
tmp
 = 0U;

1129 
	`as£¹_·¿m
(
	`IS_RTC_BKP
(
BackupRegi¡”
));

1131 
tmp
 = (
ušt32_t
)&(
h¹c
->
In¡ªû
->
BKP0R
);

1132 
tmp
 +ğ(
BackupRegi¡”
 * 4U);

1135 *(
__IO
 
ušt32_t
 *)
tmp
 = (ušt32_t)
D©a
;

1136 
	}
}

1147 
ušt32_t
 
	$HAL_RTCEx_BKUPR—d
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
BackupRegi¡”
)

1149 
ušt32_t
 
tmp
 = 0U;

1152 
	`as£¹_·¿m
(
	`IS_RTC_BKP
(
BackupRegi¡”
));

1154 
tmp
 = (
ušt32_t
)&(
h¹c
->
In¡ªû
->
BKP0R
);

1155 
tmp
 +ğ(
BackupRegi¡”
 * 4U);

1158  (*(
__IO
 
ušt32_t
 *)
tmp
);

1159 
	}
}

1178 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘Cßr£C®ib
(
RTC_HªdËTy³Def
* 
h¹c
, 
ušt32_t
 
C®ibSign
, ušt32_ˆ
V®ue
)

1181 
	`as£¹_·¿m
(
	`IS_RTC_CALIB_SIGN
(
C®ibSign
));

1182 
	`as£¹_·¿m
(
	`IS_RTC_CALIB_VALUE
(
V®ue
));

1185 
	`__HAL_LOCK
(
h¹c
);

1187 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1190 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1193 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

1196 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1199 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

1202 
	`__HAL_UNLOCK
(
h¹c
);

1204  
HAL_ERROR
;

1209 
	`__HAL_RTC_COARSE_CALIB_ENABLE
(
h¹c
);

1212 
h¹c
->
In¡ªû
->
CALIBR
 = (
ušt32_t
)(
C®ibSign
|
V®ue
);

1215 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)~
RTC_ISR_INIT
;

1219 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1222 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1225 
	`__HAL_UNLOCK
(
h¹c
);

1227  
HAL_OK
;

1228 
	}
}

1236 
HAL_StusTy³Def
 
	$HAL_RTCEx_D—ùiv©eCßr£C®ib
(
RTC_HªdËTy³Def
* 
h¹c
)

1239 
	`__HAL_LOCK
(
h¹c
);

1241 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1244 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1247 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

1250 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1253 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

1256 
	`__HAL_UNLOCK
(
h¹c
);

1258  
HAL_ERROR
;

1263 
	`__HAL_RTC_COARSE_CALIB_DISABLE
(
h¹c
);

1266 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)~
RTC_ISR_INIT
;

1270 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1273 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1276 
	`__HAL_UNLOCK
(
h¹c
);

1278  
HAL_OK
;

1279 
	}
}

1301 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘SmoÙhC®ib
(
RTC_HªdËTy³Def
* 
h¹c
, 
ušt32_t
 
SmoÙhC®ibP”iod
, ušt32_ˆ
SmoÙhC®ibPlusPul£s
, ušt32_ˆ
SmouthC®ibMšusPul£sV®ue
)

1303 
ušt32_t
 
tick¡¬t
 = 0U;

1306 
	`as£¹_·¿m
(
	`IS_RTC_SMOOTH_CALIB_PERIOD
(
SmoÙhC®ibP”iod
));

1307 
	`as£¹_·¿m
(
	`IS_RTC_SMOOTH_CALIB_PLUS
(
SmoÙhC®ibPlusPul£s
));

1308 
	`as£¹_·¿m
(
	`IS_RTC_SMOOTH_CALIB_MINUS
(
SmouthC®ibMšusPul£sV®ue
));

1311 
	`__HAL_LOCK
(
h¹c
);

1313 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1316 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1319 if((
h¹c
->
In¡ªû
->
ISR
 & 
RTC_ISR_RECALPF
è!ğ
RESET
)

1322 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1325 (
h¹c
->
In¡ªû
->
ISR
 & 
RTC_ISR_RECALPF
è!ğ
RESET
)

1327 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

1330 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1333 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1336 
	`__HAL_UNLOCK
(
h¹c
);

1338  
HAL_TIMEOUT
;

1344 
h¹c
->
In¡ªû
->
CALR
 = (
ušt32_t
)((ušt32_t)
SmoÙhC®ibP”iod
 | (ušt32_t)
SmoÙhC®ibPlusPul£s
 | (ušt32_t)
SmouthC®ibMšusPul£sV®ue
);

1347 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1350 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1353 
	`__HAL_UNLOCK
(
h¹c
);

1355  
HAL_OK
;

1356 
	}
}

1371 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘SynchroShiá
(
RTC_HªdËTy³Def
* 
h¹c
, 
ušt32_t
 
ShiáAdd1S
, ušt32_ˆ
ShiáSubFS
)

1373 
ušt32_t
 
tick¡¬t
 = 0U;

1376 
	`as£¹_·¿m
(
	`IS_RTC_SHIFT_ADD1S
(
ShiáAdd1S
));

1377 
	`as£¹_·¿m
(
	`IS_RTC_SHIFT_SUBFS
(
ShiáSubFS
));

1380 
	`__HAL_LOCK
(
h¹c
);

1382 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1385 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1388 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1391 (
h¹c
->
In¡ªû
->
ISR
 & 
RTC_ISR_SHPF
è!ğ
RESET
)

1393 if((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > 
RTC_TIMEOUT_VALUE
)

1396 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1398 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1401 
	`__HAL_UNLOCK
(
h¹c
);

1403  
HAL_TIMEOUT
;

1408 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_REFCKON
è=ğ
RESET
)

1411 
h¹c
->
In¡ªû
->
SHIFTR
 = (
ušt32_t
)(ušt32_t)(
ShiáSubFS
è| (ušt32_t)(
ShiáAdd1S
);

1414 if((
h¹c
->
In¡ªû
->
CR
 & 
RTC_CR_BYPSHAD
è=ğ
RESET
)

1416 if(
	`HAL_RTC_Wa™FÜSynchro
(
h¹c
è!ğ
HAL_OK
)

1419 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1421 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

1424 
	`__HAL_UNLOCK
(
h¹c
);

1426  
HAL_ERROR
;

1433 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1436 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

1439 
	`__HAL_UNLOCK
(
h¹c
);

1441  
HAL_ERROR
;

1445 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1448 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1451 
	`__HAL_UNLOCK
(
h¹c
);

1453  
HAL_OK
;

1454 
	}
}

1466 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘C®ib¿tiÚOutPut
(
RTC_HªdËTy³Def
* 
h¹c
, 
ušt32_t
 
C®ibOuut
)

1469 
	`as£¹_·¿m
(
	`IS_RTC_CALIB_OUTPUT
(
C®ibOuut
));

1472 
	`__HAL_LOCK
(
h¹c
);

1474 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1477 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1480 
h¹c
->
In¡ªû
->
CR
 &ğ(
ušt32_t
)~
RTC_CR_COSEL
;

1483 
h¹c
->
In¡ªû
->
CR
 |ğ(
ušt32_t
)
C®ibOuut
;

1485 
	`__HAL_RTC_CALIBRATION_OUTPUT_ENABLE
(
h¹c
);

1488 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1491 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1494 
	`__HAL_UNLOCK
(
h¹c
);

1496  
HAL_OK
;

1497 
	}
}

1505 
HAL_StusTy³Def
 
	$HAL_RTCEx_D—ùiv©eC®ib¿tiÚOutPut
(
RTC_HªdËTy³Def
* 
h¹c
)

1508 
	`__HAL_LOCK
(
h¹c
);

1510 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1513 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1515 
	`__HAL_RTC_CALIBRATION_OUTPUT_DISABLE
(
h¹c
);

1518 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1521 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1524 
	`__HAL_UNLOCK
(
h¹c
);

1526  
HAL_OK
;

1527 
	}
}

1535 
HAL_StusTy³Def
 
	$HAL_RTCEx_S‘RefClock
(
RTC_HªdËTy³Def
* 
h¹c
)

1538 
	`__HAL_LOCK
(
h¹c
);

1540 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1543 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1546 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

1549 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1552 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

1555 
	`__HAL_UNLOCK
(
h¹c
);

1557  
HAL_ERROR
;

1561 
	`__HAL_RTC_CLOCKREF_DETECTION_ENABLE
(
h¹c
);

1564 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)~
RTC_ISR_INIT
;

1568 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1571 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1574 
	`__HAL_UNLOCK
(
h¹c
);

1576  
HAL_OK
;

1577 
	}
}

1585 
HAL_StusTy³Def
 
	$HAL_RTCEx_D—ùiv©eRefClock
(
RTC_HªdËTy³Def
* 
h¹c
)

1588 
	`__HAL_LOCK
(
h¹c
);

1590 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1593 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1596 if(
	`RTC_EÁ”In™Mode
(
h¹c
è!ğ
HAL_OK
)

1599 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1602 
h¹c
->
S‹
 = 
HAL_RTC_STATE_ERROR
;

1605 
	`__HAL_UNLOCK
(
h¹c
);

1607  
HAL_ERROR
;

1611 
	`__HAL_RTC_CLOCKREF_DETECTION_DISABLE
(
h¹c
);

1614 
h¹c
->
In¡ªû
->
ISR
 &ğ(
ušt32_t
)~
RTC_ISR_INIT
;

1618 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1621 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1624 
	`__HAL_UNLOCK
(
h¹c
);

1626  
HAL_OK
;

1627 
	}
}

1637 
HAL_StusTy³Def
 
	$HAL_RTCEx_EÇbËBy·ssShadow
(
RTC_HªdËTy³Def
* 
h¹c
)

1640 
	`__HAL_LOCK
(
h¹c
);

1642 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1645 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1648 
h¹c
->
In¡ªû
->
CR
 |ğ(
ušt8_t
)
RTC_CR_BYPSHAD
;

1651 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1654 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1657 
	`__HAL_UNLOCK
(
h¹c
);

1659  
HAL_OK
;

1660 
	}
}

1670 
HAL_StusTy³Def
 
	$HAL_RTCEx_Di§bËBy·ssShadow
(
RTC_HªdËTy³Def
* 
h¹c
)

1673 
	`__HAL_LOCK
(
h¹c
);

1675 
h¹c
->
S‹
 = 
HAL_RTC_STATE_BUSY
;

1678 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
h¹c
);

1681 
h¹c
->
In¡ªû
->
CR
 &ğ(
ušt8_t
)~
RTC_CR_BYPSHAD
;

1684 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
h¹c
);

1687 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1690 
	`__HAL_UNLOCK
(
h¹c
);

1692  
HAL_OK
;

1693 
	}
}

1720 
__w—k
 
	$HAL_RTCEx_AÏrmBEv’tC®lback
(
RTC_HªdËTy³Def
 *
h¹c
)

1723 
	`UNUSED
(
h¹c
);

1727 
	}
}

1736 
HAL_StusTy³Def
 
	$HAL_RTCEx_PŞlFÜAÏrmBEv’t
(
RTC_HªdËTy³Def
 *
h¹c
, 
ušt32_t
 
Timeout
)

1738 
ušt32_t
 
tick¡¬t
 = 0U;

1741 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1743 
	`__HAL_RTC_ALARM_GET_FLAG
(
h¹c
, 
RTC_FLAG_ALRBF
è=ğ
RESET
)

1745 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1747 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

1749 
h¹c
->
S‹
 = 
HAL_RTC_STATE_TIMEOUT
;

1750  
HAL_TIMEOUT
;

1756 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
h¹c
, 
RTC_FLAG_ALRBF
);

1759 
h¹c
->
S‹
 = 
HAL_RTC_STATE_READY
;

1761  
HAL_OK
;

1762 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_sdram.c

94 
	~"¡m32f4xx_h®.h
"

104 #ifdeà
HAL_SDRAM_MODULE_ENABLED


105 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
) ||\

106 
defšed
(
STM32F446xx
è|| defšed(
STM32F469xx
è|| 
	$defšed
(
STM32F479xx
)

140 
HAL_StusTy³Def
 
	$HAL_SDRAM_In™
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
FMC_SDRAM_TimšgTy³Def
 *
Timšg
)

143 if(
hsd¿m
 =ğ
NULL
)

145  
HAL_ERROR
;

148 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_RESET
)

151 
hsd¿m
->
Lock
 = 
HAL_UNLOCKED
;

153 
	`HAL_SDRAM_M¥In™
(
hsd¿m
);

157 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_BUSY
;

160 
	`FMC_SDRAM_In™
(
hsd¿m
->
In¡ªû
, &(hsd¿m->
In™
));

163 
	`FMC_SDRAM_Timšg_In™
(
hsd¿m
->
In¡ªû
, 
Timšg
, hsd¿m->
In™
.
SDBªk
);

166 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_READY
;

168  
HAL_OK
;

169 
	}
}

177 
HAL_StusTy³Def
 
	$HAL_SDRAM_DeIn™
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

180 
	`HAL_SDRAM_M¥DeIn™
(
hsd¿m
);

183 
	`FMC_SDRAM_DeIn™
(
hsd¿m
->
In¡ªû
, hsd¿m->
In™
.
SDBªk
);

186 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_RESET
;

189 
	`__HAL_UNLOCK
(
hsd¿m
);

191  
HAL_OK
;

192 
	}
}

200 
__w—k
 
	$HAL_SDRAM_M¥In™
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

203 
	`UNUSED
(
hsd¿m
);

207 
	}
}

215 
__w—k
 
	$HAL_SDRAM_M¥DeIn™
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

218 
	`UNUSED
(
hsd¿m
);

222 
	}
}

230 
	$HAL_SDRAM_IRQHªdËr
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

233 if(
	`__FMC_SDRAM_GET_FLAG
(
hsd¿m
->
In¡ªû
, 
FMC_SDRAM_FLAG_REFRESH_IT
))

236 
	`HAL_SDRAM_ReäeshE¼ÜC®lback
(
hsd¿m
);

239 
	`__FMC_SDRAM_CLEAR_FLAG
(
hsd¿m
->
In¡ªû
, 
FMC_SDRAM_FLAG_REFRESH_ERROR
);

241 
	}
}

249 
__w—k
 
	$HAL_SDRAM_ReäeshE¼ÜC®lback
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

252 
	`UNUSED
(
hsd¿m
);

256 
	}
}

264 
__w—k
 
	$HAL_SDRAM_DMA_XãrC¶tC®lback
(
DMA_HªdËTy³Def
 *
hdma
)

267 
	`UNUSED
(
hdma
);

271 
	}
}

278 
__w—k
 
	$HAL_SDRAM_DMA_XãrE¼ÜC®lback
(
DMA_HªdËTy³Def
 *
hdma
)

281 
	`UNUSED
(
hdma
);

285 
	}
}

313 
HAL_StusTy³Def
 
	$HAL_SDRAM_R—d_8b
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, 
ušt8_t
 *
pD¡Bufãr
, ušt32_ˆ
BufãrSize
)

315 
__IO
 
ušt8_t
 *
pSd¿mAdd»ss
 = (ušt8_ˆ*)
pAdd»ss
;

318 
	`__HAL_LOCK
(
hsd¿m
);

321 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

323  
HAL_BUSY
;

325 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_PRECHARGED
)

327  
HAL_ERROR
;

331 ; 
BufãrSize
 != 0U; BufferSize--)

333 *
pD¡Bufãr
 = *(
__IO
 
ušt8_t
 *)
pSd¿mAdd»ss
;

334 
pD¡Bufãr
++;

335 
pSd¿mAdd»ss
++;

339 
	`__HAL_UNLOCK
(
hsd¿m
);

341  
HAL_OK
;

342 
	}
}

353 
HAL_StusTy³Def
 
	$HAL_SDRAM_Wr™e_8b
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, 
ušt8_t
 *
pSrcBufãr
, ušt32_ˆ
BufãrSize
)

355 
__IO
 
ušt8_t
 *
pSd¿mAdd»ss
 = (ušt8_ˆ*)
pAdd»ss
;

356 
ušt32_t
 
tmp
 = 0U;

359 
	`__HAL_LOCK
(
hsd¿m
);

362 
tmp
 = 
hsd¿m
->
S‹
;

364 if(
tmp
 =ğ
HAL_SDRAM_STATE_BUSY
)

366  
HAL_BUSY
;

368 if((
tmp
 =ğ
HAL_SDRAM_STATE_PRECHARGED
è|| (tm°=ğ
HAL_SDRAM_STATE_WRITE_PROTECTED
))

370  
HAL_ERROR
;

374 ; 
BufãrSize
 != 0U; BufferSize--)

376 *(
__IO
 
ušt8_t
 *)
pSd¿mAdd»ss
 = *
pSrcBufãr
;

377 
pSrcBufãr
++;

378 
pSd¿mAdd»ss
++;

382 
	`__HAL_UNLOCK
(
hsd¿m
);

384  
HAL_OK
;

385 
	}
}

396 
HAL_StusTy³Def
 
	$HAL_SDRAM_R—d_16b
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, 
ušt16_t
 *
pD¡Bufãr
, ušt32_ˆ
BufãrSize
)

398 
__IO
 
ušt16_t
 *
pSd¿mAdd»ss
 = (ušt16_ˆ*)
pAdd»ss
;

401 
	`__HAL_LOCK
(
hsd¿m
);

404 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

406  
HAL_BUSY
;

408 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_PRECHARGED
)

410  
HAL_ERROR
;

414 ; 
BufãrSize
 != 0U; BufferSize--)

416 *
pD¡Bufãr
 = *(
__IO
 
ušt16_t
 *)
pSd¿mAdd»ss
;

417 
pD¡Bufãr
++;

418 
pSd¿mAdd»ss
++;

422 
	`__HAL_UNLOCK
(
hsd¿m
);

424  
HAL_OK
;

425 
	}
}

436 
HAL_StusTy³Def
 
	$HAL_SDRAM_Wr™e_16b
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, 
ušt16_t
 *
pSrcBufãr
, ušt32_ˆ
BufãrSize
)

438 
__IO
 
ušt16_t
 *
pSd¿mAdd»ss
 = (ušt16_ˆ*)
pAdd»ss
;

439 
ušt32_t
 
tmp
 = 0U;

442 
	`__HAL_LOCK
(
hsd¿m
);

445 
tmp
 = 
hsd¿m
->
S‹
;

447 if(
tmp
 =ğ
HAL_SDRAM_STATE_BUSY
)

449  
HAL_BUSY
;

451 if((
tmp
 =ğ
HAL_SDRAM_STATE_PRECHARGED
è|| (tm°=ğ
HAL_SDRAM_STATE_WRITE_PROTECTED
))

453  
HAL_ERROR
;

457 ; 
BufãrSize
 != 0U; BufferSize--)

459 *(
__IO
 
ušt16_t
 *)
pSd¿mAdd»ss
 = *
pSrcBufãr
;

460 
pSrcBufãr
++;

461 
pSd¿mAdd»ss
++;

465 
	`__HAL_UNLOCK
(
hsd¿m
);

467  
HAL_OK
;

468 
	}
}

479 
HAL_StusTy³Def
 
	$HAL_SDRAM_R—d_32b
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, ušt32_ˆ*
pD¡Bufãr
, ušt32_ˆ
BufãrSize
)

481 
__IO
 
ušt32_t
 *
pSd¿mAdd»ss
 = (ušt32_ˆ*)
pAdd»ss
;

484 
	`__HAL_LOCK
(
hsd¿m
);

487 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

489  
HAL_BUSY
;

491 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_PRECHARGED
)

493  
HAL_ERROR
;

497 ; 
BufãrSize
 != 0U; BufferSize--)

499 *
pD¡Bufãr
 = *(
__IO
 
ušt32_t
 *)
pSd¿mAdd»ss
;

500 
pD¡Bufãr
++;

501 
pSd¿mAdd»ss
++;

505 
	`__HAL_UNLOCK
(
hsd¿m
);

507  
HAL_OK
;

508 
	}
}

519 
HAL_StusTy³Def
 
	$HAL_SDRAM_Wr™e_32b
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, ušt32_ˆ*
pSrcBufãr
, ušt32_ˆ
BufãrSize
)

521 
__IO
 
ušt32_t
 *
pSd¿mAdd»ss
 = (ušt32_ˆ*)
pAdd»ss
;

522 
ušt32_t
 
tmp
 = 0U;

525 
	`__HAL_LOCK
(
hsd¿m
);

528 
tmp
 = 
hsd¿m
->
S‹
;

530 if(
tmp
 =ğ
HAL_SDRAM_STATE_BUSY
)

532  
HAL_BUSY
;

534 if((
tmp
 =ğ
HAL_SDRAM_STATE_PRECHARGED
è|| (tm°=ğ
HAL_SDRAM_STATE_WRITE_PROTECTED
))

536  
HAL_ERROR
;

540 ; 
BufãrSize
 != 0U; BufferSize--)

542 *(
__IO
 
ušt32_t
 *)
pSd¿mAdd»ss
 = *
pSrcBufãr
;

543 
pSrcBufãr
++;

544 
pSd¿mAdd»ss
++;

548 
	`__HAL_UNLOCK
(
hsd¿m
);

550  
HAL_OK
;

551 
	}
}

562 
HAL_StusTy³Def
 
	$HAL_SDRAM_R—d_DMA
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, ušt32_ˆ*
pD¡Bufãr
, ušt32_ˆ
BufãrSize
)

564 
ušt32_t
 
tmp
 = 0U;

567 
	`__HAL_LOCK
(
hsd¿m
);

570 
tmp
 = 
hsd¿m
->
S‹
;

572 if(
tmp
 =ğ
HAL_SDRAM_STATE_BUSY
)

574  
HAL_BUSY
;

576 if(
tmp
 =ğ
HAL_SDRAM_STATE_PRECHARGED
)

578  
HAL_ERROR
;

582 
hsd¿m
->
hdma
->
XãrC¶tC®lback
 = 
HAL_SDRAM_DMA_XãrC¶tC®lback
;

583 
hsd¿m
->
hdma
->
XãrE¼ÜC®lback
 = 
HAL_SDRAM_DMA_XãrE¼ÜC®lback
;

586 
	`HAL_DMA_S¹_IT
(
hsd¿m
->
hdma
, (
ušt32_t
)
pAdd»ss
, (ušt32_t)
pD¡Bufãr
, (ušt32_t)
BufãrSize
);

589 
	`__HAL_UNLOCK
(
hsd¿m
);

591  
HAL_OK
;

592 
	}
}

603 
HAL_StusTy³Def
 
	$HAL_SDRAM_Wr™e_DMA
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 *
pAdd»ss
, ušt32_ˆ*
pSrcBufãr
, ušt32_ˆ
BufãrSize
)

605 
ušt32_t
 
tmp
 = 0U;

608 
	`__HAL_LOCK
(
hsd¿m
);

611 
tmp
 = 
hsd¿m
->
S‹
;

613 if(
tmp
 =ğ
HAL_SDRAM_STATE_BUSY
)

615  
HAL_BUSY
;

617 if((
tmp
 =ğ
HAL_SDRAM_STATE_PRECHARGED
è|| (tm°=ğ
HAL_SDRAM_STATE_WRITE_PROTECTED
))

619  
HAL_ERROR
;

623 
hsd¿m
->
hdma
->
XãrC¶tC®lback
 = 
HAL_SDRAM_DMA_XãrC¶tC®lback
;

624 
hsd¿m
->
hdma
->
XãrE¼ÜC®lback
 = 
HAL_SDRAM_DMA_XãrE¼ÜC®lback
;

627 
	`HAL_DMA_S¹_IT
(
hsd¿m
->
hdma
, (
ušt32_t
)
pSrcBufãr
, (ušt32_t)
pAdd»ss
, (ušt32_t)
BufãrSize
);

630 
	`__HAL_UNLOCK
(
hsd¿m
);

632  
HAL_OK
;

633 
	}
}

659 
HAL_StusTy³Def
 
	$HAL_SDRAM_Wr™ePrÙeùiÚ_EÇbË
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

662 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

664  
HAL_BUSY
;

668 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_BUSY
;

671 
	`FMC_SDRAM_Wr™ePrÙeùiÚ_EÇbË
(
hsd¿m
->
In¡ªû
, hsd¿m->
In™
.
SDBªk
);

674 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_WRITE_PROTECTED
;

676  
HAL_OK
;

677 
	}
}

685 
HAL_StusTy³Def
 
	$HAL_SDRAM_Wr™ePrÙeùiÚ_Di§bË
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

688 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

690  
HAL_BUSY
;

694 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_BUSY
;

697 
	`FMC_SDRAM_Wr™ePrÙeùiÚ_Di§bË
(
hsd¿m
->
In¡ªû
, hsd¿m->
In™
.
SDBªk
);

700 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_READY
;

702  
HAL_OK
;

703 
	}
}

713 
HAL_StusTy³Def
 
	$HAL_SDRAM_S’dCommªd
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
FMC_SDRAM_CommªdTy³Def
 *
Commªd
, 
ušt32_t
 
Timeout
)

716 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

718  
HAL_BUSY
;

722 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_BUSY
;

725 
	`FMC_SDRAM_S’dCommªd
(
hsd¿m
->
In¡ªû
, 
Commªd
, 
Timeout
);

728 if(
Commªd
->
CommªdMode
 =ğ
FMC_SDRAM_CMD_PALL
)

730 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_PRECHARGED
;

734 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_READY
;

737  
HAL_OK
;

738 
	}
}

747 
HAL_StusTy³Def
 
	$HAL_SDRAM_Prog¿mReäeshR©e
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 
ReäeshR©e
)

750 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

752  
HAL_BUSY
;

756 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_BUSY
;

759 
	`FMC_SDRAM_Prog¿mReäeshR©e
(
hsd¿m
->
In¡ªû
 ,
ReäeshR©e
);

762 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_READY
;

764  
HAL_OK
;

765 
	}
}

774 
HAL_StusTy³Def
 
	$HAL_SDRAM_S‘AutoReäeshNumb”
(
SDRAM_HªdËTy³Def
 *
hsd¿m
, 
ušt32_t
 
AutoReäeshNumb”
)

777 if(
hsd¿m
->
S‹
 =ğ
HAL_SDRAM_STATE_BUSY
)

779  
HAL_BUSY
;

783 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_BUSY
;

786 
	`FMC_SDRAM_S‘AutoReäeshNumb”
(
hsd¿m
->
In¡ªû
 ,
AutoReäeshNumb”
);

789 
hsd¿m
->
S‹
 = 
HAL_SDRAM_STATE_READY
;

791  
HAL_OK
;

792 
	}
}

800 
ušt32_t
 
	$HAL_SDRAM_G‘ModeStus
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

803 (
	`FMC_SDRAM_G‘ModeStus
(
hsd¿m
->
In¡ªû
, hsd¿m->
In™
.
SDBªk
));

804 
	}
}

831 
HAL_SDRAM_S‹Ty³Def
 
	$HAL_SDRAM_G‘S‹
(
SDRAM_HªdËTy³Def
 *
hsd¿m
)

833  
hsd¿m
->
S‹
;

834 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_uart.c

157 
	~"¡m32f4xx_h®.h
"

167 #ifdeà
HAL_UART_MODULE_ENABLED


183 
UART_EndTxT¿nsãr
(
UART_HªdËTy³Def
 *
hu¬t
);

184 
UART_EndRxT¿nsãr
(
UART_HªdËTy³Def
 *
hu¬t
);

185 
UART_DMAT¿nsm™C¶t
(
DMA_HªdËTy³Def
 *
hdma
);

186 
UART_DMAReûiveC¶t
(
DMA_HªdËTy³Def
 *
hdma
);

187 
UART_DMATxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
);

188 
UART_DMARxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
);

189 
UART_DMAE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
);

190 
UART_DMAAbÜtOnE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
);

191 
HAL_StusTy³Def
 
UART_T¿nsm™_IT
(
UART_HªdËTy³Def
 *
hu¬t
);

192 
HAL_StusTy³Def
 
UART_EndT¿nsm™_IT
(
UART_HªdËTy³Def
 *
hu¬t
);

193 
HAL_StusTy³Def
 
UART_Reûive_IT
(
UART_HªdËTy³Def
 *
hu¬t
);

194 
HAL_StusTy³Def
 
UART_Wa™OnFÏgUÁTimeout
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt32_t
 
FÏg
, 
FÏgStus
 
Stus
, ušt32_ˆ
Tick¡¬t
, ušt32_ˆ
Timeout
);

195 
UART_S‘CÚfig
 (
UART_HªdËTy³Def
 *
hu¬t
);

242 
HAL_StusTy³Def
 
	$HAL_UART_In™
(
UART_HªdËTy³Def
 *
hu¬t
)

245 if(
hu¬t
 =ğ
NULL
)

247  
HAL_ERROR
;

251 if(
hu¬t
->
In™
.
HwFlowC
 !ğ
UART_HWCONTROL_NONE
)

254 
	`as£¹_·¿m
(
	`IS_UART_HWFLOW_INSTANCE
(
hu¬t
->
In¡ªû
));

255 
	`as£¹_·¿m
(
	`IS_UART_HARDWARE_FLOW_CONTROL
(
hu¬t
->
In™
.
HwFlowC
));

259 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

261 
	`as£¹_·¿m
(
	`IS_UART_WORD_LENGTH
(
hu¬t
->
In™
.
WÜdL’gth
));

262 
	`as£¹_·¿m
(
	`IS_UART_OVERSAMPLING
(
hu¬t
->
In™
.
Ov”Sam¶šg
));

264 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_RESET
)

267 
hu¬t
->
Lock
 = 
HAL_UNLOCKED
;

269 
	`HAL_UART_M¥In™
(
hu¬t
);

272 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

275 
	`__HAL_UART_DISABLE
(
hu¬t
);

278 
	`UART_S‘CÚfig
(
hu¬t
);

283 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR2
, (
USART_CR2_LINEN
 | 
USART_CR2_CLKEN
));

284 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, (
USART_CR3_SCEN
 | 
USART_CR3_HDSEL
 | 
USART_CR3_IREN
));

287 
	`__HAL_UART_ENABLE
(
hu¬t
);

290 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

291 
hu¬t
->
gS‹
ğ
HAL_UART_STATE_READY
;

292 
hu¬t
->
RxS‹
ğ
HAL_UART_STATE_READY
;

294  
HAL_OK
;

295 
	}
}

304 
HAL_StusTy³Def
 
	$HAL_H®fDu¶ex_In™
(
UART_HªdËTy³Def
 *
hu¬t
)

307 if(
hu¬t
 =ğ
NULL
)

309  
HAL_ERROR
;

313 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

314 
	`as£¹_·¿m
(
	`IS_UART_WORD_LENGTH
(
hu¬t
->
In™
.
WÜdL’gth
));

315 
	`as£¹_·¿m
(
	`IS_UART_OVERSAMPLING
(
hu¬t
->
In™
.
Ov”Sam¶šg
));

317 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_RESET
)

320 
hu¬t
->
Lock
 = 
HAL_UNLOCKED
;

322 
	`HAL_UART_M¥In™
(
hu¬t
);

325 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

328 
	`__HAL_UART_DISABLE
(
hu¬t
);

331 
	`UART_S‘CÚfig
(
hu¬t
);

336 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR2
, (
USART_CR2_LINEN
 | 
USART_CR2_CLKEN
));

337 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, (
USART_CR3_IREN
 | 
USART_CR3_SCEN
));

340 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_HDSEL
);

343 
	`__HAL_UART_ENABLE
(
hu¬t
);

346 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

347 
hu¬t
->
gS‹
ğ
HAL_UART_STATE_READY
;

348 
hu¬t
->
RxS‹
ğ
HAL_UART_STATE_READY
;

350  
HAL_OK
;

351 
	}
}

364 
HAL_StusTy³Def
 
	$HAL_LIN_In™
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt32_t
 
B»akD‘eùL’gth
)

367 if(
hu¬t
 =ğ
NULL
)

369  
HAL_ERROR
;

373 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

374 
	`as£¹_·¿m
(
	`IS_UART_LIN_BREAK_DETECT_LENGTH
(
B»akD‘eùL’gth
));

375 
	`as£¹_·¿m
(
	`IS_UART_LIN_WORD_LENGTH
(
hu¬t
->
In™
.
WÜdL’gth
));

376 
	`as£¹_·¿m
(
	`IS_UART_LIN_OVERSAMPLING
(
hu¬t
->
In™
.
Ov”Sam¶šg
));

378 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_RESET
)

381 
hu¬t
->
Lock
 = 
HAL_UNLOCKED
;

383 
	`HAL_UART_M¥In™
(
hu¬t
);

386 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

389 
	`__HAL_UART_DISABLE
(
hu¬t
);

392 
	`UART_S‘CÚfig
(
hu¬t
);

397 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR2
, 
USART_CR2_CLKEN
);

398 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, (
USART_CR3_HDSEL
 | 
USART_CR3_IREN
 | 
USART_CR3_SCEN
));

401 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR2
, 
USART_CR2_LINEN
);

404 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR2
, 
USART_CR2_LBDL
);

405 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR2
, 
B»akD‘eùL’gth
);

408 
	`__HAL_UART_ENABLE
(
hu¬t
);

411 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

412 
hu¬t
->
gS‹
ğ
HAL_UART_STATE_READY
;

413 
hu¬t
->
RxS‹
ğ
HAL_UART_STATE_READY
;

415  
HAL_OK
;

416 
	}
}

430 
HAL_StusTy³Def
 
	$HAL_MuÉiProûssÜ_In™
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 
Add»ss
, 
ušt32_t
 
WakeUpM‘hod
)

433 if(
hu¬t
 =ğ
NULL
)

435  
HAL_ERROR
;

439 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

440 
	`as£¹_·¿m
(
	`IS_UART_WAKEUPMETHOD
(
WakeUpM‘hod
));

441 
	`as£¹_·¿m
(
	`IS_UART_ADDRESS
(
Add»ss
));

442 
	`as£¹_·¿m
(
	`IS_UART_WORD_LENGTH
(
hu¬t
->
In™
.
WÜdL’gth
));

443 
	`as£¹_·¿m
(
	`IS_UART_OVERSAMPLING
(
hu¬t
->
In™
.
Ov”Sam¶šg
));

445 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_RESET
)

448 
hu¬t
->
Lock
 = 
HAL_UNLOCKED
;

450 
	`HAL_UART_M¥In™
(
hu¬t
);

453 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

456 
	`__HAL_UART_DISABLE
(
hu¬t
);

459 
	`UART_S‘CÚfig
(
hu¬t
);

464 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR2
, (
USART_CR2_LINEN
 | 
USART_CR2_CLKEN
));

465 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, (
USART_CR3_SCEN
 | 
USART_CR3_HDSEL
 | 
USART_CR3_IREN
));

468 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR2
, 
USART_CR2_ADD
);

470 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR2
, 
Add»ss
);

473 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_WAKE
);

474 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
WakeUpM‘hod
);

477 
	`__HAL_UART_ENABLE
(
hu¬t
);

480 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

481 
hu¬t
->
gS‹
ğ
HAL_UART_STATE_READY
;

482 
hu¬t
->
RxS‹
ğ
HAL_UART_STATE_READY
;

484  
HAL_OK
;

485 
	}
}

493 
HAL_StusTy³Def
 
	$HAL_UART_DeIn™
(
UART_HªdËTy³Def
 *
hu¬t
)

496 if(
hu¬t
 =ğ
NULL
)

498  
HAL_ERROR
;

502 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

504 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

507 
	`HAL_UART_M¥DeIn™
(
hu¬t
);

509 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

510 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_RESET
;

511 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_RESET
;

514 
	`__HAL_UNLOCK
(
hu¬t
);

516  
HAL_OK
;

517 
	}
}

525 
__w—k
 
	$HAL_UART_M¥In™
(
UART_HªdËTy³Def
 *
hu¬t
)

528 
	`UNUSED
(
hu¬t
);

532 
	}
}

540 
__w—k
 
	$HAL_UART_M¥DeIn™
(
UART_HªdËTy³Def
 *
hu¬t
)

543 
	`UNUSED
(
hu¬t
);

547 
	}
}

614 
HAL_StusTy³Def
 
	$HAL_UART_T¿nsm™
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 *
pD©a
, 
ušt16_t
 
Size
, 
ušt32_t
 
Timeout
)

616 
ušt16_t
* 
tmp
;

617 
ušt32_t
 
tick¡¬t
 = 0U;

620 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_READY
)

622 if((
pD©a
 =ğ
NULL
 ) || (
Size
 == 0U))

624  
HAL_ERROR
;

628 
	`__HAL_LOCK
(
hu¬t
);

630 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

631 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY_TX
;

634 
tick¡¬t
 = 
	`HAL_G‘Tick
();

636 
hu¬t
->
TxXãrSize
 = 
Size
;

637 
hu¬t
->
TxXãrCouÁ
 = 
Size
;

638 
hu¬t
->
TxXãrCouÁ
 > 0U)

640 
hu¬t
->
TxXãrCouÁ
--;

641 if(
hu¬t
->
In™
.
WÜdL’gth
 =ğ
UART_WORDLENGTH_9B
)

643 if(
	`UART_Wa™OnFÏgUÁTimeout
(
hu¬t
, 
UART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

645  
HAL_TIMEOUT
;

647 
tmp
 = (
ušt16_t
*è
pD©a
;

648 
hu¬t
->
In¡ªû
->
DR
 = (*
tmp
 & (
ušt16_t
)0x01FFU);

649 if(
hu¬t
->
In™
.
P¬™y
 =ğ
UART_PARITY_NONE
)

651 
pD©a
 +=2U;

655 
pD©a
 +=1U;

660 if(
	`UART_Wa™OnFÏgUÁTimeout
(
hu¬t
, 
UART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

662  
HAL_TIMEOUT
;

664 
hu¬t
->
In¡ªû
->
DR
 = (*
pD©a
++ & (
ušt8_t
)0xFFU);

668 if(
	`UART_Wa™OnFÏgUÁTimeout
(
hu¬t
, 
UART_FLAG_TC
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

670  
HAL_TIMEOUT
;

674 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

677 
	`__HAL_UNLOCK
(
hu¬t
);

679  
HAL_OK
;

683  
HAL_BUSY
;

685 
	}
}

696 
HAL_StusTy³Def
 
	$HAL_UART_Reûive
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 *
pD©a
, 
ušt16_t
 
Size
, 
ušt32_t
 
Timeout
)

698 
ušt16_t
* 
tmp
;

699 
ušt32_t
 
tick¡¬t
 = 0U;

702 if(
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_READY
)

704 if((
pD©a
 =ğ
NULL
 ) || (
Size
 == 0U))

706  
HAL_ERROR
;

710 
	`__HAL_LOCK
(
hu¬t
);

712 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

713 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_BUSY_RX
;

716 
tick¡¬t
 = 
	`HAL_G‘Tick
();

718 
hu¬t
->
RxXãrSize
 = 
Size
;

719 
hu¬t
->
RxXãrCouÁ
 = 
Size
;

722 
hu¬t
->
RxXãrCouÁ
 > 0U)

724 
hu¬t
->
RxXãrCouÁ
--;

725 if(
hu¬t
->
In™
.
WÜdL’gth
 =ğ
UART_WORDLENGTH_9B
)

727 if(
	`UART_Wa™OnFÏgUÁTimeout
(
hu¬t
, 
UART_FLAG_RXNE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

729  
HAL_TIMEOUT
;

731 
tmp
 = (
ušt16_t
*è
pD©a
;

732 if(
hu¬t
->
In™
.
P¬™y
 =ğ
UART_PARITY_NONE
)

734 *
tmp
 = (
ušt16_t
)(
hu¬t
->
In¡ªû
->
DR
 & (uint16_t)0x01FFU);

735 
pD©a
 +=2U;

739 *
tmp
 = (
ušt16_t
)(
hu¬t
->
In¡ªû
->
DR
 & (uint16_t)0x00FFU);

740 
pD©a
 +=1U;

746 if(
	`UART_Wa™OnFÏgUÁTimeout
(
hu¬t
, 
UART_FLAG_RXNE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

748  
HAL_TIMEOUT
;

750 if(
hu¬t
->
In™
.
P¬™y
 =ğ
UART_PARITY_NONE
)

752 *
pD©a
++ = (
ušt8_t
)(
hu¬t
->
In¡ªû
->
DR
 & (uint8_t)0x00FFU);

756 *
pD©a
++ = (
ušt8_t
)(
hu¬t
->
In¡ªû
->
DR
 & (uint8_t)0x007FU);

763 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_READY
;

766 
	`__HAL_UNLOCK
(
hu¬t
);

768  
HAL_OK
;

772  
HAL_BUSY
;

774 
	}
}

784 
HAL_StusTy³Def
 
	$HAL_UART_T¿nsm™_IT
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 *
pD©a
, 
ušt16_t
 
Size
)

787 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_READY
)

789 if((
pD©a
 =ğ
NULL
 ) || (
Size
 == 0U))

791  
HAL_ERROR
;

795 
	`__HAL_LOCK
(
hu¬t
);

797 
hu¬t
->
pTxBuffPŒ
 = 
pD©a
;

798 
hu¬t
->
TxXãrSize
 = 
Size
;

799 
hu¬t
->
TxXãrCouÁ
 = 
Size
;

801 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

802 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY_TX
;

805 
	`__HAL_UNLOCK
(
hu¬t
);

808 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_TXEIE
);

810  
HAL_OK
;

814  
HAL_BUSY
;

816 
	}
}

826 
HAL_StusTy³Def
 
	$HAL_UART_Reûive_IT
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 *
pD©a
, 
ušt16_t
 
Size
)

829 if(
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_READY
)

831 if((
pD©a
 =ğ
NULL
 ) || (
Size
 == 0U))

833  
HAL_ERROR
;

837 
	`__HAL_LOCK
(
hu¬t
);

839 
hu¬t
->
pRxBuffPŒ
 = 
pD©a
;

840 
hu¬t
->
RxXãrSize
 = 
Size
;

841 
hu¬t
->
RxXãrCouÁ
 = 
Size
;

843 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

844 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_BUSY_RX
;

847 
	`__HAL_UNLOCK
(
hu¬t
);

850 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

853 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
 | 
USART_CR1_RXNEIE
);

855  
HAL_OK
;

859  
HAL_BUSY
;

861 
	}
}

871 
HAL_StusTy³Def
 
	$HAL_UART_T¿nsm™_DMA
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 *
pD©a
, 
ušt16_t
 
Size
)

873 
ušt32_t
 *
tmp
;

876 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_READY
)

878 if((
pD©a
 =ğ
NULL
 ) || (
Size
 == 0U))

880  
HAL_ERROR
;

884 
	`__HAL_LOCK
(
hu¬t
);

886 
hu¬t
->
pTxBuffPŒ
 = 
pD©a
;

887 
hu¬t
->
TxXãrSize
 = 
Size
;

888 
hu¬t
->
TxXãrCouÁ
 = 
Size
;

890 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

891 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY_TX
;

894 
hu¬t
->
hdm©x
->
XãrC¶tC®lback
 = 
UART_DMAT¿nsm™C¶t
;

897 
hu¬t
->
hdm©x
->
XãrH®fC¶tC®lback
 = 
UART_DMATxH®fC¶t
;

900 
hu¬t
->
hdm©x
->
XãrE¼ÜC®lback
 = 
UART_DMAE¼Ü
;

903 
hu¬t
->
hdm©x
->
XãrAbÜtC®lback
 = 
NULL
;

906 
tmp
 = (
ušt32_t
*)&
pD©a
;

907 
	`HAL_DMA_S¹_IT
(
hu¬t
->
hdm©x
, *(
ušt32_t
*)
tmp
, (ušt32_t)&hu¬t->
In¡ªû
->
DR
, 
Size
);

910 
	`__HAL_UART_CLEAR_FLAG
(
hu¬t
, 
UART_FLAG_TC
);

913 
	`__HAL_UNLOCK
(
hu¬t
);

917 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

919  
HAL_OK
;

923  
HAL_BUSY
;

925 
	}
}

936 
HAL_StusTy³Def
 
	$HAL_UART_Reûive_DMA
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt8_t
 *
pD©a
, 
ušt16_t
 
Size
)

938 
ušt32_t
 *
tmp
;

941 if(
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_READY
)

943 if((
pD©a
 =ğ
NULL
 ) || (
Size
 == 0U))

945  
HAL_ERROR
;

949 
	`__HAL_LOCK
(
hu¬t
);

951 
hu¬t
->
pRxBuffPŒ
 = 
pD©a
;

952 
hu¬t
->
RxXãrSize
 = 
Size
;

954 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

955 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_BUSY_RX
;

958 
hu¬t
->
hdm¬x
->
XãrC¶tC®lback
 = 
UART_DMAReûiveC¶t
;

961 
hu¬t
->
hdm¬x
->
XãrH®fC¶tC®lback
 = 
UART_DMARxH®fC¶t
;

964 
hu¬t
->
hdm¬x
->
XãrE¼ÜC®lback
 = 
UART_DMAE¼Ü
;

967 
hu¬t
->
hdm¬x
->
XãrAbÜtC®lback
 = 
NULL
;

970 
tmp
 = (
ušt32_t
*)&
pD©a
;

971 
	`HAL_DMA_S¹_IT
(
hu¬t
->
hdm¬x
, (
ušt32_t
)&hu¬t->
In¡ªû
->
DR
, *(ušt32_t*)
tmp
, 
Size
);

974 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

977 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

981 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

984 
	`__HAL_UNLOCK
(
hu¬t
);

986  
HAL_OK
;

990  
HAL_BUSY
;

992 
	}
}

1000 
HAL_StusTy³Def
 
	$HAL_UART_DMAPau£
(
UART_HªdËTy³Def
 *
hu¬t
)

1002 
ušt32_t
 
dm¬eque¡
 = 0x00U;

1005 
	`__HAL_LOCK
(
hu¬t
);

1006 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1007 if((
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_BUSY_TX
è&& 
dm¬eque¡
)

1010 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1012 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1013 if((
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_BUSY_RX
è&& 
dm¬eque¡
)

1016 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1017 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1020 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1024 
	`__HAL_UNLOCK
(
hu¬t
);

1026  
HAL_OK
;

1027 
	}
}

1035 
HAL_StusTy³Def
 
	$HAL_UART_DMAResume
(
UART_HªdËTy³Def
 *
hu¬t
)

1038 
	`__HAL_LOCK
(
hu¬t
);

1040 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_BUSY_TX
)

1043 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1045 if(
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_BUSY_RX
)

1048 
	`__HAL_UART_CLEAR_OREFLAG
(
hu¬t
);

1051 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1052 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1055 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1059 
	`__HAL_UNLOCK
(
hu¬t
);

1061  
HAL_OK
;

1062 
	}
}

1070 
HAL_StusTy³Def
 
	$HAL_UART_DMAStİ
(
UART_HªdËTy³Def
 *
hu¬t
)

1072 
ušt32_t
 
dm¬eque¡
 = 0x00U;

1080 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1081 if((
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_BUSY_TX
è&& 
dm¬eque¡
)

1083 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1086 if(
hu¬t
->
hdm©x
 !ğ
NULL
)

1088 
	`HAL_DMA_AbÜt
(
hu¬t
->
hdm©x
);

1090 
	`UART_EndTxT¿nsãr
(
hu¬t
);

1094 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1095 if((
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_BUSY_RX
è&& 
dm¬eque¡
)

1097 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1100 if(
hu¬t
->
hdm¬x
 !ğ
NULL
)

1102 
	`HAL_DMA_AbÜt
(
hu¬t
->
hdm¬x
);

1104 
	`UART_EndRxT¿nsãr
(
hu¬t
);

1107  
HAL_OK
;

1108 
	}
}

1116 
	$HAL_UART_IRQHªdËr
(
UART_HªdËTy³Def
 *
hu¬t
)

1118 
ušt32_t
 
i¤æags
 = 
	`READ_REG
(
hu¬t
->
In¡ªû
->
SR
);

1119 
ušt32_t
 
ü1™s
 = 
	`READ_REG
(
hu¬t
->
In¡ªû
->
CR1
);

1120 
ušt32_t
 
ü3™s
 = 
	`READ_REG
(
hu¬t
->
In¡ªû
->
CR3
);

1121 
ušt32_t
 
”rÜæags
 = 0x00U;

1122 
ušt32_t
 
dm¬eque¡
 = 0x00U;

1125 
”rÜæags
 = (
i¤æags
 & (
ušt32_t
)(
USART_SR_PE
 | 
USART_SR_FE
 | 
USART_SR_ORE
 | 
USART_SR_NE
));

1126 if(
”rÜæags
 =ğ
RESET
)

1129 if(((
i¤æags
 & 
USART_SR_RXNE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_RXNEIE
) != RESET))

1131 
	`UART_Reûive_IT
(
hu¬t
);

1137 if((
”rÜæags
 !ğ
RESET
è&& (((
ü3™s
 & 
USART_CR3_EIE
è!ğRESETè|| ((
ü1™s
 & (
USART_CR1_RXNEIE
 | 
USART_CR1_PEIE
)) != RESET)))

1140 if(((
i¤æags
 & 
USART_SR_PE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_PEIE
) != RESET))

1142 
hu¬t
->
E¼ÜCode
 |ğ
HAL_UART_ERROR_PE
;

1146 if(((
i¤æags
 & 
USART_SR_NE
è!ğ
RESET
è&& ((
ü3™s
 & 
USART_CR3_EIE
) != RESET))

1148 
hu¬t
->
E¼ÜCode
 |ğ
HAL_UART_ERROR_NE
;

1152 if(((
i¤æags
 & 
USART_SR_FE
è!ğ
RESET
è&& ((
ü3™s
 & 
USART_CR3_EIE
) != RESET))

1154 
hu¬t
->
E¼ÜCode
 |ğ
HAL_UART_ERROR_FE
;

1158 if(((
i¤æags
 & 
USART_SR_ORE
è!ğ
RESET
è&& ((
ü3™s
 & 
USART_CR3_EIE
) != RESET))

1160 
hu¬t
->
E¼ÜCode
 |ğ
HAL_UART_ERROR_ORE
;

1164 if(
hu¬t
->
E¼ÜCode
 !ğ
HAL_UART_ERROR_NONE
)

1167 if(((
i¤æags
 & 
USART_SR_RXNE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_RXNEIE
) != RESET))

1169 
	`UART_Reûive_IT
(
hu¬t
);

1174 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1175 if(((
hu¬t
->
E¼ÜCode
 & 
HAL_UART_ERROR_ORE
è!ğ
RESET
è|| 
dm¬eque¡
)

1180 
	`UART_EndRxT¿nsãr
(
hu¬t
);

1183 if(
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
))

1185 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1188 if(
hu¬t
->
hdm¬x
 !ğ
NULL
)

1192 
hu¬t
->
hdm¬x
->
XãrAbÜtC®lback
 = 
UART_DMAAbÜtOnE¼Ü
;

1193 if(
	`HAL_DMA_AbÜt_IT
(
hu¬t
->
hdm¬x
è!ğ
HAL_OK
)

1196 
hu¬t
->
hdm¬x
->
	`XãrAbÜtC®lback
(huart->hdmarx);

1202 
	`HAL_UART_E¼ÜC®lback
(
hu¬t
);

1208 
	`HAL_UART_E¼ÜC®lback
(
hu¬t
);

1215 
	`HAL_UART_E¼ÜC®lback
(
hu¬t
);

1216 
hu¬t
->
E¼ÜCode
 = 
HAL_UART_ERROR_NONE
;

1223 if(((
i¤æags
 & 
USART_SR_TXE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_TXEIE
) != RESET))

1225 
	`UART_T¿nsm™_IT
(
hu¬t
);

1230 if(((
i¤æags
 & 
USART_SR_TC
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_TCIE
) != RESET))

1232 
	`UART_EndT¿nsm™_IT
(
hu¬t
);

1235 
	}
}

1243 
__w—k
 
	$HAL_UART_TxC¶tC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

1246 
	`UNUSED
(
hu¬t
);

1250 
	}
}

1258 
__w—k
 
	$HAL_UART_TxH®fC¶tC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

1261 
	`UNUSED
(
hu¬t
);

1265 
	}
}

1273 
__w—k
 
	$HAL_UART_RxC¶tC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

1276 
	`UNUSED
(
hu¬t
);

1280 
	}
}

1288 
__w—k
 
	$HAL_UART_RxH®fC¶tC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

1291 
	`UNUSED
(
hu¬t
);

1295 
	}
}

1303 
__w—k
 
	$HAL_UART_E¼ÜC®lback
(
UART_HªdËTy³Def
 *
hu¬t
)

1306 
	`UNUSED
(
hu¬t
);

1310 
	}
}

1339 
HAL_StusTy³Def
 
	$HAL_LIN_S’dB»ak
(
UART_HªdËTy³Def
 *
hu¬t
)

1342 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

1345 
	`__HAL_LOCK
(
hu¬t
);

1347 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

1350 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_SBK
);

1352 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1355 
	`__HAL_UNLOCK
(
hu¬t
);

1357  
HAL_OK
;

1358 
	}
}

1366 
HAL_StusTy³Def
 
	$HAL_MuÉiProûssÜ_EÁ”Mu‹Mode
(
UART_HªdËTy³Def
 *
hu¬t
)

1369 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

1372 
	`__HAL_LOCK
(
hu¬t
);

1374 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

1377 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_RWU
);

1379 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1382 
	`__HAL_UNLOCK
(
hu¬t
);

1384  
HAL_OK
;

1385 
	}
}

1393 
HAL_StusTy³Def
 
	$HAL_MuÉiProûssÜ_Ex™Mu‹Mode
(
UART_HªdËTy³Def
 *
hu¬t
)

1396 
	`as£¹_·¿m
(
	`IS_UART_INSTANCE
(
hu¬t
->
In¡ªû
));

1399 
	`__HAL_LOCK
(
hu¬t
);

1401 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

1404 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_RWU
);

1406 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1409 
	`__HAL_UNLOCK
(
hu¬t
);

1411  
HAL_OK
;

1412 
	}
}

1420 
HAL_StusTy³Def
 
	$HAL_H®fDu¶ex_EÇbËT¿nsm™‹r
(
UART_HªdËTy³Def
 *
hu¬t
)

1422 
ušt32_t
 
tm´eg
 = 0x00U;

1425 
	`__HAL_LOCK
(
hu¬t
);

1427 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

1430 
tm´eg
 = 
hu¬t
->
In¡ªû
->
CR1
;

1433 
tm´eg
 &ğ(
ušt32_t
)~((ušt32_t)(
USART_CR1_TE
 | 
USART_CR1_RE
));

1436 
tm´eg
 |ğ(
ušt32_t
)
USART_CR1_TE
;

1439 
	`WRITE_REG
(
hu¬t
->
In¡ªû
->
CR1
, (
ušt32_t
)
tm´eg
);

1441 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1444 
	`__HAL_UNLOCK
(
hu¬t
);

1446  
HAL_OK
;

1447 
	}
}

1455 
HAL_StusTy³Def
 
	$HAL_H®fDu¶ex_EÇbËReûiv”
(
UART_HªdËTy³Def
 *
hu¬t
)

1457 
ušt32_t
 
tm´eg
 = 0x00U;

1460 
	`__HAL_LOCK
(
hu¬t
);

1462 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_BUSY
;

1465 
tm´eg
 = 
hu¬t
->
In¡ªû
->
CR1
;

1468 
tm´eg
 &ğ(
ušt32_t
)~((ušt32_t)(
USART_CR1_TE
 | 
USART_CR1_RE
));

1471 
tm´eg
 |ğ(
ušt32_t
)
USART_CR1_RE
;

1474 
	`WRITE_REG
(
hu¬t
->
In¡ªû
->
CR1
, (
ušt32_t
)
tm´eg
);

1476 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1479 
	`__HAL_UNLOCK
(
hu¬t
);

1481  
HAL_OK
;

1482 
	}
}

1512 
HAL_UART_S‹Ty³Def
 
	$HAL_UART_G‘S‹
(
UART_HªdËTy³Def
 *
hu¬t
)

1514 
ušt32_t
 
‹mp1
ğ0x00U, 
‹mp2
 = 0x00U;

1515 
‹mp1
 = 
hu¬t
->
gS‹
;

1516 
‹mp2
 = 
hu¬t
->
RxS‹
;

1518  (
HAL_UART_S‹Ty³Def
)(
‹mp1
 | 
‹mp2
);

1519 
	}
}

1527 
ušt32_t
 
	$HAL_UART_G‘E¼Ü
(
UART_HªdËTy³Def
 *
hu¬t
)

1529  
hu¬t
->
E¼ÜCode
;

1530 
	}
}

1541 
	$UART_DMAT¿nsm™C¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1543 
UART_HªdËTy³Def
* 
hu¬t
 = ( UART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1545 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CIRC
) == 0U)

1547 
hu¬t
->
TxXãrCouÁ
 = 0U;

1551 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1554 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_TCIE
);

1560 
	`HAL_UART_TxC¶tC®lback
(
hu¬t
);

1562 
	}
}

1570 
	$UART_DMATxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1572 
UART_HªdËTy³Def
* 
hu¬t
 = (UART_HªdËTy³Def*)((
DMA_HªdËTy³Def
*)
hdma
)->
P¬’t
;

1574 
	`HAL_UART_TxH®fC¶tC®lback
(
hu¬t
);

1575 
	}
}

1582 
	$UART_DMAReûiveC¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1584 
UART_HªdËTy³Def
* 
hu¬t
 = ( UART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1586 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CIRC
) == 0U)

1588 
hu¬t
->
RxXãrCouÁ
 = 0U;

1591 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1592 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1596 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1599 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_READY
;

1601 
	`HAL_UART_RxC¶tC®lback
(
hu¬t
);

1602 
	}
}

1610 
	$UART_DMARxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1612 
UART_HªdËTy³Def
* 
hu¬t
 = (UART_HªdËTy³Def*)((
DMA_HªdËTy³Def
*)
hdma
)->
P¬’t
;

1614 
	`HAL_UART_RxH®fC¶tC®lback
(
hu¬t
);

1615 
	}
}

1622 
	$UART_DMAE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
)

1624 
ušt32_t
 
dm¬eque¡
 = 0x00U;

1625 
UART_HªdËTy³Def
* 
hu¬t
 = ( UART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1628 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1629 if((
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_BUSY_TX
è&& 
dm¬eque¡
)

1631 
hu¬t
->
TxXãrCouÁ
 = 0U;

1632 
	`UART_EndTxT¿nsãr
(
hu¬t
);

1636 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1637 if((
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_BUSY_RX
è&& 
dm¬eque¡
)

1639 
hu¬t
->
RxXãrCouÁ
 = 0U;

1640 
	`UART_EndRxT¿nsãr
(
hu¬t
);

1643 
hu¬t
->
E¼ÜCode
 |ğ
HAL_UART_ERROR_DMA
;

1644 
	`HAL_UART_E¼ÜC®lback
(
hu¬t
);

1645 
	}
}

1657 
HAL_StusTy³Def
 
	$UART_Wa™OnFÏgUÁTimeout
(
UART_HªdËTy³Def
 *
hu¬t
, 
ušt32_t
 
FÏg
, 
FÏgStus
 
Stus
, ušt32_ˆ
Tick¡¬t
, ušt32_ˆ
Timeout
)

1660 (
	`__HAL_UART_GET_FLAG
(
hu¬t
, 
FÏg
è? 
SET
 : 
RESET
è=ğ
Stus
)

1663 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1665 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
Tick¡¬t
 ) > Timeout))

1668 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, (
USART_CR1_RXNEIE
 | 
USART_CR1_PEIE
 | 
USART_CR1_TXEIE
));

1669 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1671 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1672 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_READY
;

1675 
	`__HAL_UNLOCK
(
hu¬t
);

1677  
HAL_TIMEOUT
;

1682  
HAL_OK
;

1683 
	}
}

1690 
	$UART_EndTxT¿nsãr
(
UART_HªdËTy³Def
 *
hu¬t
)

1693 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, (
USART_CR1_TXEIE
 | 
USART_CR1_TCIE
));

1696 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1697 
	}
}

1704 
	$UART_EndRxT¿nsãr
(
UART_HªdËTy³Def
 *
hu¬t
)

1707 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, (
USART_CR1_RXNEIE
 | 
USART_CR1_PEIE
));

1708 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1711 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_READY
;

1712 
	}
}

1720 
	$UART_DMAAbÜtOnE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
)

1722 
UART_HªdËTy³Def
* 
hu¬t
 = ( UART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1723 
hu¬t
->
RxXãrCouÁ
 = 0;

1724 
hu¬t
->
TxXãrCouÁ
 = 0;

1726 
	`HAL_UART_E¼ÜC®lback
(
hu¬t
);

1727 
	}
}

1735 
HAL_StusTy³Def
 
	$UART_T¿nsm™_IT
(
UART_HªdËTy³Def
 *
hu¬t
)

1737 
ušt16_t
* 
tmp
;

1740 if(
hu¬t
->
gS‹
 =ğ
HAL_UART_STATE_BUSY_TX
)

1742 if(
hu¬t
->
In™
.
WÜdL’gth
 =ğ
UART_WORDLENGTH_9B
)

1744 
tmp
 = (
ušt16_t
*è
hu¬t
->
pTxBuffPŒ
;

1745 
hu¬t
->
In¡ªû
->
DR
 = (
ušt16_t
)(*
tmp
 & (uint16_t)0x01FFU);

1746 if(
hu¬t
->
In™
.
P¬™y
 =ğ
UART_PARITY_NONE
)

1748 
hu¬t
->
pTxBuffPŒ
 += 2U;

1752 
hu¬t
->
pTxBuffPŒ
 += 1U;

1757 
hu¬t
->
In¡ªû
->
DR
 = (
ušt8_t
)(*hu¬t->
pTxBuffPŒ
++ & (uint8_t)0x00FFU);

1760 if(--
hu¬t
->
TxXãrCouÁ
 == 0U)

1763 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_TXEIE
);

1766 
	`SET_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_TCIE
);

1768  
HAL_OK
;

1772  
HAL_BUSY
;

1774 
	}
}

1782 
HAL_StusTy³Def
 
	$UART_EndT¿nsm™_IT
(
UART_HªdËTy³Def
 *
hu¬t
)

1785 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, 
USART_CR1_TCIE
);

1788 
hu¬t
->
gS‹
 = 
HAL_UART_STATE_READY
;

1790 
	`HAL_UART_TxC¶tC®lback
(
hu¬t
);

1792  
HAL_OK
;

1793 
	}
}

1801 
HAL_StusTy³Def
 
	$UART_Reûive_IT
(
UART_HªdËTy³Def
 *
hu¬t
)

1803 
ušt16_t
* 
tmp
;

1806 if(
hu¬t
->
RxS‹
 =ğ
HAL_UART_STATE_BUSY_RX
)

1808 if(
hu¬t
->
In™
.
WÜdL’gth
 =ğ
UART_WORDLENGTH_9B
)

1810 
tmp
 = (
ušt16_t
*è
hu¬t
->
pRxBuffPŒ
;

1811 if(
hu¬t
->
In™
.
P¬™y
 =ğ
UART_PARITY_NONE
)

1813 *
tmp
 = (
ušt16_t
)(
hu¬t
->
In¡ªû
->
DR
 & (uint16_t)0x01FFU);

1814 
hu¬t
->
pRxBuffPŒ
 += 2U;

1818 *
tmp
 = (
ušt16_t
)(
hu¬t
->
In¡ªû
->
DR
 & (uint16_t)0x00FFU);

1819 
hu¬t
->
pRxBuffPŒ
 += 1U;

1824 if(
hu¬t
->
In™
.
P¬™y
 =ğ
UART_PARITY_NONE
)

1826 *
hu¬t
->
pRxBuffPŒ
++ = (
ušt8_t
)(hu¬t->
In¡ªû
->
DR
 & (uint8_t)0x00FFU);

1830 *
hu¬t
->
pRxBuffPŒ
++ = (
ušt8_t
)(hu¬t->
In¡ªû
->
DR
 & (uint8_t)0x007FU);

1834 if(--
hu¬t
->
RxXãrCouÁ
 == 0U)

1837 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR1
, (
USART_CR1_RXNEIE
 | 
USART_CR1_PEIE
));

1840 
	`CLEAR_BIT
(
hu¬t
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1843 
hu¬t
->
RxS‹
 = 
HAL_UART_STATE_READY
;

1845 
	`HAL_UART_RxC¶tC®lback
(
hu¬t
);

1847  
HAL_OK
;

1849  
HAL_OK
;

1853  
HAL_BUSY
;

1855 
	}
}

1863 
	$UART_S‘CÚfig
(
UART_HªdËTy³Def
 *
hu¬t
)

1865 
ušt32_t
 
tm´eg
 = 0x00U;

1868 
	`as£¹_·¿m
(
	`IS_UART_BAUDRATE
(
hu¬t
->
In™
.
BaudR©e
));

1869 
	`as£¹_·¿m
(
	`IS_UART_STOPBITS
(
hu¬t
->
In™
.
StİB™s
));

1870 
	`as£¹_·¿m
(
	`IS_UART_PARITY
(
hu¬t
->
In™
.
P¬™y
));

1871 
	`as£¹_·¿m
(
	`IS_UART_MODE
(
hu¬t
->
In™
.
Mode
));

1874 
tm´eg
 = 
hu¬t
->
In¡ªû
->
CR2
;

1877 
tm´eg
 &ğ(
ušt32_t
)~((ušt32_t)
USART_CR2_STOP
);

1880 
tm´eg
 |ğ(
ušt32_t
)
hu¬t
->
In™
.
StİB™s
;

1883 
	`WRITE_REG
(
hu¬t
->
In¡ªû
->
CR2
, (
ušt32_t
)
tm´eg
);

1886 
tm´eg
 = 
hu¬t
->
In¡ªû
->
CR1
;

1889 
tm´eg
 &ğ(
ušt32_t
)~((ušt32_t)(
USART_CR1_M
 | 
USART_CR1_PCE
 | 
USART_CR1_PS
 | 
USART_CR1_TE
 | \

1890 
USART_CR1_RE
 | 
USART_CR1_OVER8
));

1897 
tm´eg
 |ğ(
ušt32_t
)
hu¬t
->
In™
.
WÜdL’gth
 | hu¬t->In™.
P¬™y
 | hu¬t->In™.
Mode
 | hu¬t->In™.
Ov”Sam¶šg
;

1900 
	`WRITE_REG
(
hu¬t
->
In¡ªû
->
CR1
, (
ušt32_t
)
tm´eg
);

1903 
tm´eg
 = 
hu¬t
->
In¡ªû
->
CR3
;

1906 
tm´eg
 &ğ(
ušt32_t
)~((ušt32_t)(
USART_CR3_RTSE
 | 
USART_CR3_CTSE
));

1909 
tm´eg
 |ğ
hu¬t
->
In™
.
HwFlowC
;

1912 
	`WRITE_REG
(
hu¬t
->
In¡ªû
->
CR3
, (
ušt32_t
)
tm´eg
);

1915 if(
hu¬t
->
In™
.
Ov”Sam¶šg
 =ğ
UART_OVERSAMPLING_8
)

1918 if((
hu¬t
->
In¡ªû
 =ğ
USART1
è|| (hu¬t->In¡ªû =ğ
USART6
))

1920 
hu¬t
->
In¡ªû
->
BRR
 = 
	`UART_BRR_SAMPLING8
(
	`HAL_RCC_G‘PCLK2F»q
(), hu¬t->
In™
.
BaudR©e
);

1924 
hu¬t
->
In¡ªû
->
BRR
 = 
	`UART_BRR_SAMPLING8
(
	`HAL_RCC_G‘PCLK1F»q
(), hu¬t->
In™
.
BaudR©e
);

1930 if((
hu¬t
->
In¡ªû
 =ğ
USART1
è|| (hu¬t->In¡ªû =ğ
USART6
))

1932 
hu¬t
->
In¡ªû
->
BRR
 = 
	`UART_BRR_SAMPLING16
(
	`HAL_RCC_G‘PCLK2F»q
(), hu¬t->
In™
.
BaudR©e
);

1936 
hu¬t
->
In¡ªû
->
BRR
 = 
	`UART_BRR_SAMPLING16
(
	`HAL_RCC_G‘PCLK1F»q
(), hu¬t->
In™
.
BaudR©e
);

1939 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_usart.c

136 
	~"¡m32f4xx_h®.h
"

146 #ifdeà
HAL_USART_MODULE_ENABLED


152 
	#DUMMY_DATA
 0xFFFFU

	)

153 
	#USART_TIMEOUT_VALUE
 22000U

	)

164 
USART_EndTxT¿nsãr
(
USART_HªdËTy³Def
 *
hu§¹
);

165 
USART_EndRxT¿nsãr
(
USART_HªdËTy³Def
 *
hu§¹
);

166 
HAL_StusTy³Def
 
USART_T¿nsm™_IT
(
USART_HªdËTy³Def
 *
hu§¹
);

167 
HAL_StusTy³Def
 
USART_EndT¿nsm™_IT
(
USART_HªdËTy³Def
 *
hu§¹
);

168 
HAL_StusTy³Def
 
USART_Reûive_IT
(
USART_HªdËTy³Def
 *
hu§¹
);

169 
HAL_StusTy³Def
 
USART_T¿nsm™Reûive_IT
(
USART_HªdËTy³Def
 *
hu§¹
);

170 
USART_S‘CÚfig
 (
USART_HªdËTy³Def
 *
hu§¹
);

171 
USART_DMAT¿nsm™C¶t
(
DMA_HªdËTy³Def
 *
hdma
);

172 
USART_DMATxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
);

173 
USART_DMAReûiveC¶t
(
DMA_HªdËTy³Def
 *
hdma
);

174 
USART_DMARxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
);

175 
USART_DMAE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
);

176 
USART_DMAAbÜtOnE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
);

178 
HAL_StusTy³Def
 
USART_Wa™OnFÏgUÁTimeout
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt32_t
 
FÏg
, 
FÏgStus
 
Stus
, ušt32_ˆ
Tick¡¬t
, ušt32_ˆ
Timeout
);

226 
HAL_StusTy³Def
 
	$HAL_USART_In™
(
USART_HªdËTy³Def
 *
hu§¹
)

229 if(
hu§¹
 =ğ
NULL
)

231  
HAL_ERROR
;

235 
	`as£¹_·¿m
(
	`IS_USART_INSTANCE
(
hu§¹
->
In¡ªû
));

237 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_RESET
)

240 
hu§¹
->
Lock
 = 
HAL_UNLOCKED
;

242 
	`HAL_USART_M¥In™
(
hu§¹
);

245 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY
;

248 
	`USART_S‘CÚfig
(
hu§¹
);

253 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR2
, 
USART_CR2_LINEN
);

254 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, (
USART_CR3_SCEN
 | 
USART_CR3_HDSEL
 | 
USART_CR3_IREN
));

257 
	`__HAL_USART_ENABLE
(
hu§¹
);

260 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

261 
hu§¹
->
S‹
ğ
HAL_USART_STATE_READY
;

263  
HAL_OK
;

264 
	}
}

272 
HAL_StusTy³Def
 
	$HAL_USART_DeIn™
(
USART_HªdËTy³Def
 *
hu§¹
)

275 if(
hu§¹
 =ğ
NULL
)

277  
HAL_ERROR
;

281 
	`as£¹_·¿m
(
	`IS_USART_INSTANCE
(
hu§¹
->
In¡ªû
));

283 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY
;

286 
	`__HAL_USART_DISABLE
(
hu§¹
);

289 
	`HAL_USART_M¥DeIn™
(
hu§¹
);

291 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

292 
hu§¹
->
S‹
 = 
HAL_USART_STATE_RESET
;

295 
	`__HAL_UNLOCK
(
hu§¹
);

297  
HAL_OK
;

298 
	}
}

306 
__w—k
 
	$HAL_USART_M¥In™
(
USART_HªdËTy³Def
 *
hu§¹
)

309 
	`UNUSED
(
hu§¹
);

313 
	}
}

321 
__w—k
 
	$HAL_USART_M¥DeIn™
(
USART_HªdËTy³Def
 *
hu§¹
)

324 
	`UNUSED
(
hu§¹
);

328 
	}
}

404 
HAL_StusTy³Def
 
	$HAL_USART_T¿nsm™
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pTxD©a
, 
ušt16_t
 
Size
, 
ušt32_t
 
Timeout
)

406 
ušt16_t
* 
tmp
;

407 
ušt32_t
 
tick¡¬t
 = 0U;

409 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

411 if((
pTxD©a
 =ğ
NULL
è|| (
Size
 == 0U))

413  
HAL_ERROR
;

417 
	`__HAL_LOCK
(
hu§¹
);

419 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

420 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_TX
;

423 
tick¡¬t
 = 
	`HAL_G‘Tick
();

425 
hu§¹
->
TxXãrSize
 = 
Size
;

426 
hu§¹
->
TxXãrCouÁ
 = 
Size
;

427 
hu§¹
->
TxXãrCouÁ
 > 0U)

429 
hu§¹
->
TxXãrCouÁ
--;

430 if(
hu§¹
->
In™
.
WÜdL’gth
 =ğ
USART_WORDLENGTH_9B
)

433 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

435  
HAL_TIMEOUT
;

437 
tmp
 = (
ušt16_t
*è
pTxD©a
;

438 
hu§¹
->
In¡ªû
->
DR
 = (*
tmp
 & (
ušt16_t
)0x01FFU);

439 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

441 
pTxD©a
 += 2U;

445 
pTxD©a
 += 1U;

450 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

452  
HAL_TIMEOUT
;

454 
hu§¹
->
In¡ªû
->
DR
 = (*
pTxD©a
++ & (
ušt8_t
)0xFFU);

458 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_TC
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

460  
HAL_TIMEOUT
;

463 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

466 
	`__HAL_UNLOCK
(
hu§¹
);

468  
HAL_OK
;

472  
HAL_BUSY
;

474 
	}
}

485 
HAL_StusTy³Def
 
	$HAL_USART_Reûive
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pRxD©a
, 
ušt16_t
 
Size
, 
ušt32_t
 
Timeout
)

487 
ušt16_t
* 
tmp
;

488 
ušt32_t
 
tick¡¬t
 = 0U;

490 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

492 if((
pRxD©a
 =ğ
NULL
è|| (
Size
 == 0U))

494  
HAL_ERROR
;

497 
	`__HAL_LOCK
(
hu§¹
);

499 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

500 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_RX
;

503 
tick¡¬t
 = 
	`HAL_G‘Tick
();

505 
hu§¹
->
RxXãrSize
 = 
Size
;

506 
hu§¹
->
RxXãrCouÁ
 = 
Size
;

508 
hu§¹
->
RxXãrCouÁ
 > 0U)

510 
hu§¹
->
RxXãrCouÁ
--;

511 if(
hu§¹
->
In™
.
WÜdL’gth
 =ğ
USART_WORDLENGTH_9B
)

514 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

516  
HAL_TIMEOUT
;

519 
hu§¹
->
In¡ªû
->
DR
 = (
DUMMY_DATA
 & (
ušt16_t
)0x01FFU);

522 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_RXNE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

524  
HAL_TIMEOUT
;

526 
tmp
 = (
ušt16_t
*è
pRxD©a
 ;

527 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

529 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x01FFU);

530 
pRxD©a
 +=2;

534 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x00FFU);

535 
pRxD©a
 +=1;

541 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

543  
HAL_TIMEOUT
;

547 
hu§¹
->
In¡ªû
->
DR
 = (
DUMMY_DATA
 & (
ušt16_t
)0x00FFU);

550 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_RXNE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

552  
HAL_TIMEOUT
;

554 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

557 *
pRxD©a
++ = (
ušt8_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint8_t)0x00FFU);

562 *
pRxD©a
++ = (
ušt8_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint8_t)0x007FU);

568 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

571 
	`__HAL_UNLOCK
(
hu§¹
);

573  
HAL_OK
;

577  
HAL_BUSY
;

579 
	}
}

591 
HAL_StusTy³Def
 
	$HAL_USART_T¿nsm™Reûive
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pTxD©a
, ušt8_ˆ*
pRxD©a
, 
ušt16_t
 
Size
, 
ušt32_t
 
Timeout
)

593 
ušt16_t
* 
tmp
;

594 
ušt32_t
 
tick¡¬t
 = 0U;

596 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

598 if((
pTxD©a
 =ğ
NULL
è|| (
pRxD©a
 =ğNULLè|| (
Size
 == 0U))

600  
HAL_ERROR
;

603 
	`__HAL_LOCK
(
hu§¹
);

605 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

606 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_RX
;

609 
tick¡¬t
 = 
	`HAL_G‘Tick
();

611 
hu§¹
->
RxXãrSize
 = 
Size
;

612 
hu§¹
->
TxXãrSize
 = 
Size
;

613 
hu§¹
->
TxXãrCouÁ
 = 
Size
;

614 
hu§¹
->
RxXãrCouÁ
 = 
Size
;

617 
hu§¹
->
TxXãrCouÁ
 > 0U)

619 
hu§¹
->
TxXãrCouÁ
--;

620 
hu§¹
->
RxXãrCouÁ
--;

621 if(
hu§¹
->
In™
.
WÜdL’gth
 =ğ
USART_WORDLENGTH_9B
)

624 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

626  
HAL_TIMEOUT
;

628 
tmp
 = (
ušt16_t
*è
pTxD©a
;

629 
hu§¹
->
In¡ªû
->
DR
 = (*
tmp
 & (
ušt16_t
)0x01FFU);

630 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

632 
pTxD©a
 += 2U;

636 
pTxD©a
 += 1U;

640 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_RXNE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

642  
HAL_TIMEOUT
;

644 
tmp
 = (
ušt16_t
*è
pRxD©a
 ;

645 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

647 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x01FFU);

648 
pRxD©a
 += 2U;

652 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x00FFU);

653 
pRxD©a
 += 1U;

659 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_TXE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

661  
HAL_TIMEOUT
;

663 
hu§¹
->
In¡ªû
->
DR
 = (*
pTxD©a
++ & (
ušt8_t
)0x00FFU);

666 if(
	`USART_Wa™OnFÏgUÁTimeout
(
hu§¹
, 
USART_FLAG_RXNE
, 
RESET
, 
tick¡¬t
, 
Timeout
è!ğ
HAL_OK
)

668  
HAL_TIMEOUT
;

670 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

673 *
pRxD©a
++ = (
ušt8_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint8_t)0x00FFU);

678 *
pRxD©a
++ = (
ušt8_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint8_t)0x007FU);

683 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

686 
	`__HAL_UNLOCK
(
hu§¹
);

688  
HAL_OK
;

692  
HAL_BUSY
;

694 
	}
}

705 
HAL_StusTy³Def
 
	$HAL_USART_T¿nsm™_IT
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pTxD©a
, 
ušt16_t
 
Size
)

707 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

709 if((
pTxD©a
 =ğ
NULL
è|| (
Size
 == 0U))

711  
HAL_ERROR
;

715 
	`__HAL_LOCK
(
hu§¹
);

717 
hu§¹
->
pTxBuffPŒ
 = 
pTxD©a
;

718 
hu§¹
->
TxXãrSize
 = 
Size
;

719 
hu§¹
->
TxXãrCouÁ
 = 
Size
;

721 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

722 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_TX
;

733 
	`__HAL_UNLOCK
(
hu§¹
);

736 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TXEIE
);

738  
HAL_OK
;

742  
HAL_BUSY
;

744 
	}
}

754 
HAL_StusTy³Def
 
	$HAL_USART_Reûive_IT
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pRxD©a
, 
ušt16_t
 
Size
)

756 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

758 if((
pRxD©a
 =ğ
NULL
è|| (
Size
 == 0U))

760  
HAL_ERROR
;

763 
	`__HAL_LOCK
(
hu§¹
);

765 
hu§¹
->
pRxBuffPŒ
 = 
pRxD©a
;

766 
hu§¹
->
RxXãrSize
 = 
Size
;

767 
hu§¹
->
RxXãrCouÁ
 = 
Size
;

769 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

770 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_RX
;

773 
	`__HAL_UNLOCK
(
hu§¹
);

776 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
 | 
USART_CR1_RXNEIE
);

779 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

782 
hu§¹
->
In¡ªû
->
DR
 = (
DUMMY_DATA
 & (
ušt16_t
)0x01FFU);

784  
HAL_OK
;

788  
HAL_BUSY
;

790 
	}
}

801 
HAL_StusTy³Def
 
	$HAL_USART_T¿nsm™Reûive_IT
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pTxD©a
, ušt8_ˆ*
pRxD©a
, 
ušt16_t
 
Size
)

803 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

805 if((
pTxD©a
 =ğ
NULL
è|| (
pRxD©a
 =ğNULLè|| (
Size
 == 0U))

807  
HAL_ERROR
;

810 
	`__HAL_LOCK
(
hu§¹
);

812 
hu§¹
->
pRxBuffPŒ
 = 
pRxD©a
;

813 
hu§¹
->
RxXãrSize
 = 
Size
;

814 
hu§¹
->
RxXãrCouÁ
 = 
Size
;

815 
hu§¹
->
pTxBuffPŒ
 = 
pTxD©a
;

816 
hu§¹
->
TxXãrSize
 = 
Size
;

817 
hu§¹
->
TxXãrCouÁ
 = 
Size
;

819 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

820 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_TX_RX
;

823 
	`__HAL_UNLOCK
(
hu§¹
);

826 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_RXNEIE
);

829 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

832 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

835 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TXEIE
);

837  
HAL_OK
;

841  
HAL_BUSY
;

843 
	}
}

853 
HAL_StusTy³Def
 
	$HAL_USART_T¿nsm™_DMA
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pTxD©a
, 
ušt16_t
 
Size
)

855 
ušt32_t
 *
tmp
;

857 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

859 if((
pTxD©a
 =ğ
NULL
è|| (
Size
 == 0U))

861  
HAL_ERROR
;

864 
	`__HAL_LOCK
(
hu§¹
);

866 
hu§¹
->
pTxBuffPŒ
 = 
pTxD©a
;

867 
hu§¹
->
TxXãrSize
 = 
Size
;

868 
hu§¹
->
TxXãrCouÁ
 = 
Size
;

870 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

871 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_TX
;

874 
hu§¹
->
hdm©x
->
XãrC¶tC®lback
 = 
USART_DMAT¿nsm™C¶t
;

877 
hu§¹
->
hdm©x
->
XãrH®fC¶tC®lback
 = 
USART_DMATxH®fC¶t
;

880 
hu§¹
->
hdm©x
->
XãrE¼ÜC®lback
 = 
USART_DMAE¼Ü
;

883 
hu§¹
->
hdm©x
->
XãrAbÜtC®lback
 = 
NULL
;

886 
tmp
 = (
ušt32_t
*)&
pTxD©a
;

887 
	`HAL_DMA_S¹_IT
(
hu§¹
->
hdm©x
, *(
ušt32_t
*)
tmp
, (ušt32_t)&hu§¹->
In¡ªû
->
DR
, 
Size
);

890 
	`__HAL_USART_CLEAR_FLAG
(
hu§¹
, 
USART_FLAG_TC
);

893 
	`__HAL_UNLOCK
(
hu§¹
);

897 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

899  
HAL_OK
;

903  
HAL_BUSY
;

905 
	}
}

917 
HAL_StusTy³Def
 
	$HAL_USART_Reûive_DMA
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pRxD©a
, 
ušt16_t
 
Size
)

919 
ušt32_t
 *
tmp
;

921 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

923 if((
pRxD©a
 =ğ
NULL
è|| (
Size
 == 0U))

925  
HAL_ERROR
;

929 
	`__HAL_LOCK
(
hu§¹
);

931 
hu§¹
->
pRxBuffPŒ
 = 
pRxD©a
;

932 
hu§¹
->
RxXãrSize
 = 
Size
;

933 
hu§¹
->
pTxBuffPŒ
 = 
pRxD©a
;

934 
hu§¹
->
TxXãrSize
 = 
Size
;

936 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

937 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_RX
;

940 
hu§¹
->
hdm¬x
->
XãrC¶tC®lback
 = 
USART_DMAReûiveC¶t
;

943 
hu§¹
->
hdm¬x
->
XãrH®fC¶tC®lback
 = 
USART_DMARxH®fC¶t
;

946 
hu§¹
->
hdm¬x
->
XãrE¼ÜC®lback
 = 
USART_DMAE¼Ü
;

949 
hu§¹
->
hdm¬x
->
XãrAbÜtC®lback
 = 
NULL
;

953 
hu§¹
->
hdm©x
->
XãrH®fC¶tC®lback
 = 
NULL
;

954 
hu§¹
->
hdm©x
->
XãrC¶tC®lback
 = 
NULL
;

957 
hu§¹
->
hdm©x
->
XãrE¼ÜC®lback
 = 
USART_DMAE¼Ü
;

960 
hu§¹
->
hdm©x
->
XãrAbÜtC®lback
 = 
NULL
;

963 
tmp
 = (
ušt32_t
*)&
pRxD©a
;

964 
	`HAL_DMA_S¹_IT
(
hu§¹
->
hdm¬x
, (
ušt32_t
)&hu§¹->
In¡ªû
->
DR
, *(ušt32_t*)
tmp
, 
Size
);

969 
	`HAL_DMA_S¹_IT
(
hu§¹
->
hdm©x
, *(
ušt32_t
*)
tmp
, (ušt32_t)&hu§¹->
In¡ªû
->
DR
, 
Size
);

973 
	`__HAL_USART_CLEAR_OREFLAG
(
hu§¹
);

976 
	`__HAL_UNLOCK
(
hu§¹
);

979 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

982 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

986 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

990 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

992  
HAL_OK
;

996  
HAL_BUSY
;

998 
	}
}

1010 
HAL_StusTy³Def
 
	$HAL_USART_T¿nsm™Reûive_DMA
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt8_t
 *
pTxD©a
, ušt8_ˆ*
pRxD©a
, 
ušt16_t
 
Size
)

1012 
ušt32_t
 *
tmp
;

1014 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_READY
)

1016 if((
pTxD©a
 =ğ
NULL
è|| (
pRxD©a
 =ğNULLè|| (
Size
 == 0U))

1018  
HAL_ERROR
;

1021 
	`__HAL_LOCK
(
hu§¹
);

1023 
hu§¹
->
pRxBuffPŒ
 = 
pRxD©a
;

1024 
hu§¹
->
RxXãrSize
 = 
Size
;

1025 
hu§¹
->
pTxBuffPŒ
 = 
pTxD©a
;

1026 
hu§¹
->
TxXãrSize
 = 
Size
;

1028 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

1029 
hu§¹
->
S‹
 = 
HAL_USART_STATE_BUSY_TX_RX
;

1032 
hu§¹
->
hdm¬x
->
XãrC¶tC®lback
 = 
USART_DMAReûiveC¶t
;

1035 
hu§¹
->
hdm¬x
->
XãrH®fC¶tC®lback
 = 
USART_DMARxH®fC¶t
;

1038 
hu§¹
->
hdm©x
->
XãrC¶tC®lback
 = 
USART_DMAT¿nsm™C¶t
;

1041 
hu§¹
->
hdm©x
->
XãrH®fC¶tC®lback
 = 
USART_DMATxH®fC¶t
;

1044 
hu§¹
->
hdm©x
->
XãrE¼ÜC®lback
 = 
USART_DMAE¼Ü
;

1047 
hu§¹
->
hdm¬x
->
XãrE¼ÜC®lback
 = 
USART_DMAE¼Ü
;

1050 
hu§¹
->
hdm¬x
->
XãrAbÜtC®lback
 = 
NULL
;

1053 
tmp
 = (
ušt32_t
*)&
pRxD©a
;

1054 
	`HAL_DMA_S¹_IT
(
hu§¹
->
hdm¬x
, (
ušt32_t
)&hu§¹->
In¡ªû
->
DR
, *(ušt32_t*)
tmp
, 
Size
);

1057 
tmp
 = (
ušt32_t
*)&
pTxD©a
;

1058 
	`HAL_DMA_S¹_IT
(
hu§¹
->
hdm©x
, *(
ušt32_t
*)
tmp
, (ušt32_t)&hu§¹->
In¡ªû
->
DR
, 
Size
);

1061 
	`__HAL_USART_CLEAR_FLAG
(
hu§¹
, 
USART_FLAG_TC
);

1064 
	`__HAL_USART_CLEAR_OREFLAG
(
hu§¹
);

1067 
	`__HAL_UNLOCK
(
hu§¹
);

1070 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1073 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1077 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1081 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1083  
HAL_OK
;

1087  
HAL_BUSY
;

1089 
	}
}

1097 
HAL_StusTy³Def
 
	$HAL_USART_DMAPau£
(
USART_HªdËTy³Def
 *
hu§¹
)

1100 
	`__HAL_LOCK
(
hu§¹
);

1103 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1106 
	`__HAL_UNLOCK
(
hu§¹
);

1108  
HAL_OK
;

1109 
	}
}

1117 
HAL_StusTy³Def
 
	$HAL_USART_DMAResume
(
USART_HªdËTy³Def
 *
hu§¹
)

1120 
	`__HAL_LOCK
(
hu§¹
);

1123 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1126 
	`__HAL_UNLOCK
(
hu§¹
);

1128  
HAL_OK
;

1129 
	}
}

1137 
HAL_StusTy³Def
 
	$HAL_USART_DMAStİ
(
USART_HªdËTy³Def
 *
hu§¹
)

1139 
ušt32_t
 
dm¬eque¡
 = 0x00U;

1147 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1148 if((
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_TX
è&& 
dm¬eque¡
)

1150 
	`USART_EndTxT¿nsãr
(
hu§¹
);

1153 if(
hu§¹
->
hdm©x
 !ğ
NULL
)

1155 
	`HAL_DMA_AbÜt
(
hu§¹
->
hdm©x
);

1159 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1163 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1164 if((
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_RX
è&& 
dm¬eque¡
)

1166 
	`USART_EndRxT¿nsãr
(
hu§¹
);

1169 if(
hu§¹
->
hdm¬x
 !ğ
NULL
)

1171 
	`HAL_DMA_AbÜt
(
hu§¹
->
hdm¬x
);

1175 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1178  
HAL_OK
;

1179 
	}
}

1187 
	$HAL_USART_IRQHªdËr
(
USART_HªdËTy³Def
 *
hu§¹
)

1189 
ušt32_t
 
i¤æags
 = 
	`READ_REG
(
hu§¹
->
In¡ªû
->
SR
);

1190 
ušt32_t
 
ü1™s
 = 
	`READ_REG
(
hu§¹
->
In¡ªû
->
CR1
);

1191 
ušt32_t
 
ü3™s
 = 
	`READ_REG
(
hu§¹
->
In¡ªû
->
CR3
);

1192 
ušt32_t
 
”rÜæags
 = 0x00U;

1193 
ušt32_t
 
dm¬eque¡
 = 0x00U;

1196 
”rÜæags
 = (
i¤æags
 & (
ušt32_t
)(
USART_SR_PE
 | 
USART_SR_FE
 | 
USART_SR_ORE
 | 
USART_SR_NE
));

1197 if(
”rÜæags
 =ğ
RESET
)

1200 if(((
i¤æags
 & 
USART_SR_RXNE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_RXNEIE
) != RESET))

1202 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_RX
)

1204 
	`USART_Reûive_IT
(
hu§¹
);

1208 
	`USART_T¿nsm™Reûive_IT
(
hu§¹
);

1214 if((
”rÜæags
 !ğ
RESET
è&& (((
ü3™s
 & 
USART_CR3_EIE
è!ğRESETè|| ((
ü1™s
 & (
USART_CR1_RXNEIE
 | 
USART_CR1_PEIE
)) != RESET)))

1217 if(((
i¤æags
 & 
USART_SR_PE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_PEIE
) != RESET))

1219 
hu§¹
->
E¼ÜCode
 |ğ
HAL_USART_ERROR_PE
;

1223 if(((
i¤æags
 & 
USART_SR_NE
è!ğ
RESET
è&& ((
ü3™s
 & 
USART_CR3_EIE
) != RESET))

1225 
hu§¹
->
E¼ÜCode
 |ğ
HAL_USART_ERROR_NE
;

1229 if(((
i¤æags
 & 
USART_SR_FE
è!ğ
RESET
è&& ((
ü3™s
 & 
USART_CR3_EIE
) != RESET))

1231 
hu§¹
->
E¼ÜCode
 |ğ
HAL_USART_ERROR_FE
;

1235 if(((
i¤æags
 & 
USART_SR_ORE
è!ğ
RESET
è&& ((
ü3™s
 & 
USART_CR3_EIE
) != RESET))

1237 
hu§¹
->
E¼ÜCode
 |ğ
HAL_USART_ERROR_ORE
;

1240 if(
hu§¹
->
E¼ÜCode
 !ğ
HAL_USART_ERROR_NONE
)

1243 if(((
i¤æags
 & 
USART_SR_RXNE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_RXNEIE
) != RESET))

1245 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_RX
)

1247 
	`USART_Reûive_IT
(
hu§¹
);

1251 
	`USART_T¿nsm™Reûive_IT
(
hu§¹
);

1256 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1257 if(((
hu§¹
->
E¼ÜCode
 & 
HAL_USART_ERROR_ORE
è!ğ
RESET
è|| 
dm¬eque¡
)

1261 
	`USART_EndRxT¿nsãr
(
hu§¹
);

1264 ià(
	`HAL_IS_BIT_SET
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
))

1266 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1269 if(
hu§¹
->
hdm¬x
 !ğ
NULL
)

1273 
hu§¹
->
hdm¬x
->
XãrAbÜtC®lback
 = 
USART_DMAAbÜtOnE¼Ü
;

1275 if(
	`HAL_DMA_AbÜt_IT
(
hu§¹
->
hdm¬x
è!ğ
HAL_OK
)

1278 
hu§¹
->
hdm¬x
->
	`XãrAbÜtC®lback
(husart->hdmarx);

1284 
	`HAL_USART_E¼ÜC®lback
(
hu§¹
);

1290 
	`HAL_USART_E¼ÜC®lback
(
hu§¹
);

1296 
	`HAL_USART_E¼ÜC®lback
(
hu§¹
);

1297 
hu§¹
->
E¼ÜCode
 = 
HAL_USART_ERROR_NONE
;

1304 if(((
i¤æags
 & 
USART_SR_TXE
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_TXEIE
) != RESET))

1306 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_TX
)

1308 
	`USART_T¿nsm™_IT
(
hu§¹
);

1312 
	`USART_T¿nsm™Reûive_IT
(
hu§¹
);

1318 if(((
i¤æags
 & 
USART_SR_TC
è!ğ
RESET
è&& ((
ü1™s
 & 
USART_CR1_TCIE
) != RESET))

1320 
	`USART_EndT¿nsm™_IT
(
hu§¹
);

1323 
	}
}

1331 
__w—k
 
	$HAL_USART_TxC¶tC®lback
(
USART_HªdËTy³Def
 *
hu§¹
)

1334 
	`UNUSED
(
hu§¹
);

1338 
	}
}

1346 
__w—k
 
	$HAL_USART_TxH®fC¶tC®lback
(
USART_HªdËTy³Def
 *
hu§¹
)

1349 
	`UNUSED
(
hu§¹
);

1353 
	}
}

1361 
__w—k
 
	$HAL_USART_RxC¶tC®lback
(
USART_HªdËTy³Def
 *
hu§¹
)

1364 
	`UNUSED
(
hu§¹
);

1368 
	}
}

1376 
__w—k
 
	$HAL_USART_RxH®fC¶tC®lback
(
USART_HªdËTy³Def
 *
hu§¹
)

1379 
	`UNUSED
(
hu§¹
);

1383 
	}
}

1391 
__w—k
 
	$HAL_USART_TxRxC¶tC®lback
(
USART_HªdËTy³Def
 *
hu§¹
)

1394 
	`UNUSED
(
hu§¹
);

1398 
	}
}

1406 
__w—k
 
	$HAL_USART_E¼ÜC®lback
(
USART_HªdËTy³Def
 *
hu§¹
)

1409 
	`UNUSED
(
hu§¹
);

1413 
	}
}

1444 
HAL_USART_S‹Ty³Def
 
	$HAL_USART_G‘S‹
(
USART_HªdËTy³Def
 *
hu§¹
)

1446  
hu§¹
->
S‹
;

1447 
	}
}

1455 
ušt32_t
 
	$HAL_USART_G‘E¼Ü
(
USART_HªdËTy³Def
 *
hu§¹
)

1457  
hu§¹
->
E¼ÜCode
;

1458 
	}
}

1469 
	$USART_DMAT¿nsm™C¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1471 
USART_HªdËTy³Def
* 
hu§¹
 = ( USART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1473 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CIRC
) == 0U)

1475 
hu§¹
->
TxXãrCouÁ
 = 0U;

1476 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_TX
)

1480 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1483 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TCIE
);

1489 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_TX
)

1491 
	`HAL_USART_TxC¶tC®lback
(
hu§¹
);

1494 
	}
}

1502 
	$USART_DMATxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1504 
USART_HªdËTy³Def
* 
hu§¹
 = (USART_HªdËTy³Def*)((
DMA_HªdËTy³Def
*)
hdma
)->
P¬’t
;

1506 
	`HAL_USART_TxH®fC¶tC®lback
(
hu§¹
);

1507 
	}
}

1514 
	$USART_DMAReûiveC¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1516 
USART_HªdËTy³Def
* 
hu§¹
 = ( USART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1518 if((
hdma
->
In¡ªû
->
CR
 & 
DMA_SxCR_CIRC
) == 0U)

1520 
hu§¹
->
RxXãrCouÁ
 = 0x00U;

1523 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1524 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1526 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_RX
)

1530 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1532 
hu§¹
->
S‹
ğ
HAL_USART_STATE_READY
;

1533 
	`HAL_USART_RxC¶tC®lback
(
hu§¹
);

1540 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1541 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1543 
hu§¹
->
S‹
ğ
HAL_USART_STATE_READY
;

1544 
	`HAL_USART_TxRxC¶tC®lback
(
hu§¹
);

1550 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_RX
)

1552 
	`HAL_USART_RxC¶tC®lback
(
hu§¹
);

1557 
	`HAL_USART_TxRxC¶tC®lback
(
hu§¹
);

1560 
	}
}

1568 
	$USART_DMARxH®fC¶t
(
DMA_HªdËTy³Def
 *
hdma
)

1570 
USART_HªdËTy³Def
* 
hu§¹
 = (USART_HªdËTy³Def*)((
DMA_HªdËTy³Def
*)
hdma
)->
P¬’t
;

1572 
	`HAL_USART_RxH®fC¶tC®lback
(
hu§¹
);

1573 
	}
}

1580 
	$USART_DMAE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
)

1582 
ušt32_t
 
dm¬eque¡
 = 0x00U;

1583 
USART_HªdËTy³Def
* 
hu§¹
 = ( USART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1584 
hu§¹
->
RxXãrCouÁ
 = 0x00U;

1585 
hu§¹
->
TxXãrCouÁ
 = 0x00U;

1588 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAT
);

1589 if((
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_TX
è&& 
dm¬eque¡
)

1591 
	`USART_EndTxT¿nsãr
(
hu§¹
);

1595 
dm¬eque¡
 = 
	`HAL_IS_BIT_SET
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_DMAR
);

1596 if((
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_RX
è&& 
dm¬eque¡
)

1598 
	`USART_EndRxT¿nsãr
(
hu§¹
);

1601 
hu§¹
->
E¼ÜCode
 |ğ
HAL_USART_ERROR_DMA
;

1602 
hu§¹
->
S‹
ğ
HAL_USART_STATE_READY
;

1604 
	`HAL_USART_E¼ÜC®lback
(
hu§¹
);

1605 
	}
}

1617 
HAL_StusTy³Def
 
	$USART_Wa™OnFÏgUÁTimeout
(
USART_HªdËTy³Def
 *
hu§¹
, 
ušt32_t
 
FÏg
, 
FÏgStus
 
Stus
, ušt32_ˆ
Tick¡¬t
, ušt32_ˆ
Timeout
)

1620 (
	`__HAL_USART_GET_FLAG
(
hu§¹
, 
FÏg
è? 
SET
 : 
RESET
è=ğ
Stus
)

1623 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1625 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
Tick¡¬t
 ) > Timeout))

1628 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TXEIE
);

1631 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_RXNEIE
);

1634 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1637 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1639 
hu§¹
->
S‹
ğ
HAL_USART_STATE_READY
;

1642 
	`__HAL_UNLOCK
(
hu§¹
);

1644  
HAL_TIMEOUT
;

1648  
HAL_OK
;

1649 
	}
}

1656 
	$USART_EndTxT¿nsãr
(
USART_HªdËTy³Def
 *
hu§¹
)

1659 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, (
USART_CR1_TXEIE
 | 
USART_CR1_TCIE
));

1662 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

1663 
	}
}

1670 
	$USART_EndRxT¿nsãr
(
USART_HªdËTy³Def
 *
hu§¹
)

1673 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, (
USART_CR1_RXNEIE
 | 
USART_CR1_PEIE
));

1674 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1677 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

1678 
	}
}

1686 
	$USART_DMAAbÜtOnE¼Ü
(
DMA_HªdËTy³Def
 *
hdma
)

1688 
USART_HªdËTy³Def
* 
hu§¹
 = ( USART_HªdËTy³Def* )((
DMA_HªdËTy³Def
* )
hdma
)->
P¬’t
;

1689 
hu§¹
->
RxXãrCouÁ
 = 0x00U;

1690 
hu§¹
->
TxXãrCouÁ
 = 0x00U;

1692 
	`HAL_USART_E¼ÜC®lback
(
hu§¹
);

1693 
	}
}

1702 
HAL_StusTy³Def
 
	$USART_T¿nsm™_IT
(
USART_HªdËTy³Def
 *
hu§¹
)

1704 
ušt16_t
* 
tmp
;

1706 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_TX
)

1708 if(
hu§¹
->
In™
.
WÜdL’gth
 =ğ
USART_WORDLENGTH_9B
)

1710 
tmp
 = (
ušt16_t
*è
hu§¹
->
pTxBuffPŒ
;

1711 
hu§¹
->
In¡ªû
->
DR
 = (
ušt16_t
)(*
tmp
 & (uint16_t)0x01FFU);

1712 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

1714 
hu§¹
->
pTxBuffPŒ
 += 2U;

1718 
hu§¹
->
pTxBuffPŒ
 += 1U;

1723 
hu§¹
->
In¡ªû
->
DR
 = (
ušt8_t
)(*hu§¹->
pTxBuffPŒ
++ & (uint8_t)0x00FFU);

1726 if(--
hu§¹
->
TxXãrCouÁ
 == 0U)

1729 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TXEIE
);

1732 
	`SET_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TCIE
);

1734  
HAL_OK
;

1738  
HAL_BUSY
;

1740 
	}
}

1748 
HAL_StusTy³Def
 
	$USART_EndT¿nsm™_IT
(
USART_HªdËTy³Def
 *
hu§¹
)

1751 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TCIE
);

1754 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1756 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

1758 
	`HAL_USART_TxC¶tC®lback
(
hu§¹
);

1760  
HAL_OK
;

1761 
	}
}

1769 
HAL_StusTy³Def
 
	$USART_Reûive_IT
(
USART_HªdËTy³Def
 *
hu§¹
)

1771 
ušt16_t
* 
tmp
;

1772 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_RX
)

1774 if(
hu§¹
->
In™
.
WÜdL’gth
 =ğ
USART_WORDLENGTH_9B
)

1776 
tmp
 = (
ušt16_t
*è
hu§¹
->
pRxBuffPŒ
;

1777 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

1779 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x01FFU);

1780 
hu§¹
->
pRxBuffPŒ
 += 2U;

1784 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x00FFU);

1785 
hu§¹
->
pRxBuffPŒ
 += 1U;

1787 if(--
hu§¹
->
RxXãrCouÁ
 != 0x00U)

1790 
hu§¹
->
In¡ªû
->
DR
 = (
DUMMY_DATA
 & (
ušt16_t
)0x01FFU);

1795 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

1797 *
hu§¹
->
pRxBuffPŒ
++ = (
ušt8_t
)(hu§¹->
In¡ªû
->
DR
 & (uint8_t)0x00FFU);

1801 *
hu§¹
->
pRxBuffPŒ
++ = (
ušt8_t
)(hu§¹->
In¡ªû
->
DR
 & (uint8_t)0x007FU);

1804 if(--
hu§¹
->
RxXãrCouÁ
 != 0x00U)

1807 
hu§¹
->
In¡ªû
->
DR
 = (
DUMMY_DATA
 & (
ušt16_t
)0x00FFU);

1811 if(
hu§¹
->
RxXãrCouÁ
 == 0U)

1814 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_RXNEIE
);

1817 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1820 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1822 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

1823 
	`HAL_USART_RxC¶tC®lback
(
hu§¹
);

1825  
HAL_OK
;

1827  
HAL_OK
;

1831  
HAL_BUSY
;

1833 
	}
}

1841 
HAL_StusTy³Def
 
	$USART_T¿nsm™Reûive_IT
(
USART_HªdËTy³Def
 *
hu§¹
)

1843 
ušt16_t
* 
tmp
;

1845 if(
hu§¹
->
S‹
 =ğ
HAL_USART_STATE_BUSY_TX_RX
)

1847 if(
hu§¹
->
TxXãrCouÁ
 != 0x00U)

1849 if(
	`__HAL_USART_GET_FLAG
(
hu§¹
, 
USART_FLAG_TXE
è!ğ
RESET
)

1851 if(
hu§¹
->
In™
.
WÜdL’gth
 =ğ
USART_WORDLENGTH_9B
)

1853 
tmp
 = (
ušt16_t
*è
hu§¹
->
pTxBuffPŒ
;

1854 
hu§¹
->
In¡ªû
->
DR
 = (
ušt16_t
)(*
tmp
 & (uint16_t)0x01FFU);

1855 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

1857 
hu§¹
->
pTxBuffPŒ
 += 2U;

1861 
hu§¹
->
pTxBuffPŒ
 += 1U;

1866 
hu§¹
->
In¡ªû
->
DR
 = (
ušt8_t
)(*hu§¹->
pTxBuffPŒ
++ & (uint8_t)0x00FFU);

1868 
hu§¹
->
TxXãrCouÁ
--;

1871 if(
hu§¹
->
TxXãrCouÁ
 == 0U)

1873 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_TXEIE
);

1878 if(
hu§¹
->
RxXãrCouÁ
 != 0x00U)

1880 if(
	`__HAL_USART_GET_FLAG
(
hu§¹
, 
USART_FLAG_RXNE
è!ğ
RESET
)

1882 if(
hu§¹
->
In™
.
WÜdL’gth
 =ğ
USART_WORDLENGTH_9B
)

1884 
tmp
 = (
ušt16_t
*è
hu§¹
->
pRxBuffPŒ
;

1885 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

1887 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x01FFU);

1888 
hu§¹
->
pRxBuffPŒ
 += 2U;

1892 *
tmp
 = (
ušt16_t
)(
hu§¹
->
In¡ªû
->
DR
 & (uint16_t)0x00FFU);

1893 
hu§¹
->
pRxBuffPŒ
 += 1U;

1898 if(
hu§¹
->
In™
.
P¬™y
 =ğ
USART_PARITY_NONE
)

1900 *
hu§¹
->
pRxBuffPŒ
++ = (
ušt8_t
)(hu§¹->
In¡ªû
->
DR
 & (uint8_t)0x00FFU);

1904 *
hu§¹
->
pRxBuffPŒ
++ = (
ušt8_t
)(hu§¹->
In¡ªû
->
DR
 & (uint8_t)0x007FU);

1907 
hu§¹
->
RxXãrCouÁ
--;

1912 if(
hu§¹
->
RxXãrCouÁ
 == 0U)

1915 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_RXNEIE
);

1918 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, 
USART_CR1_PEIE
);

1921 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, 
USART_CR3_EIE
);

1923 
hu§¹
->
S‹
 = 
HAL_USART_STATE_READY
;

1925 
	`HAL_USART_TxRxC¶tC®lback
(
hu§¹
);

1927  
HAL_OK
;

1930  
HAL_OK
;

1934  
HAL_BUSY
;

1936 
	}
}

1944 
	$USART_S‘CÚfig
(
USART_HªdËTy³Def
 *
hu§¹
)

1946 
ušt32_t
 
tm´eg
 = 0x00U;

1949 
	`as£¹_·¿m
(
	`IS_USART_INSTANCE
(
hu§¹
->
In¡ªû
));

1950 
	`as£¹_·¿m
(
	`IS_USART_POLARITY
(
hu§¹
->
In™
.
CLKPŞ¬™y
));

1951 
	`as£¹_·¿m
(
	`IS_USART_PHASE
(
hu§¹
->
In™
.
CLKPha£
));

1952 
	`as£¹_·¿m
(
	`IS_USART_LASTBIT
(
hu§¹
->
In™
.
CLKLa¡B™
));

1953 
	`as£¹_·¿m
(
	`IS_USART_BAUDRATE
(
hu§¹
->
In™
.
BaudR©e
));

1954 
	`as£¹_·¿m
(
	`IS_USART_WORD_LENGTH
(
hu§¹
->
In™
.
WÜdL’gth
));

1955 
	`as£¹_·¿m
(
	`IS_USART_STOPBITS
(
hu§¹
->
In™
.
StİB™s
));

1956 
	`as£¹_·¿m
(
	`IS_USART_PARITY
(
hu§¹
->
In™
.
P¬™y
));

1957 
	`as£¹_·¿m
(
	`IS_USART_MODE
(
hu§¹
->
In™
.
Mode
));

1961 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR1
, (
USART_CR1_TE
 | 
USART_CR1_RE
));

1964 
tm´eg
 = 
hu§¹
->
In¡ªû
->
CR2
;

1966 
tm´eg
 &ğ(
ušt32_t
)~((ušt32_t)(
USART_CR2_CPHA
 | 
USART_CR2_CPOL
 | 
USART_CR2_CLKEN
 | 
USART_CR2_LBCL
 | 
USART_CR2_STOP
));

1972 
tm´eg
 |ğ(
ušt32_t
)(
USART_CLOCK_ENABLE
| 
hu§¹
->
In™
.
CLKPŞ¬™y
 |

1973 
hu§¹
->
In™
.
CLKPha£
| hu§¹->In™.
CLKLa¡B™
 | hu§¹->In™.
StİB™s
);

1975 
	`WRITE_REG
(
hu§¹
->
In¡ªû
->
CR2
, (
ušt32_t
)
tm´eg
);

1978 
tm´eg
 = 
hu§¹
->
In¡ªû
->
CR1
;

1981 
tm´eg
 &ğ(
ušt32_t
)~((ušt32_t)(
USART_CR1_M
 | 
USART_CR1_PCE
 | 
USART_CR1_PS
 | 
USART_CR1_TE
 | \

1982 
USART_CR1_RE
 | 
USART_CR1_OVER8
));

1989 
tm´eg
 |ğ(
ušt32_t
)
hu§¹
->
In™
.
WÜdL’gth
 | hu§¹->In™.
P¬™y
 | hu§¹->In™.
Mode
 | 
USART_CR1_OVER8
;

1992 
	`WRITE_REG
(
hu§¹
->
In¡ªû
->
CR1
, (
ušt32_t
)
tm´eg
);

1996 
	`CLEAR_BIT
(
hu§¹
->
In¡ªû
->
CR3
, (
USART_CR3_RTSE
 | 
USART_CR3_CTSE
));

1999 if((
hu§¹
->
In¡ªû
 =ğ
USART1
è|| (hu§¹->In¡ªû =ğ
USART6
))

2001 
hu§¹
->
In¡ªû
->
BRR
 = 
	`USART_BRR
(
	`HAL_RCC_G‘PCLK2F»q
(), hu§¹->
In™
.
BaudR©e
);

2005 
hu§¹
->
In¡ªû
->
BRR
 = 
	`USART_BRR
(
	`HAL_RCC_G‘PCLK1F»q
(), hu§¹->
In™
.
BaudR©e
);

2007 
	}
}

	@D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_ll_fmc.c

77 
	~"¡m32f4xx_h®.h
"

88 #ià
defšed
 (
HAL_SRAM_MODULE_ENABLED
è|| defšed(
HAL_NOR_MODULE_ENABLED
è|| defšed(
HAL_NAND_MODULE_ENABLED
è|| defšed(
HAL_PCCARD_MODULE_ENABLED
è|| defšed(
HAL_SDRAM_MODULE_ENABLED
)

90 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
è|| defšed(
STM32F446xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
)

151 
HAL_StusTy³Def
 
	$FMC_NORSRAM_In™
(
FMC_NORSRAM_Ty³Def
 *
Deviû
, 
FMC_NORSRAM_In™Ty³Def
* 
In™
)

153 
ušt32_t
 
tm´
 = 0U;

156 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_DEVICE
(
Deviû
));

157 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_BANK
(
In™
->
NSBªk
));

158 
	`as£¹_·¿m
(
	`IS_FMC_MUX
(
In™
->
D©aAdd»ssMux
));

159 
	`as£¹_·¿m
(
	`IS_FMC_MEMORY
(
In™
->
MemÜyTy³
));

160 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_MEMORY_WIDTH
(
In™
->
MemÜyD©aWidth
));

161 
	`as£¹_·¿m
(
	`IS_FMC_BURSTMODE
(
In™
->
Bur¡AcûssMode
));

162 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_POLARITY
(
In™
->
Wa™SigÇlPŞ¬™y
));

163 #ià
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)

164 
	`as£¹_·¿m
(
	`IS_FMC_WRAP_MODE
(
In™
->
W¿pMode
));

166 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_SIGNAL_ACTIVE
(
In™
->
Wa™SigÇlAùive
));

167 
	`as£¹_·¿m
(
	`IS_FMC_WRITE_OPERATION
(
In™
->
Wr™eO³¿tiÚ
));

168 
	`as£¹_·¿m
(
	`IS_FMC_WAITE_SIGNAL
(
In™
->
Wa™SigÇl
));

169 
	`as£¹_·¿m
(
	`IS_FMC_EXTENDED_MODE
(
In™
->
Ex‹ndedMode
));

170 
	`as£¹_·¿m
(
	`IS_FMC_ASYNWAIT
(
In™
->
AsynchrÚousWa™
));

171 
	`as£¹_·¿m
(
	`IS_FMC_WRITE_BURST
(
In™
->
Wr™eBur¡
));

172 
	`as£¹_·¿m
(
	`IS_FMC_CONTINOUS_CLOCK
(
In™
->
CÚtšuousClock
));

173 
	`as£¹_·¿m
(
	`IS_FMC_PAGESIZE
(
In™
->
PageSize
));

174 #ià
	`defšed
 (
STM32F446xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
)

175 
	`as£¹_·¿m
(
	`IS_FMC_WRITE_FIFO
(
In™
->
Wr™eFifo
));

179 
tm´
 = 
Deviû
->
BTCR
[
In™
->
NSBªk
];

181 #ià
	`defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)

184 
tm´
 &ğ((
ušt32_t
)~(
FMC_BCR1_MBKEN
 | 
FMC_BCR1_MUXEN
 | 
FMC_BCR1_MTYP
 | \

185 
FMC_BCR1_MWID
 | 
FMC_BCR1_FACCEN
 | 
FMC_BCR1_BURSTEN
 | \

186 
FMC_BCR1_WAITPOL
 | 
FMC_BCR1_WRAPMOD
 | 
FMC_BCR1_WAITCFG
 | \

187 
FMC_BCR1_WREN
 | 
FMC_BCR1_WAITEN
 | 
FMC_BCR1_EXTMOD
 | \

188 
FMC_BCR1_ASYNCWAIT
 | 
FMC_BCR1_CPSIZE
 | 
FMC_BCR1_CBURSTRW
 | \

189 
FMC_BCR1_CCLKEN
));

192 
tm´
 |ğ(
ušt32_t
)(
In™
->
D©aAdd»ssMux
 |\

193 
In™
->
MemÜyTy³
 |\

194 
In™
->
MemÜyD©aWidth
 |\

195 
In™
->
Bur¡AcûssMode
 |\

196 
In™
->
Wa™SigÇlPŞ¬™y
 |\

197 
In™
->
W¿pMode
 |\

198 
In™
->
Wa™SigÇlAùive
 |\

199 
In™
->
Wr™eO³¿tiÚ
 |\

200 
In™
->
Wa™SigÇl
 |\

201 
In™
->
Ex‹ndedMode
 |\

202 
In™
->
AsynchrÚousWa™
 |\

203 
In™
->
PageSize
 |\

204 
In™
->
Wr™eBur¡
 |\

205 
In™
->
CÚtšuousClock
);

209 
tm´
 &ğ((
ušt32_t
)~(
FMC_BCR1_MBKEN
 | 
FMC_BCR1_MUXEN
 | 
FMC_BCR1_MTYP
 | \

210 
FMC_BCR1_MWID
 | 
FMC_BCR1_FACCEN
 | 
FMC_BCR1_BURSTEN
 | \

211 
FMC_BCR1_WAITPOL
 | 
FMC_BCR1_WAITCFG
 | 
FMC_BCR1_CPSIZE
 | \

212 
FMC_BCR1_WREN
 | 
FMC_BCR1_WAITEN
 | 
FMC_BCR1_EXTMOD
 | \

213 
FMC_BCR1_ASYNCWAIT
 | 
FMC_BCR1_CBURSTRW
 | 
FMC_BCR1_CCLKEN
 | \

214 
FMC_BCR1_WFDIS
));

217 
tm´
 |ğ(
ušt32_t
)(
In™
->
D©aAdd»ssMux
 |\

218 
In™
->
MemÜyTy³
 |\

219 
In™
->
MemÜyD©aWidth
 |\

220 
In™
->
Bur¡AcûssMode
 |\

221 
In™
->
Wa™SigÇlPŞ¬™y
 |\

222 
In™
->
Wa™SigÇlAùive
 |\

223 
In™
->
Wr™eO³¿tiÚ
 |\

224 
In™
->
Wa™SigÇl
 |\

225 
In™
->
Ex‹ndedMode
 |\

226 
In™
->
AsynchrÚousWa™
 |\

227 
In™
->
Wr™eBur¡
 |\

228 
In™
->
CÚtšuousClock
 |\

229 
In™
->
PageSize
 |\

230 
In™
->
Wr™eFifo
);

233 if(
In™
->
MemÜyTy³
 =ğ
FMC_MEMORY_TYPE_NOR
)

235 
tm´
 |ğ(
ušt32_t
)
FMC_NORSRAM_FLASH_ACCESS_ENABLE
;

238 
Deviû
->
BTCR
[
In™
->
NSBªk
] = 
tm´
;

241 if((
In™
->
CÚtšuousClock
 =ğ
FMC_CONTINUOUS_CLOCK_SYNC_ASYNC
è&& (In™->
NSBªk
 !ğ
FMC_NORSRAM_BANK1
))

243 
Deviû
->
BTCR
[
FMC_NORSRAM_BANK1
] |ğ(
ušt32_t
)(
In™
->
CÚtšuousClock
);

246 #ià
	`defšed
(
STM32F446xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
)

247 if(
In™
->
NSBªk
 !ğ
FMC_NORSRAM_BANK1
)

249 
Deviû
->
BTCR
[
FMC_NORSRAM_BANK1
] |ğ(
ušt32_t
)(
In™
->
Wr™eFifo
);

253  
HAL_OK
;

254 
	}
}

263 
HAL_StusTy³Def
 
	$FMC_NORSRAM_DeIn™
(
FMC_NORSRAM_Ty³Def
 *
Deviû
, 
FMC_NORSRAM_EXTENDED_Ty³Def
 *
ExDeviû
, 
ušt32_t
 
Bªk
)

266 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_DEVICE
(
Deviû
));

267 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_EXTENDED_DEVICE
(
ExDeviû
));

268 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_BANK
(
Bªk
));

271 
	`__FMC_NORSRAM_DISABLE
(
Deviû
, 
Bªk
);

275 if(
Bªk
 =ğ
FMC_NORSRAM_BANK1
)

277 
Deviû
->
BTCR
[
Bªk
] = 0x000030DBU;

282 
Deviû
->
BTCR
[
Bªk
] = 0x000030D2U;

285 
Deviû
->
BTCR
[
Bªk
 + 1] = 0x0FFFFFFFU;

286 
ExDeviû
->
BWTR
[
Bªk
] = 0x0FFFFFFFU;

288  
HAL_OK
;

289 
	}
}

299 
HAL_StusTy³Def
 
	$FMC_NORSRAM_Timšg_In™
(
FMC_NORSRAM_Ty³Def
 *
Deviû
, 
FMC_NORSRAM_TimšgTy³Def
 *
Timšg
, 
ušt32_t
 
Bªk
)

301 
ušt32_t
 
tm´
 = 0U;

304 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_DEVICE
(
Deviû
));

305 
	`as£¹_·¿m
(
	`IS_FMC_ADDRESS_SETUP_TIME
(
Timšg
->
Add»ssS‘upTime
));

306 
	`as£¹_·¿m
(
	`IS_FMC_ADDRESS_HOLD_TIME
(
Timšg
->
Add»ssHŞdTime
));

307 
	`as£¹_·¿m
(
	`IS_FMC_DATASETUP_TIME
(
Timšg
->
D©aS‘upTime
));

308 
	`as£¹_·¿m
(
	`IS_FMC_TURNAROUND_TIME
(
Timšg
->
BusTuºAroundDu¿tiÚ
));

309 
	`as£¹_·¿m
(
	`IS_FMC_CLK_DIV
(
Timšg
->
CLKDivisiÚ
));

310 
	`as£¹_·¿m
(
	`IS_FMC_DATA_LATENCY
(
Timšg
->
D©aL©’cy
));

311 
	`as£¹_·¿m
(
	`IS_FMC_ACCESS_MODE
(
Timšg
->
AcûssMode
));

312 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_BANK
(
Bªk
));

315 
tm´
 = 
Deviû
->
BTCR
[
Bªk
 + 1U];

318 
tm´
 &ğ((
ušt32_t
)~(
FMC_BTR1_ADDSET
 | 
FMC_BTR1_ADDHLD
 | 
FMC_BTR1_DATAST
 | \

319 
FMC_BTR1_BUSTURN
 | 
FMC_BTR1_CLKDIV
 | 
FMC_BTR1_DATLAT
 | \

320 
FMC_BTR1_ACCMOD
));

323 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
Add»ssS‘upTime
 |\

324 ((
Timšg
->
Add»ssHŞdTime
) << 4U) |\

325 ((
Timšg
->
D©aS‘upTime
) << 8U) |\

326 ((
Timšg
->
BusTuºAroundDu¿tiÚ
) << 16U) |\

327 (((
Timšg
->
CLKDivisiÚ
) - 1U) << 20U) |\

328 (((
Timšg
->
D©aL©’cy
) - 2U) << 24U) |\

329 (
Timšg
->
AcûssMode
));

331 
Deviû
->
BTCR
[
Bªk
 + 1U] = 
tm´
;

334 if(
	`HAL_IS_BIT_SET
(
Deviû
->
BTCR
[
FMC_NORSRAM_BANK1
], 
FMC_BCR1_CCLKEN
))

336 
tm´
 = (
ušt32_t
)(
Deviû
->
BTCR
[
FMC_NORSRAM_BANK1
 + 1U] & ~(((uint32_t)0x0FU) << 20U));

337 
tm´
 |ğ(
ušt32_t
)(((
Timšg
->
CLKDivisiÚ
) - 1U) << 20U);

338 
Deviû
->
BTCR
[
FMC_NORSRAM_BANK1
 + 1U] = 
tm´
;

341  
HAL_OK
;

342 
	}
}

352 
HAL_StusTy³Def
 
	$FMC_NORSRAM_Ex‹nded_Timšg_In™
(
FMC_NORSRAM_EXTENDED_Ty³Def
 *
Deviû
, 
FMC_NORSRAM_TimšgTy³Def
 *
Timšg
, 
ušt32_t
 
Bªk
, ušt32_ˆ
Ex‹ndedMode
)

354 
ušt32_t
 
tm´
 = 0U;

357 
	`as£¹_·¿m
(
	`IS_FMC_EXTENDED_MODE
(
Ex‹ndedMode
));

360 if(
Ex‹ndedMode
 =ğ
FMC_EXTENDED_MODE_ENABLE
)

363 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_EXTENDED_DEVICE
(
Deviû
));

364 
	`as£¹_·¿m
(
	`IS_FMC_ADDRESS_SETUP_TIME
(
Timšg
->
Add»ssS‘upTime
));

365 
	`as£¹_·¿m
(
	`IS_FMC_ADDRESS_HOLD_TIME
(
Timšg
->
Add»ssHŞdTime
));

366 
	`as£¹_·¿m
(
	`IS_FMC_DATASETUP_TIME
(
Timšg
->
D©aS‘upTime
));

367 
	`as£¹_·¿m
(
	`IS_FMC_TURNAROUND_TIME
(
Timšg
->
BusTuºAroundDu¿tiÚ
));

368 
	`as£¹_·¿m
(
	`IS_FMC_ACCESS_MODE
(
Timšg
->
AcûssMode
));

369 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_BANK
(
Bªk
));

372 
tm´
 = 
Deviû
->
BWTR
[
Bªk
];

375 
tm´
 &ğ((
ušt32_t
)~(
FMC_BWTR1_ADDSET
 | 
FMC_BWTR1_ADDHLD
 | 
FMC_BWTR1_DATAST
 | \

376 
FMC_BWTR1_BUSTURN
 | 
FMC_BWTR1_ACCMOD
));

378 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
Add»ssS‘upTime
 |\

379 ((
Timšg
->
Add»ssHŞdTime
) << 4U) |\

380 ((
Timšg
->
D©aS‘upTime
) << 8U) |\

381 ((
Timšg
->
BusTuºAroundDu¿tiÚ
) << 16U) |\

382 (
Timšg
->
AcûssMode
));

384 
Deviû
->
BWTR
[
Bªk
] = 
tm´
;

388 
Deviû
->
BWTR
[
Bªk
] = 0x0FFFFFFFU;

391  
HAL_OK
;

392 
	}
}

417 
HAL_StusTy³Def
 
	$FMC_NORSRAM_Wr™eO³¿tiÚ_EÇbË
(
FMC_NORSRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

420 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_DEVICE
(
Deviû
));

421 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_BANK
(
Bªk
));

424 
Deviû
->
BTCR
[
Bªk
] |ğ
FMC_WRITE_OPERATION_ENABLE
;

426  
HAL_OK
;

427 
	}
}

435 
HAL_StusTy³Def
 
	$FMC_NORSRAM_Wr™eO³¿tiÚ_Di§bË
(
FMC_NORSRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

438 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_DEVICE
(
Deviû
));

439 
	`as£¹_·¿m
(
	`IS_FMC_NORSRAM_BANK
(
Bªk
));

442 
Deviû
->
BTCR
[
Bªk
] &ğ~
FMC_WRITE_OPERATION_ENABLE
;

444  
HAL_OK
;

445 
	}
}

480 #ià
defšed
(
STM32F446xx
è|| defšed(
STM32F469xx
è|| defšed(
STM32F479xx
)

505 
HAL_StusTy³Def
 
	$FMC_NAND_In™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
FMC_NAND_In™Ty³Def
 *
In™
)

507 
ušt32_t
 
tm´
 = 0U;

510 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

511 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
In™
->
NªdBªk
));

512 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_FEATURE
(
In™
->
Wa™ã©u»
));

513 
	`as£¹_·¿m
(
	`IS_FMC_NAND_MEMORY_WIDTH
(
In™
->
MemÜyD©aWidth
));

514 
	`as£¹_·¿m
(
	`IS_FMC_ECC_STATE
(
In™
->
EccComputiÚ
));

515 
	`as£¹_·¿m
(
	`IS_FMC_ECCPAGE_SIZE
(
In™
->
ECCPageSize
));

516 
	`as£¹_·¿m
(
	`IS_FMC_TCLR_TIME
(
In™
->
TCLRS‘upTime
));

517 
	`as£¹_·¿m
(
	`IS_FMC_TAR_TIME
(
In™
->
TARS‘upTime
));

520 
tm´
 = 
Deviû
->
PCR
;

523 
tm´
 &ğ((
ušt32_t
)~(
FMC_PCR_PWAITEN
 | 
FMC_PCR_PBKEN
 | 
FMC_PCR_PTYP
 | \

524 
FMC_PCR_PWID
 | 
FMC_PCR_ECCEN
 | 
FMC_PCR_TCLR
 | \

525 
FMC_PCR_TAR
 | 
FMC_PCR_ECCPS
));

528 
tm´
 |ğ(
ušt32_t
)(
In™
->
Wa™ã©u»
 |\

529 
FMC_PCR_MEMORY_TYPE_NAND
 |\

530 
In™
->
MemÜyD©aWidth
 |\

531 
In™
->
EccComputiÚ
 |\

532 
In™
->
ECCPageSize
 |\

533 ((
In™
->
TCLRS‘upTime
) << 9U) |\

534 ((
In™
->
TARS‘upTime
) << 13U));

537 
Deviû
->
PCR
 = 
tm´
;

539  
HAL_OK
;

540 
	}
}

550 
HAL_StusTy³Def
 
	$FMC_NAND_CommÚS·û_Timšg_In™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
FMC_NAND_PCC_TimšgTy³Def
 *
Timšg
, 
ušt32_t
 
Bªk
)

552 
ušt32_t
 
tm´
 = 0U;

555 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

556 
	`as£¹_·¿m
(
	`IS_FMC_SETUP_TIME
(
Timšg
->
S‘upTime
));

557 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_TIME
(
Timšg
->
Wa™S‘upTime
));

558 
	`as£¹_·¿m
(
	`IS_FMC_HOLD_TIME
(
Timšg
->
HŞdS‘upTime
));

559 
	`as£¹_·¿m
(
	`IS_FMC_HIZ_TIME
(
Timšg
->
HiZS‘upTime
));

560 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

563 
tm´
 = 
Deviû
->
PMEM
;

567 
tm´
 &ğ((
ušt32_t
)~(
FMC_PMEM_MEMSET2
 | 
FMC_PMEM_MEMWAIT2
 | 
FMC_PMEM_MEMHOLD2
 | \

568 
FMC_PMEM_MEMHIZ2
));

571 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
S‘upTime
 |\

572 ((
Timšg
->
Wa™S‘upTime
) << 8U) |\

573 ((
Timšg
->
HŞdS‘upTime
) << 16U) |\

574 ((
Timšg
->
HiZS‘upTime
) << 24U)

578 
Deviû
->
PMEM
 = 
tm´
;

580  
HAL_OK
;

581 
	}
}

591 
HAL_StusTy³Def
 
	$FMC_NAND_A‰ribu‹S·û_Timšg_In™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
FMC_NAND_PCC_TimšgTy³Def
 *
Timšg
, 
ušt32_t
 
Bªk
)

593 
ušt32_t
 
tm´
 = 0U;

596 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

597 
	`as£¹_·¿m
(
	`IS_FMC_SETUP_TIME
(
Timšg
->
S‘upTime
));

598 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_TIME
(
Timšg
->
Wa™S‘upTime
));

599 
	`as£¹_·¿m
(
	`IS_FMC_HOLD_TIME
(
Timšg
->
HŞdS‘upTime
));

600 
	`as£¹_·¿m
(
	`IS_FMC_HIZ_TIME
(
Timšg
->
HiZS‘upTime
));

601 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

604 
tm´
 = 
Deviû
->
PATT
;

607 
tm´
 &ğ((
ušt32_t
)~(
FMC_PATT_ATTSET2
 | 
FMC_PATT_ATTWAIT2
 | 
FMC_PATT_ATTHOLD2
 | \

608 
FMC_PATT_ATTHIZ2
));

611 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
S‘upTime
 |\

612 ((
Timšg
->
Wa™S‘upTime
) << 8U) |\

613 ((
Timšg
->
HŞdS‘upTime
) << 16U) |\

614 ((
Timšg
->
HiZS‘upTime
) << 24U));

617 
Deviû
->
PATT
 = 
tm´
;

619  
HAL_OK
;

620 
	}
}

629 
HAL_StusTy³Def
 
	$FMC_NAND_DeIn™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

632 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

633 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

636 
	`__FMC_NAND_DISABLE
(
Deviû
, 
Bªk
);

640 
Deviû
->
PCR
 = 0x00000018U;

641 
Deviû
->
SR
 = 0x00000040U;

642 
Deviû
->
PMEM
 = 0xFCFCFCFCU;

643 
Deviû
->
PATT
 = 0xFCFCFCFCU;

645  
HAL_OK
;

646 
	}
}

675 
HAL_StusTy³Def
 
	$FMC_NAND_ECC_EÇbË
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

678 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

679 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

682 
Deviû
->
PCR
 |ğ
FMC_PCR_ECCEN
;

684  
HAL_OK
;

685 
	}
}

694 
HAL_StusTy³Def
 
	$FMC_NAND_ECC_Di§bË
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

697 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

698 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

701 
Deviû
->
PCR
 &ğ~
FMC_PCR_ECCEN
;

703  
HAL_OK
;

704 
	}
}

714 
HAL_StusTy³Def
 
	$FMC_NAND_G‘ECC
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 *
ECCv®
, ušt32_ˆ
Bªk
, ušt32_ˆ
Timeout
)

716 
ušt32_t
 
tick¡¬t
 = 0U;

719 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

720 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

723 
tick¡¬t
 = 
	`HAL_G‘Tick
();

726 
	`__FMC_NAND_GET_FLAG
(
Deviû
, 
Bªk
, 
FMC_FLAG_FEMPT
è=ğ
RESET
)

729 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

731 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

733  
HAL_TIMEOUT
;

739 *
ECCv®
 = (
ušt32_t
)
Deviû
->
ECCR
;

741  
HAL_OK
;

742 
	}
}

772 
HAL_StusTy³Def
 
	$FMC_NAND_In™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
FMC_NAND_In™Ty³Def
 *
In™
)

774 
ušt32_t
 
tm´
 = 0U;

777 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

778 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
In™
->
NªdBªk
));

779 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_FEATURE
(
In™
->
Wa™ã©u»
));

780 
	`as£¹_·¿m
(
	`IS_FMC_NAND_MEMORY_WIDTH
(
In™
->
MemÜyD©aWidth
));

781 
	`as£¹_·¿m
(
	`IS_FMC_ECC_STATE
(
In™
->
EccComputiÚ
));

782 
	`as£¹_·¿m
(
	`IS_FMC_ECCPAGE_SIZE
(
In™
->
ECCPageSize
));

783 
	`as£¹_·¿m
(
	`IS_FMC_TCLR_TIME
(
In™
->
TCLRS‘upTime
));

784 
	`as£¹_·¿m
(
	`IS_FMC_TAR_TIME
(
In™
->
TARS‘upTime
));

786 if(
In™
->
NªdBªk
 =ğ
FMC_NAND_BANK2
)

789 
tm´
 = 
Deviû
->
PCR2
;

794 
tm´
 = 
Deviû
->
PCR3
;

798 
tm´
 &ğ((
ušt32_t
)~(
FMC_PCR2_PWAITEN
 | 
FMC_PCR2_PBKEN
 | 
FMC_PCR2_PTYP
 | \

799 
FMC_PCR2_PWID
 | 
FMC_PCR2_ECCEN
 | 
FMC_PCR2_TCLR
 | \

800 
FMC_PCR2_TAR
 | 
FMC_PCR2_ECCPS
));

803 
tm´
 |ğ(
ušt32_t
)(
In™
->
Wa™ã©u»
 |\

804 
FMC_PCR_MEMORY_TYPE_NAND
 |\

805 
In™
->
MemÜyD©aWidth
 |\

806 
In™
->
EccComputiÚ
 |\

807 
In™
->
ECCPageSize
 |\

808 ((
In™
->
TCLRS‘upTime
) << 9U) |\

809 ((
In™
->
TARS‘upTime
) << 13U));

811 if(
In™
->
NªdBªk
 =ğ
FMC_NAND_BANK2
)

814 
Deviû
->
PCR2
 = 
tm´
;

819 
Deviû
->
PCR3
 = 
tm´
;

822  
HAL_OK
;

824 
	}
}

834 
HAL_StusTy³Def
 
	$FMC_NAND_CommÚS·û_Timšg_In™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
FMC_NAND_PCC_TimšgTy³Def
 *
Timšg
, 
ušt32_t
 
Bªk
)

836 
ušt32_t
 
tm´
 = 0U;

839 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

840 
	`as£¹_·¿m
(
	`IS_FMC_SETUP_TIME
(
Timšg
->
S‘upTime
));

841 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_TIME
(
Timšg
->
Wa™S‘upTime
));

842 
	`as£¹_·¿m
(
	`IS_FMC_HOLD_TIME
(
Timšg
->
HŞdS‘upTime
));

843 
	`as£¹_·¿m
(
	`IS_FMC_HIZ_TIME
(
Timšg
->
HiZS‘upTime
));

844 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

846 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

849 
tm´
 = 
Deviû
->
PMEM2
;

854 
tm´
 = 
Deviû
->
PMEM3
;

858 
tm´
 &ğ((
ušt32_t
)~(
FMC_PMEM2_MEMSET2
 | 
FMC_PMEM2_MEMWAIT2
 | 
FMC_PMEM2_MEMHOLD2
 | \

859 
FMC_PMEM2_MEMHIZ2
));

862 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
S‘upTime
 |\

863 ((
Timšg
->
Wa™S‘upTime
) << 8U) |\

864 ((
Timšg
->
HŞdS‘upTime
) << 16U) |\

865 ((
Timšg
->
HiZS‘upTime
) << 24U)

868 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

871 
Deviû
->
PMEM2
 = 
tm´
;

876 
Deviû
->
PMEM3
 = 
tm´
;

879  
HAL_OK
;

880 
	}
}

890 
HAL_StusTy³Def
 
	$FMC_NAND_A‰ribu‹S·û_Timšg_In™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
FMC_NAND_PCC_TimšgTy³Def
 *
Timšg
, 
ušt32_t
 
Bªk
)

892 
ušt32_t
 
tm´
 = 0U;

895 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

896 
	`as£¹_·¿m
(
	`IS_FMC_SETUP_TIME
(
Timšg
->
S‘upTime
));

897 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_TIME
(
Timšg
->
Wa™S‘upTime
));

898 
	`as£¹_·¿m
(
	`IS_FMC_HOLD_TIME
(
Timšg
->
HŞdS‘upTime
));

899 
	`as£¹_·¿m
(
	`IS_FMC_HIZ_TIME
(
Timšg
->
HiZS‘upTime
));

900 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

902 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

905 
tm´
 = 
Deviû
->
PATT2
;

910 
tm´
 = 
Deviû
->
PATT3
;

914 
tm´
 &ğ((
ušt32_t
)~(
FMC_PATT2_ATTSET2
 | 
FMC_PATT2_ATTWAIT2
 | 
FMC_PATT2_ATTHOLD2
 | \

915 
FMC_PATT2_ATTHIZ2
));

918 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
S‘upTime
 |\

919 ((
Timšg
->
Wa™S‘upTime
) << 8U) |\

920 ((
Timšg
->
HŞdS‘upTime
) << 16U) |\

921 ((
Timšg
->
HiZS‘upTime
) << 24U));

923 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

926 
Deviû
->
PATT2
 = 
tm´
;

931 
Deviû
->
PATT3
 = 
tm´
;

934  
HAL_OK
;

935 
	}
}

943 
HAL_StusTy³Def
 
	$FMC_NAND_DeIn™
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

946 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

947 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

950 
	`__FMC_NAND_DISABLE
(
Deviû
, 
Bªk
);

953 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

956 
Deviû
->
PCR2
 = 0x00000018U;

957 
Deviû
->
SR2
 = 0x00000040U;

958 
Deviû
->
PMEM2
 = 0xFCFCFCFCU;

959 
Deviû
->
PATT2
 = 0xFCFCFCFCU;

965 
Deviû
->
PCR3
 = 0x00000018U;

966 
Deviû
->
SR3
 = 0x00000040U;

967 
Deviû
->
PMEM3
 = 0xFCFCFCFCU;

968 
Deviû
->
PATT3
 = 0xFCFCFCFCU;

971  
HAL_OK
;

972 
	}
}

998 
HAL_StusTy³Def
 
	$FMC_NAND_ECC_EÇbË
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

1001 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

1002 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

1005 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

1007 
Deviû
->
PCR2
 |ğ
FMC_PCR2_ECCEN
;

1011 
Deviû
->
PCR3
 |ğ
FMC_PCR3_ECCEN
;

1014  
HAL_OK
;

1015 
	}
}

1023 
HAL_StusTy³Def
 
	$FMC_NAND_ECC_Di§bË
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

1026 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

1027 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

1030 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

1032 
Deviû
->
PCR2
 &ğ~
FMC_PCR2_ECCEN
;

1036 
Deviû
->
PCR3
 &ğ~
FMC_PCR3_ECCEN
;

1039  
HAL_OK
;

1040 
	}
}

1050 
HAL_StusTy³Def
 
	$FMC_NAND_G‘ECC
(
FMC_NAND_Ty³Def
 *
Deviû
, 
ušt32_t
 *
ECCv®
, ušt32_ˆ
Bªk
, ušt32_ˆ
Timeout
)

1052 
ušt32_t
 
tick¡¬t
 = 0U;

1055 
	`as£¹_·¿m
(
	`IS_FMC_NAND_DEVICE
(
Deviû
));

1056 
	`as£¹_·¿m
(
	`IS_FMC_NAND_BANK
(
Bªk
));

1059 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1062 
	`__FMC_NAND_GET_FLAG
(
Deviû
, 
Bªk
, 
FMC_FLAG_FEMPT
è=ğ
RESET
)

1065 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1067 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

1069  
HAL_TIMEOUT
;

1074 if(
Bªk
 =ğ
FMC_NAND_BANK2
)

1077 *
ECCv®
 = (
ušt32_t
)
Deviû
->
ECCR2
;

1082 *
ECCv®
 = (
ušt32_t
)
Deviû
->
ECCR3
;

1085  
HAL_OK
;

1086 
	}
}

1097 #ià
defšed
(
STM32F427xx
è|| defšed(
STM32F437xx
è|| defšed(
STM32F429xx
è|| defšed(
STM32F439xx
)

1145 
HAL_StusTy³Def
 
	$FMC_PCCARD_In™
(
FMC_PCCARD_Ty³Def
 *
Deviû
, 
FMC_PCCARD_In™Ty³Def
 *
In™
)

1147 
ušt32_t
 
tm´
 = 0U;

1150 
	`as£¹_·¿m
(
	`IS_FMC_PCCARD_DEVICE
(
Deviû
));

1151 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_FEATURE
(
In™
->
Wa™ã©u»
));

1152 
	`as£¹_·¿m
(
	`IS_FMC_TCLR_TIME
(
In™
->
TCLRS‘upTime
));

1153 
	`as£¹_·¿m
(
	`IS_FMC_TAR_TIME
(
In™
->
TARS‘upTime
));

1156 
tm´
 = 
Deviû
->
PCR4
;

1159 
tm´
 &ğ((
ušt32_t
)~(
FMC_PCR4_TAR
 | 
FMC_PCR4_TCLR
 | 
FMC_PCR4_PWAITEN
 | \

1160 
FMC_PCR4_PWID
));

1163 
tm´
 |ğ(
ušt32_t
)(
In™
->
Wa™ã©u»
 |\

1164 
FMC_NAND_PCC_MEM_BUS_WIDTH_16
 |\

1165 (
In™
->
TCLRS‘upTime
 << 9U) |\

1166 (
In™
->
TARS‘upTime
 << 13U));

1168 
Deviû
->
PCR4
 = 
tm´
;

1170  
HAL_OK
;

1171 
	}
}

1180 
HAL_StusTy³Def
 
	$FMC_PCCARD_CommÚS·û_Timšg_In™
(
FMC_PCCARD_Ty³Def
 *
Deviû
, 
FMC_NAND_PCC_TimšgTy³Def
 *
Timšg
)

1182 
ušt32_t
 
tm´
 = 0U;

1185 
	`as£¹_·¿m
(
	`IS_FMC_PCCARD_DEVICE
(
Deviû
));

1186 
	`as£¹_·¿m
(
	`IS_FMC_SETUP_TIME
(
Timšg
->
S‘upTime
));

1187 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_TIME
(
Timšg
->
Wa™S‘upTime
));

1188 
	`as£¹_·¿m
(
	`IS_FMC_HOLD_TIME
(
Timšg
->
HŞdS‘upTime
));

1189 
	`as£¹_·¿m
(
	`IS_FMC_HIZ_TIME
(
Timšg
->
HiZS‘upTime
));

1192 
tm´
 = 
Deviû
->
PMEM4
;

1195 
tm´
 &ğ((
ušt32_t
)~(
FMC_PMEM4_MEMSET4
 | 
FMC_PMEM4_MEMWAIT4
 | 
FMC_PMEM4_MEMHOLD4
 | \

1196 
FMC_PMEM4_MEMHIZ4
));

1198 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
S‘upTime
 |\

1199 ((
Timšg
->
Wa™S‘upTime
) << 8U) |\

1200 ((
Timšg
->
HŞdS‘upTime
) << 16U) |\

1201 ((
Timšg
->
HiZS‘upTime
) << 24U));

1203 
Deviû
->
PMEM4
 = 
tm´
;

1205  
HAL_OK
;

1206 
	}
}

1215 
HAL_StusTy³Def
 
	$FMC_PCCARD_A‰ribu‹S·û_Timšg_In™
(
FMC_PCCARD_Ty³Def
 *
Deviû
, 
FMC_NAND_PCC_TimšgTy³Def
 *
Timšg
)

1217 
ušt32_t
 
tm´
 = 0U;

1220 
	`as£¹_·¿m
(
	`IS_FMC_PCCARD_DEVICE
(
Deviû
));

1221 
	`as£¹_·¿m
(
	`IS_FMC_SETUP_TIME
(
Timšg
->
S‘upTime
));

1222 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_TIME
(
Timšg
->
Wa™S‘upTime
));

1223 
	`as£¹_·¿m
(
	`IS_FMC_HOLD_TIME
(
Timšg
->
HŞdS‘upTime
));

1224 
	`as£¹_·¿m
(
	`IS_FMC_HIZ_TIME
(
Timšg
->
HiZS‘upTime
));

1227 
tm´
 = 
Deviû
->
PATT4
;

1230 
tm´
 &ğ((
ušt32_t
)~(
FMC_PATT4_ATTSET4
 | 
FMC_PATT4_ATTWAIT4
 | 
FMC_PATT4_ATTHOLD4
 | \

1231 
FMC_PATT4_ATTHIZ4
));

1234 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
S‘upTime
 |\

1235 ((
Timšg
->
Wa™S‘upTime
) << 8U) |\

1236 ((
Timšg
->
HŞdS‘upTime
) << 16U) |\

1237 ((
Timšg
->
HiZS‘upTime
) << 24U));

1238 
Deviû
->
PATT4
 = 
tm´
;

1240  
HAL_OK
;

1241 
	}
}

1250 
HAL_StusTy³Def
 
	$FMC_PCCARD_IOS·û_Timšg_In™
(
FMC_PCCARD_Ty³Def
 *
Deviû
, 
FMC_NAND_PCC_TimšgTy³Def
 *
Timšg
)

1252 
ušt32_t
 
tm´
 = 0;

1255 
	`as£¹_·¿m
(
	`IS_FMC_PCCARD_DEVICE
(
Deviû
));

1256 
	`as£¹_·¿m
(
	`IS_FMC_SETUP_TIME
(
Timšg
->
S‘upTime
));

1257 
	`as£¹_·¿m
(
	`IS_FMC_WAIT_TIME
(
Timšg
->
Wa™S‘upTime
));

1258 
	`as£¹_·¿m
(
	`IS_FMC_HOLD_TIME
(
Timšg
->
HŞdS‘upTime
));

1259 
	`as£¹_·¿m
(
	`IS_FMC_HIZ_TIME
(
Timšg
->
HiZS‘upTime
));

1262 
tm´
 = 
Deviû
->
PIO4
;

1265 
tm´
 &ğ((
ušt32_t
)~(
FMC_PIO4_IOSET4
 | 
FMC_PIO4_IOWAIT4
 | 
FMC_PIO4_IOHOLD4
 | \

1266 
FMC_PIO4_IOHIZ4
));

1269 
tm´
 |ğ(
ušt32_t
)(
Timšg
->
S‘upTime
 |\

1270 ((
Timšg
->
Wa™S‘upTime
) << 8U) |\

1271 ((
Timšg
->
HŞdS‘upTime
) << 16U) |\

1272 ((
Timšg
->
HiZS‘upTime
) << 24U));

1274 
Deviû
->
PIO4
 = 
tm´
;

1276  
HAL_OK
;

1277 
	}
}

1284 
HAL_StusTy³Def
 
	$FMC_PCCARD_DeIn™
(
FMC_PCCARD_Ty³Def
 *
Deviû
)

1287 
	`as£¹_·¿m
(
	`IS_FMC_PCCARD_DEVICE
(
Deviû
));

1290 
	`__FMC_PCCARD_DISABLE
(
Deviû
);

1293 
Deviû
->
PCR4
 = 0x00000018U;

1294 
Deviû
->
SR4
 = 0x00000000U;

1295 
Deviû
->
PMEM4
 = 0xFCFCFCFCU;

1296 
Deviû
->
PATT4
 = 0xFCFCFCFCU;

1297 
Deviû
->
PIO4
 = 0xFCFCFCFCU;

1299  
HAL_OK
;

1300 
	}
}

1354 
HAL_StusTy³Def
 
	$FMC_SDRAM_In™
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
FMC_SDRAM_In™Ty³Def
 *
In™
)

1356 
ušt32_t
 
tm´1
 = 0U;

1357 
ušt32_t
 
tm´2
 = 0U;

1360 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1361 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_BANK
(
In™
->
SDBªk
));

1362 
	`as£¹_·¿m
(
	`IS_FMC_COLUMNBITS_NUMBER
(
In™
->
CŞumnB™sNumb”
));

1363 
	`as£¹_·¿m
(
	`IS_FMC_ROWBITS_NUMBER
(
In™
->
RowB™sNumb”
));

1364 
	`as£¹_·¿m
(
	`IS_FMC_SDMEMORY_WIDTH
(
In™
->
MemÜyD©aWidth
));

1365 
	`as£¹_·¿m
(
	`IS_FMC_INTERNALBANK_NUMBER
(
In™
->
IÁ”ÇlBªkNumb”
));

1366 
	`as£¹_·¿m
(
	`IS_FMC_CAS_LATENCY
(
In™
->
CASL©’cy
));

1367 
	`as£¹_·¿m
(
	`IS_FMC_WRITE_PROTECTION
(
In™
->
Wr™ePrÙeùiÚ
));

1368 
	`as£¹_·¿m
(
	`IS_FMC_SDCLOCK_PERIOD
(
In™
->
SDClockP”iod
));

1369 
	`as£¹_·¿m
(
	`IS_FMC_READ_BURST
(
In™
->
R—dBur¡
));

1370 
	`as£¹_·¿m
(
	`IS_FMC_READPIPE_DELAY
(
In™
->
R—dPeD–ay
));

1373 ià(
In™
->
SDBªk
 !ğ
FMC_SDRAM_BANK2
)

1375 
tm´1
 = 
Deviû
->
SDCR
[
FMC_SDRAM_BANK1
];

1378 
tm´1
 &ğ((
ušt32_t
)~(
FMC_SDCR1_NC
 | 
FMC_SDCR1_NR
 | 
FMC_SDCR1_MWID
 | \

1379 
FMC_SDCR1_NB
 | 
FMC_SDCR1_CAS
 | 
FMC_SDCR1_WP
 | \

1380 
FMC_SDCR1_SDCLK
 | 
FMC_SDCR1_RBURST
 | 
FMC_SDCR1_RPIPE
));

1383 
tm´1
 |ğ(
ušt32_t
)(
In™
->
CŞumnB™sNumb”
 |\

1384 
In™
->
RowB™sNumb”
 |\

1385 
In™
->
MemÜyD©aWidth
 |\

1386 
In™
->
IÁ”ÇlBªkNumb”
 |\

1387 
In™
->
CASL©’cy
 |\

1388 
In™
->
Wr™ePrÙeùiÚ
 |\

1389 
In™
->
SDClockP”iod
 |\

1390 
In™
->
R—dBur¡
 |\

1391 
In™
->
R—dPeD–ay


1393 
Deviû
->
SDCR
[
FMC_SDRAM_BANK1
] = 
tm´1
;

1397 
tm´1
 = 
Deviû
->
SDCR
[
FMC_SDRAM_BANK1
];

1400 
tm´1
 &ğ((
ušt32_t
)~(
FMC_SDCR1_SDCLK
 | 
FMC_SDCR1_RBURST
 | 
FMC_SDCR1_RPIPE
));

1402 
tm´1
 |ğ(
ušt32_t
)(
In™
->
SDClockP”iod
 |\

1403 
In™
->
R—dBur¡
 |\

1404 
In™
->
R—dPeD–ay
);

1406 
tm´2
 = 
Deviû
->
SDCR
[
FMC_SDRAM_BANK2
];

1409 
tm´2
 &ğ((
ušt32_t
)~(
FMC_SDCR1_NC
 | 
FMC_SDCR1_NR
 | 
FMC_SDCR1_MWID
 | \

1410 
FMC_SDCR1_NB
 | 
FMC_SDCR1_CAS
 | 
FMC_SDCR1_WP
 | \

1411 
FMC_SDCR1_SDCLK
 | 
FMC_SDCR1_RBURST
 | 
FMC_SDCR1_RPIPE
));

1413 
tm´2
 |ğ(
ušt32_t
)(
In™
->
CŞumnB™sNumb”
 |\

1414 
In™
->
RowB™sNumb”
 |\

1415 
In™
->
MemÜyD©aWidth
 |\

1416 
In™
->
IÁ”ÇlBªkNumb”
 |\

1417 
In™
->
CASL©’cy
 |\

1418 
In™
->
Wr™ePrÙeùiÚ
);

1420 
Deviû
->
SDCR
[
FMC_SDRAM_BANK1
] = 
tm´1
;

1421 
Deviû
->
SDCR
[
FMC_SDRAM_BANK2
] = 
tm´2
;

1424  
HAL_OK
;

1425 
	}
}

1435 
HAL_StusTy³Def
 
	$FMC_SDRAM_Timšg_In™
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
FMC_SDRAM_TimšgTy³Def
 *
Timšg
, 
ušt32_t
 
Bªk
)

1437 
ušt32_t
 
tm´1
 = 0U;

1438 
ušt32_t
 
tm´2
 = 0U;

1441 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1442 
	`as£¹_·¿m
(
	`IS_FMC_LOADTOACTIVE_DELAY
(
Timšg
->
LßdToAùiveD–ay
));

1443 
	`as£¹_·¿m
(
	`IS_FMC_EXITSELFREFRESH_DELAY
(
Timšg
->
Ex™S–fReäeshD–ay
));

1444 
	`as£¹_·¿m
(
	`IS_FMC_SELFREFRESH_TIME
(
Timšg
->
S–fReäeshTime
));

1445 
	`as£¹_·¿m
(
	`IS_FMC_ROWCYCLE_DELAY
(
Timšg
->
RowCyşeD–ay
));

1446 
	`as£¹_·¿m
(
	`IS_FMC_WRITE_RECOVERY_TIME
(
Timšg
->
Wr™eRecov”yTime
));

1447 
	`as£¹_·¿m
(
	`IS_FMC_RP_DELAY
(
Timšg
->
RPD–ay
));

1448 
	`as£¹_·¿m
(
	`IS_FMC_RCD_DELAY
(
Timšg
->
RCDD–ay
));

1449 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_BANK
(
Bªk
));

1452 ià(
Bªk
 !ğ
FMC_SDRAM_BANK2
)

1454 
tm´1
 = 
Deviû
->
SDTR
[
FMC_SDRAM_BANK1
];

1457 
tm´1
 &ğ((
ušt32_t
)~(
FMC_SDTR1_TMRD
 | 
FMC_SDTR1_TXSR
 | 
FMC_SDTR1_TRAS
 | \

1458 
FMC_SDTR1_TRC
 | 
FMC_SDTR1_TWR
 | 
FMC_SDTR1_TRP
 | \

1459 
FMC_SDTR1_TRCD
));

1461 
tm´1
 |ğ(
ušt32_t
)(((
Timšg
->
LßdToAùiveD–ay
)-1U) |\

1462 (((
Timšg
->
Ex™S–fReäeshD–ay
)-1U) << 4U) |\

1463 (((
Timšg
->
S–fReäeshTime
)-1U) << 8U) |\

1464 (((
Timšg
->
RowCyşeD–ay
)-1U) << 12U) |\

1465 (((
Timšg
->
Wr™eRecov”yTime
)-1U) <<16U) |\

1466 (((
Timšg
->
RPD–ay
)-1U) << 20U) |\

1467 (((
Timšg
->
RCDD–ay
)-1U) << 24U));

1468 
Deviû
->
SDTR
[
FMC_SDRAM_BANK1
] = 
tm´1
;

1472 
tm´1
 = 
Deviû
->
SDTR
[
FMC_SDRAM_BANK1
];

1475 
tm´1
 &ğ((
ušt32_t
)~(
FMC_SDTR1_TRC
 | 
FMC_SDTR1_TRP
));

1477 
tm´1
 |ğ(
ušt32_t
)((((
Timšg
->
RowCyşeD–ay
)-1) << 12) |\

1478 (((
Timšg
->
RPD–ay
)-1) << 20));

1480 
tm´2
 = 
Deviû
->
SDTR
[
FMC_SDRAM_BANK2
];

1483 
tm´2
 &ğ((
ušt32_t
)~(
FMC_SDTR1_TMRD
 | 
FMC_SDTR1_TXSR
 | 
FMC_SDTR1_TRAS
 | \

1484 
FMC_SDTR1_TRC
 | 
FMC_SDTR1_TWR
 | 
FMC_SDTR1_TRP
 | \

1485 
FMC_SDTR1_TRCD
));

1487 
tm´2
 |ğ(
ušt32_t
)((((
Timšg
->
LßdToAùiveD–ay
)-1) |\

1488 (((
Timšg
->
Ex™S–fReäeshD–ay
)-1) << 4) |\

1489 (((
Timšg
->
S–fReäeshTime
)-1) << 8) |\

1490 (((
Timšg
->
Wr™eRecov”yTime
)-1) <<16) |\

1491 (((
Timšg
->
RCDD–ay
)-1) << 24)));

1493 
Deviû
->
SDTR
[
FMC_SDRAM_BANK1
] = 
tm´1
;

1494 
Deviû
->
SDTR
[
FMC_SDRAM_BANK2
] = 
tm´2
;

1496  
HAL_OK
;

1497 
	}
}

1504 
HAL_StusTy³Def
 
	$FMC_SDRAM_DeIn™
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

1507 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1508 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_BANK
(
Bªk
));

1511 
Deviû
->
SDCR
[
Bªk
] = 0x000002D0U;

1512 
Deviû
->
SDTR
[
Bªk
] = 0x0FFFFFFFU;

1513 
Deviû
->
SDCMR
 = 0x00000000U;

1514 
Deviû
->
SDRTR
 = 0x00000000U;

1515 
Deviû
->
SDSR
 = 0x00000000U;

1517  
HAL_OK
;

1518 
	}
}

1544 
HAL_StusTy³Def
 
	$FMC_SDRAM_Wr™ePrÙeùiÚ_EÇbË
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

1547 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1548 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_BANK
(
Bªk
));

1551 
Deviû
->
SDCR
[
Bªk
] |ğ
FMC_SDRAM_WRITE_PROTECTION_ENABLE
;

1553  
HAL_OK
;

1554 
	}
}

1561 
HAL_StusTy³Def
 
	$FMC_SDRAM_Wr™ePrÙeùiÚ_Di§bË
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

1564 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1565 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_BANK
(
Bªk
));

1568 
Deviû
->
SDCR
[
Bªk
] &ğ~
FMC_SDRAM_WRITE_PROTECTION_ENABLE
;

1570  
HAL_OK
;

1571 
	}
}

1581 
HAL_StusTy³Def
 
	$FMC_SDRAM_S’dCommªd
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
FMC_SDRAM_CommªdTy³Def
 *
Commªd
, 
ušt32_t
 
Timeout
)

1583 
__IO
 
ušt32_t
 
tm´
 = 0U;

1584 
ušt32_t
 
tick¡¬t
 = 0U;

1587 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1588 
	`as£¹_·¿m
(
	`IS_FMC_COMMAND_MODE
(
Commªd
->
CommªdMode
));

1589 
	`as£¹_·¿m
(
	`IS_FMC_COMMAND_TARGET
(
Commªd
->
CommªdT¬g‘
));

1590 
	`as£¹_·¿m
(
	`IS_FMC_AUTOREFRESH_NUMBER
(
Commªd
->
AutoReäeshNumb”
));

1591 
	`as£¹_·¿m
(
	`IS_FMC_MODE_REGISTER
(
Commªd
->
ModeRegi¡”Defš™iÚ
));

1594 
tm´
 = (
ušt32_t
)((
Commªd
->
CommªdMode
) |\

1595 (
Commªd
->
CommªdT¬g‘
) |\

1596 (((
Commªd
->
AutoReäeshNumb”
)-1U) << 5U) |\

1597 ((
Commªd
->
ModeRegi¡”Defš™iÚ
) << 9U)

1600 
Deviû
->
SDCMR
 = 
tm´
;

1603 
tick¡¬t
 = 
	`HAL_G‘Tick
();

1606 
	`HAL_IS_BIT_SET
(
Deviû
->
SDSR
, 
FMC_SDSR_BUSY
))

1609 if(
Timeout
 !ğ
HAL_MAX_DELAY
)

1611 if((
Timeout
 =ğ0U)||((
	`HAL_G‘Tick
(è- 
tick¡¬t
 ) > Timeout))

1613  
HAL_TIMEOUT
;

1618  
HAL_OK
;

1619 
	}
}

1627 
HAL_StusTy³Def
 
	$FMC_SDRAM_Prog¿mReäeshR©e
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
ReäeshR©e
)

1630 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1631 
	`as£¹_·¿m
(
	`IS_FMC_REFRESH_RATE
(
ReäeshR©e
));

1634 
Deviû
->
SDRTR
 |ğ(
ReäeshR©e
<<1U);

1636  
HAL_OK
;

1637 
	}
}

1645 
HAL_StusTy³Def
 
	$FMC_SDRAM_S‘AutoReäeshNumb”
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
AutoReäeshNumb”
)

1648 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1649 
	`as£¹_·¿m
(
	`IS_FMC_AUTOREFRESH_NUMBER
(
AutoReäeshNumb”
));

1652 
Deviû
->
SDCMR
 |ğ(
AutoReäeshNumb”
 << 5U);

1654  
HAL_OK
;

1655 
	}
}

1666 
ušt32_t
 
	$FMC_SDRAM_G‘ModeStus
(
FMC_SDRAM_Ty³Def
 *
Deviû
, 
ušt32_t
 
Bªk
)

1668 
ušt32_t
 
tm´eg
 = 0U;

1671 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_DEVICE
(
Deviû
));

1672 
	`as£¹_·¿m
(
	`IS_FMC_SDRAM_BANK
(
Bªk
));

1675 if(
Bªk
 =ğ
FMC_SDRAM_BANK1
)

1677 
tm´eg
 = (
ušt32_t
)(
Deviû
->
SDSR
 & 
FMC_SDSR_MODES1
);

1681 
tm´eg
 = ((
ušt32_t
)(
Deviû
->
SDSR
 & 
FMC_SDSR_MODES2
) >> 2U);

1685  
tm´eg
;

1686 
	}
}

	@D:\Documents\Projects\chargersdk\src\hmi\EVSEDLG.c

24 
	~"DIALOG.h
"

32 
	#ID_FRAMEWIN_0
 (
GUI_ID_USER
 + 0x00)

	)

33 
	#ID_BUTTON_0
 (
GUI_ID_USER
 + 0x01)

	)

53 cÚ¡ 
GUI_WIDGET_CREATE_INFO
 
	g_aDŸlogC»©e
[] = {

54 { 
FRAMEWIN_C»©eIndœeù
, "EVSE", 
ID_FRAMEWIN_0
, 0, 0, 1024, 600, 0, 0x0, 0 },

55 { 
BUTTON_C»©eIndœeù
, "Ğ£×¼", 
ID_BUTTON_0
, 605, 87, 80, 20, 0, 0x0, 0 },

74 
	$_cbDŸlog
(
WM_MESSAGE
 * 
pMsg
) {

75 
WM_HWIN
 
hI‹m
;

76 
NCode
;

77 
Id
;

81 
pMsg
->
MsgId
) {

82 
WM_INIT_DIALOG
:

86 
hI‹m
 = 
pMsg
->
hWš
;

87 
	`FRAMEWIN_S‘T™ËVis
(
hI‹m
, 0);

88 
	`FRAMEWIN_S‘FÚt
(
hI‹m
, 
GUI_FONT_16_HK
);

92 
WM_NOTIFY_PARENT
:

93 
Id
 = 
	`WM_G‘Id
(
pMsg
->
hWšSrc
);

94 
NCode
 = 
pMsg
->
D©a
.
v
;

95 
Id
) {

96 
ID_BUTTON_0
:

97 
NCode
) {

98 
WM_NOTIFICATION_CLICKED
:

102 
WM_NOTIFICATION_RELEASED
:

117 
	`WM_DeçuÉProc
(
pMsg
);

120 
	}
}

132 
WM_HWIN
 
C»©eEVSE
();

133 
WM_HWIN
 
	$C»©eEVSE
() {

134 
WM_HWIN
 
hWš
;

136 
hWš
 = 
	`GUI_C»©eDŸlogBox
(
_aDŸlogC»©e
, 
	`GUI_COUNTOF
(_aDŸlogC»©e), 
_cbDŸlog
, 
WM_HBKWIN
, 0, 0);

137  
hWš
;

138 
	}
}

	@D:\Documents\Projects\chargersdk\src\hmi\HMI_Start.c

1 
	~"GUI.h
"

3 
	$MašTask
()

5 
	`GUI_CURSOR_Show
();

6 
	`C»©eEVSE
();

10 
	`GUI_D–ay
(10);

12 
	}
}

	@D:\Documents\Projects\chargersdk\src\hmi\TOUCH_Calibrate.c

51 
	~"GUI.h
"

52 
	~"mxml.h
"

53 
	~"šşudes.h
"

63 
	#RECOMMENDED_MEMORY
 (1024L * 10)

	)

72 cÚ¡ *
	g_acPos
[] =

91 
	$_Wa™FÜP»s£dS‹
(
P»s£d
)

94 
ušt8_t
 
³n_¡©e
 = 0;

100 
³n_¡©e
 = 
PEN
?0:1;

101 
	`GUI_D–ay
(1);

102 ià(
³n_¡©e
 =ğ
P»s£d
)

104 
TimeS¹
 = 
	`GUI_G‘Time
();

108 
³n_¡©e
 = 
PEN
?0:1;

109 
	`GUI_D–ay
(1);

110 ià(
³n_¡©e
 !ğ
P»s£d
)

114 ià((
	`GUI_G‘Time
(è- 50è> 
TimeS¹
)

123 
	}
}

132 
	$_Di¥SŒšgC’‹»d
(cÚ¡ *
pSŒšg
)

134 
GUI_RECT
 
Reù
;

136 
Reù
.
x0
 = Reù.
y0
 = 0;

137 
Reù
.
x1
 = 
	`LCD_G‘XSize
() - 1;

138 
Reù
.
y1
 = 
	`LCD_G‘YSize
() - 1;

139 
	`GUI_Di¥SŒšgInReù
(
pSŒšg
, &
Reù
, 
GUI_TA_HCENTER
 | 
GUI_TA_VCENTER
);

140 
	}
}

150 
	$_G‘PhysV®ues
(
LogX
, 
LogY
, *
pPhysX
, *
pPhysY
, cÚ¡ *
pSŒšg
)

152 
acText
[] = "Press here";

153 
GUI_RECT
 
Reù
;

154 
FÚtSizeY
;

155 
Align
;

157 
FÚtSizeY
 = 
	`GUI_G‘FÚtSizeY
();

158 
	`GUI_CË¬
();

159 
	`GUI_S‘CŞÜ
(
GUI_BLACK
);

160 
	`_Di¥SŒšgC’‹»d
("Runtime calibration,\n"

166 
Reù
.
y0
 = 
LogY
 - 
FÚtSizeY
;

167 
Reù
.
y1
 = 
LogY
 + 
FÚtSizeY
;

168 ià(
LogX
 < 
	`LCD_G‘XSize
() / 2)

170 
Reù
.
x0
 = 
LogX
 + 15;

171 
Reù
.
x1
 = 
	`LCD_G‘XSize
();

172 
Align
 = 
GUI_TA_LEFT
;

176 
Reù
.
x0
 = 0;

177 
Reù
.
x1
 = 
LogX
 - 15;

178 
Align
 = 
GUI_TA_RIGHT
;

183 
	`GUI_Di¥SŒšgInReù
(
acText
, &
Reù
, 
Align
 | 
GUI_TA_TOP
);

184 
	`GUI_Di¥SŒšgInReù
(
pSŒšg
, &
Reù
, 
Align
 | 
GUI_TA_BOTTOM
);

188 
	`GUI_FlCœşe
(
LogX
, 
LogY
, 10);

189 
	`GUI_S‘CŞÜ
(
GUI_WHITE
);

190 
	`GUI_FlCœşe
(
LogX
, 
LogY
, 5);

191 
	`GUI_S‘CŞÜ
(
GUI_BLACK
);

198 
	`_Wa™FÜP»s£dS‹
(1);

199 *
pPhysX
 = 
	`GUI_TOUCH_G‘xPhys
();

200 *
pPhysY
 = 
	`GUI_TOUCH_G‘yPhys
();

201 
	`_Wa™FÜP»s£dS‹
(0);

203 *
pPhysX
 >ğ65535 || *
pPhysY
 >= 65535);

208 
	}
}

217 
	$_Ex¶aš
()

219 
	`_Di¥SŒšgC’‹»d
("This sample shows how\n"

224 
	`GUI_Di¥SŒšgHC’‹rAt
("TOUCH_C®ib¿‹", 
	`LCD_G‘XSize
() / 2, 5);

225 
	`_Wa™FÜP»s£dS‹
(1);

226 
	`_Wa™FÜP»s£dS‹
(0);

227 
	}
}

238 
	$Touch_C®ib¿‹
()

240 
aPhysX
[2], 
aPhysY
[2], 
aLogX
[2], 
aLogY
[2], 
i
;

241 
	`GUI_In™
();

245 ià(
	`GUI_ALLOC_G‘NumF»eBy‹s
(è< 
RECOMMENDED_MEMORY
)

247 
	`GUI_E¼ÜOut
("Notƒnough memory‡vailable.");

250 
	`GUI_S‘BkCŞÜ
(
GUI_WHITE
);

251 
	`GUI_CË¬
();

252 
	`GUI_S‘CŞÜ
(
GUI_BLACK
);

253 
	`GUI_S‘FÚt
(&
GUI_FÚt13B_ASCII
);

254 
	`_Ex¶aš
();

256 
aLogX
[0] = 15;

257 
aLogY
[0] = 15;

258 
aLogX
[1] = 
	`LCD_G‘XSize
() - 15;

259 
aLogY
[1] = 
	`LCD_G‘YSize
() - 15;

261 
i
 = 0; i < 2; i++)

263 
	`_G‘PhysV®ues
(
aLogX
[
i
], 
aLogY
[i], &
aPhysX
[i], &
aPhysY
[i], 
_acPos
[i]);

266 
	`GUI_TOUCH_C®ib¿‹
(
GUI_COORD_X
, 
aLogX
[0],‡LogX[1], 
aPhysX
[0],‡PhysX[1]);

267 
	`GUI_TOUCH_C®ib¿‹
(
GUI_COORD_Y
, 
aLogY
[0],‡LogY[1], 
aPhysY
[0],‡PhysY[1]);

268 
syscÚf_·¿m
.
ad_Ëá
 = 
aPhysX
[0];

269 
syscÚf_·¿m
.
ad_right
 = 
aPhysX
[1];

270 
syscÚf_·¿m
.
ad_tİ
 = 
aPhysY
[0];

271 
syscÚf_·¿m
.
ad_bÙtom
 = 
aPhysY
[1];

272 
	`wr™e_syscÚf_xml
();

274 
	`GUI_CURSOR_Show
();

275 
	`GUI_CË¬
();

276 
	`_Di¥SŒšgC’‹»d
("Congratulation, your\n"

284 
GUI_PID_STATE
 
S‹
;

285 
	`GUI_TOUCH_G‘S‹
(&
S‹
);

286 ià(
S‹
.
P»s£d
 == 1)

288 
	`GUI_FlCœşe
(
S‹
.
x
, S‹.
y
, 3);

290 
	`GUI_D–ay
(10);

292 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\GUIConf.c

54 
	~<¡dlib.h
>

55 
	~"GUI.h
"

66 
	#GUI_NUMBYTES
 (8*1024*1024)

	)

67 
	#GUI_BLOCKSIZE
 0X80

68 

	)

83 
	$GUI_X_CÚfig
() {

88 
U32
 *
aMemÜy
 = (U32 *)(0xC0300000);

93 
	`GUI_ALLOC_AssignMemÜy
(
aMemÜy
, 
GUI_NUMBYTES
);

98 
	`GUI_ALLOC_S‘AvBlockSize
(
GUI_BLOCKSIZE
);

102 
	`GUI_S‘DeçuÉFÚt
(
GUI_FONT_6X8
);

103 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\GUIConf.h

54 #iâdeà
GUICONF_H


55 
	#GUICONF_H


	)

61 
	#GUI_NUM_LAYERS
 2

62 

	)

67 #ifdeà
OS_SUPPORT


68 
	#GUI_OS
 (1)

69 #–£

	)

70 
	#GUI_OS
 (0)

	)

77 #iâdeà 
GUI_SUPPORT_TOUCH


78 
	#GUI_SUPPORT_TOUCH
 (1)

80 

	)

85 
	#GUI_DEFAULT_FONT
 &
GUI_FÚt6x8


	)

91 
	#GUI_SUPPORT_MOUSE
 (1è

	)

92 
	#GUI_WINSUPPORT
 (1è

	)

93 
	#GUI_SUPPORT_MEMDEV
 (1è

	)

94 
	#GUI_SUPPORT_DEVICES
 (1è

	)

	@D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\LCDConf_Lin_AT070.c

49 
	~"šşudes.h
"

50 
	~"LCDCÚf.h
"

51 
	~"GUI_Priv©e.h
"

80 
	#XSIZE_PHYS
 800

	)

81 
	#YSIZE_PHYS
 480

	)

83 
	#NUM_BUFFERS
 3

84 
	#NUM_VSCREENS
 1

85 

	)

86 
	#BK_COLOR
 
GUI_DARKBLUE


	)

88 #undeà
GUI_NUM_LAYERS


89 
	#GUI_NUM_LAYERS
 1

	)

91 
	#COLOR_CONVERSION_0
 
GUICC_M565


	)

92 
	#DISPLAY_DRIVER_0
 
GUIDRV_LIN_16


	)

94 #ià(
GUI_NUM_LAYERS
 > 1)

95 
	#COLOR_CONVERSION_1
 
GUICC_M1555I


	)

96 
	#DISPLAY_DRIVER_1
 
GUIDRV_LIN_16


	)

99 #iâdeà 
XSIZE_PHYS


100 #”rÜ 
Physiÿl
 
X
 
size
 
of
 
di¥Ïy
 
is
 
nÙ
 
defšed
!

102 #iâdeà 
YSIZE_PHYS


103 #”rÜ 
Physiÿl
 
Y
 
size
 
of
 
di¥Ïy
 
is
 
nÙ
 
defšed
!

105 #iâdeà 
NUM_VSCREENS


106 
	#NUM_VSCREENS
 1

	)

108 #ià(
NUM_VSCREENS
 <= 0)

109 #”rÜ 
At
 
Ëa¡
 
Úe
 
sü“’
 
Ãeds
 
to
 
be
 
defšed
!

112 #ià(
NUM_VSCREENS
 > 1è&& (
NUM_BUFFERS
 > 1)

113 #”rÜ 
Vœtu®
 
sü“ns
 
ªd
 
muÉË
 
bufãrs
 
¬e
 
nÙ
 
®lowed
!

116 
	#LCD_LAYER0_FRAME_BUFFER_SIZE
 (3*1024*1024)

	)

117 
	#LCD_LAYER1_FRAME_BUFFER_SIZE
 (3*1024*1024)

	)

119 
	#LCD_LAYER0_FRAME_BUFFER
 ((
ušt32_t
)0xC0000000)

120 
	#LCD_LAYER1_FRAME_BUFFER
 ((
ušt32_t
)0xC0300000)

121 

	)

132 
	#DEFINEDMA2D_COLORCONVERSION
(
PFIX
, 
PIXELFORMAT
) \

133 
CŞÜ2IndexBulk_
##
PFIX
##
	`DMA2D
(
LCD_COLOR
 * 
pCŞÜ
, * 
pIndex
, 
U32
 
NumI‹ms
, 
U8
 
SizeOfIndex
) { \

134 
	`DMA2D_CŞÜ2IndexBulk
(
pCŞÜ
, 
pIndex
, 
NumI‹ms
, 
SizeOfIndex
, 
PIXELFORMAT
); \

136 
Index2CŞÜBulk_
##
PFIX
##
	`DMA2D
(* 
pIndex
, 
LCD_COLOR
 * 
pCŞÜ
, 
U32
 
NumI‹ms
, 
U8
 
SizeOfIndex
) { \

137 
	`DMA2D_Index2CŞÜBulk
(
pIndex
, 
pCŞÜ
, 
NumI‹ms
, 
SizeOfIndex
, 
PIXELFORMAT
); \

138 }

	)

148 
LTDC_HªdËTy³Def
 
	ghÉdc
;

149 
DMA2D_HªdËTy³Def
 
	ghdma2d
;

150 
LCD_Lay”PrİTy³def
 
	gÏy”_´İ
[
GUI_NUM_LAYERS
];

152 
_Édc_dev
 
	glcdÉdc
;

154 cÚ¡ 
LCD_API_COLOR_CONV
 *
	g­CŞÜCÚvAPI
[] =

156 
COLOR_CONVERSION_0
,

157 #ià
GUI_NUM_LAYERS
 > 1

158 
COLOR_CONVERSION_1
,

162 
U32
 
	gaBufãrDMA2D
 [
XSIZE_PHYS
 * (U32)];

163 
U32
 
	gaBufãr_FG
 [
XSIZE_PHYS
 * (U32)];

164 
U32
 
	gaBufãr_BG
 [
XSIZE_PHYS
 * (U32)];

174 
ušt32_t
 
LCD_LL_G‘Pix–fÜm©
(ušt32_ˆ
Lay”Index
);

175 
DMA2D_CİyBufãr
(
ušt32_t
 
Lay”Index
, *
pSrc
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLšeSrc
, ušt32_ˆ
OffLšeD¡
);

176 
DMA2D_FlBufãr
(
ušt32_t
 
Lay”Index
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLše
, ušt32_ˆ
CŞÜIndex
);

177 
LCD_LL_In™
();

178 
LCD_LL_Lay”In™
(
ušt32_t
 
Lay”Index
);

180 
CUSTOM_CİyBufãr
(
št32_t
 
Lay”Index
, iÁ32_ˆ
IndexSrc
, iÁ32_ˆ
IndexD¡
);

181 
CUSTOM_CİyReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
);

182 
CUSTOM_FlReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, 
ušt32_t
 
Pix–Index
);

184 
DMA2D_Index2CŞÜBulk
(*
pIndex
, 
LCD_COLOR
 *
pCŞÜ
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
);

185 
DMA2D_CŞÜ2IndexBulk
(
LCD_COLOR
 *
pCŞÜ
, *
pIndex
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
);

187 
BSP_LCD_D¿wB™m­8bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U8
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
);

188 
BSP_LCD_D¿wB™m­16bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U16
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
);

189 
DMA2D_AÍhaBËndšgBulk
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
);

190 
DMA2D_AÍhaBËndšg
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
);

191 
LCD_PIXELINDEX
 *
_LCD_G‘pP®CÚvTabË
(cÚ¡ 
LCD_LOGPALETTE
 
GUI_UNI_PTR
 *
pLogP®
, cÚ¡ 
GUI_BITMAP
 GUI_UNI_PTR *
pB™m­
, 
Lay”Index
);

192 
LCD_COLOR
 
DMA2D_MixCŞÜs
(LCD_COLOR 
CŞÜ
, LCD_COLOR 
BkCŞÜ
, 
U8
 
IÁ’s
);

193 
LCD_MixCŞÜsBulk
(
U32
 *
pFG
, U32 *
pBG
, U32 *
pD¡
, 
OffFG
, 
OffBG
, 
OffDe¡
, 
xSize
, 
ySize
, 
U8
 
IÁ’s
);

195 
	$DEFINEDMA2D_COLORCONVERSION
(
M8888I
, 
LTDC_PIXEL_FORMAT_ARGB8888
)

196 
	$DEFINEDMA2D_COLORCONVERSION
(
M888
, 
LTDC_PIXEL_FORMAT_ARGB8888
)

198 
	$DEFINEDMA2D_COLORCONVERSION
(
M1555I
, 
LTDC_PIXEL_FORMAT_ARGB1555
)

199 
	$DEFINEDMA2D_COLORCONVERSION
(
M4444I
, 
LTDC_PIXEL_FORMAT_ARGB4444
)

201 
ušt32_t
 
	`G‘BufãrSize
(ušt32_ˆ
Lay”Index
);

215 
	$LTDC_IRQHªdËr
()

217 
	`HAL_LTDC_IRQHªdËr
(&
hÉdc
);

218 
	}
}

220 
	$LCD_BackLight
(
OnOff
)

222 if(
OnOff
 == 1)

224 
	`HAL_GPIO_Wr™ePš
(
GPIOB
, 
GPIO_PIN_5
, 
GPIO_PIN_SET
);

226 if(
OnOff
 == 0)

228 
	`HAL_GPIO_Wr™ePš
(
GPIOB
, 
GPIO_PIN_5
, 
GPIO_PIN_RESET
);

230 
	}
}

241 
	$HAL_DMA2D_M¥In™
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

244 
	`__HAL_RCC_DMA2D_CLK_ENABLE
();

245 
	}
}

254 
	$HAL_DMA2D_M¥DeIn™
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

257 
	`__HAL_RCC_DMA2D_FORCE_RESET
();

260 
	`__HAL_RCC_DMA2D_RELEASE_RESET
();

261 
	}
}

271 
	$HAL_LTDC_M¥In™
(
LTDC_HªdËTy³Def
 *
hÉdc
)

273 
GPIO_In™Ty³Def
 
GPIO_In™_SŒuùu»
;

277 
	`__HAL_RCC_LTDC_CLK_ENABLE
();

280 
	`__HAL_RCC_GPIOB_CLK_ENABLE
();

281 
	`__HAL_RCC_GPIOF_CLK_ENABLE
();

282 
	`__HAL_RCC_GPIOG_CLK_ENABLE
();

283 
	`__HAL_RCC_GPIOH_CLK_ENABLE
();

284 
	`__HAL_RCC_GPIOI_CLK_ENABLE
();

302 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_5
;

303 
GPIO_In™_SŒuùu»
.
Mode
 = 
GPIO_MODE_OUTPUT_PP
;

304 
GPIO_In™_SŒuùu»
.
PuÎ
 = 
GPIO_PULLUP
;

305 
GPIO_In™_SŒuùu»
.
S³ed
 = 
GPIO_SPEED_HIGH
;

306 
	`HAL_GPIO_In™
(
GPIOB
, &
GPIO_In™_SŒuùu»
);

309 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_10
;

310 
GPIO_In™_SŒuùu»
.
Mode
 = 
GPIO_MODE_AF_PP
;

311 
GPIO_In™_SŒuùu»
.
PuÎ
 = 
GPIO_NOPULL
;

312 
GPIO_In™_SŒuùu»
.
S³ed
 = 
GPIO_SPEED_HIGH
;

313 
GPIO_In™_SŒuùu»
.
AÉ”Ç‹
 = 
GPIO_AF14_LTDC
;

314 
	`HAL_GPIO_In™
(
GPIOF
, &
GPIO_In™_SŒuùu»
);

317 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_6
 | 
GPIO_PIN_7
 | 
GPIO_PIN_11
;

318 
	`HAL_GPIO_In™
(
GPIOG
, &
GPIO_In™_SŒuùu»
);

321 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_9
 | 
GPIO_PIN_10
 | 
GPIO_PIN_11
 | \

322 
GPIO_PIN_12
 | 
GPIO_PIN_13
 | 
GPIO_PIN_14
 | 
GPIO_PIN_15
;

323 
	`HAL_GPIO_In™
(
GPIOH
, &
GPIO_In™_SŒuùu»
);

326 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_0
 | 
GPIO_PIN_1
 | 
GPIO_PIN_2
 | 
GPIO_PIN_4
 | 
GPIO_PIN_5
 | \

327 
GPIO_PIN_6
 | 
GPIO_PIN_7
 | 
GPIO_PIN_9
 | 
GPIO_PIN_10
;

328 
	`HAL_GPIO_In™
(
GPIOI
, &
GPIO_In™_SŒuùu»
);

331 
	`HAL_NVIC_S‘PriÜ™y
(
LTDC_IRQn
, 
b¥LTDC_P»em±PriÜ™y
, 
b¥LTDC_SubPriÜ™y
);

334 
	`HAL_NVIC_EÇbËIRQ
(
LTDC_IRQn
);

337 
	`LCD_BackLight
(1);

338 
	}
}

347 
	$HAL_LTDC_M¥DeIn™
(
LTDC_HªdËTy³Def
 *
hÉdc
)

351 
	`__HAL_RCC_LTDC_FORCE_RESET
();

354 
	`__HAL_RCC_LTDC_RELEASE_RESET
();

355 
	}
}

363 
	$HAL_LTDC_LšeEv’C®lback
(
LTDC_HªdËTy³Def
 *
hÉdc
)

365 
ušt32_t
 
Addr
;

366 
ušt32_t
 
Ïy”
;

368 
Ïy”
 = 0;†ay” < 
GUI_NUM_LAYERS
;†ayer++)

370 ià(
Ïy”_´İ
[
Ïy”
].
³ndšg_bufãr
 >= 0)

373 
Addr
 = 
Ïy”_´İ
[
Ïy”
].
add»ss
 +†ay”_´İ[Ïy”].
xSize
 *†ay”_´İ[Ïy”].
ySize
 *†ay”_´İ[Ïy”].
³ndšg_bufãr
 *†ay”_´İ[Ïy”].
By‹sP”Pix–
;

374 
	`HAL_LTDC_S‘Add»ss
(
hÉdc
, 
Addr
, 
Ïy”
);

376 
	`__HAL_LTDC_RELOAD_CONFIG
(
hÉdc
);

379 
	`GUI_MULTIBUF_CÚfœmEx
(
Ïy”
, 
Ïy”_´İ
[Ïy”].
³ndšg_bufãr
);

382 
Ïy”_´İ
[
Ïy”
].
³ndšg_bufãr
 = -1;

386 
	`HAL_LTDC_Prog¿mLšeEv’t
(
hÉdc
, 0);

387 
	}
}

398 
	$LCD_X_CÚfig
()

400 
ušt32_t
 
i
;

402 
	`LCD_LL_In™
();

405 #ià(
NUM_BUFFERS
 > 1)

406 
i
 = 0; i < 
GUI_NUM_LAYERS
; i++)

408 
	`GUI_MULTIBUF_CÚfigEx
(
i
, 
NUM_BUFFERS
);

413 
	`GUI_DEVICE_C»©eAndLšk
(
DISPLAY_DRIVER_0
, 
COLOR_CONVERSION_0
, 0, 0);

416 ià(
	`LCD_G‘Sw­XYEx
(0))

418 
	`LCD_S‘SizeEx
 (0, 
YSIZE_PHYS
, 
XSIZE_PHYS
);

419 
	`LCD_S‘VSizeEx
(0, 
YSIZE_PHYS
 * 
NUM_VSCREENS
, 
XSIZE_PHYS
);

423 
	`LCD_S‘SizeEx
 (0, 
XSIZE_PHYS
, 
YSIZE_PHYS
);

424 
	`LCD_S‘VSizeEx
(0, 
XSIZE_PHYS
, 
YSIZE_PHYS
 * 
NUM_VSCREENS
);

426 
	`GUI_TOUCH_C®ib¿‹
(
GUI_COORD_X
,0+15,
lcdÉdc
.
pwidth
-15,
syscÚf_·¿m
.
ad_Ëá
,syscÚf_·¿m.
ad_right
);

427 
	`GUI_TOUCH_C®ib¿‹
(
GUI_COORD_Y
,0+15,
lcdÉdc
.
pheight
-15,
syscÚf_·¿m
.
ad_tİ
,syscÚf_·¿m.
ad_bÙtom
);

429 #ià(
GUI_NUM_LAYERS
 > 1)

431 
	`GUI_DEVICE_C»©eAndLšk
(
DISPLAY_DRIVER_1
, 
COLOR_CONVERSION_1
, 0, 1);

433 ià(
	`LCD_G‘Sw­XYEx
(1))

435 
	`LCD_S‘SizeEx
 (1, 
YSIZE_PHYS
, 
XSIZE_PHYS
);

436 
	`LCD_S‘VSizeEx
(1, 
YSIZE_PHYS
 * 
NUM_VSCREENS
, 
XSIZE_PHYS
);

440 
	`LCD_S‘SizeEx
 (1, 
XSIZE_PHYS
, 
YSIZE_PHYS
);

441 
	`LCD_S‘VSizeEx
(1, 
XSIZE_PHYS
, 
YSIZE_PHYS
 * 
NUM_VSCREENS
);

446 
Ïy”_´İ
[0].
add»ss
 = 
LCD_LAYER0_FRAME_BUFFER
;

447 #ià(
GUI_NUM_LAYERS
 > 1)

448 
Ïy”_´İ
[1].
add»ss
 = 
LCD_LAYER1_FRAME_BUFFER
;

452 
i
 = 0; i < 
GUI_NUM_LAYERS
; i++)

454 
Ïy”_´İ
[
i
].
pCŞÜCÚvAPI
 = (
LCD_API_COLOR_CONV
 *)
­CŞÜCÚvAPI
[i];

456 
Ïy”_´İ
[
i
].
³ndšg_bufãr
 = -1;

459 
	`LCD_S‘VRAMAddrEx
(
i
, (*)(
Ïy”_´İ
[i].
add»ss
));

462 
Ïy”_´İ
[
i
].
By‹sP”Pix–
 = 
	`LCD_G‘B™sP”Pix–Ex
(i) >> 3;

465 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_COPYBUFFER
, ((*)())
CUSTOM_CİyBufãr
);

466 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_COPYRECT
, ((*)())
CUSTOM_CİyReù
);

469 ià(
	`LCD_LL_G‘Pix–fÜm©
(
i
è<ğ
LTDC_PIXEL_FORMAT_ARGB4444
)

471 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_FILLRECT
, ((*)())
CUSTOM_FlReù
);

472 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_DRAWBMP_8BPP
, ((*)())
BSP_LCD_D¿wB™m­8bµ
);

476 ià(
	`LCD_LL_G‘Pix–fÜm©
(
i
è=ğ
LTDC_PIXEL_FORMAT_RGB565
)

478 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_DRAWBMP_16BPP
, ((*)())
BSP_LCD_D¿wB™m­16bµ
);

482 
	`GUICC_M1555I_S‘Cu¡CŞÜCÚv
(
CŞÜ2IndexBulk_M1555IDMA2D
, 
Index2CŞÜBulk_M1555IDMA2D
);

484 
	`GUICC_M4444I_S‘Cu¡CŞÜCÚv
(
CŞÜ2IndexBulk_M4444IDMA2D
, 
Index2CŞÜBulk_M4444IDMA2D
);

485 
	`GUICC_M888_S‘Cu¡CŞÜCÚv
 (
CŞÜ2IndexBulk_M888DMA2D
, 
Index2CŞÜBulk_M888DMA2D
);

486 
	`GUICC_M8888I_S‘Cu¡CŞÜCÚv
(
CŞÜ2IndexBulk_M8888IDMA2D
, 
Index2CŞÜBulk_M8888IDMA2D
);

489 
	`GUI_S‘FuncAÍhaBËndšg
(
DMA2D_AÍhaBËndšg
);

493 
	`GUI_S‘FuncG‘pP®CÚvTabË
(
_LCD_G‘pP®CÚvTabË
);

496 
	`GUI_S‘FuncMixCŞÜs
(
DMA2D_MixCŞÜs
);

499 
	`GUI_S‘FuncMixCŞÜsBulk
(
LCD_MixCŞÜsBulk
);

501 
	}
}

514 
	$LCD_X_Di¥ÏyDriv”
(
Lay”Index
, 
Cmd
, *
pD©a
)

516 
št32_t
 
r
 = 0;

517 
ušt32_t
 
addr
;

518 
št32_t
 
xPos
, 
yPos
;

519 
ušt32_t
 
CŞÜ
;

521 
Cmd
)

523 
LCD_X_INITCONTROLLER
:

524 
	`LCD_LL_Lay”In™
(
Lay”Index
);

527 
LCD_X_SETORG
:

528 
addr
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + ((
LCD_X_SETORG_INFO
 *)
pD©a
)->
yPos
 *†ay”_´İ[Lay”Index].
xSize
 *†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

529 
	`HAL_LTDC_S‘Add»ss
(&
hÉdc
, 
addr
, 
Lay”Index
);

532 
LCD_X_SHOWBUFFER
:

533 
Ïy”_´İ
[
Lay”Index
].
³ndšg_bufãr
 = ((
LCD_X_SHOWBUFFER_INFO
 *)
pD©a
)->
Index
;

536 
LCD_X_SETLUTENTRY
:

537 
	`HAL_LTDC_CÚfigCLUT
(&
hÉdc
, (
ušt32_t
 *è& (((
LCD_X_SETLUTENTRY_INFO
 *)
pD©a
)->
CŞÜ
), 1, 
Lay”Index
);

540 
LCD_X_ON
:

541 
	`__HAL_LTDC_ENABLE
(&
hÉdc
);

544 
LCD_X_OFF
:

545 
	`__HAL_LTDC_DISABLE
(&
hÉdc
);

548 
LCD_X_SETVIS
:

549 if(((
LCD_X_SETVIS_INFO
 *)
pD©a
)->
OnOff
 =ğ
ENABLE
 )

551 
	`__HAL_LTDC_LAYER_ENABLE
(&
hÉdc
, 
Lay”Index
);

555 
	`__HAL_LTDC_LAYER_DISABLE
(&
hÉdc
, 
Lay”Index
);

557 
	`__HAL_LTDC_RELOAD_CONFIG
(&
hÉdc
);

560 
LCD_X_SETPOS
:

561 
	`HAL_LTDC_S‘WšdowPos™iÚ
(&
hÉdc
,

562 ((
LCD_X_SETPOS_INFO
 *)
pD©a
)->
xPos
,

563 ((
LCD_X_SETPOS_INFO
 *)
pD©a
)->
yPos
,

564 
Lay”Index
);

567 
LCD_X_SETSIZE
:

568 
	`GUI_G‘Lay”PosEx
(
Lay”Index
, (*)&
xPos
, (*)&
yPos
);

569 
Ïy”_´İ
[
Lay”Index
].
xSize
 = ((
LCD_X_SETSIZE_INFO
 *)
pD©a
)->xSize;

570 
Ïy”_´İ
[
Lay”Index
].
ySize
 = ((
LCD_X_SETSIZE_INFO
 *)
pD©a
)->ySize;

571 
	`HAL_LTDC_S‘WšdowPos™iÚ
(&
hÉdc
, 
xPos
, 
yPos
, 
Lay”Index
);

574 
LCD_X_SETALPHA
:

575 
	`HAL_LTDC_S‘AÍha
(&
hÉdc
, ((
LCD_X_SETALPHA_INFO
 *)
pD©a
)->
AÍha
, 
Lay”Index
);

578 
LCD_X_SETCHROMAMODE
:

579 if(((
LCD_X_SETCHROMAMODE_INFO
 *)
pD©a
)->
ChromaMode
 != 0)

581 
	`HAL_LTDC_EÇbËCŞÜKeyšg
(&
hÉdc
, 
Lay”Index
);

585 
	`HAL_LTDC_Di§bËCŞÜKeyšg
(&
hÉdc
, 
Lay”Index
);

589 
LCD_X_SETCHROMA
:

591 
CŞÜ
 = ((((
LCD_X_SETCHROMA_INFO
 *)
pD©a
)->
ChromaMš
 & 0xFF0000) >> 16) | \

592 (((
LCD_X_SETCHROMA_INFO
 *)
pD©a
)->
ChromaMš
 & 0x00FF00) | \

593 ((((
LCD_X_SETCHROMA_INFO
 *)
pD©a
)->
ChromaMš
 & 0x0000FF) << 16);

595 
	`HAL_LTDC_CÚfigCŞÜKeyšg
(&
hÉdc
, 
CŞÜ
, 
Lay”Index
);

599 
r
 = -1;

601  
r
;

602 
	}
}

612 
	$LCD_LL_Lay”In™
(
ušt32_t
 
Lay”Index
)

614 
ušt32_t
 
i
;

615 
ušt32_t
 
LUT
[256];

616 
LTDC_Lay”CfgTy³Def
 
Ïy”_cfg
;

618 ià(
Lay”Index
 < 
GUI_NUM_LAYERS
)

621 
Ïy”_cfg
.
WšdowX0
 = 0;

622 
Ïy”_cfg
.
WšdowX1
 = 
XSIZE_PHYS
;

623 
Ïy”_cfg
.
WšdowY0
 = 0;

624 
Ïy”_cfg
.
WšdowY1
 = 
YSIZE_PHYS
;

625 
Ïy”_cfg
.
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

626 
Ïy”_cfg
.
FBS¹Ad»ss
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
;

627 
Ïy”_cfg
.
AÍha
 = 255;

628 
Ïy”_cfg
.
AÍha0
 = 0;

629 
Ïy”_cfg
.
BackcŞÜ
.
Blue
 = 0;

630 
Ïy”_cfg
.
BackcŞÜ
.
G»’
 = 0;

631 
Ïy”_cfg
.
BackcŞÜ
.
Red
 = 0;

632 
Ïy”_cfg
.
BËndšgFaùÜ1
 = 
LTDC_BLENDING_FACTOR1_PAxCA
;

633 
Ïy”_cfg
.
BËndšgFaùÜ2
 = 
LTDC_BLENDING_FACTOR2_PAxCA
;

634 
Ïy”_cfg
.
ImageWidth
 = 
XSIZE_PHYS
;

635 
Ïy”_cfg
.
ImageHeight
 = 
YSIZE_PHYS
;

636 
	`HAL_LTDC_CÚfigLay”
(&
hÉdc
, &
Ïy”_cfg
, 
Lay”Index
);

639 ià(
	`LCD_G‘B™sP”Pix–Ex
(
Lay”Index
) <= 8)

642 
	`HAL_LTDC_EÇbËCLUT
(&
hÉdc
, 
Lay”Index
);

647 ià(
Ïy”_´İ
[
Lay”Index
].
pCŞÜCÚvAPI
 =ğ
GUICC_88666I
)

649 
	`HAL_LTDC_EÇbËCLUT
(&
hÉdc
, 
Lay”Index
);

651 
i
 = 0; i < 256; i++)

653 
LUT
[
i
] = 
LCD_API_CŞÜCÚv_8666
.
	`pfIndex2CŞÜ
(i);

655 
	`HAL_LTDC_CÚfigCLUT
(&
hÉdc
, 
LUT
, 256, 
Lay”Index
);

659 
	}
}

667 
	$LCD_LL_In™
()

670 
RCC_P”hCLKIn™Ty³Def
 
P”hClkIn™SŒuù
;

672 
lcdÉdc
.
pwidth
 = 
XSIZE_PHYS
;

673 
lcdÉdc
.
pheight
 = 
YSIZE_PHYS
;

674 
lcdÉdc
.
hsw
 = 1;

675 
lcdÉdc
.
vsw
 = 1;

676 
lcdÉdc
.
hbp
 = 46;

677 
lcdÉdc
.
vbp
 = 23;

678 
lcdÉdc
.
hå
 = 210;

679 
lcdÉdc
.
vå
 = 22;

682 
	`HAL_LTDC_DeIn™
(&
hÉdc
);

685 
hÉdc
.
In™
.
HÜizÚlSync
 = 
lcdÉdc
.
hsw
 - 1;

686 
hÉdc
.
In™
.
V”tiÿlSync
 = 
lcdÉdc
.
vsw
 - 1;

687 
hÉdc
.
In™
.
AccumuÏ‹dHBP
 = 
lcdÉdc
.
hsw
 +†cdÉdc.
hbp
 - 1;

688 
hÉdc
.
In™
.
AccumuÏ‹dVBP
 = 
lcdÉdc
.
vsw
 +†cdÉdc.
vbp
 - 1;

689 
hÉdc
.
In™
.
AccumuÏ‹dAùiveW
 = 
lcdÉdc
.
hsw
 +†cdÉdc.
hbp
 +†cdÉdc.
pwidth
 - 1;

690 
hÉdc
.
In™
.
AccumuÏ‹dAùiveH
 = 
lcdÉdc
.
vsw
 +†cdÉdc.
vbp
 +†cdÉdc.
pheight
 - 1;

691 
hÉdc
.
In™
.
TÙ®Width
 = 
lcdÉdc
.
hsw
 +†cdÉdc.
hbp
 +†cdÉdc.
pwidth
 +†cdÉdc.
hå
 - 1;

692 
hÉdc
.
In™
.
TÙ®Heigh
 = 
lcdÉdc
.
vsw
 +†cdÉdc.
vbp
 +†cdÉdc.
pheight
 +†cdÉdc.
vå
 - 1;

696 
hÉdc
.
In™
.
BackcŞÜ
.
Blue
 = 0;

697 
hÉdc
.
In™
.
BackcŞÜ
.
G»’
 = 0;

698 
hÉdc
.
In™
.
BackcŞÜ
.
Red
 = 0;

705 
P”hClkIn™SŒuù
.
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_LTDC
;

706 
P”hClkIn™SŒuù
.
PLLSAI
.
PLLSAIN
 = 320;

707 
P”hClkIn™SŒuù
.
PLLSAI
.
PLLSAIR
 = 2;

708 
P”hClkIn™SŒuù
.
PLLSAIDivR
 = 
RCC_PLLSAIDIVR_4
;

709 
	`HAL_RCCEx_P”hCLKCÚfig
(&
P”hClkIn™SŒuù
);

712 
hÉdc
.
In™
.
HSPŞ¬™y
 = 
LTDC_HSPOLARITY_AL
;

713 
hÉdc
.
In™
.
VSPŞ¬™y
 = 
LTDC_VSPOLARITY_AL
;

714 
hÉdc
.
In™
.
DEPŞ¬™y
 = 
LTDC_DEPOLARITY_AL
;

715 
hÉdc
.
In™
.
PCPŞ¬™y
 = 
LTDC_PCPOLARITY_IPC
;

716 
hÉdc
.
In¡ªû
 = 
LTDC
;

718 
	`HAL_LTDC_In™
(&
hÉdc
);

719 
	`HAL_LTDC_Prog¿mLšeEv’t
(&
hÉdc
, 0);

722 
hdma2d
.
In™
.
Mode
 = 
DMA2D_R2M
;

723 
hdma2d
.
In™
.
CŞÜMode
 = 
DMA2D_RGB565
;

724 
hdma2d
.
In™
.
OuutOff£t
 = 0x0;

726 
hdma2d
.
In¡ªû
 = 
DMA2D
;

728 if(
	`HAL_DMA2D_In™
(&
hdma2d
è!ğ
HAL_OK
)

732 
	}
}

739 
ušt32_t
 
	$LCD_LL_G‘Pix–fÜm©
(
ušt32_t
 
Lay”Index
)

741 cÚ¡ 
LCD_API_COLOR_CONV
 *
pCŞÜCÚvAPI
;

743 ià(
Lay”Index
 >ğ
GUI_NUM_LAYERS
)

747 
pCŞÜCÚvAPI
 = 
Ïy”_´İ
[
Lay”Index
].pColorConvAPI;

749 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M8888I
)

751  
LTDC_PIXEL_FORMAT_ARGB8888
;

753 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M888
)

755  
LTDC_PIXEL_FORMAT_RGB888
;

757 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M565
)

759  
LTDC_PIXEL_FORMAT_RGB565
;

761 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M1555I
)

763  
LTDC_PIXEL_FORMAT_ARGB1555
;

765 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M4444I
)

767  
LTDC_PIXEL_FORMAT_ARGB4444
;

769 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_8666
)

771  
LTDC_PIXEL_FORMAT_L8
;

773 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_1616I
)

775  
LTDC_PIXEL_FORMAT_AL44
;

777 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_88666I
)

779  
LTDC_PIXEL_FORMAT_AL88
;

782 
	}
}

788 
	$DMA2D_CİyBufãr
(
ušt32_t
 
Lay”Index
, *
pSrc
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLšeSrc
, ušt32_ˆ
OffLšeD¡
)

790 
ušt32_t
 
Pix–FÜm©
;

792 
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

793 
DMA2D
->
CR
 = 0x00000000UL | (1 << 9);

796 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pSrc
;

797 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

798 
DMA2D
->
FGOR
 = 
OffLšeSrc
;

799 
DMA2D
->
OOR
 = 
OffLšeD¡
;

802 
DMA2D
->
FGPFCCR
 = 
Pix–FÜm©
;

805 
DMA2D
->
NLR
 = (
ušt32_t
)(
xSize
 << 16è| (
U16
)
ySize
;

807 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

810 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

813 
	}
}

819 
	$DMA2D_FlBufãr
(
ušt32_t
 
Lay”Index
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLše
, ušt32_ˆ
CŞÜIndex
)

821 
ušt32_t
 
Pix–FÜm©
;

823 
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

826 
DMA2D
->
CR
 = 0x00030000UL | (1 << 9);

827 
DMA2D
->
OCOLR
 = 
CŞÜIndex
;

830 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

833 
DMA2D
->
OOR
 = 
OffLše
;

836 
DMA2D
->
OPFCCR
 = 
Pix–FÜm©
;

839 
DMA2D
->
NLR
 = (
ušt32_t
)(
xSize
 << 16è| (
U16
)
ySize
;

841 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

844 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

847 
	}
}

854 
ušt32_t
 
	$G‘BufãrSize
(
ušt32_t
 
Lay”Index
)

856 
ušt32_t
 
BufãrSize
;

858 
BufãrSize
 = 
Ïy”_´İ
[
Lay”Index
].
xSize
 *†ay”_´İ[Lay”Index].
ySize
 *†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

859  
BufãrSize
;

860 
	}
}

866 
	$CUSTOM_CİyBufãr
(
št32_t
 
Lay”Index
, iÁ32_ˆ
IndexSrc
, iÁ32_ˆ
IndexD¡
)

868 
ušt32_t
 
BufãrSize
, 
AddrSrc
, 
AddrD¡
;

870 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

871 
AddrSrc
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 * 
IndexSrc
;

872 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 * 
IndexD¡
;

873 
	`DMA2D_CİyBufãr
(
Lay”Index
, (*)
AddrSrc
, (*)
AddrD¡
, 
Ïy”_´İ
[Lay”Index].
xSize
,†ay”_´İ[Lay”Index].
ySize
, 0, 0);

874 
Ïy”_´İ
[
Lay”Index
].
bufãr_šdex
 = 
IndexD¡
;

875 
	}
}

892 
	$CUSTOM_CİyReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
)

894 
U32
 
AddrSrc
, 
AddrD¡
;

896 
AddrSrc
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + (
y0
 *†ay”_´İ[Lay”Index].
xSize
 + 
x0
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

897 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + (
y1
 *†ay”_´İ[Lay”Index].
xSize
 + 
x1
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

898 
	`DMA2D_CİyBufãr
(
Lay”Index
, (*)
AddrSrc
, (*)
AddrD¡
, 
xSize
, 
ySize
, 
Ïy”_´İ
[LayerIndex].xSize - xSize,†ayer_prop[LayerIndex].xSize - xSize);

899 
	}
}

905 
	$CUSTOM_FlReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, 
ušt32_t
 
Pix–Index
)

907 
ušt32_t
 
BufãrSize
, 
AddrD¡
;

908 
št32_t
 
xSize
, 
ySize
;

910 ià(
	`GUI_G‘D¿wMode
(è=ğ
GUI_DM_XOR
)

912 
	`LCD_S‘DevFunc
(
Lay”Index
, 
LCD_DEVFUNC_FILLRECT
, 
NULL
);

913 
	`LCD_FlReù
(
x0
, 
y0
, 
x1
, 
y1
);

914 
	`LCD_S‘DevFunc
(
Lay”Index
, 
LCD_DEVFUNC_FILLRECT
, ((*)())
CUSTOM_FlReù
);

918 
xSize
 = 
x1
 - 
x0
 + 1;

919 
ySize
 = 
y1
 - 
y0
 + 1;

920 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

921 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 *†ay”_´İ[Lay”Index].
bufãr_šdex
 + (
y0
 *†ay”_´İ[Lay”Index].
xSize
 + 
x0
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

922 
	`DMA2D_FlBufãr
(
Lay”Index
, (*)
AddrD¡
, 
xSize
, 
ySize
, 
Ïy”_´İ
[Lay”Index].xSiz- xSize, 
Pix–Index
);

924 
	}
}

932 
	$DMA2D_LßdLUT
(
LCD_COLOR
 *
pCŞÜ
, 
ušt32_t
 
NumI‹ms
)

934 
DMA2D
->
FGCMAR
 = (
ušt32_t
)
pCŞÜ
;

937 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_RGB888


938 | ((
NumI‹ms
 - 1) & 0xFF) << 8;

939 
DMA2D
->
FGPFCCR
 |= (1 << 5);

940 
	}
}

949 
	$Inv”tAÍha_Sw­RB
(
LCD_COLOR
 *
pCŞÜSrc
, LCD_COLOR *
pCŞÜD¡
, 
ušt32_t
 
NumI‹ms
)

951 
ušt32_t
 
CŞÜ
;

954 
CŞÜ
 = *
pCŞÜSrc
++;

955 *
pCŞÜD¡
++ = ((
CŞÜ
 & 0x000000FF) << 16)

956 | (
CŞÜ
 & 0x0000FF00)

957 | ((
CŞÜ
 & 0x00FF0000) >> 16)

958 | ((
CŞÜ
 & 0xFF000000) ^ 0xFF000000);

960 --
NumI‹ms
);

961 
	}
}

971 
	$Inv”tAÍha
(
LCD_COLOR
 *
pCŞÜSrc
, LCD_COLOR *
pCŞÜD¡
, 
ušt32_t
 
NumI‹ms
)

973 
ušt32_t
 
CŞÜ
;

977 
CŞÜ
 = *
pCŞÜSrc
++;

978 *
pCŞÜD¡
++ = 
CŞÜ
 ^ 0xFF000000;

980 --
NumI‹ms
);

981 
	}
}

991 
	$DMA2D_AÍhaBËndšgBulk
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
)

994 
DMA2D
->
CR
 = 0x00020000UL | (1 << 9);

997 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pCŞÜFG
;

998 
DMA2D
->
BGMAR
 = (
ušt32_t
)
pCŞÜBG
;

999 
DMA2D
->
OMAR
 = (
ušt32_t
)
pCŞÜD¡
;

1002 
DMA2D
->
FGOR
 = 0;

1003 
DMA2D
->
BGOR
 = 0;

1004 
DMA2D
->
OOR
 = 0;

1007 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1008 
DMA2D
->
BGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1009 
DMA2D
->
OPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1012 
DMA2D
->
NLR
 = (
ušt32_t
)(
NumI‹ms
 << 16) | 1;

1016 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1018 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1021 
	}
}

1023 #ià
defšed
 (
__GNUC__
)

1024 #´agm¨
GCC
 
İtimize
 ("O0")

1035 
LCD_COLOR
 
	$DMA2D_MixCŞÜs
(
LCD_COLOR
 
CŞÜ
, LCD_COLOR 
BkCŞÜ
, 
U8
 
IÁ’s
)

1037 
ušt32_t
 
CŞÜFG
, 
CŞÜBG
, 
CŞÜD¡
;

1039 ià((
BkCŞÜ
 & 0xFF000000) == 0xFF000000)

1041  
CŞÜ
;

1043 
CŞÜFG
 = 
CŞÜ
 ^ 0xFF000000;

1044 
CŞÜBG
 = 
BkCŞÜ
 ^ 0xFF000000;

1047 
DMA2D
->
CR
 = 0x00020000UL | (1 << 9);

1050 
DMA2D
->
FGMAR
 = (
ušt32_t
)&
CŞÜFG
;

1051 
DMA2D
->
BGMAR
 = (
ušt32_t
)&
CŞÜBG
;

1052 
DMA2D
->
OMAR
 = (
ušt32_t
)&
CŞÜD¡
;

1055 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1057 | ((
ušt32_t
)
IÁ’s
 << 24);

1058 
DMA2D
->
BGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1060 | ((
ušt32_t
)(255 - 
IÁ’s
) << 24);

1061 
DMA2D
->
OPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1064 
DMA2D
->
NLR
 = (
ušt32_t
)(1 << 16) | 1;

1067 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1070 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1074  (
CŞÜD¡
 ^ 0xFF000000);

1075 
	}
}

1086 
	$DMA2D_CÚv”tCŞÜ
(*
pSrc
, *
pD¡
, 
ušt32_t
 
Pix–FÜm©Src
, ušt32_ˆ
Pix–FÜm©D¡
, ušt32_ˆ
NumI‹ms
)

1090 
DMA2D
->
CR
 = 0x00010000UL | (1 << 9);

1093 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pSrc
;

1094 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

1097 
DMA2D
->
FGOR
 = 0;

1098 
DMA2D
->
OOR
 = 0;

1101 
DMA2D
->
FGPFCCR
 = 
Pix–FÜm©Src
;

1102 
DMA2D
->
OPFCCR
 = 
Pix–FÜm©D¡
;

1105 
DMA2D
->
NLR
 = (
ušt32_t
)(
NumI‹ms
 << 16) | 1;

1108 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1110 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1113 
	}
}

1125 
LCD_PIXELINDEX
 *
	$_LCD_G‘pP®CÚvTabË
(cÚ¡ 
LCD_LOGPALETTE
 
GUI_UNI_PTR
 *
pLogP®
, cÚ¡ 
GUI_BITMAP
 GUI_UNI_PTR *
pB™m­
, 
Lay”Index
)

1127 (* 
pFunc
)();

1128 
št32_t
 
DoDeçuÉ
 = 0;

1131 ià(
pB™m­
->
B™sP”Pix–
 == 8)

1133 
pFunc
 = 
	`LCD_G‘DevFunc
(
Lay”Index
, 
LCD_DEVFUNC_DRAWBMP_8BPP
);

1134 ià(
pFunc
)

1136 ià(
pB™m­
->
pP®
)

1138 ià(
pB™m­
->
pP®
->
HasT¿ns
)

1140 
DoDeçuÉ
 = 1;

1145 
DoDeçuÉ
 = 1;

1150 
DoDeçuÉ
 = 1;

1155 
DoDeçuÉ
 = 1;

1159 ià(
DoDeçuÉ
)

1163  
	`LCD_G‘pP®CÚvTabË
(
pLogP®
);

1167 
	`Inv”tAÍha_Sw­RB
((
U32
 *)
pLogP®
->
pP®EÁr›s
, 
aBufãrDMA2D
,…LogP®->
NumEÁr›s
);

1170 
	`DMA2D_LßdLUT
(
aBufãrDMA2D
, 
pLogP®
->
NumEÁr›s
);

1173  
aBufãrDMA2D
;

1174 
	}
}

1185 
	$DMA2D_MixCŞÜsBulk
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U8
 
IÁ’s
, 
ušt32_t
 
NumI‹ms
)

1188 
DMA2D
->
CR
 = 0x00020000UL | (1 << 9);

1191 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pCŞÜFG
;

1192 
DMA2D
->
BGMAR
 = (
ušt32_t
)
pCŞÜBG
;

1193 
DMA2D
->
OMAR
 = (
ušt32_t
)
pCŞÜD¡
;

1196 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1198 | ((
ušt32_t
)
IÁ’s
 << 24);

1199 
DMA2D
->
BGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1201 | ((
ušt32_t
)(255 - 
IÁ’s
) << 24);

1202 
DMA2D
->
OPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1205 
DMA2D
->
NLR
 = (
ušt32_t
)(
NumI‹ms
 << 16) | 1;

1208 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1210 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1213 
	}
}

1223 
	$DMA2D_AÍhaBËndšg
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
)

1226 
	`Inv”tAÍha
(
pCŞÜFG
, 
aBufãr_FG
, 
NumI‹ms
);

1227 
	`Inv”tAÍha
(
pCŞÜBG
, 
aBufãr_BG
, 
NumI‹ms
);

1230 
	`DMA2D_AÍhaBËndšgBulk
(
aBufãr_FG
, 
aBufãr_BG
, 
aBufãrDMA2D
, 
NumI‹ms
);

1233 
	`Inv”tAÍha
(
aBufãrDMA2D
, 
pCŞÜD¡
, 
NumI‹ms
);

1234 
	}
}

1248 
	$DMA2D_Index2CŞÜBulk
(*
pIndex
, 
LCD_COLOR
 *
pCŞÜ
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
)

1251 
	`DMA2D_CÚv”tCŞÜ
(
pIndex
, 
aBufãrDMA2D
, 
Pix–FÜm©
, 
LTDC_PIXEL_FORMAT_ARGB8888
, 
NumI‹ms
);

1254 
	`Inv”tAÍha_Sw­RB
(
aBufãrDMA2D
, 
pCŞÜ
, 
NumI‹ms
);

1255 
	}
}

1269 
	$DMA2D_CŞÜ2IndexBulk
(
LCD_COLOR
 *
pCŞÜ
, *
pIndex
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
)

1272 
	`Inv”tAÍha_Sw­RB
(
pCŞÜ
, 
aBufãrDMA2D
, 
NumI‹ms
);

1275 
	`DMA2D_CÚv”tCŞÜ
(
aBufãrDMA2D
, 
pIndex
, 
LTDC_PIXEL_FORMAT_ARGB8888
, 
Pix–FÜm©
, 
NumI‹ms
);

1276 
	}
}

1291 
	$LCD_MixCŞÜsBulk
(
U32
 *
pFG
, U32 *
pBG
, U32 *
pD¡
, 
OffFG
, 
OffBG
, 
OffDe¡
, 
xSize
, 
ySize
, 
U8
 
IÁ’s
)

1293 
št32_t
 
y
;

1295 
	`GUI_USE_PARA
(
OffFG
);

1296 
	`GUI_USE_PARA
(
OffDe¡
);

1297 
y
 = 0; y < 
ySize
; y++)

1300 
	`Inv”tAÍha
(
pFG
, 
aBufãr_FG
, 
xSize
);

1301 
	`Inv”tAÍha
(
pBG
, 
aBufãr_BG
, 
xSize
);

1303 
	`DMA2D_MixCŞÜsBulk
(
aBufãr_FG
, 
aBufãr_BG
, 
aBufãrDMA2D
, 
IÁ’s
, 
xSize
);

1305 
	`Inv”tAÍha
(
aBufãrDMA2D
, 
pD¡
, 
xSize
);

1306 
pFG
 +ğ
xSize
 + 
OffFG
;

1307 
pBG
 +ğ
xSize
 + 
OffBG
;

1308 
pD¡
 +ğ
xSize
 + 
OffDe¡
;

1310 
	}
}

1323 
	$DMA2D_D¿wB™m­L8
(*
pSrc
, *
pD¡
, 
ušt32_t
 
OffSrc
, ušt32_ˆ
OffD¡
, ušt32_ˆ
Pix–FÜm©D¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
)

1326 
DMA2D
->
CR
 = 0x00010000UL | (1 << 9);

1329 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pSrc
;

1330 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

1333 
DMA2D
->
FGOR
 = 
OffSrc
;

1334 
DMA2D
->
OOR
 = 
OffD¡
;

1337 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_L8
;

1338 
DMA2D
->
OPFCCR
 = 
Pix–FÜm©D¡
;

1341 
DMA2D
->
NLR
 = (
ušt32_t
)(
xSize
 << 16è| 
ySize
;

1344 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1347 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1350 
	}
}

1363 
	$BSP_LCD_D¿wB™m­16bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U16
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
)

1365 
ušt32_t
 
BufãrSize
, 
AddrD¡
;

1366 
št32_t
 
OffLšeSrc
, 
OffLšeD¡
;

1368 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

1369 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 *†ay”_´İ[Lay”Index].
bufãr_šdex
 + (
y
 *†ay”_´İ[Lay”Index].
xSize
 + 
x
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

1370 
OffLšeSrc
 = (
By‹sP”Lše
 / 2è- 
xSize
;

1371 
OffLšeD¡
 = 
Ïy”_´İ
[
Lay”Index
].
xSize
 - xSize;

1372 
	`DMA2D_CİyBufãr
(
Lay”Index
, (*)
p
, (*)
AddrD¡
, 
xSize
, 
ySize
, 
OffLšeSrc
, 
OffLšeD¡
);

1373 
	}
}

1386 
	$BSP_LCD_D¿wB™m­8bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U8
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
)

1388 
ušt32_t
 
BufãrSize
, 
AddrD¡
;

1389 
št32_t
 
OffLšeSrc
, 
OffLšeD¡
;

1390 
ušt32_t
 
Pix–FÜm©
;

1392 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

1393 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 *†ay”_´İ[Lay”Index].
bufãr_šdex
 + (
y
 *†ay”_´İ[Lay”Index].
xSize
 + 
x
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

1394 
OffLšeSrc
 = 
By‹sP”Lše
 - 
xSize
;

1395 
OffLšeD¡
 = 
Ïy”_´İ
[
Lay”Index
].
xSize
 - xSize;

1396 
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

1397 
	`DMA2D_D¿wB™m­L8
((*)
p
, (*)
AddrD¡
, 
OffLšeSrc
, 
OffLšeD¡
, 
Pix–FÜm©
, 
xSize
, 
ySize
);

1398 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\LCDConf_Lin_ATK_7016.c

49 
	~"šşudes.h
"

50 
	~"LCDCÚf.h
"

51 
	~"GUI_Priv©e.h
"

80 
	#XSIZE_PHYS
 1024

	)

81 
	#YSIZE_PHYS
 600

	)

83 
	#NUM_BUFFERS
 3

84 
	#NUM_VSCREENS
 1

85 

	)

86 
	#BK_COLOR
 
GUI_DARKBLUE


	)

88 #undeà
GUI_NUM_LAYERS


89 
	#GUI_NUM_LAYERS
 1

	)

91 
	#COLOR_CONVERSION_0
 
GUICC_M565


	)

92 
	#DISPLAY_DRIVER_0
 
GUIDRV_LIN_16


	)

94 #ià(
GUI_NUM_LAYERS
 > 1)

95 
	#COLOR_CONVERSION_1
 
GUICC_M1555I


	)

96 
	#DISPLAY_DRIVER_1
 
GUIDRV_LIN_16


	)

99 #iâdeà 
XSIZE_PHYS


100 #”rÜ 
Physiÿl
 
X
 
size
 
of
 
di¥Ïy
 
is
 
nÙ
 
defšed
!

102 #iâdeà 
YSIZE_PHYS


103 #”rÜ 
Physiÿl
 
Y
 
size
 
of
 
di¥Ïy
 
is
 
nÙ
 
defšed
!

105 #iâdeà 
NUM_VSCREENS


106 
	#NUM_VSCREENS
 1

	)

108 #ià(
NUM_VSCREENS
 <= 0)

109 #”rÜ 
At
 
Ëa¡
 
Úe
 
sü“’
 
Ãeds
 
to
 
be
 
defšed
!

112 #ià(
NUM_VSCREENS
 > 1è&& (
NUM_BUFFERS
 > 1)

113 #”rÜ 
Vœtu®
 
sü“ns
 
ªd
 
muÉË
 
bufãrs
 
¬e
 
nÙ
 
®lowed
!

116 
	#LCD_LAYER0_FRAME_BUFFER_SIZE
 (3*1024*1024)

	)

117 
	#LCD_LAYER1_FRAME_BUFFER_SIZE
 (3*1024*1024)

	)

119 
	#LCD_LAYER0_FRAME_BUFFER
 ((
ušt32_t
)0xC0000000)

120 
	#LCD_LAYER1_FRAME_BUFFER
 ((
ušt32_t
)0xC0300000)

121 

	)

123 
	#rccPLLSAIN
 396

	)

124 
	#rccPLLSAIR
 2

	)

125 
	#rccPLLSAIDivR
 
RCC_PLLSAIDIVR_4


	)

136 
	#DEFINEDMA2D_COLORCONVERSION
(
PFIX
, 
PIXELFORMAT
) \

137 
CŞÜ2IndexBulk_
##
PFIX
##
	`DMA2D
(
LCD_COLOR
 * 
pCŞÜ
, * 
pIndex
, 
U32
 
NumI‹ms
, 
U8
 
SizeOfIndex
) { \

138 
	`DMA2D_CŞÜ2IndexBulk
(
pCŞÜ
, 
pIndex
, 
NumI‹ms
, 
SizeOfIndex
, 
PIXELFORMAT
); \

140 
Index2CŞÜBulk_
##
PFIX
##
	`DMA2D
(* 
pIndex
, 
LCD_COLOR
 * 
pCŞÜ
, 
U32
 
NumI‹ms
, 
U8
 
SizeOfIndex
) { \

141 
	`DMA2D_Index2CŞÜBulk
(
pIndex
, 
pCŞÜ
, 
NumI‹ms
, 
SizeOfIndex
, 
PIXELFORMAT
); \

142 }

	)

152 
LTDC_HªdËTy³Def
 
	ghÉdc
;

153 
DMA2D_HªdËTy³Def
 
	ghdma2d
;

154 
LCD_Lay”PrİTy³def
 
	gÏy”_´İ
[
GUI_NUM_LAYERS
];

156 cÚ¡ 
LCD_API_COLOR_CONV
 *
	g­CŞÜCÚvAPI
[] =

158 
COLOR_CONVERSION_0
,

159 #ià
GUI_NUM_LAYERS
 > 1

160 
COLOR_CONVERSION_1
,

164 
U32
 
	gaBufãrDMA2D
 [
XSIZE_PHYS
 * (U32)];

165 
U32
 
	gaBufãr_FG
 [
XSIZE_PHYS
 * (U32)];

166 
U32
 
	gaBufãr_BG
 [
XSIZE_PHYS
 * (U32)];

176 
ušt32_t
 
LCD_LL_G‘Pix–fÜm©
(ušt32_ˆ
Lay”Index
);

177 
DMA2D_CİyBufãr
(
ušt32_t
 
Lay”Index
, *
pSrc
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLšeSrc
, ušt32_ˆ
OffLšeD¡
);

178 
DMA2D_FlBufãr
(
ušt32_t
 
Lay”Index
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLše
, ušt32_ˆ
CŞÜIndex
);

179 
LCD_LL_In™
();

180 
LCD_LL_Lay”In™
(
ušt32_t
 
Lay”Index
);

182 
CUSTOM_CİyBufãr
(
št32_t
 
Lay”Index
, iÁ32_ˆ
IndexSrc
, iÁ32_ˆ
IndexD¡
);

183 
CUSTOM_CİyReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
);

184 
CUSTOM_FlReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, 
ušt32_t
 
Pix–Index
);

186 
DMA2D_Index2CŞÜBulk
(*
pIndex
, 
LCD_COLOR
 *
pCŞÜ
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
);

187 
DMA2D_CŞÜ2IndexBulk
(
LCD_COLOR
 *
pCŞÜ
, *
pIndex
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
);

189 
BSP_LCD_D¿wB™m­8bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U8
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
);

190 
BSP_LCD_D¿wB™m­16bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U16
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
);

191 
DMA2D_AÍhaBËndšgBulk
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
);

192 
DMA2D_AÍhaBËndšg
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
);

193 
LCD_PIXELINDEX
 *
_LCD_G‘pP®CÚvTabË
(cÚ¡ 
LCD_LOGPALETTE
 
GUI_UNI_PTR
 *
pLogP®
, cÚ¡ 
GUI_BITMAP
 GUI_UNI_PTR *
pB™m­
, 
Lay”Index
);

194 
LCD_COLOR
 
DMA2D_MixCŞÜs
(LCD_COLOR 
CŞÜ
, LCD_COLOR 
BkCŞÜ
, 
U8
 
IÁ’s
);

195 
LCD_MixCŞÜsBulk
(
U32
 *
pFG
, U32 *
pBG
, U32 *
pD¡
, 
OffFG
, 
OffBG
, 
OffDe¡
, 
xSize
, 
ySize
, 
U8
 
IÁ’s
);

197 
	$DEFINEDMA2D_COLORCONVERSION
(
M8888I
, 
LTDC_PIXEL_FORMAT_ARGB8888
)

198 
	$DEFINEDMA2D_COLORCONVERSION
(
M888
, 
LTDC_PIXEL_FORMAT_ARGB8888
)

200 
	$DEFINEDMA2D_COLORCONVERSION
(
M1555I
, 
LTDC_PIXEL_FORMAT_ARGB1555
)

201 
	$DEFINEDMA2D_COLORCONVERSION
(
M4444I
, 
LTDC_PIXEL_FORMAT_ARGB4444
)

203 
ušt32_t
 
	`G‘BufãrSize
(ušt32_ˆ
Lay”Index
);

217 
	$LTDC_IRQHªdËr
()

219 
	`HAL_LTDC_IRQHªdËr
(&
hÉdc
);

220 
	}
}

222 
	$LCD_BackLight
(
OnOff
)

224 if(
OnOff
 == 1)

226 
	`HAL_GPIO_Wr™ePš
(
GPIOB
, 
GPIO_PIN_5
, 
GPIO_PIN_SET
);

228 if(
OnOff
 == 0)

230 
	`HAL_GPIO_Wr™ePš
(
GPIOB
, 
GPIO_PIN_5
, 
GPIO_PIN_RESET
);

232 
	}
}

243 
	$HAL_DMA2D_M¥In™
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

246 
	`__HAL_RCC_DMA2D_CLK_ENABLE
();

247 
	}
}

256 
	$HAL_DMA2D_M¥DeIn™
(
DMA2D_HªdËTy³Def
 *
hdma2d
)

259 
	`__HAL_RCC_DMA2D_FORCE_RESET
();

262 
	`__HAL_RCC_DMA2D_RELEASE_RESET
();

263 
	}
}

273 
	$HAL_LTDC_M¥In™
(
LTDC_HªdËTy³Def
 *
hÉdc
)

275 
GPIO_In™Ty³Def
 
GPIO_In™_SŒuùu»
;

279 
	`__HAL_RCC_LTDC_CLK_ENABLE
();

282 
	`__HAL_RCC_GPIOB_CLK_ENABLE
();

283 
	`__HAL_RCC_GPIOF_CLK_ENABLE
();

284 
	`__HAL_RCC_GPIOG_CLK_ENABLE
();

285 
	`__HAL_RCC_GPIOH_CLK_ENABLE
();

286 
	`__HAL_RCC_GPIOI_CLK_ENABLE
();

304 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_5
;

305 
GPIO_In™_SŒuùu»
.
Mode
 = 
GPIO_MODE_OUTPUT_PP
;

306 
GPIO_In™_SŒuùu»
.
PuÎ
 = 
GPIO_PULLUP
;

307 
GPIO_In™_SŒuùu»
.
S³ed
 = 
GPIO_SPEED_HIGH
;

308 
	`HAL_GPIO_In™
(
GPIOB
, &
GPIO_In™_SŒuùu»
);

311 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_10
;

312 
GPIO_In™_SŒuùu»
.
Mode
 = 
GPIO_MODE_AF_PP
;

313 
GPIO_In™_SŒuùu»
.
PuÎ
 = 
GPIO_NOPULL
;

314 
GPIO_In™_SŒuùu»
.
S³ed
 = 
GPIO_SPEED_HIGH
;

315 
GPIO_In™_SŒuùu»
.
AÉ”Ç‹
 = 
GPIO_AF14_LTDC
;

316 
	`HAL_GPIO_In™
(
GPIOF
, &
GPIO_In™_SŒuùu»
);

319 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_6
 | 
GPIO_PIN_7
 | 
GPIO_PIN_11
;

320 
	`HAL_GPIO_In™
(
GPIOG
, &
GPIO_In™_SŒuùu»
);

323 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_9
 | 
GPIO_PIN_10
 | 
GPIO_PIN_11
 | \

324 
GPIO_PIN_12
 | 
GPIO_PIN_13
 | 
GPIO_PIN_14
 | 
GPIO_PIN_15
;

325 
	`HAL_GPIO_In™
(
GPIOH
, &
GPIO_In™_SŒuùu»
);

328 
GPIO_In™_SŒuùu»
.
Pš
 = 
GPIO_PIN_0
 | 
GPIO_PIN_1
 | 
GPIO_PIN_2
 | 
GPIO_PIN_4
 | 
GPIO_PIN_5
 | \

329 
GPIO_PIN_6
 | 
GPIO_PIN_7
 | 
GPIO_PIN_9
 | 
GPIO_PIN_10
;

330 
	`HAL_GPIO_In™
(
GPIOI
, &
GPIO_In™_SŒuùu»
);

333 
	`HAL_NVIC_S‘PriÜ™y
(
LTDC_IRQn
, 
b¥LTDC_P»em±PriÜ™y
, 
b¥LTDC_SubPriÜ™y
);

336 
	`HAL_NVIC_EÇbËIRQ
(
LTDC_IRQn
);

339 
	`LCD_BackLight
(1);

340 
	}
}

349 
	$HAL_LTDC_M¥DeIn™
(
LTDC_HªdËTy³Def
 *
hÉdc
)

353 
	`__HAL_RCC_LTDC_FORCE_RESET
();

356 
	`__HAL_RCC_LTDC_RELEASE_RESET
();

357 
	}
}

365 
	$HAL_LTDC_LšeEv’C®lback
(
LTDC_HªdËTy³Def
 *
hÉdc
)

367 
ušt32_t
 
Addr
;

368 
ušt32_t
 
Ïy”
;

370 
Ïy”
 = 0;†ay” < 
GUI_NUM_LAYERS
;†ayer++)

372 ià(
Ïy”_´İ
[
Ïy”
].
³ndšg_bufãr
 >= 0)

375 
Addr
 = 
Ïy”_´İ
[
Ïy”
].
add»ss
 +†ay”_´İ[Ïy”].
xSize
 *†ay”_´İ[Ïy”].
ySize
 *†ay”_´İ[Ïy”].
³ndšg_bufãr
 *†ay”_´İ[Ïy”].
By‹sP”Pix–
;

376 
	`HAL_LTDC_S‘Add»ss
(
hÉdc
, 
Addr
, 
Ïy”
);

378 
	`__HAL_LTDC_RELOAD_CONFIG
(
hÉdc
);

381 
	`GUI_MULTIBUF_CÚfœmEx
(
Ïy”
, 
Ïy”_´İ
[Ïy”].
³ndšg_bufãr
);

384 
Ïy”_´İ
[
Ïy”
].
³ndšg_bufãr
 = -1;

388 
	`HAL_LTDC_Prog¿mLšeEv’t
(
hÉdc
, 0);

389 
	}
}

400 
	$LCD_X_CÚfig
()

402 
ušt32_t
 
i
;

404 
	`LCD_LL_In™
();

407 #ià(
NUM_BUFFERS
 > 1)

408 
i
 = 0; i < 
GUI_NUM_LAYERS
; i++)

410 
	`GUI_MULTIBUF_CÚfigEx
(
i
, 
NUM_BUFFERS
);

415 
	`GUI_DEVICE_C»©eAndLšk
(
DISPLAY_DRIVER_0
, 
COLOR_CONVERSION_0
, 0, 0);

418 ià(
	`LCD_G‘Sw­XYEx
(0))

420 
	`LCD_S‘SizeEx
 (0, 
YSIZE_PHYS
, 
XSIZE_PHYS
);

421 
	`LCD_S‘VSizeEx
(0, 
YSIZE_PHYS
 * 
NUM_VSCREENS
, 
XSIZE_PHYS
);

425 
	`LCD_S‘SizeEx
 (0, 
XSIZE_PHYS
, 
YSIZE_PHYS
);

426 
	`LCD_S‘VSizeEx
(0, 
XSIZE_PHYS
, 
YSIZE_PHYS
 * 
NUM_VSCREENS
);

429 #ià(
GUI_NUM_LAYERS
 > 1)

431 
	`GUI_DEVICE_C»©eAndLšk
(
DISPLAY_DRIVER_1
, 
COLOR_CONVERSION_1
, 0, 1);

433 ià(
	`LCD_G‘Sw­XYEx
(1))

435 
	`LCD_S‘SizeEx
 (1, 
YSIZE_PHYS
, 
XSIZE_PHYS
);

436 
	`LCD_S‘VSizeEx
(1, 
YSIZE_PHYS
 * 
NUM_VSCREENS
, 
XSIZE_PHYS
);

440 
	`LCD_S‘SizeEx
 (1, 
XSIZE_PHYS
, 
YSIZE_PHYS
);

441 
	`LCD_S‘VSizeEx
(1, 
XSIZE_PHYS
, 
YSIZE_PHYS
 * 
NUM_VSCREENS
);

446 
Ïy”_´İ
[0].
add»ss
 = 
LCD_LAYER0_FRAME_BUFFER
;

447 #ià(
GUI_NUM_LAYERS
 > 1)

448 
Ïy”_´İ
[1].
add»ss
 = 
LCD_LAYER1_FRAME_BUFFER
;

452 
i
 = 0; i < 
GUI_NUM_LAYERS
; i++)

454 
Ïy”_´İ
[
i
].
pCŞÜCÚvAPI
 = (
LCD_API_COLOR_CONV
 *)
­CŞÜCÚvAPI
[i];

456 
Ïy”_´İ
[
i
].
³ndšg_bufãr
 = -1;

459 
	`LCD_S‘VRAMAddrEx
(
i
, (*)(
Ïy”_´İ
[i].
add»ss
));

462 
Ïy”_´İ
[
i
].
By‹sP”Pix–
 = 
	`LCD_G‘B™sP”Pix–Ex
(i) >> 3;

465 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_COPYBUFFER
, ((*)())
CUSTOM_CİyBufãr
);

466 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_COPYRECT
, ((*)())
CUSTOM_CİyReù
);

469 ià(
	`LCD_LL_G‘Pix–fÜm©
(
i
è<ğ
LTDC_PIXEL_FORMAT_ARGB4444
)

471 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_FILLRECT
, ((*)())
CUSTOM_FlReù
);

472 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_DRAWBMP_8BPP
, ((*)())
BSP_LCD_D¿wB™m­8bµ
);

476 ià(
	`LCD_LL_G‘Pix–fÜm©
(
i
è=ğ
LTDC_PIXEL_FORMAT_RGB565
)

478 
	`LCD_S‘DevFunc
(
i
, 
LCD_DEVFUNC_DRAWBMP_16BPP
, ((*)())
BSP_LCD_D¿wB™m­16bµ
);

482 
	`GUICC_M1555I_S‘Cu¡CŞÜCÚv
(
CŞÜ2IndexBulk_M1555IDMA2D
, 
Index2CŞÜBulk_M1555IDMA2D
);

484 
	`GUICC_M4444I_S‘Cu¡CŞÜCÚv
(
CŞÜ2IndexBulk_M4444IDMA2D
, 
Index2CŞÜBulk_M4444IDMA2D
);

485 
	`GUICC_M888_S‘Cu¡CŞÜCÚv
 (
CŞÜ2IndexBulk_M888DMA2D
, 
Index2CŞÜBulk_M888DMA2D
);

486 
	`GUICC_M8888I_S‘Cu¡CŞÜCÚv
(
CŞÜ2IndexBulk_M8888IDMA2D
, 
Index2CŞÜBulk_M8888IDMA2D
);

489 
	`GUI_S‘FuncAÍhaBËndšg
(
DMA2D_AÍhaBËndšg
);

493 
	`GUI_S‘FuncG‘pP®CÚvTabË
(
_LCD_G‘pP®CÚvTabË
);

496 
	`GUI_S‘FuncMixCŞÜs
(
DMA2D_MixCŞÜs
);

499 
	`GUI_S‘FuncMixCŞÜsBulk
(
LCD_MixCŞÜsBulk
);

501 
	}
}

514 
	$LCD_X_Di¥ÏyDriv”
(
Lay”Index
, 
Cmd
, *
pD©a
)

516 
št32_t
 
r
 = 0;

517 
ušt32_t
 
addr
;

518 
št32_t
 
xPos
, 
yPos
;

519 
ušt32_t
 
CŞÜ
;

521 
Cmd
)

523 
LCD_X_INITCONTROLLER
:

524 
	`LCD_LL_Lay”In™
(
Lay”Index
);

527 
LCD_X_SETORG
:

528 
addr
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + ((
LCD_X_SETORG_INFO
 *)
pD©a
)->
yPos
 *†ay”_´İ[Lay”Index].
xSize
 *†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

529 
	`HAL_LTDC_S‘Add»ss
(&
hÉdc
, 
addr
, 
Lay”Index
);

532 
LCD_X_SHOWBUFFER
:

533 
Ïy”_´İ
[
Lay”Index
].
³ndšg_bufãr
 = ((
LCD_X_SHOWBUFFER_INFO
 *)
pD©a
)->
Index
;

536 
LCD_X_SETLUTENTRY
:

537 
	`HAL_LTDC_CÚfigCLUT
(&
hÉdc
, (
ušt32_t
 *è& (((
LCD_X_SETLUTENTRY_INFO
 *)
pD©a
)->
CŞÜ
), 1, 
Lay”Index
);

540 
LCD_X_ON
:

541 
	`__HAL_LTDC_ENABLE
(&
hÉdc
);

544 
LCD_X_OFF
:

545 
	`__HAL_LTDC_DISABLE
(&
hÉdc
);

548 
LCD_X_SETVIS
:

549 if(((
LCD_X_SETVIS_INFO
 *)
pD©a
)->
OnOff
 =ğ
ENABLE
 )

551 
	`__HAL_LTDC_LAYER_ENABLE
(&
hÉdc
, 
Lay”Index
);

555 
	`__HAL_LTDC_LAYER_DISABLE
(&
hÉdc
, 
Lay”Index
);

557 
	`__HAL_LTDC_RELOAD_CONFIG
(&
hÉdc
);

560 
LCD_X_SETPOS
:

561 
	`HAL_LTDC_S‘WšdowPos™iÚ
(&
hÉdc
,

562 ((
LCD_X_SETPOS_INFO
 *)
pD©a
)->
xPos
,

563 ((
LCD_X_SETPOS_INFO
 *)
pD©a
)->
yPos
,

564 
Lay”Index
);

567 
LCD_X_SETSIZE
:

568 
	`GUI_G‘Lay”PosEx
(
Lay”Index
, (*)&
xPos
, (*)&
yPos
);

569 
Ïy”_´İ
[
Lay”Index
].
xSize
 = ((
LCD_X_SETSIZE_INFO
 *)
pD©a
)->xSize;

570 
Ïy”_´İ
[
Lay”Index
].
ySize
 = ((
LCD_X_SETSIZE_INFO
 *)
pD©a
)->ySize;

571 
	`HAL_LTDC_S‘WšdowPos™iÚ
(&
hÉdc
, 
xPos
, 
yPos
, 
Lay”Index
);

574 
LCD_X_SETALPHA
:

575 
	`HAL_LTDC_S‘AÍha
(&
hÉdc
, ((
LCD_X_SETALPHA_INFO
 *)
pD©a
)->
AÍha
, 
Lay”Index
);

578 
LCD_X_SETCHROMAMODE
:

579 if(((
LCD_X_SETCHROMAMODE_INFO
 *)
pD©a
)->
ChromaMode
 != 0)

581 
	`HAL_LTDC_EÇbËCŞÜKeyšg
(&
hÉdc
, 
Lay”Index
);

585 
	`HAL_LTDC_Di§bËCŞÜKeyšg
(&
hÉdc
, 
Lay”Index
);

589 
LCD_X_SETCHROMA
:

591 
CŞÜ
 = ((((
LCD_X_SETCHROMA_INFO
 *)
pD©a
)->
ChromaMš
 & 0xFF0000) >> 16) | \

592 (((
LCD_X_SETCHROMA_INFO
 *)
pD©a
)->
ChromaMš
 & 0x00FF00) | \

593 ((((
LCD_X_SETCHROMA_INFO
 *)
pD©a
)->
ChromaMš
 & 0x0000FF) << 16);

595 
	`HAL_LTDC_CÚfigCŞÜKeyšg
(&
hÉdc
, 
CŞÜ
, 
Lay”Index
);

599 
r
 = -1;

601  
r
;

602 
	}
}

612 
	$LCD_LL_Lay”In™
(
ušt32_t
 
Lay”Index
)

614 
ušt32_t
 
i
;

615 
ušt32_t
 
LUT
[256];

616 
LTDC_Lay”CfgTy³Def
 
Ïy”_cfg
;

618 ià(
Lay”Index
 < 
GUI_NUM_LAYERS
)

621 
Ïy”_cfg
.
WšdowX0
 = 0;

622 
Ïy”_cfg
.
WšdowX1
 = 
XSIZE_PHYS
;

623 
Ïy”_cfg
.
WšdowY0
 = 0;

624 
Ïy”_cfg
.
WšdowY1
 = 
YSIZE_PHYS
;

625 
Ïy”_cfg
.
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

626 
Ïy”_cfg
.
FBS¹Ad»ss
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
;

627 
Ïy”_cfg
.
AÍha
 = 255;

628 
Ïy”_cfg
.
AÍha0
 = 0;

629 
Ïy”_cfg
.
BackcŞÜ
.
Blue
 = 0;

630 
Ïy”_cfg
.
BackcŞÜ
.
G»’
 = 0;

631 
Ïy”_cfg
.
BackcŞÜ
.
Red
 = 0;

632 
Ïy”_cfg
.
BËndšgFaùÜ1
 = 
LTDC_BLENDING_FACTOR1_PAxCA
;

633 
Ïy”_cfg
.
BËndšgFaùÜ2
 = 
LTDC_BLENDING_FACTOR2_PAxCA
;

634 
Ïy”_cfg
.
ImageWidth
 = 
XSIZE_PHYS
;

635 
Ïy”_cfg
.
ImageHeight
 = 
YSIZE_PHYS
;

636 
	`HAL_LTDC_CÚfigLay”
(&
hÉdc
, &
Ïy”_cfg
, 
Lay”Index
);

639 ià(
	`LCD_G‘B™sP”Pix–Ex
(
Lay”Index
) <= 8)

642 
	`HAL_LTDC_EÇbËCLUT
(&
hÉdc
, 
Lay”Index
);

647 ià(
Ïy”_´İ
[
Lay”Index
].
pCŞÜCÚvAPI
 =ğ
GUICC_88666I
)

649 
	`HAL_LTDC_EÇbËCLUT
(&
hÉdc
, 
Lay”Index
);

651 
i
 = 0; i < 256; i++)

653 
LUT
[
i
] = 
LCD_API_CŞÜCÚv_8666
.
	`pfIndex2CŞÜ
(i);

655 
	`HAL_LTDC_CÚfigCLUT
(&
hÉdc
, 
LUT
, 256, 
Lay”Index
);

659 
	}
}

666 
	$LCD_LL_In™
()

668 
_Édc_dev
 
lcdÉdc
;

669 
RCC_P”hCLKIn™Ty³Def
 
P”hClkIn™SŒuù
;

671 
lcdÉdc
.
pwidth
 = 
XSIZE_PHYS
;

672 
lcdÉdc
.
pheight
 = 
YSIZE_PHYS
;

673 
lcdÉdc
.
hsw
 = 20;

674 
lcdÉdc
.
vsw
 = 3;

675 
lcdÉdc
.
hbp
 = 140;

676 
lcdÉdc
.
vbp
 = 20;

677 
lcdÉdc
.
hå
 = 160;

678 
lcdÉdc
.
vå
 = 12;

681 
	`HAL_LTDC_DeIn™
(&
hÉdc
);

684 
hÉdc
.
In™
.
HÜizÚlSync
 = 
lcdÉdc
.
hsw
 - 1;

685 
hÉdc
.
In™
.
V”tiÿlSync
 = 
lcdÉdc
.
vsw
 - 1;

686 
hÉdc
.
In™
.
AccumuÏ‹dHBP
 = 
lcdÉdc
.
hsw
 +†cdÉdc.
hbp
 - 1;

687 
hÉdc
.
In™
.
AccumuÏ‹dVBP
 = 
lcdÉdc
.
vsw
 +†cdÉdc.
vbp
 - 1;

688 
hÉdc
.
In™
.
AccumuÏ‹dAùiveW
 = 
lcdÉdc
.
hsw
 +†cdÉdc.
hbp
 +†cdÉdc.
pwidth
 - 1;

689 
hÉdc
.
In™
.
AccumuÏ‹dAùiveH
 = 
lcdÉdc
.
vsw
 +†cdÉdc.
vbp
 +†cdÉdc.
pheight
 - 1;

690 
hÉdc
.
In™
.
TÙ®Width
 = 
lcdÉdc
.
hsw
 +†cdÉdc.
hbp
 +†cdÉdc.
pwidth
 +†cdÉdc.
hå
 - 1;

691 
hÉdc
.
In™
.
TÙ®Heigh
 = 
lcdÉdc
.
vsw
 +†cdÉdc.
vbp
 +†cdÉdc.
pheight
 +†cdÉdc.
vå
 - 1;

695 
hÉdc
.
In™
.
BackcŞÜ
.
Blue
 = 0;

696 
hÉdc
.
In™
.
BackcŞÜ
.
G»’
 = 0;

697 
hÉdc
.
In™
.
BackcŞÜ
.
Red
 = 0;

704 
P”hClkIn™SŒuù
.
P”hClockS–eùiÚ
 = 
RCC_PERIPHCLK_LTDC
;

705 
P”hClkIn™SŒuù
.
PLLSAI
.
PLLSAIN
 = 396;

706 
P”hClkIn™SŒuù
.
PLLSAI
.
PLLSAIR
 = 2;

707 
P”hClkIn™SŒuù
.
PLLSAIDivR
 = 
RCC_PLLSAIDIVR_4
;

708 
	`HAL_RCCEx_P”hCLKCÚfig
(&
P”hClkIn™SŒuù
);

711 
hÉdc
.
In™
.
HSPŞ¬™y
 = 
LTDC_HSPOLARITY_AL
;

712 
hÉdc
.
In™
.
VSPŞ¬™y
 = 
LTDC_VSPOLARITY_AL
;

713 
hÉdc
.
In™
.
DEPŞ¬™y
 = 
LTDC_DEPOLARITY_AL
;

714 
hÉdc
.
In™
.
PCPŞ¬™y
 = 
LTDC_PCPOLARITY_IPC
;

715 
hÉdc
.
In¡ªû
 = 
LTDC
;

717 
	`HAL_LTDC_In™
(&
hÉdc
);

718 
	`HAL_LTDC_Prog¿mLšeEv’t
(&
hÉdc
, 0);

721 
hdma2d
.
In™
.
Mode
 = 
DMA2D_R2M
;

722 
hdma2d
.
In™
.
CŞÜMode
 = 
DMA2D_RGB565
;

723 
hdma2d
.
In™
.
OuutOff£t
 = 0x0;

725 
hdma2d
.
In¡ªû
 = 
DMA2D
;

727 if(
	`HAL_DMA2D_In™
(&
hdma2d
è!ğ
HAL_OK
)

731 
	}
}

738 
ušt32_t
 
	$LCD_LL_G‘Pix–fÜm©
(
ušt32_t
 
Lay”Index
)

740 cÚ¡ 
LCD_API_COLOR_CONV
 *
pCŞÜCÚvAPI
;

742 ià(
Lay”Index
 >ğ
GUI_NUM_LAYERS
)

746 
pCŞÜCÚvAPI
 = 
Ïy”_´İ
[
Lay”Index
].pColorConvAPI;

748 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M8888I
)

750  
LTDC_PIXEL_FORMAT_ARGB8888
;

752 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M888
)

754  
LTDC_PIXEL_FORMAT_RGB888
;

756 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M565
)

758  
LTDC_PIXEL_FORMAT_RGB565
;

760 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M1555I
)

762  
LTDC_PIXEL_FORMAT_ARGB1555
;

764 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_M4444I
)

766  
LTDC_PIXEL_FORMAT_ARGB4444
;

768 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_8666
)

770  
LTDC_PIXEL_FORMAT_L8
;

772 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_1616I
)

774  
LTDC_PIXEL_FORMAT_AL44
;

776 ià(
pCŞÜCÚvAPI
 =ğ
GUICC_88666I
)

778  
LTDC_PIXEL_FORMAT_AL88
;

781 
	}
}

787 
	$DMA2D_CİyBufãr
(
ušt32_t
 
Lay”Index
, *
pSrc
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLšeSrc
, ušt32_ˆ
OffLšeD¡
)

789 
ušt32_t
 
Pix–FÜm©
;

791 
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

792 
DMA2D
->
CR
 = 0x00000000UL | (1 << 9);

795 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pSrc
;

796 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

797 
DMA2D
->
FGOR
 = 
OffLšeSrc
;

798 
DMA2D
->
OOR
 = 
OffLšeD¡
;

801 
DMA2D
->
FGPFCCR
 = 
Pix–FÜm©
;

804 
DMA2D
->
NLR
 = (
ušt32_t
)(
xSize
 << 16è| (
U16
)
ySize
;

806 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

809 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

812 
	}
}

818 
	$DMA2D_FlBufãr
(
ušt32_t
 
Lay”Index
, *
pD¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
, ušt32_ˆ
OffLše
, ušt32_ˆ
CŞÜIndex
)

820 
ušt32_t
 
Pix–FÜm©
;

822 
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

825 
DMA2D
->
CR
 = 0x00030000UL | (1 << 9);

826 
DMA2D
->
OCOLR
 = 
CŞÜIndex
;

829 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

832 
DMA2D
->
OOR
 = 
OffLše
;

835 
DMA2D
->
OPFCCR
 = 
Pix–FÜm©
;

838 
DMA2D
->
NLR
 = (
ušt32_t
)(
xSize
 << 16è| (
U16
)
ySize
;

840 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

843 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

846 
	}
}

853 
ušt32_t
 
	$G‘BufãrSize
(
ušt32_t
 
Lay”Index
)

855 
ušt32_t
 
BufãrSize
;

857 
BufãrSize
 = 
Ïy”_´İ
[
Lay”Index
].
xSize
 *†ay”_´İ[Lay”Index].
ySize
 *†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

858  
BufãrSize
;

859 
	}
}

865 
	$CUSTOM_CİyBufãr
(
št32_t
 
Lay”Index
, iÁ32_ˆ
IndexSrc
, iÁ32_ˆ
IndexD¡
)

867 
ušt32_t
 
BufãrSize
, 
AddrSrc
, 
AddrD¡
;

869 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

870 
AddrSrc
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 * 
IndexSrc
;

871 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 * 
IndexD¡
;

872 
	`DMA2D_CİyBufãr
(
Lay”Index
, (*)
AddrSrc
, (*)
AddrD¡
, 
Ïy”_´İ
[Lay”Index].
xSize
,†ay”_´İ[Lay”Index].
ySize
, 0, 0);

873 
Ïy”_´İ
[
Lay”Index
].
bufãr_šdex
 = 
IndexD¡
;

874 
	}
}

891 
	$CUSTOM_CİyReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
)

893 
U32
 
AddrSrc
, 
AddrD¡
;

895 
AddrSrc
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + (
y0
 *†ay”_´İ[Lay”Index].
xSize
 + 
x0
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

896 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + (
y1
 *†ay”_´İ[Lay”Index].
xSize
 + 
x1
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

897 
	`DMA2D_CİyBufãr
(
Lay”Index
, (*)
AddrSrc
, (*)
AddrD¡
, 
xSize
, 
ySize
, 
Ïy”_´İ
[LayerIndex].xSize - xSize,†ayer_prop[LayerIndex].xSize - xSize);

898 
	}
}

904 
	$CUSTOM_FlReù
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x0
, iÁ32_ˆ
y0
, iÁ32_ˆ
x1
, iÁ32_ˆ
y1
, 
ušt32_t
 
Pix–Index
)

906 
ušt32_t
 
BufãrSize
, 
AddrD¡
;

907 
št32_t
 
xSize
, 
ySize
;

909 ià(
	`GUI_G‘D¿wMode
(è=ğ
GUI_DM_XOR
)

911 
	`LCD_S‘DevFunc
(
Lay”Index
, 
LCD_DEVFUNC_FILLRECT
, 
NULL
);

912 
	`LCD_FlReù
(
x0
, 
y0
, 
x1
, 
y1
);

913 
	`LCD_S‘DevFunc
(
Lay”Index
, 
LCD_DEVFUNC_FILLRECT
, ((*)())
CUSTOM_FlReù
);

917 
xSize
 = 
x1
 - 
x0
 + 1;

918 
ySize
 = 
y1
 - 
y0
 + 1;

919 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

920 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 *†ay”_´İ[Lay”Index].
bufãr_šdex
 + (
y0
 *†ay”_´İ[Lay”Index].
xSize
 + 
x0
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

921 
	`DMA2D_FlBufãr
(
Lay”Index
, (*)
AddrD¡
, 
xSize
, 
ySize
, 
Ïy”_´İ
[Lay”Index].xSiz- xSize, 
Pix–Index
);

923 
	}
}

931 
	$DMA2D_LßdLUT
(
LCD_COLOR
 *
pCŞÜ
, 
ušt32_t
 
NumI‹ms
)

933 
DMA2D
->
FGCMAR
 = (
ušt32_t
)
pCŞÜ
;

936 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_RGB888


937 | ((
NumI‹ms
 - 1) & 0xFF) << 8;

938 
DMA2D
->
FGPFCCR
 |= (1 << 5);

939 
	}
}

948 
	$Inv”tAÍha_Sw­RB
(
LCD_COLOR
 *
pCŞÜSrc
, LCD_COLOR *
pCŞÜD¡
, 
ušt32_t
 
NumI‹ms
)

950 
ušt32_t
 
CŞÜ
;

953 
CŞÜ
 = *
pCŞÜSrc
++;

954 *
pCŞÜD¡
++ = ((
CŞÜ
 & 0x000000FF) << 16)

955 | (
CŞÜ
 & 0x0000FF00)

956 | ((
CŞÜ
 & 0x00FF0000) >> 16)

957 | ((
CŞÜ
 & 0xFF000000) ^ 0xFF000000);

959 --
NumI‹ms
);

960 
	}
}

970 
	$Inv”tAÍha
(
LCD_COLOR
 *
pCŞÜSrc
, LCD_COLOR *
pCŞÜD¡
, 
ušt32_t
 
NumI‹ms
)

972 
ušt32_t
 
CŞÜ
;

976 
CŞÜ
 = *
pCŞÜSrc
++;

977 *
pCŞÜD¡
++ = 
CŞÜ
 ^ 0xFF000000;

979 --
NumI‹ms
);

980 
	}
}

990 
	$DMA2D_AÍhaBËndšgBulk
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
)

993 
DMA2D
->
CR
 = 0x00020000UL | (1 << 9);

996 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pCŞÜFG
;

997 
DMA2D
->
BGMAR
 = (
ušt32_t
)
pCŞÜBG
;

998 
DMA2D
->
OMAR
 = (
ušt32_t
)
pCŞÜD¡
;

1001 
DMA2D
->
FGOR
 = 0;

1002 
DMA2D
->
BGOR
 = 0;

1003 
DMA2D
->
OOR
 = 0;

1006 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1007 
DMA2D
->
BGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1008 
DMA2D
->
OPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1011 
DMA2D
->
NLR
 = (
ušt32_t
)(
NumI‹ms
 << 16) | 1;

1015 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1017 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1020 
	}
}

1022 #ià
defšed
 (
__GNUC__
)

1023 #´agm¨
GCC
 
İtimize
 ("O0")

1034 
LCD_COLOR
 
	$DMA2D_MixCŞÜs
(
LCD_COLOR
 
CŞÜ
, LCD_COLOR 
BkCŞÜ
, 
U8
 
IÁ’s
)

1036 
ušt32_t
 
CŞÜFG
, 
CŞÜBG
, 
CŞÜD¡
;

1038 ià((
BkCŞÜ
 & 0xFF000000) == 0xFF000000)

1040  
CŞÜ
;

1042 
CŞÜFG
 = 
CŞÜ
 ^ 0xFF000000;

1043 
CŞÜBG
 = 
BkCŞÜ
 ^ 0xFF000000;

1046 
DMA2D
->
CR
 = 0x00020000UL | (1 << 9);

1049 
DMA2D
->
FGMAR
 = (
ušt32_t
)&
CŞÜFG
;

1050 
DMA2D
->
BGMAR
 = (
ušt32_t
)&
CŞÜBG
;

1051 
DMA2D
->
OMAR
 = (
ušt32_t
)&
CŞÜD¡
;

1054 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1056 | ((
ušt32_t
)
IÁ’s
 << 24);

1057 
DMA2D
->
BGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1059 | ((
ušt32_t
)(255 - 
IÁ’s
) << 24);

1060 
DMA2D
->
OPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1063 
DMA2D
->
NLR
 = (
ušt32_t
)(1 << 16) | 1;

1066 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1069 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1073  (
CŞÜD¡
 ^ 0xFF000000);

1074 
	}
}

1085 
	$DMA2D_CÚv”tCŞÜ
(*
pSrc
, *
pD¡
, 
ušt32_t
 
Pix–FÜm©Src
, ušt32_ˆ
Pix–FÜm©D¡
, ušt32_ˆ
NumI‹ms
)

1089 
DMA2D
->
CR
 = 0x00010000UL | (1 << 9);

1092 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pSrc
;

1093 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

1096 
DMA2D
->
FGOR
 = 0;

1097 
DMA2D
->
OOR
 = 0;

1100 
DMA2D
->
FGPFCCR
 = 
Pix–FÜm©Src
;

1101 
DMA2D
->
OPFCCR
 = 
Pix–FÜm©D¡
;

1104 
DMA2D
->
NLR
 = (
ušt32_t
)(
NumI‹ms
 << 16) | 1;

1107 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1109 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1112 
	}
}

1124 
LCD_PIXELINDEX
 *
	$_LCD_G‘pP®CÚvTabË
(cÚ¡ 
LCD_LOGPALETTE
 
GUI_UNI_PTR
 *
pLogP®
, cÚ¡ 
GUI_BITMAP
 GUI_UNI_PTR *
pB™m­
, 
Lay”Index
)

1126 (* 
pFunc
)();

1127 
št32_t
 
DoDeçuÉ
 = 0;

1130 ià(
pB™m­
->
B™sP”Pix–
 == 8)

1132 
pFunc
 = 
	`LCD_G‘DevFunc
(
Lay”Index
, 
LCD_DEVFUNC_DRAWBMP_8BPP
);

1133 ià(
pFunc
)

1135 ià(
pB™m­
->
pP®
)

1137 ià(
pB™m­
->
pP®
->
HasT¿ns
)

1139 
DoDeçuÉ
 = 1;

1144 
DoDeçuÉ
 = 1;

1149 
DoDeçuÉ
 = 1;

1154 
DoDeçuÉ
 = 1;

1158 ià(
DoDeçuÉ
)

1162  
	`LCD_G‘pP®CÚvTabË
(
pLogP®
);

1166 
	`Inv”tAÍha_Sw­RB
((
U32
 *)
pLogP®
->
pP®EÁr›s
, 
aBufãrDMA2D
,…LogP®->
NumEÁr›s
);

1169 
	`DMA2D_LßdLUT
(
aBufãrDMA2D
, 
pLogP®
->
NumEÁr›s
);

1172  
aBufãrDMA2D
;

1173 
	}
}

1184 
	$DMA2D_MixCŞÜsBulk
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U8
 
IÁ’s
, 
ušt32_t
 
NumI‹ms
)

1187 
DMA2D
->
CR
 = 0x00020000UL | (1 << 9);

1190 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pCŞÜFG
;

1191 
DMA2D
->
BGMAR
 = (
ušt32_t
)
pCŞÜBG
;

1192 
DMA2D
->
OMAR
 = (
ušt32_t
)
pCŞÜD¡
;

1195 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1197 | ((
ušt32_t
)
IÁ’s
 << 24);

1198 
DMA2D
->
BGPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888


1200 | ((
ušt32_t
)(255 - 
IÁ’s
) << 24);

1201 
DMA2D
->
OPFCCR
 = 
LTDC_PIXEL_FORMAT_ARGB8888
;

1204 
DMA2D
->
NLR
 = (
ušt32_t
)(
NumI‹ms
 << 16) | 1;

1207 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1209 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1212 
	}
}

1222 
	$DMA2D_AÍhaBËndšg
(
LCD_COLOR
 *
pCŞÜFG
, LCD_COLOR *
pCŞÜBG
, LCD_COLOR *
pCŞÜD¡
, 
U32
 
NumI‹ms
)

1225 
	`Inv”tAÍha
(
pCŞÜFG
, 
aBufãr_FG
, 
NumI‹ms
);

1226 
	`Inv”tAÍha
(
pCŞÜBG
, 
aBufãr_BG
, 
NumI‹ms
);

1229 
	`DMA2D_AÍhaBËndšgBulk
(
aBufãr_FG
, 
aBufãr_BG
, 
aBufãrDMA2D
, 
NumI‹ms
);

1232 
	`Inv”tAÍha
(
aBufãrDMA2D
, 
pCŞÜD¡
, 
NumI‹ms
);

1233 
	}
}

1247 
	$DMA2D_Index2CŞÜBulk
(*
pIndex
, 
LCD_COLOR
 *
pCŞÜ
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
)

1250 
	`DMA2D_CÚv”tCŞÜ
(
pIndex
, 
aBufãrDMA2D
, 
Pix–FÜm©
, 
LTDC_PIXEL_FORMAT_ARGB8888
, 
NumI‹ms
);

1253 
	`Inv”tAÍha_Sw­RB
(
aBufãrDMA2D
, 
pCŞÜ
, 
NumI‹ms
);

1254 
	}
}

1268 
	$DMA2D_CŞÜ2IndexBulk
(
LCD_COLOR
 *
pCŞÜ
, *
pIndex
, 
ušt32_t
 
NumI‹ms
, 
U8
 
SizeOfIndex
, ušt32_ˆ
Pix–FÜm©
)

1271 
	`Inv”tAÍha_Sw­RB
(
pCŞÜ
, 
aBufãrDMA2D
, 
NumI‹ms
);

1274 
	`DMA2D_CÚv”tCŞÜ
(
aBufãrDMA2D
, 
pIndex
, 
LTDC_PIXEL_FORMAT_ARGB8888
, 
Pix–FÜm©
, 
NumI‹ms
);

1275 
	}
}

1290 
	$LCD_MixCŞÜsBulk
(
U32
 *
pFG
, U32 *
pBG
, U32 *
pD¡
, 
OffFG
, 
OffBG
, 
OffDe¡
, 
xSize
, 
ySize
, 
U8
 
IÁ’s
)

1292 
št32_t
 
y
;

1294 
	`GUI_USE_PARA
(
OffFG
);

1295 
	`GUI_USE_PARA
(
OffDe¡
);

1296 
y
 = 0; y < 
ySize
; y++)

1299 
	`Inv”tAÍha
(
pFG
, 
aBufãr_FG
, 
xSize
);

1300 
	`Inv”tAÍha
(
pBG
, 
aBufãr_BG
, 
xSize
);

1302 
	`DMA2D_MixCŞÜsBulk
(
aBufãr_FG
, 
aBufãr_BG
, 
aBufãrDMA2D
, 
IÁ’s
, 
xSize
);

1304 
	`Inv”tAÍha
(
aBufãrDMA2D
, 
pD¡
, 
xSize
);

1305 
pFG
 +ğ
xSize
 + 
OffFG
;

1306 
pBG
 +ğ
xSize
 + 
OffBG
;

1307 
pD¡
 +ğ
xSize
 + 
OffDe¡
;

1309 
	}
}

1322 
	$DMA2D_D¿wB™m­L8
(*
pSrc
, *
pD¡
, 
ušt32_t
 
OffSrc
, ušt32_ˆ
OffD¡
, ušt32_ˆ
Pix–FÜm©D¡
, ušt32_ˆ
xSize
, ušt32_ˆ
ySize
)

1325 
DMA2D
->
CR
 = 0x00010000UL | (1 << 9);

1328 
DMA2D
->
FGMAR
 = (
ušt32_t
)
pSrc
;

1329 
DMA2D
->
OMAR
 = (
ušt32_t
)
pD¡
;

1332 
DMA2D
->
FGOR
 = 
OffSrc
;

1333 
DMA2D
->
OOR
 = 
OffD¡
;

1336 
DMA2D
->
FGPFCCR
 = 
LTDC_PIXEL_FORMAT_L8
;

1337 
DMA2D
->
OPFCCR
 = 
Pix–FÜm©D¡
;

1340 
DMA2D
->
NLR
 = (
ušt32_t
)(
xSize
 << 16è| 
ySize
;

1343 
DMA2D
->
CR
 |ğ
DMA2D_CR_START
;

1346 
DMA2D
->
CR
 & 
DMA2D_CR_START
)

1349 
	}
}

1362 
	$BSP_LCD_D¿wB™m­16bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U16
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
)

1364 
ušt32_t
 
BufãrSize
, 
AddrD¡
;

1365 
št32_t
 
OffLšeSrc
, 
OffLšeD¡
;

1367 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

1368 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 *†ay”_´İ[Lay”Index].
bufãr_šdex
 + (
y
 *†ay”_´İ[Lay”Index].
xSize
 + 
x
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

1369 
OffLšeSrc
 = (
By‹sP”Lše
 / 2è- 
xSize
;

1370 
OffLšeD¡
 = 
Ïy”_´İ
[
Lay”Index
].
xSize
 - xSize;

1371 
	`DMA2D_CİyBufãr
(
Lay”Index
, (*)
p
, (*)
AddrD¡
, 
xSize
, 
ySize
, 
OffLšeSrc
, 
OffLšeD¡
);

1372 
	}
}

1385 
	$BSP_LCD_D¿wB™m­8bµ
(
št32_t
 
Lay”Index
, iÁ32_ˆ
x
, iÁ32_ˆ
y
, 
U8
 cÚ¡ *
p
, iÁ32_ˆ
xSize
, iÁ32_ˆ
ySize
, iÁ32_ˆ
By‹sP”Lše
)

1387 
ušt32_t
 
BufãrSize
, 
AddrD¡
;

1388 
št32_t
 
OffLšeSrc
, 
OffLšeD¡
;

1389 
ušt32_t
 
Pix–FÜm©
;

1391 
BufãrSize
 = 
	`G‘BufãrSize
(
Lay”Index
);

1392 
AddrD¡
 = 
Ïy”_´İ
[
Lay”Index
].
add»ss
 + 
BufãrSize
 *†ay”_´İ[Lay”Index].
bufãr_šdex
 + (
y
 *†ay”_´İ[Lay”Index].
xSize
 + 
x
è*†ay”_´İ[Lay”Index].
By‹sP”Pix–
;

1393 
OffLšeSrc
 = 
By‹sP”Lše
 - 
xSize
;

1394 
OffLšeD¡
 = 
Ïy”_´İ
[
Lay”Index
].
xSize
 - xSize;

1395 
Pix–FÜm©
 = 
	`LCD_LL_G‘Pix–fÜm©
(
Lay”Index
);

1396 
	`DMA2D_D¿wB™m­L8
((*)
p
, (*)
AddrD¡
, 
OffLšeSrc
, 
OffLšeD¡
, 
Pix–FÜm©
, 
xSize
, 
ySize
);

1397 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\STemWin\GUI_X\GUI_X_FreeRTOS.c

56 
	~"GUI.h
"

59 
	~"F»eRTOS.h
"

60 
	~"sk.h
"

61 
	~"tim”s.h
"

62 
	~"£mphr.h
"

68 
xSem­hÜeHªdË
 
	gxQueueMu‹x
;

69 
xSem­hÜeHªdË
 
	gxSemaTxDÚe
;

82 
	$GUI_X_G‘Time
()

84  ((è
	`xTaskG‘TickCouÁ
());

85 
	}
}

87 
	$GUI_X_D–ay
(
ms
)

89 
	`vTaskD–ay
Ğ
ms
 );

90 
	}
}

102 
	$GUI_X_In™
() {

103 
	}
}

114 
	$GUI_X_ExecIdË
()

116 
	`vTaskD–ay
(30/
pÜtTICK_RATE_MS
);

117 
	}
}

138 
	$GUI_X_In™OS
()

141 
xQueueMu‹x
 = 
	`xSem­hÜeC»©eMu‹x
();

142 
	`cÚfigASSERT
 (
xQueueMu‹x
 !ğ
NULL
);

145 
	`vSem­hÜeC»©eBš¬y
Ğ
xSemaTxDÚe
 );

146 
	`cÚfigASSERT
 ( 
xSemaTxDÚe
 !ğ
NULL
 );

147 
	}
}

149 
	$GUI_X_UÆock
()

151 
	`xSem­hÜeGive
Ğ
xQueueMu‹x
 );

152 
	}
}

154 
	$GUI_X_Lock
()

156 if(
xQueueMu‹x
 =ğ
NULL
)

158 
	`GUI_X_In™OS
();

161 
	`xSem­hÜeTake
Ğ
xQueueMu‹x
, 
pÜtMAX_DELAY
 );

162 
	}
}

165 
U32
 
	$GUI_X_G‘TaskId
()

167  ((
U32
è
	`xTaskG‘Cu¼’tTaskHªdË
());

168 
	}
}

170 
	$GUI_X_Wa™Ev’t
 ()

172  
	`xSem­hÜeTake
(
xSemaTxDÚe
, 
pÜtMAX_DELAY
 ) !ğ
pdTRUE
 );

173 
	}
}

176 
	$GUI_X_SigÇlEv’t
 ()

178 
	`xSem­hÜeGive
Ğ
xSemaTxDÚe
 );

179 
	}
}

195 
	$GUI_X_Log
 (cÚ¡ *
s
è{ 
	}
}

196 
	$GUI_X_W¬n
 (cÚ¡ *
s
è{ 
	}
}

197 
	$GUI_X_E¼ÜOut
(cÚ¡ *
s
è{ 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\STemWin\GUI_X\GUI_X_Touch_Analog.c

45 
	~"GUI.h
"

46 
	~"b¥.h
"

48 
u16
 
	gadc_x
,
	gadc_y
;

50 
	$GUI_TOUCH_X_Aùiv©eX
() {

51 
	}
}

53 
	$GUI_TOUCH_X_Aùiv©eY
() {

54 
	}
}

56 
	$GUI_TOUCH_X_M—su»X
() {

57 
	`TP_Sÿn
(&
adc_x
, &
adc_y
);

58  
adc_x
;

59 
	}
}

61 
	$GUI_TOUCH_X_M—su»Y
() {

62  
adc_y
;

63 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\camellia-BSD-1.2.0\camellia.c

34 
	~<¡ršg.h
>

35 
	~<¡dlib.h
>

37 
	~"ÿm–lŸ.h
"

40 
	tu32
;

41 
	tu8
;

45 
	#CAMELLIA_SIGMA1L
 (0xA09E667FL)

	)

46 
	#CAMELLIA_SIGMA1R
 (0x3BCC908BL)

	)

47 
	#CAMELLIA_SIGMA2L
 (0xB67AE858L)

	)

48 
	#CAMELLIA_SIGMA2R
 (0x4CAA73B2L)

	)

49 
	#CAMELLIA_SIGMA3L
 (0xC6EF372FL)

	)

50 
	#CAMELLIA_SIGMA3R
 (0xE94F82BEL)

	)

51 
	#CAMELLIA_SIGMA4L
 (0x54FF53A5L)

	)

52 
	#CAMELLIA_SIGMA4R
 (0xF1D36F1CL)

	)

53 
	#CAMELLIA_SIGMA5L
 (0x10E527FAL)

	)

54 
	#CAMELLIA_SIGMA5R
 (0xDE682D1DL)

	)

55 
	#CAMELLIA_SIGMA6L
 (0xB05688C2L)

	)

56 
	#CAMELLIA_SIGMA6R
 (0xB3E6C1FDL)

	)

63 #ià
defšed
(
_MSC_VER
)

65 
	#SWAP
(
x
è(
	`_ÌÙl
(x, 8è& 0x00ff00fà| 
	`_ÌÙr
(x, 8è& 0xff00ff00)

	)

66 
	#GETU32
(
p
è
	`SWAP
(*((
u32
 *)Õ)))

	)

67 
	#PUTU32
(
ù
, 
¡
è{*((
u32
 *)(ù)èğ
	`SWAP
((¡));}

	)

71 
	#GETU32
(
±
) \

72 (((
u32
)(
±
)[0] << 24) \

73 ^ ((
u32
)(
±
)[1] << 16) \

74 ^ ((
u32
)(
±
)[2] << 8) \

75 ^ ((
u32
)(
±
)[3]))

	)

77 
	#PUTU32
(
ù
, 
¡
) { \

78 (
ù
)[0] = (
u8
)((
¡
) >> 24); \

79 (
ù
)[1] = (
u8
)((
¡
) >> 16); \

80 (
ù
)[2] = (
u8
)((
¡
) >> 8); \

81 (
ù
)[3] = (
u8
)(
¡
); }

	)

85 
	#Cam–lŸSubkeyL
(
INDEX
è(
subkey
[(INDEX)*2])

	)

86 
	#Cam–lŸSubkeyR
(
INDEX
è(
subkey
[(INDEX)*2 + 1])

	)

89 
	#CAMELLIA_RR8
(
x
è(((xè>> 8è+ ((xè<< 24))

	)

91 
	#CAMELLIA_RL1
(
x
è(((xè<< 1è+ ((xè>> 31))

	)

93 
	#CAMELLIA_RL8
(
x
è(((xè<< 8è+ ((xè>> 24))

	)

95 
	#CAMELLIA_ROLDQ
(
Î
, 
Ì
, 
¾
, 
¼
, 
w0
, 
w1
, 
b™s
) \

97 
w0
 = 
Î
; \

98 
Î
 = (Î << 
b™s
è+ (
Ì
 >> (32 - bits)); \

99 
Ì
 = (Ì << 
b™s
è+ (
¾
 >> (32 - bits)); \

100 
¾
 = (¾ << 
b™s
è+ (
¼
 >> (32 - bits)); \

101 
¼
 = (¼ << 
b™s
è+ (
w0
 >> (32 - bits)); \

102 } 0)

	)

104 
	#CAMELLIA_ROLDQo32
(
Î
, 
Ì
, 
¾
, 
¼
, 
w0
, 
w1
, 
b™s
) \

106 
w0
 = 
Î
; \

107 
w1
 = 
Ì
; \

108 
Î
 = (
Ì
 << (
b™s
 - 32)è+ (
¾
 >> (64 - bits)); \

109 
Ì
 = (
¾
 << (
b™s
 - 32)è+ (
¼
 >> (64 - bits)); \

110 
¾
 = (
¼
 << (
b™s
 - 32)è+ (
w0
 >> (64 - bits)); \

111 
¼
 = (
w0
 << (
b™s
 - 32)è+ (
w1
 >> (64 - bits)); \

112 } 0)

	)

114 
	#CAMELLIA_SP1110
(
INDEX
è(
ÿm–lŸ_¥1110
[(INDEX)])

	)

115 
	#CAMELLIA_SP0222
(
INDEX
è(
ÿm–lŸ_¥0222
[(INDEX)])

	)

116 
	#CAMELLIA_SP3033
(
INDEX
è(
ÿm–lŸ_¥3033
[(INDEX)])

	)

117 
	#CAMELLIA_SP4404
(
INDEX
è(
ÿm–lŸ_¥4404
[(INDEX)])

	)

119 
	#CAMELLIA_F
(
xl
, 
xr
, 
kl
, 
kr
, 
yl
, 
yr
, 

, 
œ
, 
t0
, 
t1
) \

121 

 = 
xl
 ^ 
kl
; \

122 
œ
 = 
xr
 ^ 
kr
; \

123 
t0
 = 

 >> 16; \

124 
t1
 = 
œ
 >> 16; \

125 
yl
 = 
	`CAMELLIA_SP1110
(
œ
 & 0xff) \

126 ^ 
	`CAMELLIA_SP0222
((
t1
 >> 8) & 0xff) \

127 ^ 
	`CAMELLIA_SP3033
(
t1
 & 0xff) \

128 ^ 
	`CAMELLIA_SP4404
((
œ
 >> 8) & 0xff); \

129 
yr
 = 
	`CAMELLIA_SP1110
((
t0
 >> 8) & 0xff) \

130 ^ 
	`CAMELLIA_SP0222
(
t0
 & 0xff) \

131 ^ 
	`CAMELLIA_SP3033
((

 >> 8) & 0xff) \

132 ^ 
	`CAMELLIA_SP4404
(

 & 0xff); \

133 
yl
 ^ğ
yr
; \

134 
yr
 = 
	`CAMELLIA_RR8
(yr); \

135 
yr
 ^ğ
yl
; \

136 } 0)

	)

143 
	#CAMELLIA_FLS
(
Î
, 
Ì
, 
¾
, 
¼
, 
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
t0
, 
t1
, 
t2
, 
t3
) \

145 
t0
 = 
kÎ
; \

146 
t0
 &ğ
Î
; \

147 
Ì
 ^ğ
	`CAMELLIA_RL1
(
t0
); \

148 
t1
 = 
kÌ
; \

149 
t1
 |ğ
Ì
; \

150 
Î
 ^ğ
t1
; \

152 
t2
 = 
k¼
; \

153 
t2
 |ğ
¼
; \

154 
¾
 ^ğ
t2
; \

155 
t3
 = 
k¾
; \

156 
t3
 &ğ
¾
; \

157 
¼
 ^ğ
	`CAMELLIA_RL1
(
t3
); \

158 } 0)

	)

160 
	#CAMELLIA_ROUNDSM
(
xl
, 
xr
, 
kl
, 
kr
, 
yl
, 
yr
, 

, 
œ
, 
t0
, 
t1
) \

162 
œ
 = 
	`CAMELLIA_SP1110
(
xr
 & 0xff) \

163 ^ 
	`CAMELLIA_SP0222
((
xr
 >> 24) & 0xff) \

164 ^ 
	`CAMELLIA_SP3033
((
xr
 >> 16) & 0xff) \

165 ^ 
	`CAMELLIA_SP4404
((
xr
 >> 8) & 0xff); \

166 

 = 
	`CAMELLIA_SP1110
((
xl
 >> 24) & 0xff) \

167 ^ 
	`CAMELLIA_SP0222
((
xl
 >> 16) & 0xff) \

168 ^ 
	`CAMELLIA_SP3033
((
xl
 >> 8) & 0xff) \

169 ^ 
	`CAMELLIA_SP4404
(
xl
 & 0xff); \

170 

 ^ğ
kl
; \

171 
œ
 ^ğ
kr
; \

172 
œ
 ^ğ

; \

173 

 = 
	`CAMELLIA_RR8
(il); \

174 

 ^ğ
œ
; \

175 
yl
 ^ğ
œ
; \

176 
yr
 ^ğ

; \

177 } 0)

	)

180 cÚ¡ 
u32
 
	gÿm–lŸ_¥1110
[256] = {

247 cÚ¡ 
u32
 
	gÿm–lŸ_¥0222
[256] = {

314 cÚ¡ 
u32
 
	gÿm–lŸ_¥3033
[256] = {

381 cÚ¡ 
u32
 
	gÿm–lŸ_¥4404
[256] = {

452 
	#subl
(
x
è
subL
[(x)]

	)

453 
	#subr
(
x
è
subR
[(x)]

	)

455 
	$ÿm–lŸ_£tup128
(cÚ¡ *
key
, 
u32
 *
subkey
)

457 
u32
 
kÎ
, 
kÌ
, 
k¾
, 
k¼
;

458 
u32
 

, 
œ
, 
t0
, 
t1
, 
w0
, 
w1
;

459 
u32
 
kw4l
, 
kw4r
, 
dw
, 

, 
Œ
;

460 
u32
 
subL
[26];

461 
u32
 
subR
[26];

466 
kÎ
 = 
	`GETU32
(
key
 );

467 
kÌ
 = 
	`GETU32
(
key
 + 4);

468 
k¾
 = 
	`GETU32
(
key
 + 8);

469 
k¼
 = 
	`GETU32
(
key
 + 12);

473 
	`subl
(0èğ
kÎ
; 
	`subr
(0èğ
kÌ
;

474 
	`subl
(1èğ
k¾
; 
	`subr
(1èğ
k¼
;

475 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

476 
	`subl
(4èğ
kÎ
; 
	`subr
(4èğ
kÌ
;

477 
	`subl
(5èğ
k¾
; 
	`subr
(5èğ
k¼
;

478 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 30);

479 
	`subl
(10èğ
kÎ
; 
	`subr
(10èğ
kÌ
;

480 
	`subl
(11èğ
k¾
; 
	`subr
(11èğ
k¼
;

481 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

482 
	`subl
(13èğ
k¾
; 
	`subr
(13èğ
k¼
;

483 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 17);

484 
	`subl
(16èğ
kÎ
; 
	`subr
(16èğ
kÌ
;

485 
	`subl
(17èğ
k¾
; 
	`subr
(17èğ
k¼
;

486 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 17);

487 
	`subl
(18èğ
kÎ
; 
	`subr
(18èğ
kÌ
;

488 
	`subl
(19èğ
k¾
; 
	`subr
(19èğ
k¼
;

489 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 17);

490 
	`subl
(22èğ
kÎ
; 
	`subr
(22èğ
kÌ
;

491 
	`subl
(23èğ
k¾
; 
	`subr
(23èğ
k¼
;

494 
kÎ
 = 
	`subl
(0); 
kÌ
 = 
	`subr
(0);

495 
k¾
 = 
	`subl
(1); 
k¼
 = 
	`subr
(1);

496 
	`CAMELLIA_F
(
kÎ
, 
kÌ
,

497 
CAMELLIA_SIGMA1L
, 
CAMELLIA_SIGMA1R
,

498 
w0
, 
w1
, 

, 
œ
, 
t0
, 
t1
);

499 
k¾
 ^ğ
w0
; 
k¼
 ^ğ
w1
;

500 
	`CAMELLIA_F
(
k¾
, 
k¼
,

501 
CAMELLIA_SIGMA2L
, 
CAMELLIA_SIGMA2R
,

502 
kÎ
, 
kÌ
, 

, 
œ
, 
t0
, 
t1
);

503 
	`CAMELLIA_F
(
kÎ
, 
kÌ
,

504 
CAMELLIA_SIGMA3L
, 
CAMELLIA_SIGMA3R
,

505 
k¾
, 
k¼
, 

, 
œ
, 
t0
, 
t1
);

506 
k¾
 ^ğ
w0
; 
k¼
 ^ğ
w1
;

507 
	`CAMELLIA_F
(
k¾
, 
k¼
,

508 
CAMELLIA_SIGMA4L
, 
CAMELLIA_SIGMA4R
,

509 
w0
, 
w1
, 

, 
œ
, 
t0
, 
t1
);

510 
kÎ
 ^ğ
w0
; 
kÌ
 ^ğ
w1
;

513 
	`subl
(2èğ
kÎ
; 
	`subr
(2èğ
kÌ
;

514 
	`subl
(3èğ
k¾
; 
	`subr
(3èğ
k¼
;

515 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

516 
	`subl
(6èğ
kÎ
; 
	`subr
(6èğ
kÌ
;

517 
	`subl
(7èğ
k¾
; 
	`subr
(7èğ
k¼
;

518 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

519 
	`subl
(8èğ
kÎ
; 
	`subr
(8èğ
kÌ
;

520 
	`subl
(9èğ
k¾
; 
	`subr
(9èğ
k¼
;

521 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

522 
	`subl
(12èğ
kÎ
; 
	`subr
(12èğ
kÌ
;

523 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

524 
	`subl
(14èğ
kÎ
; 
	`subr
(14èğ
kÌ
;

525 
	`subl
(15èğ
k¾
; 
	`subr
(15èğ
k¼
;

526 
	`CAMELLIA_ROLDQo32
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 34);

527 
	`subl
(20èğ
kÎ
; 
	`subr
(20èğ
kÌ
;

528 
	`subl
(21èğ
k¾
; 
	`subr
(21èğ
k¼
;

529 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 17);

530 
	`subl
(24èğ
kÎ
; 
	`subr
(24èğ
kÌ
;

531 
	`subl
(25èğ
k¾
; 
	`subr
(25èğ
k¼
;

535 
	`subl
(3è^ğsubl(1); 
	`subr
(3) ^= subr(1);

536 
	`subl
(5è^ğsubl(1); 
	`subr
(5) ^= subr(1);

537 
	`subl
(7è^ğsubl(1); 
	`subr
(7) ^= subr(1);

538 
	`subl
(1è^ğ
	`subr
(1) & ~subr(9);

539 
dw
 = 
	`subl
(1è& subl(9), 
	`subr
(1è^ğ
	`CAMELLIA_RL1
(dw);

540 
	`subl
(11è^ğsubl(1); 
	`subr
(11) ^= subr(1);

541 
	`subl
(13è^ğsubl(1); 
	`subr
(13) ^= subr(1);

542 
	`subl
(15è^ğsubl(1); 
	`subr
(15) ^= subr(1);

543 
	`subl
(1è^ğ
	`subr
(1) & ~subr(17);

544 
dw
 = 
	`subl
(1è& subl(17), 
	`subr
(1è^ğ
	`CAMELLIA_RL1
(dw);

545 
	`subl
(19è^ğsubl(1); 
	`subr
(19) ^= subr(1);

546 
	`subl
(21è^ğsubl(1); 
	`subr
(21) ^= subr(1);

547 
	`subl
(23è^ğsubl(1); 
	`subr
(23) ^= subr(1);

548 
	`subl
(24è^ğsubl(1); 
	`subr
(24) ^= subr(1);

551 
kw4l
 = 
	`subl
(25); 
kw4r
 = 
	`subr
(25);

552 
	`subl
(22è^ğ
kw4l
; 
	`subr
(22è^ğ
kw4r
;

553 
	`subl
(20è^ğ
kw4l
; 
	`subr
(20è^ğ
kw4r
;

554 
	`subl
(18è^ğ
kw4l
; 
	`subr
(18è^ğ
kw4r
;

555 
kw4l
 ^ğ
kw4r
 & ~
	`subr
(16);

556 
dw
 = 
kw4l
 & 
	`subl
(16), 
kw4r
 ^ğ
	`CAMELLIA_RL1
(dw);

557 
	`subl
(14è^ğ
kw4l
; 
	`subr
(14è^ğ
kw4r
;

558 
	`subl
(12è^ğ
kw4l
; 
	`subr
(12è^ğ
kw4r
;

559 
	`subl
(10è^ğ
kw4l
; 
	`subr
(10è^ğ
kw4r
;

560 
kw4l
 ^ğ
kw4r
 & ~
	`subr
(8);

561 
dw
 = 
kw4l
 & 
	`subl
(8), 
kw4r
 ^ğ
	`CAMELLIA_RL1
(dw);

562 
	`subl
(6è^ğ
kw4l
; 
	`subr
(6è^ğ
kw4r
;

563 
	`subl
(4è^ğ
kw4l
; 
	`subr
(4è^ğ
kw4r
;

564 
	`subl
(2è^ğ
kw4l
; 
	`subr
(2è^ğ
kw4r
;

565 
	`subl
(0è^ğ
kw4l
; 
	`subr
(0è^ğ
kw4r
;

568 
	`Cam–lŸSubkeyL
(0èğ
	`subl
(0) ^ subl(2);

569 
	`Cam–lŸSubkeyR
(0èğ
	`subr
(0) ^ subr(2);

570 
	`Cam–lŸSubkeyL
(2èğ
	`subl
(3);

571 
	`Cam–lŸSubkeyR
(2èğ
	`subr
(3);

572 
	`Cam–lŸSubkeyL
(3èğ
	`subl
(2) ^ subl(4);

573 
	`Cam–lŸSubkeyR
(3èğ
	`subr
(2) ^ subr(4);

574 
	`Cam–lŸSubkeyL
(4èğ
	`subl
(3) ^ subl(5);

575 
	`Cam–lŸSubkeyR
(4èğ
	`subr
(3) ^ subr(5);

576 
	`Cam–lŸSubkeyL
(5èğ
	`subl
(4) ^ subl(6);

577 
	`Cam–lŸSubkeyR
(5èğ
	`subr
(4) ^ subr(6);

578 
	`Cam–lŸSubkeyL
(6èğ
	`subl
(5) ^ subl(7);

579 
	`Cam–lŸSubkeyR
(6èğ
	`subr
(5) ^ subr(7);

580 

 = 
	`subl
(10è^ (
	`subr
(10) & ~subr(8));

581 
dw
 = 

 & 
	`subl
(8), 
Œ
 = 
	`subr
(10è^ 
	`CAMELLIA_RL1
(dw);

582 
	`Cam–lŸSubkeyL
(7èğ
	`subl
(6è^ 

;

583 
	`Cam–lŸSubkeyR
(7èğ
	`subr
(6è^ 
Œ
;

584 
	`Cam–lŸSubkeyL
(8èğ
	`subl
(8);

585 
	`Cam–lŸSubkeyR
(8èğ
	`subr
(8);

586 
	`Cam–lŸSubkeyL
(9èğ
	`subl
(9);

587 
	`Cam–lŸSubkeyR
(9èğ
	`subr
(9);

588 

 = 
	`subl
(7è^ (
	`subr
(7) & ~subr(9));

589 
dw
 = 

 & 
	`subl
(9), 
Œ
 = 
	`subr
(7è^ 
	`CAMELLIA_RL1
(dw);

590 
	`Cam–lŸSubkeyL
(10èğ

 ^ 
	`subl
(11);

591 
	`Cam–lŸSubkeyR
(10èğ
Œ
 ^ 
	`subr
(11);

592 
	`Cam–lŸSubkeyL
(11èğ
	`subl
(10) ^ subl(12);

593 
	`Cam–lŸSubkeyR
(11èğ
	`subr
(10) ^ subr(12);

594 
	`Cam–lŸSubkeyL
(12èğ
	`subl
(11) ^ subl(13);

595 
	`Cam–lŸSubkeyR
(12èğ
	`subr
(11) ^ subr(13);

596 
	`Cam–lŸSubkeyL
(13èğ
	`subl
(12) ^ subl(14);

597 
	`Cam–lŸSubkeyR
(13èğ
	`subr
(12) ^ subr(14);

598 
	`Cam–lŸSubkeyL
(14èğ
	`subl
(13) ^ subl(15);

599 
	`Cam–lŸSubkeyR
(14èğ
	`subr
(13) ^ subr(15);

600 

 = 
	`subl
(18è^ (
	`subr
(18) & ~subr(16));

601 
dw
 = 

 & 
	`subl
(16), 
Œ
 = 
	`subr
(18è^ 
	`CAMELLIA_RL1
(dw);

602 
	`Cam–lŸSubkeyL
(15èğ
	`subl
(14è^ 

;

603 
	`Cam–lŸSubkeyR
(15èğ
	`subr
(14è^ 
Œ
;

604 
	`Cam–lŸSubkeyL
(16èğ
	`subl
(16);

605 
	`Cam–lŸSubkeyR
(16èğ
	`subr
(16);

606 
	`Cam–lŸSubkeyL
(17èğ
	`subl
(17);

607 
	`Cam–lŸSubkeyR
(17èğ
	`subr
(17);

608 

 = 
	`subl
(15è^ (
	`subr
(15) & ~subr(17));

609 
dw
 = 

 & 
	`subl
(17), 
Œ
 = 
	`subr
(15è^ 
	`CAMELLIA_RL1
(dw);

610 
	`Cam–lŸSubkeyL
(18èğ

 ^ 
	`subl
(19);

611 
	`Cam–lŸSubkeyR
(18èğ
Œ
 ^ 
	`subr
(19);

612 
	`Cam–lŸSubkeyL
(19èğ
	`subl
(18) ^ subl(20);

613 
	`Cam–lŸSubkeyR
(19èğ
	`subr
(18) ^ subr(20);

614 
	`Cam–lŸSubkeyL
(20èğ
	`subl
(19) ^ subl(21);

615 
	`Cam–lŸSubkeyR
(20èğ
	`subr
(19) ^ subr(21);

616 
	`Cam–lŸSubkeyL
(21èğ
	`subl
(20) ^ subl(22);

617 
	`Cam–lŸSubkeyR
(21èğ
	`subr
(20) ^ subr(22);

618 
	`Cam–lŸSubkeyL
(22èğ
	`subl
(21) ^ subl(23);

619 
	`Cam–lŸSubkeyR
(22èğ
	`subr
(21) ^ subr(23);

620 
	`Cam–lŸSubkeyL
(23èğ
	`subl
(22);

621 
	`Cam–lŸSubkeyR
(23èğ
	`subr
(22);

622 
	`Cam–lŸSubkeyL
(24èğ
	`subl
(24) ^ subl(23);

623 
	`Cam–lŸSubkeyR
(24èğ
	`subr
(24) ^ subr(23);

626 
dw
 = 
	`Cam–lŸSubkeyL
(2è^ 
	`Cam–lŸSubkeyR
(2), dw = 
	`CAMELLIA_RL8
(dw);

627 
	`Cam–lŸSubkeyR
(2èğ
	`Cam–lŸSubkeyL
(2è^ 
dw
, CamelliaSubkeyL(2) = dw;

628 
dw
 = 
	`Cam–lŸSubkeyL
(3è^ 
	`Cam–lŸSubkeyR
(3), dw = 
	`CAMELLIA_RL8
(dw);

629 
	`Cam–lŸSubkeyR
(3èğ
	`Cam–lŸSubkeyL
(3è^ 
dw
, CamelliaSubkeyL(3) = dw;

630 
dw
 = 
	`Cam–lŸSubkeyL
(4è^ 
	`Cam–lŸSubkeyR
(4), dw = 
	`CAMELLIA_RL8
(dw);

631 
	`Cam–lŸSubkeyR
(4èğ
	`Cam–lŸSubkeyL
(4è^ 
dw
, CamelliaSubkeyL(4) = dw;

632 
dw
 = 
	`Cam–lŸSubkeyL
(5è^ 
	`Cam–lŸSubkeyR
(5), dw = 
	`CAMELLIA_RL8
(dw);

633 
	`Cam–lŸSubkeyR
(5èğ
	`Cam–lŸSubkeyL
(5è^ 
dw
, CamelliaSubkeyL(5) = dw;

634 
dw
 = 
	`Cam–lŸSubkeyL
(6è^ 
	`Cam–lŸSubkeyR
(6), dw = 
	`CAMELLIA_RL8
(dw);

635 
	`Cam–lŸSubkeyR
(6èğ
	`Cam–lŸSubkeyL
(6è^ 
dw
, CamelliaSubkeyL(6) = dw;

636 
dw
 = 
	`Cam–lŸSubkeyL
(7è^ 
	`Cam–lŸSubkeyR
(7), dw = 
	`CAMELLIA_RL8
(dw);

637 
	`Cam–lŸSubkeyR
(7èğ
	`Cam–lŸSubkeyL
(7è^ 
dw
, CamelliaSubkeyL(7) = dw;

638 
dw
 = 
	`Cam–lŸSubkeyL
(10è^ 
	`Cam–lŸSubkeyR
(10), dw = 
	`CAMELLIA_RL8
(dw);

639 
	`Cam–lŸSubkeyR
(10èğ
	`Cam–lŸSubkeyL
(10è^ 
dw
, CamelliaSubkeyL(10) = dw;

640 
dw
 = 
	`Cam–lŸSubkeyL
(11è^ 
	`Cam–lŸSubkeyR
(11), dw = 
	`CAMELLIA_RL8
(dw);

641 
	`Cam–lŸSubkeyR
(11èğ
	`Cam–lŸSubkeyL
(11è^ 
dw
, CamelliaSubkeyL(11) = dw;

642 
dw
 = 
	`Cam–lŸSubkeyL
(12è^ 
	`Cam–lŸSubkeyR
(12), dw = 
	`CAMELLIA_RL8
(dw);

643 
	`Cam–lŸSubkeyR
(12èğ
	`Cam–lŸSubkeyL
(12è^ 
dw
, CamelliaSubkeyL(12) = dw;

644 
dw
 = 
	`Cam–lŸSubkeyL
(13è^ 
	`Cam–lŸSubkeyR
(13), dw = 
	`CAMELLIA_RL8
(dw);

645 
	`Cam–lŸSubkeyR
(13èğ
	`Cam–lŸSubkeyL
(13è^ 
dw
, CamelliaSubkeyL(13) = dw;

646 
dw
 = 
	`Cam–lŸSubkeyL
(14è^ 
	`Cam–lŸSubkeyR
(14), dw = 
	`CAMELLIA_RL8
(dw);

647 
	`Cam–lŸSubkeyR
(14èğ
	`Cam–lŸSubkeyL
(14è^ 
dw
, CamelliaSubkeyL(14) = dw;

648 
dw
 = 
	`Cam–lŸSubkeyL
(15è^ 
	`Cam–lŸSubkeyR
(15), dw = 
	`CAMELLIA_RL8
(dw);

649 
	`Cam–lŸSubkeyR
(15èğ
	`Cam–lŸSubkeyL
(15è^ 
dw
, CamelliaSubkeyL(15) = dw;

650 
dw
 = 
	`Cam–lŸSubkeyL
(18è^ 
	`Cam–lŸSubkeyR
(18), dw = 
	`CAMELLIA_RL8
(dw);

651 
	`Cam–lŸSubkeyR
(18èğ
	`Cam–lŸSubkeyL
(18è^ 
dw
, CamelliaSubkeyL(18) = dw;

652 
dw
 = 
	`Cam–lŸSubkeyL
(19è^ 
	`Cam–lŸSubkeyR
(19), dw = 
	`CAMELLIA_RL8
(dw);

653 
	`Cam–lŸSubkeyR
(19èğ
	`Cam–lŸSubkeyL
(19è^ 
dw
, CamelliaSubkeyL(19) = dw;

654 
dw
 = 
	`Cam–lŸSubkeyL
(20è^ 
	`Cam–lŸSubkeyR
(20), dw = 
	`CAMELLIA_RL8
(dw);

655 
	`Cam–lŸSubkeyR
(20èğ
	`Cam–lŸSubkeyL
(20è^ 
dw
, CamelliaSubkeyL(20) = dw;

656 
dw
 = 
	`Cam–lŸSubkeyL
(21è^ 
	`Cam–lŸSubkeyR
(21), dw = 
	`CAMELLIA_RL8
(dw);

657 
	`Cam–lŸSubkeyR
(21èğ
	`Cam–lŸSubkeyL
(21è^ 
dw
, CamelliaSubkeyL(21) = dw;

658 
dw
 = 
	`Cam–lŸSubkeyL
(22è^ 
	`Cam–lŸSubkeyR
(22), dw = 
	`CAMELLIA_RL8
(dw);

659 
	`Cam–lŸSubkeyR
(22èğ
	`Cam–lŸSubkeyL
(22è^ 
dw
, CamelliaSubkeyL(22) = dw;

660 
dw
 = 
	`Cam–lŸSubkeyL
(23è^ 
	`Cam–lŸSubkeyR
(23), dw = 
	`CAMELLIA_RL8
(dw);

661 
	`Cam–lŸSubkeyR
(23èğ
	`Cam–lŸSubkeyL
(23è^ 
dw
, CamelliaSubkeyL(23) = dw;

664 
	}
}

666 
	$ÿm–lŸ_£tup256
(cÚ¡ *
key
, 
u32
 *
subkey
)

668 
u32
 
kÎ
,
kÌ
,
k¾
,
k¼
;

669 
u32
 
k¾l
,
k¾r
,
k¼l
,
k¼r
;

670 
u32
 

, 
œ
, 
t0
, 
t1
, 
w0
, 
w1
;

671 
u32
 
kw4l
, 
kw4r
, 
dw
, 

, 
Œ
;

672 
u32
 
subL
[34];

673 
u32
 
subR
[34];

680 
kÎ
 = 
	`GETU32
(
key
 );

681 
kÌ
 = 
	`GETU32
(
key
 + 4);

682 
k¾
 = 
	`GETU32
(
key
 + 8);

683 
k¼
 = 
	`GETU32
(
key
 + 12);

684 
k¾l
 = 
	`GETU32
(
key
 + 16);

685 
k¾r
 = 
	`GETU32
(
key
 + 20);

686 
k¼l
 = 
	`GETU32
(
key
 + 24);

687 
k¼r
 = 
	`GETU32
(
key
 + 28);

690 
	`subl
(0èğ
kÎ
; 
	`subr
(0èğ
kÌ
;

691 
	`subl
(1èğ
k¾
; 
	`subr
(1èğ
k¼
;

692 
	`CAMELLIA_ROLDQo32
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 45);

693 
	`subl
(12èğ
kÎ
; 
	`subr
(12èğ
kÌ
;

694 
	`subl
(13èğ
k¾
; 
	`subr
(13èğ
k¼
;

695 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

696 
	`subl
(16èğ
kÎ
; 
	`subr
(16èğ
kÌ
;

697 
	`subl
(17èğ
k¾
; 
	`subr
(17èğ
k¼
;

698 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 17);

699 
	`subl
(22èğ
kÎ
; 
	`subr
(22èğ
kÌ
;

700 
	`subl
(23èğ
k¾
; 
	`subr
(23èğ
k¼
;

701 
	`CAMELLIA_ROLDQo32
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 34);

702 
	`subl
(30èğ
kÎ
; 
	`subr
(30èğ
kÌ
;

703 
	`subl
(31èğ
k¾
; 
	`subr
(31èğ
k¼
;

706 
	`CAMELLIA_ROLDQ
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 15);

707 
	`subl
(4èğ
k¾l
; 
	`subr
(4èğ
k¾r
;

708 
	`subl
(5èğ
k¼l
; 
	`subr
(5èğ
k¼r
;

709 
	`CAMELLIA_ROLDQ
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 15);

710 
	`subl
(8èğ
k¾l
; 
	`subr
(8èğ
k¾r
;

711 
	`subl
(9èğ
k¼l
; 
	`subr
(9èğ
k¼r
;

712 
	`CAMELLIA_ROLDQ
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 30);

713 
	`subl
(18èğ
k¾l
; 
	`subr
(18èğ
k¾r
;

714 
	`subl
(19èğ
k¼l
; 
	`subr
(19èğ
k¼r
;

715 
	`CAMELLIA_ROLDQo32
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 34);

716 
	`subl
(26èğ
k¾l
; 
	`subr
(26èğ
k¾r
;

717 
	`subl
(27èğ
k¼l
; 
	`subr
(27èğ
k¼r
;

718 
	`CAMELLIA_ROLDQo32
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 34);

721 
kÎ
 = 
	`subl
(0è^ 
k¾l
; 
kÌ
 = 
	`subr
(0è^ 
k¾r
;

722 
k¾
 = 
	`subl
(1è^ 
k¼l
; 
k¼
 = 
	`subr
(1è^ 
k¼r
;

723 
	`CAMELLIA_F
(
kÎ
, 
kÌ
,

724 
CAMELLIA_SIGMA1L
, 
CAMELLIA_SIGMA1R
,

725 
w0
, 
w1
, 

, 
œ
, 
t0
, 
t1
);

726 
k¾
 ^ğ
w0
; 
k¼
 ^ğ
w1
;

727 
	`CAMELLIA_F
(
k¾
, 
k¼
,

728 
CAMELLIA_SIGMA2L
, 
CAMELLIA_SIGMA2R
,

729 
kÎ
, 
kÌ
, 

, 
œ
, 
t0
, 
t1
);

730 
kÎ
 ^ğ
k¾l
; 
kÌ
 ^ğ
k¾r
;

731 
	`CAMELLIA_F
(
kÎ
, 
kÌ
,

732 
CAMELLIA_SIGMA3L
, 
CAMELLIA_SIGMA3R
,

733 
k¾
, 
k¼
, 

, 
œ
, 
t0
, 
t1
);

734 
k¾
 ^ğ
w0
 ^ 
k¼l
; 
k¼
 ^ğ
w1
 ^ 
k¼r
;

735 
	`CAMELLIA_F
(
k¾
, 
k¼
,

736 
CAMELLIA_SIGMA4L
, 
CAMELLIA_SIGMA4R
,

737 
w0
, 
w1
, 

, 
œ
, 
t0
, 
t1
);

738 
kÎ
 ^ğ
w0
; 
kÌ
 ^ğ
w1
;

741 
k¾l
 ^ğ
kÎ
; 
k¾r
 ^ğ
kÌ
;

742 
k¼l
 ^ğ
k¾
; 
k¼r
 ^ğ
k¼
;

743 
	`CAMELLIA_F
(
k¾l
, 
k¾r
,

744 
CAMELLIA_SIGMA5L
, 
CAMELLIA_SIGMA5R
,

745 
w0
, 
w1
, 

, 
œ
, 
t0
, 
t1
);

746 
k¼l
 ^ğ
w0
; 
k¼r
 ^ğ
w1
;

747 
	`CAMELLIA_F
(
k¼l
, 
k¼r
,

748 
CAMELLIA_SIGMA6L
, 
CAMELLIA_SIGMA6R
,

749 
w0
, 
w1
, 

, 
œ
, 
t0
, 
t1
);

750 
k¾l
 ^ğ
w0
; 
k¾r
 ^ğ
w1
;

753 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 15);

754 
	`subl
(6èğ
kÎ
; 
	`subr
(6èğ
kÌ
;

755 
	`subl
(7èğ
k¾
; 
	`subr
(7èğ
k¼
;

756 
	`CAMELLIA_ROLDQ
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 30);

757 
	`subl
(14èğ
kÎ
; 
	`subr
(14èğ
kÌ
;

758 
	`subl
(15èğ
k¾
; 
	`subr
(15èğ
k¼
;

759 
	`subl
(24èğ
kÌ
; 
	`subr
(24èğ
k¾
;

760 
	`subl
(25èğ
k¼
; 
	`subr
(25èğ
kÎ
;

761 
	`CAMELLIA_ROLDQo32
(
kÎ
, 
kÌ
, 
k¾
, 
k¼
, 
w0
, 
w1
, 49);

762 
	`subl
(28èğ
kÎ
; 
	`subr
(28èğ
kÌ
;

763 
	`subl
(29èğ
k¾
; 
	`subr
(29èğ
k¼
;

766 
	`subl
(2èğ
k¾l
; 
	`subr
(2èğ
k¾r
;

767 
	`subl
(3èğ
k¼l
; 
	`subr
(3èğ
k¼r
;

768 
	`CAMELLIA_ROLDQ
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 30);

769 
	`subl
(10èğ
k¾l
; 
	`subr
(10èğ
k¾r
;

770 
	`subl
(11èğ
k¼l
; 
	`subr
(11èğ
k¼r
;

771 
	`CAMELLIA_ROLDQ
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 30);

772 
	`subl
(20èğ
k¾l
; 
	`subr
(20èğ
k¾r
;

773 
	`subl
(21èğ
k¼l
; 
	`subr
(21èğ
k¼r
;

774 
	`CAMELLIA_ROLDQo32
(
k¾l
, 
k¾r
, 
k¼l
, 
k¼r
, 
w0
, 
w1
, 51);

775 
	`subl
(32èğ
k¾l
; 
	`subr
(32èğ
k¾r
;

776 
	`subl
(33èğ
k¼l
; 
	`subr
(33èğ
k¼r
;

779 
	`subl
(3è^ğsubl(1); 
	`subr
(3) ^= subr(1);

780 
	`subl
(5è^ğsubl(1); 
	`subr
(5) ^= subr(1);

781 
	`subl
(7è^ğsubl(1); 
	`subr
(7) ^= subr(1);

782 
	`subl
(1è^ğ
	`subr
(1) & ~subr(9);

783 
dw
 = 
	`subl
(1è& subl(9), 
	`subr
(1è^ğ
	`CAMELLIA_RL1
(dw);

784 
	`subl
(11è^ğsubl(1); 
	`subr
(11) ^= subr(1);

785 
	`subl
(13è^ğsubl(1); 
	`subr
(13) ^= subr(1);

786 
	`subl
(15è^ğsubl(1); 
	`subr
(15) ^= subr(1);

787 
	`subl
(1è^ğ
	`subr
(1) & ~subr(17);

788 
dw
 = 
	`subl
(1è& subl(17), 
	`subr
(1è^ğ
	`CAMELLIA_RL1
(dw);

789 
	`subl
(19è^ğsubl(1); 
	`subr
(19) ^= subr(1);

790 
	`subl
(21è^ğsubl(1); 
	`subr
(21) ^= subr(1);

791 
	`subl
(23è^ğsubl(1); 
	`subr
(23) ^= subr(1);

792 
	`subl
(1è^ğ
	`subr
(1) & ~subr(25);

793 
dw
 = 
	`subl
(1è& subl(25), 
	`subr
(1è^ğ
	`CAMELLIA_RL1
(dw);

794 
	`subl
(27è^ğsubl(1); 
	`subr
(27) ^= subr(1);

795 
	`subl
(29è^ğsubl(1); 
	`subr
(29) ^= subr(1);

796 
	`subl
(31è^ğsubl(1); 
	`subr
(31) ^= subr(1);

797 
	`subl
(32è^ğsubl(1); 
	`subr
(32) ^= subr(1);

800 
kw4l
 = 
	`subl
(33); 
kw4r
 = 
	`subr
(33);

801 
	`subl
(30è^ğ
kw4l
; 
	`subr
(30è^ğ
kw4r
;

802 
	`subl
(28è^ğ
kw4l
; 
	`subr
(28è^ğ
kw4r
;

803 
	`subl
(26è^ğ
kw4l
; 
	`subr
(26è^ğ
kw4r
;

804 
kw4l
 ^ğ
kw4r
 & ~
	`subr
(24);

805 
dw
 = 
kw4l
 & 
	`subl
(24), 
kw4r
 ^ğ
	`CAMELLIA_RL1
(dw);

806 
	`subl
(22è^ğ
kw4l
; 
	`subr
(22è^ğ
kw4r
;

807 
	`subl
(20è^ğ
kw4l
; 
	`subr
(20è^ğ
kw4r
;

808 
	`subl
(18è^ğ
kw4l
; 
	`subr
(18è^ğ
kw4r
;

809 
kw4l
 ^ğ
kw4r
 & ~
	`subr
(16);

810 
dw
 = 
kw4l
 & 
	`subl
(16), 
kw4r
 ^ğ
	`CAMELLIA_RL1
(dw);

811 
	`subl
(14è^ğ
kw4l
; 
	`subr
(14è^ğ
kw4r
;

812 
	`subl
(12è^ğ
kw4l
; 
	`subr
(12è^ğ
kw4r
;

813 
	`subl
(10è^ğ
kw4l
; 
	`subr
(10è^ğ
kw4r
;

814 
kw4l
 ^ğ
kw4r
 & ~
	`subr
(8);

815 
dw
 = 
kw4l
 & 
	`subl
(8), 
kw4r
 ^ğ
	`CAMELLIA_RL1
(dw);

816 
	`subl
(6è^ğ
kw4l
; 
	`subr
(6è^ğ
kw4r
;

817 
	`subl
(4è^ğ
kw4l
; 
	`subr
(4è^ğ
kw4r
;

818 
	`subl
(2è^ğ
kw4l
; 
	`subr
(2è^ğ
kw4r
;

819 
	`subl
(0è^ğ
kw4l
; 
	`subr
(0è^ğ
kw4r
;

822 
	`Cam–lŸSubkeyL
(0èğ
	`subl
(0) ^ subl(2);

823 
	`Cam–lŸSubkeyR
(0èğ
	`subr
(0) ^ subr(2);

824 
	`Cam–lŸSubkeyL
(2èğ
	`subl
(3);

825 
	`Cam–lŸSubkeyR
(2èğ
	`subr
(3);

826 
	`Cam–lŸSubkeyL
(3èğ
	`subl
(2) ^ subl(4);

827 
	`Cam–lŸSubkeyR
(3èğ
	`subr
(2) ^ subr(4);

828 
	`Cam–lŸSubkeyL
(4èğ
	`subl
(3) ^ subl(5);

829 
	`Cam–lŸSubkeyR
(4èğ
	`subr
(3) ^ subr(5);

830 
	`Cam–lŸSubkeyL
(5èğ
	`subl
(4) ^ subl(6);

831 
	`Cam–lŸSubkeyR
(5èğ
	`subr
(4) ^ subr(6);

832 
	`Cam–lŸSubkeyL
(6èğ
	`subl
(5) ^ subl(7);

833 
	`Cam–lŸSubkeyR
(6èğ
	`subr
(5) ^ subr(7);

834 

 = 
	`subl
(10è^ (
	`subr
(10) & ~subr(8));

835 
dw
 = 

 & 
	`subl
(8), 
Œ
 = 
	`subr
(10è^ 
	`CAMELLIA_RL1
(dw);

836 
	`Cam–lŸSubkeyL
(7èğ
	`subl
(6è^ 

;

837 
	`Cam–lŸSubkeyR
(7èğ
	`subr
(6è^ 
Œ
;

838 
	`Cam–lŸSubkeyL
(8èğ
	`subl
(8);

839 
	`Cam–lŸSubkeyR
(8èğ
	`subr
(8);

840 
	`Cam–lŸSubkeyL
(9èğ
	`subl
(9);

841 
	`Cam–lŸSubkeyR
(9èğ
	`subr
(9);

842 

 = 
	`subl
(7è^ (
	`subr
(7) & ~subr(9));

843 
dw
 = 

 & 
	`subl
(9), 
Œ
 = 
	`subr
(7è^ 
	`CAMELLIA_RL1
(dw);

844 
	`Cam–lŸSubkeyL
(10èğ

 ^ 
	`subl
(11);

845 
	`Cam–lŸSubkeyR
(10èğ
Œ
 ^ 
	`subr
(11);

846 
	`Cam–lŸSubkeyL
(11èğ
	`subl
(10) ^ subl(12);

847 
	`Cam–lŸSubkeyR
(11èğ
	`subr
(10) ^ subr(12);

848 
	`Cam–lŸSubkeyL
(12èğ
	`subl
(11) ^ subl(13);

849 
	`Cam–lŸSubkeyR
(12èğ
	`subr
(11) ^ subr(13);

850 
	`Cam–lŸSubkeyL
(13èğ
	`subl
(12) ^ subl(14);

851 
	`Cam–lŸSubkeyR
(13èğ
	`subr
(12) ^ subr(14);

852 
	`Cam–lŸSubkeyL
(14èğ
	`subl
(13) ^ subl(15);

853 
	`Cam–lŸSubkeyR
(14èğ
	`subr
(13) ^ subr(15);

854 

 = 
	`subl
(18è^ (
	`subr
(18) & ~subr(16));

855 
dw
 = 

 & 
	`subl
(16), 
Œ
 = 
	`subr
(18è^ 
	`CAMELLIA_RL1
(dw);

856 
	`Cam–lŸSubkeyL
(15èğ
	`subl
(14è^ 

;

857 
	`Cam–lŸSubkeyR
(15èğ
	`subr
(14è^ 
Œ
;

858 
	`Cam–lŸSubkeyL
(16èğ
	`subl
(16);

859 
	`Cam–lŸSubkeyR
(16èğ
	`subr
(16);

860 
	`Cam–lŸSubkeyL
(17èğ
	`subl
(17);

861 
	`Cam–lŸSubkeyR
(17èğ
	`subr
(17);

862 

 = 
	`subl
(15è^ (
	`subr
(15) & ~subr(17));

863 
dw
 = 

 & 
	`subl
(17), 
Œ
 = 
	`subr
(15è^ 
	`CAMELLIA_RL1
(dw);

864 
	`Cam–lŸSubkeyL
(18èğ

 ^ 
	`subl
(19);

865 
	`Cam–lŸSubkeyR
(18èğ
Œ
 ^ 
	`subr
(19);

866 
	`Cam–lŸSubkeyL
(19èğ
	`subl
(18) ^ subl(20);

867 
	`Cam–lŸSubkeyR
(19èğ
	`subr
(18) ^ subr(20);

868 
	`Cam–lŸSubkeyL
(20èğ
	`subl
(19) ^ subl(21);

869 
	`Cam–lŸSubkeyR
(20èğ
	`subr
(19) ^ subr(21);

870 
	`Cam–lŸSubkeyL
(21èğ
	`subl
(20) ^ subl(22);

871 
	`Cam–lŸSubkeyR
(21èğ
	`subr
(20) ^ subr(22);

872 
	`Cam–lŸSubkeyL
(22èğ
	`subl
(21) ^ subl(23);

873 
	`Cam–lŸSubkeyR
(22èğ
	`subr
(21) ^ subr(23);

874 

 = 
	`subl
(26è^ (
	`subr
(26) & ~subr(24));

875 
dw
 = 

 & 
	`subl
(24), 
Œ
 = 
	`subr
(26è^ 
	`CAMELLIA_RL1
(dw);

876 
	`Cam–lŸSubkeyL
(23èğ
	`subl
(22è^ 

;

877 
	`Cam–lŸSubkeyR
(23èğ
	`subr
(22è^ 
Œ
;

878 
	`Cam–lŸSubkeyL
(24èğ
	`subl
(24);

879 
	`Cam–lŸSubkeyR
(24èğ
	`subr
(24);

880 
	`Cam–lŸSubkeyL
(25èğ
	`subl
(25);

881 
	`Cam–lŸSubkeyR
(25èğ
	`subr
(25);

882 

 = 
	`subl
(23è^ (
	`subr
(23) & ~subr(25));

883 
dw
 = 

 & 
	`subl
(25), 
Œ
 = 
	`subr
(23è^ 
	`CAMELLIA_RL1
(dw);

884 
	`Cam–lŸSubkeyL
(26èğ

 ^ 
	`subl
(27);

885 
	`Cam–lŸSubkeyR
(26èğ
Œ
 ^ 
	`subr
(27);

886 
	`Cam–lŸSubkeyL
(27èğ
	`subl
(26) ^ subl(28);

887 
	`Cam–lŸSubkeyR
(27èğ
	`subr
(26) ^ subr(28);

888 
	`Cam–lŸSubkeyL
(28èğ
	`subl
(27) ^ subl(29);

889 
	`Cam–lŸSubkeyR
(28èğ
	`subr
(27) ^ subr(29);

890 
	`Cam–lŸSubkeyL
(29èğ
	`subl
(28) ^ subl(30);

891 
	`Cam–lŸSubkeyR
(29èğ
	`subr
(28) ^ subr(30);

892 
	`Cam–lŸSubkeyL
(30èğ
	`subl
(29) ^ subl(31);

893 
	`Cam–lŸSubkeyR
(30èğ
	`subr
(29) ^ subr(31);

894 
	`Cam–lŸSubkeyL
(31èğ
	`subl
(30);

895 
	`Cam–lŸSubkeyR
(31èğ
	`subr
(30);

896 
	`Cam–lŸSubkeyL
(32èğ
	`subl
(32) ^ subl(31);

897 
	`Cam–lŸSubkeyR
(32èğ
	`subr
(32) ^ subr(31);

900 
dw
 = 
	`Cam–lŸSubkeyL
(2è^ 
	`Cam–lŸSubkeyR
(2), dw = 
	`CAMELLIA_RL8
(dw);

901 
	`Cam–lŸSubkeyR
(2èğ
	`Cam–lŸSubkeyL
(2è^ 
dw
, CamelliaSubkeyL(2) = dw;

902 
dw
 = 
	`Cam–lŸSubkeyL
(3è^ 
	`Cam–lŸSubkeyR
(3), dw = 
	`CAMELLIA_RL8
(dw);

903 
	`Cam–lŸSubkeyR
(3èğ
	`Cam–lŸSubkeyL
(3è^ 
dw
, CamelliaSubkeyL(3) = dw;

904 
dw
 = 
	`Cam–lŸSubkeyL
(4è^ 
	`Cam–lŸSubkeyR
(4), dw = 
	`CAMELLIA_RL8
(dw);

905 
	`Cam–lŸSubkeyR
(4èğ
	`Cam–lŸSubkeyL
(4è^ 
dw
, CamelliaSubkeyL(4) = dw;

906 
dw
 = 
	`Cam–lŸSubkeyL
(5è^ 
	`Cam–lŸSubkeyR
(5), dw = 
	`CAMELLIA_RL8
(dw);

907 
	`Cam–lŸSubkeyR
(5èğ
	`Cam–lŸSubkeyL
(5è^ 
dw
, CamelliaSubkeyL(5) = dw;

908 
dw
 = 
	`Cam–lŸSubkeyL
(6è^ 
	`Cam–lŸSubkeyR
(6), dw = 
	`CAMELLIA_RL8
(dw);

909 
	`Cam–lŸSubkeyR
(6èğ
	`Cam–lŸSubkeyL
(6è^ 
dw
, CamelliaSubkeyL(6) = dw;

910 
dw
 = 
	`Cam–lŸSubkeyL
(7è^ 
	`Cam–lŸSubkeyR
(7), dw = 
	`CAMELLIA_RL8
(dw);

911 
	`Cam–lŸSubkeyR
(7èğ
	`Cam–lŸSubkeyL
(7è^ 
dw
, CamelliaSubkeyL(7) = dw;

912 
dw
 = 
	`Cam–lŸSubkeyL
(10è^ 
	`Cam–lŸSubkeyR
(10), dw = 
	`CAMELLIA_RL8
(dw);

913 
	`Cam–lŸSubkeyR
(10èğ
	`Cam–lŸSubkeyL
(10è^ 
dw
, CamelliaSubkeyL(10) = dw;

914 
dw
 = 
	`Cam–lŸSubkeyL
(11è^ 
	`Cam–lŸSubkeyR
(11), dw = 
	`CAMELLIA_RL8
(dw);

915 
	`Cam–lŸSubkeyR
(11èğ
	`Cam–lŸSubkeyL
(11è^ 
dw
, CamelliaSubkeyL(11) = dw;

916 
dw
 = 
	`Cam–lŸSubkeyL
(12è^ 
	`Cam–lŸSubkeyR
(12), dw = 
	`CAMELLIA_RL8
(dw);

917 
	`Cam–lŸSubkeyR
(12èğ
	`Cam–lŸSubkeyL
(12è^ 
dw
, CamelliaSubkeyL(12) = dw;

918 
dw
 = 
	`Cam–lŸSubkeyL
(13è^ 
	`Cam–lŸSubkeyR
(13), dw = 
	`CAMELLIA_RL8
(dw);

919 
	`Cam–lŸSubkeyR
(13èğ
	`Cam–lŸSubkeyL
(13è^ 
dw
, CamelliaSubkeyL(13) = dw;

920 
dw
 = 
	`Cam–lŸSubkeyL
(14è^ 
	`Cam–lŸSubkeyR
(14), dw = 
	`CAMELLIA_RL8
(dw);

921 
	`Cam–lŸSubkeyR
(14èğ
	`Cam–lŸSubkeyL
(14è^ 
dw
, CamelliaSubkeyL(14) = dw;

922 
dw
 = 
	`Cam–lŸSubkeyL
(15è^ 
	`Cam–lŸSubkeyR
(15), dw = 
	`CAMELLIA_RL8
(dw);

923 
	`Cam–lŸSubkeyR
(15èğ
	`Cam–lŸSubkeyL
(15è^ 
dw
, CamelliaSubkeyL(15) = dw;

924 
dw
 = 
	`Cam–lŸSubkeyL
(18è^ 
	`Cam–lŸSubkeyR
(18), dw = 
	`CAMELLIA_RL8
(dw);

925 
	`Cam–lŸSubkeyR
(18èğ
	`Cam–lŸSubkeyL
(18è^ 
dw
, CamelliaSubkeyL(18) = dw;

926 
dw
 = 
	`Cam–lŸSubkeyL
(19è^ 
	`Cam–lŸSubkeyR
(19), dw = 
	`CAMELLIA_RL8
(dw);

927 
	`Cam–lŸSubkeyR
(19èğ
	`Cam–lŸSubkeyL
(19è^ 
dw
, CamelliaSubkeyL(19) = dw;

928 
dw
 = 
	`Cam–lŸSubkeyL
(20è^ 
	`Cam–lŸSubkeyR
(20), dw = 
	`CAMELLIA_RL8
(dw);

929 
	`Cam–lŸSubkeyR
(20èğ
	`Cam–lŸSubkeyL
(20è^ 
dw
, CamelliaSubkeyL(20) = dw;

930 
dw
 = 
	`Cam–lŸSubkeyL
(21è^ 
	`Cam–lŸSubkeyR
(21), dw = 
	`CAMELLIA_RL8
(dw);

931 
	`Cam–lŸSubkeyR
(21èğ
	`Cam–lŸSubkeyL
(21è^ 
dw
, CamelliaSubkeyL(21) = dw;

932 
dw
 = 
	`Cam–lŸSubkeyL
(22è^ 
	`Cam–lŸSubkeyR
(22), dw = 
	`CAMELLIA_RL8
(dw);

933 
	`Cam–lŸSubkeyR
(22èğ
	`Cam–lŸSubkeyL
(22è^ 
dw
, CamelliaSubkeyL(22) = dw;

934 
dw
 = 
	`Cam–lŸSubkeyL
(23è^ 
	`Cam–lŸSubkeyR
(23), dw = 
	`CAMELLIA_RL8
(dw);

935 
	`Cam–lŸSubkeyR
(23èğ
	`Cam–lŸSubkeyL
(23è^ 
dw
, CamelliaSubkeyL(23) = dw;

936 
dw
 = 
	`Cam–lŸSubkeyL
(26è^ 
	`Cam–lŸSubkeyR
(26), dw = 
	`CAMELLIA_RL8
(dw);

937 
	`Cam–lŸSubkeyR
(26èğ
	`Cam–lŸSubkeyL
(26è^ 
dw
, CamelliaSubkeyL(26) = dw;

938 
dw
 = 
	`Cam–lŸSubkeyL
(27è^ 
	`Cam–lŸSubkeyR
(27), dw = 
	`CAMELLIA_RL8
(dw);

939 
	`Cam–lŸSubkeyR
(27èğ
	`Cam–lŸSubkeyL
(27è^ 
dw
, CamelliaSubkeyL(27) = dw;

940 
dw
 = 
	`Cam–lŸSubkeyL
(28è^ 
	`Cam–lŸSubkeyR
(28), dw = 
	`CAMELLIA_RL8
(dw);

941 
	`Cam–lŸSubkeyR
(28èğ
	`Cam–lŸSubkeyL
(28è^ 
dw
, CamelliaSubkeyL(28) = dw;

942 
dw
 = 
	`Cam–lŸSubkeyL
(29è^ 
	`Cam–lŸSubkeyR
(29), dw = 
	`CAMELLIA_RL8
(dw);

943 
	`Cam–lŸSubkeyR
(29èğ
	`Cam–lŸSubkeyL
(29è^ 
dw
, CamelliaSubkeyL(29) = dw;

944 
dw
 = 
	`Cam–lŸSubkeyL
(30è^ 
	`Cam–lŸSubkeyR
(30), dw = 
	`CAMELLIA_RL8
(dw);

945 
	`Cam–lŸSubkeyR
(30èğ
	`Cam–lŸSubkeyL
(30è^ 
dw
, CamelliaSubkeyL(30) = dw;

946 
dw
 = 
	`Cam–lŸSubkeyL
(31è^ 
	`Cam–lŸSubkeyR
(31), dw = 
	`CAMELLIA_RL8
(dw);

947 
	`Cam–lŸSubkeyR
(31èğ
	`Cam–lŸSubkeyL
(31è^ 
dw
,CamelliaSubkeyL(31) = dw;

950 
	}
}

952 
	$ÿm–lŸ_£tup192
(cÚ¡ *
key
, 
u32
 *
subkey
)

954 
kk
[32];

955 
u32
 
k¾l
, 
k¾r
, 
k¼l
,
k¼r
;

957 
	`memıy
(
kk
, 
key
, 24);

958 
	`memıy
((*)&
k¾l
, 
key
+16,4);

959 
	`memıy
((*)&
k¾r
, 
key
+20,4);

960 
k¼l
 = ~
k¾l
;

961 
k¼r
 = ~
k¾r
;

962 
	`memıy
(
kk
+24, (*)&
k¼l
, 4);

963 
	`memıy
(
kk
+28, (*)&
k¼r
, 4);

964 
	`ÿm–lŸ_£tup256
(
kk
, 
subkey
);

966 
	}
}

974 
	$ÿm–lŸ_’üy±128
(cÚ¡ 
u32
 *
subkey
, u32 *
io
)

976 
u32
 

, 
œ
, 
t0
, 
t1
;

979 
io
[0] ^ğ
	`Cam–lŸSubkeyL
(0);

980 
io
[1] ^ğ
	`Cam–lŸSubkeyR
(0);

983 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

984 
	`Cam–lŸSubkeyL
(2),
	`Cam–lŸSubkeyR
(2),

985 
io
[2],io[3],

,
œ
,
t0
,
t1
);

986 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

987 
	`Cam–lŸSubkeyL
(3),
	`Cam–lŸSubkeyR
(3),

988 
io
[0],io[1],

,
œ
,
t0
,
t1
);

989 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

990 
	`Cam–lŸSubkeyL
(4),
	`Cam–lŸSubkeyR
(4),

991 
io
[2],io[3],

,
œ
,
t0
,
t1
);

992 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

993 
	`Cam–lŸSubkeyL
(5),
	`Cam–lŸSubkeyR
(5),

994 
io
[0],io[1],

,
œ
,
t0
,
t1
);

995 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

996 
	`Cam–lŸSubkeyL
(6),
	`Cam–lŸSubkeyR
(6),

997 
io
[2],io[3],

,
œ
,
t0
,
t1
);

998 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

999 
	`Cam–lŸSubkeyL
(7),
	`Cam–lŸSubkeyR
(7),

1000 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1002 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1003 
	`Cam–lŸSubkeyL
(8),
	`Cam–lŸSubkeyR
(8),

1004 
	`Cam–lŸSubkeyL
(9),
	`Cam–lŸSubkeyR
(9),

1005 
t0
,
t1
,

,
œ
);

1007 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1008 
	`Cam–lŸSubkeyL
(10),
	`Cam–lŸSubkeyR
(10),

1009 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1010 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1011 
	`Cam–lŸSubkeyL
(11),
	`Cam–lŸSubkeyR
(11),

1012 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1013 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1014 
	`Cam–lŸSubkeyL
(12),
	`Cam–lŸSubkeyR
(12),

1015 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1016 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1017 
	`Cam–lŸSubkeyL
(13),
	`Cam–lŸSubkeyR
(13),

1018 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1019 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1020 
	`Cam–lŸSubkeyL
(14),
	`Cam–lŸSubkeyR
(14),

1021 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1022 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1023 
	`Cam–lŸSubkeyL
(15),
	`Cam–lŸSubkeyR
(15),

1024 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1026 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1027 
	`Cam–lŸSubkeyL
(16),
	`Cam–lŸSubkeyR
(16),

1028 
	`Cam–lŸSubkeyL
(17),
	`Cam–lŸSubkeyR
(17),

1029 
t0
,
t1
,

,
œ
);

1031 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1032 
	`Cam–lŸSubkeyL
(18),
	`Cam–lŸSubkeyR
(18),

1033 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1034 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1035 
	`Cam–lŸSubkeyL
(19),
	`Cam–lŸSubkeyR
(19),

1036 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1037 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1038 
	`Cam–lŸSubkeyL
(20),
	`Cam–lŸSubkeyR
(20),

1039 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1040 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1041 
	`Cam–lŸSubkeyL
(21),
	`Cam–lŸSubkeyR
(21),

1042 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1043 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1044 
	`Cam–lŸSubkeyL
(22),
	`Cam–lŸSubkeyR
(22),

1045 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1046 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1047 
	`Cam–lŸSubkeyL
(23),
	`Cam–lŸSubkeyR
(23),

1048 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1051 
io
[2] ^ğ
	`Cam–lŸSubkeyL
(24);

1052 
io
[3] ^ğ
	`Cam–lŸSubkeyR
(24);

1054 
t0
 = 
io
[0];

1055 
t1
 = 
io
[1];

1056 
io
[0] = io[2];

1057 
io
[1] = io[3];

1058 
io
[2] = 
t0
;

1059 
io
[3] = 
t1
;

1062 
	}
}

1064 
	$ÿm–lŸ_deüy±128
(cÚ¡ 
u32
 *
subkey
, u32 *
io
)

1066 
u32
 

,
œ
,
t0
,
t1
;

1069 
io
[0] ^ğ
	`Cam–lŸSubkeyL
(24);

1070 
io
[1] ^ğ
	`Cam–lŸSubkeyR
(24);

1073 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1074 
	`Cam–lŸSubkeyL
(23),
	`Cam–lŸSubkeyR
(23),

1075 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1076 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1077 
	`Cam–lŸSubkeyL
(22),
	`Cam–lŸSubkeyR
(22),

1078 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1079 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1080 
	`Cam–lŸSubkeyL
(21),
	`Cam–lŸSubkeyR
(21),

1081 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1082 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1083 
	`Cam–lŸSubkeyL
(20),
	`Cam–lŸSubkeyR
(20),

1084 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1085 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1086 
	`Cam–lŸSubkeyL
(19),
	`Cam–lŸSubkeyR
(19),

1087 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1088 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1089 
	`Cam–lŸSubkeyL
(18),
	`Cam–lŸSubkeyR
(18),

1090 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1092 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1093 
	`Cam–lŸSubkeyL
(17),
	`Cam–lŸSubkeyR
(17),

1094 
	`Cam–lŸSubkeyL
(16),
	`Cam–lŸSubkeyR
(16),

1095 
t0
,
t1
,

,
œ
);

1097 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1098 
	`Cam–lŸSubkeyL
(15),
	`Cam–lŸSubkeyR
(15),

1099 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1100 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1101 
	`Cam–lŸSubkeyL
(14),
	`Cam–lŸSubkeyR
(14),

1102 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1103 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1104 
	`Cam–lŸSubkeyL
(13),
	`Cam–lŸSubkeyR
(13),

1105 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1106 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1107 
	`Cam–lŸSubkeyL
(12),
	`Cam–lŸSubkeyR
(12),

1108 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1109 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1110 
	`Cam–lŸSubkeyL
(11),
	`Cam–lŸSubkeyR
(11),

1111 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1112 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1113 
	`Cam–lŸSubkeyL
(10),
	`Cam–lŸSubkeyR
(10),

1114 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1116 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1117 
	`Cam–lŸSubkeyL
(9),
	`Cam–lŸSubkeyR
(9),

1118 
	`Cam–lŸSubkeyL
(8),
	`Cam–lŸSubkeyR
(8),

1119 
t0
,
t1
,

,
œ
);

1121 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1122 
	`Cam–lŸSubkeyL
(7),
	`Cam–lŸSubkeyR
(7),

1123 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1124 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1125 
	`Cam–lŸSubkeyL
(6),
	`Cam–lŸSubkeyR
(6),

1126 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1127 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1128 
	`Cam–lŸSubkeyL
(5),
	`Cam–lŸSubkeyR
(5),

1129 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1130 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1131 
	`Cam–lŸSubkeyL
(4),
	`Cam–lŸSubkeyR
(4),

1132 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1133 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1134 
	`Cam–lŸSubkeyL
(3),
	`Cam–lŸSubkeyR
(3),

1135 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1136 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1137 
	`Cam–lŸSubkeyL
(2),
	`Cam–lŸSubkeyR
(2),

1138 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1141 
io
[2] ^ğ
	`Cam–lŸSubkeyL
(0);

1142 
io
[3] ^ğ
	`Cam–lŸSubkeyR
(0);

1144 
t0
 = 
io
[0];

1145 
t1
 = 
io
[1];

1146 
io
[0] = io[2];

1147 
io
[1] = io[3];

1148 
io
[2] = 
t0
;

1149 
io
[3] = 
t1
;

1152 
	}
}

1157 
	$ÿm–lŸ_’üy±256
(cÚ¡ 
u32
 *
subkey
, u32 *
io
)

1159 
u32
 

,
œ
,
t0
,
t1
;

1162 
io
[0] ^ğ
	`Cam–lŸSubkeyL
(0);

1163 
io
[1] ^ğ
	`Cam–lŸSubkeyR
(0);

1166 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1167 
	`Cam–lŸSubkeyL
(2),
	`Cam–lŸSubkeyR
(2),

1168 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1169 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1170 
	`Cam–lŸSubkeyL
(3),
	`Cam–lŸSubkeyR
(3),

1171 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1172 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1173 
	`Cam–lŸSubkeyL
(4),
	`Cam–lŸSubkeyR
(4),

1174 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1175 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1176 
	`Cam–lŸSubkeyL
(5),
	`Cam–lŸSubkeyR
(5),

1177 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1178 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1179 
	`Cam–lŸSubkeyL
(6),
	`Cam–lŸSubkeyR
(6),

1180 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1181 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1182 
	`Cam–lŸSubkeyL
(7),
	`Cam–lŸSubkeyR
(7),

1183 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1185 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1186 
	`Cam–lŸSubkeyL
(8),
	`Cam–lŸSubkeyR
(8),

1187 
	`Cam–lŸSubkeyL
(9),
	`Cam–lŸSubkeyR
(9),

1188 
t0
,
t1
,

,
œ
);

1190 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1191 
	`Cam–lŸSubkeyL
(10),
	`Cam–lŸSubkeyR
(10),

1192 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1193 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1194 
	`Cam–lŸSubkeyL
(11),
	`Cam–lŸSubkeyR
(11),

1195 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1196 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1197 
	`Cam–lŸSubkeyL
(12),
	`Cam–lŸSubkeyR
(12),

1198 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1199 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1200 
	`Cam–lŸSubkeyL
(13),
	`Cam–lŸSubkeyR
(13),

1201 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1202 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1203 
	`Cam–lŸSubkeyL
(14),
	`Cam–lŸSubkeyR
(14),

1204 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1205 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1206 
	`Cam–lŸSubkeyL
(15),
	`Cam–lŸSubkeyR
(15),

1207 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1209 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1210 
	`Cam–lŸSubkeyL
(16),
	`Cam–lŸSubkeyR
(16),

1211 
	`Cam–lŸSubkeyL
(17),
	`Cam–lŸSubkeyR
(17),

1212 
t0
,
t1
,

,
œ
);

1214 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1215 
	`Cam–lŸSubkeyL
(18),
	`Cam–lŸSubkeyR
(18),

1216 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1217 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1218 
	`Cam–lŸSubkeyL
(19),
	`Cam–lŸSubkeyR
(19),

1219 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1220 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1221 
	`Cam–lŸSubkeyL
(20),
	`Cam–lŸSubkeyR
(20),

1222 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1223 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1224 
	`Cam–lŸSubkeyL
(21),
	`Cam–lŸSubkeyR
(21),

1225 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1226 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1227 
	`Cam–lŸSubkeyL
(22),
	`Cam–lŸSubkeyR
(22),

1228 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1229 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1230 
	`Cam–lŸSubkeyL
(23),
	`Cam–lŸSubkeyR
(23),

1231 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1233 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1234 
	`Cam–lŸSubkeyL
(24),
	`Cam–lŸSubkeyR
(24),

1235 
	`Cam–lŸSubkeyL
(25),
	`Cam–lŸSubkeyR
(25),

1236 
t0
,
t1
,

,
œ
);

1238 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1239 
	`Cam–lŸSubkeyL
(26),
	`Cam–lŸSubkeyR
(26),

1240 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1241 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1242 
	`Cam–lŸSubkeyL
(27),
	`Cam–lŸSubkeyR
(27),

1243 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1244 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1245 
	`Cam–lŸSubkeyL
(28),
	`Cam–lŸSubkeyR
(28),

1246 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1247 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1248 
	`Cam–lŸSubkeyL
(29),
	`Cam–lŸSubkeyR
(29),

1249 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1250 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1251 
	`Cam–lŸSubkeyL
(30),
	`Cam–lŸSubkeyR
(30),

1252 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1253 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1254 
	`Cam–lŸSubkeyL
(31),
	`Cam–lŸSubkeyR
(31),

1255 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1258 
io
[2] ^ğ
	`Cam–lŸSubkeyL
(32);

1259 
io
[3] ^ğ
	`Cam–lŸSubkeyR
(32);

1261 
t0
 = 
io
[0];

1262 
t1
 = 
io
[1];

1263 
io
[0] = io[2];

1264 
io
[1] = io[3];

1265 
io
[2] = 
t0
;

1266 
io
[3] = 
t1
;

1269 
	}
}

1271 
	$ÿm–lŸ_deüy±256
(cÚ¡ 
u32
 *
subkey
, u32 *
io
)

1273 
u32
 

,
œ
,
t0
,
t1
;

1276 
io
[0] ^ğ
	`Cam–lŸSubkeyL
(32);

1277 
io
[1] ^ğ
	`Cam–lŸSubkeyR
(32);

1280 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1281 
	`Cam–lŸSubkeyL
(31),
	`Cam–lŸSubkeyR
(31),

1282 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1283 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1284 
	`Cam–lŸSubkeyL
(30),
	`Cam–lŸSubkeyR
(30),

1285 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1286 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1287 
	`Cam–lŸSubkeyL
(29),
	`Cam–lŸSubkeyR
(29),

1288 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1289 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1290 
	`Cam–lŸSubkeyL
(28),
	`Cam–lŸSubkeyR
(28),

1291 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1292 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1293 
	`Cam–lŸSubkeyL
(27),
	`Cam–lŸSubkeyR
(27),

1294 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1295 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1296 
	`Cam–lŸSubkeyL
(26),
	`Cam–lŸSubkeyR
(26),

1297 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1299 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1300 
	`Cam–lŸSubkeyL
(25),
	`Cam–lŸSubkeyR
(25),

1301 
	`Cam–lŸSubkeyL
(24),
	`Cam–lŸSubkeyR
(24),

1302 
t0
,
t1
,

,
œ
);

1304 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1305 
	`Cam–lŸSubkeyL
(23),
	`Cam–lŸSubkeyR
(23),

1306 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1307 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1308 
	`Cam–lŸSubkeyL
(22),
	`Cam–lŸSubkeyR
(22),

1309 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1310 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1311 
	`Cam–lŸSubkeyL
(21),
	`Cam–lŸSubkeyR
(21),

1312 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1313 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1314 
	`Cam–lŸSubkeyL
(20),
	`Cam–lŸSubkeyR
(20),

1315 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1316 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1317 
	`Cam–lŸSubkeyL
(19),
	`Cam–lŸSubkeyR
(19),

1318 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1319 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1320 
	`Cam–lŸSubkeyL
(18),
	`Cam–lŸSubkeyR
(18),

1321 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1323 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1324 
	`Cam–lŸSubkeyL
(17),
	`Cam–lŸSubkeyR
(17),

1325 
	`Cam–lŸSubkeyL
(16),
	`Cam–lŸSubkeyR
(16),

1326 
t0
,
t1
,

,
œ
);

1328 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1329 
	`Cam–lŸSubkeyL
(15),
	`Cam–lŸSubkeyR
(15),

1330 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1331 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1332 
	`Cam–lŸSubkeyL
(14),
	`Cam–lŸSubkeyR
(14),

1333 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1334 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1335 
	`Cam–lŸSubkeyL
(13),
	`Cam–lŸSubkeyR
(13),

1336 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1337 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1338 
	`Cam–lŸSubkeyL
(12),
	`Cam–lŸSubkeyR
(12),

1339 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1340 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1341 
	`Cam–lŸSubkeyL
(11),
	`Cam–lŸSubkeyR
(11),

1342 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1343 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1344 
	`Cam–lŸSubkeyL
(10),
	`Cam–lŸSubkeyR
(10),

1345 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1347 
	`CAMELLIA_FLS
(
io
[0],io[1],io[2],io[3],

1348 
	`Cam–lŸSubkeyL
(9),
	`Cam–lŸSubkeyR
(9),

1349 
	`Cam–lŸSubkeyL
(8),
	`Cam–lŸSubkeyR
(8),

1350 
t0
,
t1
,

,
œ
);

1352 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1353 
	`Cam–lŸSubkeyL
(7),
	`Cam–lŸSubkeyR
(7),

1354 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1355 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1356 
	`Cam–lŸSubkeyL
(6),
	`Cam–lŸSubkeyR
(6),

1357 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1358 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1359 
	`Cam–lŸSubkeyL
(5),
	`Cam–lŸSubkeyR
(5),

1360 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1361 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1362 
	`Cam–lŸSubkeyL
(4),
	`Cam–lŸSubkeyR
(4),

1363 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1364 
	`CAMELLIA_ROUNDSM
(
io
[0],io[1],

1365 
	`Cam–lŸSubkeyL
(3),
	`Cam–lŸSubkeyR
(3),

1366 
io
[2],io[3],

,
œ
,
t0
,
t1
);

1367 
	`CAMELLIA_ROUNDSM
(
io
[2],io[3],

1368 
	`Cam–lŸSubkeyL
(2),
	`Cam–lŸSubkeyR
(2),

1369 
io
[0],io[1],

,
œ
,
t0
,
t1
);

1372 
io
[2] ^ğ
	`Cam–lŸSubkeyL
(0);

1373 
io
[3] ^ğ
	`Cam–lŸSubkeyR
(0);

1375 
t0
 = 
io
[0];

1376 
t1
 = 
io
[1];

1377 
io
[0] = io[2];

1378 
io
[1] = io[3];

1379 
io
[2] = 
t0
;

1380 
io
[3] = 
t1
;

1383 
	}
}

1390 
	$Cam–lŸ_Ekeyg’
(cÚ¡ 
keyB™L’gth
,

1391 cÚ¡ *
¿wKey
,

1392 
KEY_TABLE_TYPE
 
keyTabË
)

1394 
keyB™L’gth
) {

1396 
	`ÿm–lŸ_£tup128
(
¿wKey
, 
keyTabË
);

1399 
	`ÿm–lŸ_£tup192
(
¿wKey
, 
keyTabË
);

1402 
	`ÿm–lŸ_£tup256
(
¿wKey
, 
keyTabË
);

1407 
	}
}

1410 
	$Cam–lŸ_Enüy±Block
(cÚ¡ 
keyB™L’gth
,

1411 cÚ¡ *
¶aš‹xt
,

1412 cÚ¡ 
KEY_TABLE_TYPE
 
keyTabË
,

1413 *
ch”‹xt
)

1415 
u32
 
tmp
[4];

1417 
tmp
[0] = 
	`GETU32
(
¶aš‹xt
);

1418 
tmp
[1] = 
	`GETU32
(
¶aš‹xt
 + 4);

1419 
tmp
[2] = 
	`GETU32
(
¶aš‹xt
 + 8);

1420 
tmp
[3] = 
	`GETU32
(
¶aš‹xt
 + 12);

1422 
keyB™L’gth
) {

1424 
	`ÿm–lŸ_’üy±128
(
keyTabË
, 
tmp
);

1429 
	`ÿm–lŸ_’üy±256
(
keyTabË
, 
tmp
);

1435 
	`PUTU32
(
ch”‹xt
, 
tmp
[0]);

1436 
	`PUTU32
(
ch”‹xt
 + 4, 
tmp
[1]);

1437 
	`PUTU32
(
ch”‹xt
 + 8, 
tmp
[2]);

1438 
	`PUTU32
(
ch”‹xt
 + 12, 
tmp
[3]);

1439 
	}
}

1441 
	$Cam–lŸ_Deüy±Block
(cÚ¡ 
keyB™L’gth
,

1442 cÚ¡ *
ch”‹xt
,

1443 cÚ¡ 
KEY_TABLE_TYPE
 
keyTabË
,

1444 *
¶aš‹xt
)

1446 
u32
 
tmp
[4];

1448 
tmp
[0] = 
	`GETU32
(
ch”‹xt
);

1449 
tmp
[1] = 
	`GETU32
(
ch”‹xt
 + 4);

1450 
tmp
[2] = 
	`GETU32
(
ch”‹xt
 + 8);

1451 
tmp
[3] = 
	`GETU32
(
ch”‹xt
 + 12);

1453 
keyB™L’gth
) {

1455 
	`ÿm–lŸ_deüy±128
(
keyTabË
, 
tmp
);

1460 
	`ÿm–lŸ_deüy±256
(
keyTabË
, 
tmp
);

1465 
	`PUTU32
(
¶aš‹xt
, 
tmp
[0]);

1466 
	`PUTU32
(
¶aš‹xt
 + 4, 
tmp
[1]);

1467 
	`PUTU32
(
¶aš‹xt
 + 8, 
tmp
[2]);

1468 
	`PUTU32
(
¶aš‹xt
 + 12, 
tmp
[3]);

1469 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\camellia-BSD-1.2.0\camellia.h

28 #iâdeà
HEADER_CAMELLIA_H


29 
	#HEADER_CAMELLIA_H


	)

31 #ifdeà 
__ılu¥lus


35 
	#CAMELLIA_BLOCK_SIZE
 16

	)

36 
	#CAMELLIA_TABLE_BYTE_LEN
 272

	)

37 
	#CAMELLIA_TABLE_WORD_LEN
 (
CAMELLIA_TABLE_BYTE_LEN
 / 4)

	)

39 
	tKEY_TABLE_TYPE
[
CAMELLIA_TABLE_WORD_LEN
];

42 
Cam–lŸ_Ekeyg’
(cÚ¡ 
keyB™L’gth
,

43 cÚ¡ *
¿wKey
,

44 
KEY_TABLE_TYPE
 
keyTabË
);

46 
Cam–lŸ_Enüy±Block
(cÚ¡ 
keyB™L’gth
,

47 cÚ¡ *
¶aš‹xt
,

48 cÚ¡ 
KEY_TABLE_TYPE
 
keyTabË
,

49 *
ch”Text
);

51 
Cam–lŸ_Deüy±Block
(cÚ¡ 
keyB™L’gth
,

52 cÚ¡ *
ch”Text
,

53 cÚ¡ 
KEY_TABLE_TYPE
 
keyTabË
,

54 *
¶aš‹xt
);

57 #ifdeà 
__ılu¥lus


	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\diskdrv\ff_gen_drv.c

29 
	~"ff_g’_drv.h
"

34 
Disk_drvTy³Def
 
	gdisk
 = {{0},{0},{0},0};

49 
ušt8_t
 
	$FATFS_LškDriv”Ex
(
Diskio_drvTy³Def
 *
drv
, *
·th
, 
ušt8_t
 
lun
)

51 
ušt8_t
 
»t
 = 1;

52 
ušt8_t
 
DiskNum
 = 0;

54 if(
disk
.
nbr
 <ğ
_VOLUMES
)

56 
disk
.
is_š™Ÿlized
[disk.
nbr
] = 0;

57 
disk
.
drv
[disk.
nbr
] = drv;

58 
disk
.
lun
[disk.
nbr
] =†un;

59 
DiskNum
 = 
disk
.
nbr
++;

60 
·th
[0] = 
DiskNum
 + '0';

61 
·th
[1] = ':';

62 
·th
[2] = '/';

63 
·th
[3] = 0;

64 
»t
 = 0;

67  
»t
;

68 
	}
}

78 
ušt8_t
 
	$FATFS_LškDriv”
(
Diskio_drvTy³Def
 *
drv
, *
·th
)

80  
	`FATFS_LškDriv”Ex
(
drv
, 
·th
, 0);

81 
	}
}

90 
ušt8_t
 
	$FATFS_UnLškDriv”Ex
(*
·th
, 
ušt8_t
 
lun
)

92 
ušt8_t
 
DiskNum
 = 0;

93 
ušt8_t
 
»t
 = 1;

95 if(
disk
.
nbr
 >= 1)

97 
DiskNum
 = 
·th
[0] - '0';

98 if(
disk
.
drv
[
DiskNum
] != 0)

100 
disk
.
drv
[
DiskNum
] = 0;

101 
disk
.
lun
[
DiskNum
] = 0;

102 
disk
.
nbr
--;

103 
»t
 = 0;

107  
»t
;

108 
	}
}

116 
ušt8_t
 
	$FATFS_UnLškDriv”
(*
·th
)

118  
	`FATFS_UnLškDriv”Ex
(
·th
, 0);

119 
	}
}

126 
ušt8_t
 
	$FATFS_G‘A‰achedDriv”sNbr
()

128  
disk
.
nbr
;

129 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\diskdrv\nand_diskio.c

2 
	~<¡ršg.h
>

3 
	~"ff_g’_drv.h
"

4 
	~"b¥_Çnd_ál.h
"

9 
	#BLOCK_SIZE
 512

	)

13 vŞ©
DSTATUS
 
	gSt
 = 
STA_NOINIT
;

16 
DSTATUS
 
NAND_š™Ÿlize
 (
BYTE
);

17 
DSTATUS
 
NAND_¡©us
 (
BYTE
);

18 
DRESULT
 
NAND_»ad
 (
BYTE
, BYTE *, 
DWORD
, 
UINT
);

19 
DRESULT
 
NAND_wr™e
 (
BYTE
, cÚ¡ BYTE *, 
DWORD
, 
UINT
);

20 
DRESULT
 
NAND_ioùl
 (
BYTE
, BYTE, *);

23 cÚ¡ 
Diskio_drvTy³Def
 
	gNANDDISK_Driv”
 =

25 
NAND_š™Ÿlize
,

26 
NAND_¡©us
,

27 
NAND_»ad
,

28 
NAND_wr™e
,

29 
NAND_ioùl
,

39 
DSTATUS
 
	$NAND_š™Ÿlize
(
BYTE
 
lun
)

41 
»tv®
;

42 
St
 = 
STA_NOINIT
;

44 
»tv®
 = 
	`FTL_In™
();

45 if(
»tv®
 == 0)

47 
St
 &ğ~
STA_NOINIT
;

50  
St
;

51 
	}
}

58 
DSTATUS
 
	$NAND_¡©us
(
BYTE
 
lun
)

60 
St
 = 
STA_NOINIT
;

62 
St
 &ğ~
STA_NOINIT
;

64  
St
;

65 
	}
}

75 
DRESULT
 
	$NAND_»ad
(
BYTE
 
lun
, BYTE *
buff
, 
DWORD
 
£ùÜ
, 
UINT
 
couÁ
)

77 
DRESULT
 
»s
 = 
RES_ERROR
;

79 if(
	`FTL_R—dSeùÜs
(
buff
, 
£ùÜ
, 
BLOCK_SIZE
, 
couÁ
) == 0)

81 
»s
 = 
RES_OK
;

85 
»s
 = 
RES_ERROR
;

88  
»s
;

89 
	}
}

99 
DRESULT
 
	$NAND_wr™e
(
BYTE
 
lun
, cÚ¡ BYTE *
buff
, 
DWORD
 
£ùÜ
, 
UINT
 
couÁ
)

101 
DRESULT
 
»s
 = 
RES_ERROR
;

102 if(
	`FTL_Wr™eSeùÜs
((
u8
 *)
buff
, 
£ùÜ
, 512, 
couÁ
) == 0)

104 
»s
 = 
RES_OK
;

108 
»s
 = 
RES_ERROR
;

111  
»s
;

112 
	}
}

121 
DRESULT
 
	$NAND_ioùl
(
BYTE
 
lun
, BYTE 
cmd
, *
buff
)

123 
DRESULT
 
»s
 = 
RES_ERROR
;

125 ià(
St
 & 
STA_NOINIT
)

127  
RES_NOTRDY
;

130 
cmd
)

133 
CTRL_SYNC
:

134 
»s
 = 
RES_OK
;

136 
GET_SECTOR_SIZE
:

137 *(
WORD
 *)
buff
 = 512;

138 
»s
 = 
RES_OK
;

140 
GET_BLOCK_SIZE
:

141 *(
WORD
 *)
buff
 = 
Çnd_dev
.
·ge_mašsize
 / 512;

142 
»s
 = 
RES_OK
;

144 
GET_SECTOR_COUNT
:

145 *(
DWORD
 *)
buff
 = 
Çnd_dev
.
v®id_blocknum
 *‚ªd_dev.
block_·g’um
 *‚ªd_dev.
·ge_mašsize
 / 512;

146 
»s
 = 
RES_OK
;

149 
»s
 = 
RES_PARERR
;

153  
»s
;

154 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\diskio.c

10 
	~"diskio.h
"

11 
	~"ff_g’_drv.h
"

12 
Disk_drvTy³Def
 
disk
;

18 
DSTATUS
 
	$disk_¡©us
 (

19 
BYTE
 
pdrv


22 
DSTATUS
 
¡©
 = 
STA_NOINIT
;

23 
¡©
 = 
disk
.
drv
[
pdrv
]->
	`disk_¡©us
(disk.
lun
[pdrv]);

24  
¡©
;

25 
	}
}

33 
DSTATUS
 
	$disk_š™Ÿlize
 (

34 
BYTE
 
pdrv


37 
DSTATUS
 
¡©
 = 
RES_OK
;

38 if(
disk
.
is_š™Ÿlized
[
pdrv
] == 0)

40 
disk
.
is_š™Ÿlized
[
pdrv
] = 1;

41 
¡©
 = 
disk
.
drv
[
pdrv
]->
	`disk_š™Ÿlize
(disk.
lun
[pdrv]);

43  
¡©
;

44 
	}
}

52 
DRESULT
 
	$disk_»ad
 (

53 
BYTE
 
pdrv
,

54 
BYTE
 *
buff
,

55 
DWORD
 
£ùÜ
,

56 
UINT
 
couÁ


59 
DRESULT
 
»s
 = 
RES_PARERR
;

60 
»s
 = 
disk
.
drv
[
pdrv
]->
	`disk_»ad
(disk.
lun
[pdrv], 
buff
, 
£ùÜ
, 
couÁ
);

61  
»s
;

62 
	}
}

70 
DRESULT
 
	$disk_wr™e
 (

71 
BYTE
 
pdrv
,

72 cÚ¡ 
BYTE
 *
buff
,

73 
DWORD
 
£ùÜ
,

74 
UINT
 
couÁ


77 
DRESULT
 
»s
 = 
RES_PARERR
;

78 
»s
 = 
disk
.
drv
[
pdrv
]->
	`disk_wr™e
(disk.
lun
[pdrv], 
buff
, 
£ùÜ
, 
couÁ
);

79  
»s
;

80 
	}
}

88 
DRESULT
 
	$disk_ioùl
 (

89 
BYTE
 
pdrv
,

90 
BYTE
 
cmd
,

91 *
buff


94 
DRESULT
 
»s
 = 
RES_PARERR
;

95 
»s
 = 
disk
.
drv
[
pdrv
]->
	`disk_ioùl
(disk.
lun
[pdrv], 
cmd
, 
buff
);

96  
»s
;

97 
	}
}

101 
DWORD
 
	$g‘_ç‰ime
 ()

106  ((
DWORD
)(2013 - 1980) << 25)

107 | ((
DWORD
)1 << 21)

108 | ((
DWORD
)1 << 16)

109 | ((
DWORD
)0 << 11)

110 | ((
DWORD
)0 << 5)

111 | ((
DWORD
)0 >> 1);

112 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\ff.c

21 
	~"ff.h
"

22 
	~"diskio.h
"

31 #ià
_FATFS
 != 68020

32 #”rÜ 
WrÚg
 
šşude
 
fe
 (
ff
.
h
).

36 
	#ABORT
(
fs
, 
»s
è{ 
å
->
”r
 = (
BYTE
)Ôes); 
	`LEAVE_FF
(fs,„es); }

	)

40 #ià
_FS_REENTRANT


41 #ià
_USE_LFN
 == 1

42 #”rÜ 
Stic
 
LFN
 
wÜk
 
¬—
 
ÿÂÙ
 
be
 
u£d
 
©
 
th»ad
-
§ã
 
cÚfigu¿tiÚ


44 
	#ENTER_FF
(
fs
è{ ià(!
	`lock_fs
(fs)è 
FR_TIMEOUT
; }

	)

45 
	#LEAVE_FF
(
fs
, 
»s
è{ 
	`uÆock_fs
(fs,„es); „es; }

	)

47 
	#ENTER_FF
(
fs
)

	)

48 
	#LEAVE_FF
(
fs
, 
»s
è 
	)
res

54 #ià(
_MAX_SS
 < 
_MIN_SS
) || (_MAX_SS != 512 && _MAX_SS != 1024 && _MAX_SS != 2048 && _MAX_SS != 4096) || (_MIN_SS != 512 && _MIN_SS != 1024 && _MIN_SS != 2048 && _MIN_SS != 4096)

55 #”rÜ 
WrÚg
 
£ùÜ
 
size
 
cÚfigu¿tiÚ


57 #ià
_MAX_SS
 =ğ
_MIN_SS


58 
	#SS
(
fs
è((
UINT
)
_MAX_SS
è

	)

60 
	#SS
(
fs
è((fs)->
ssize
è

	)

65 #ià
_FS_NORTC
 == 1

66 #ià
_NORTC_YEAR
 < 1980 || _NORTC_YEAR > 2107 || 
_NORTC_MON
 < 1 || _NORTC_MON > 12 || 
_NORTC_MDAY
 < 1 || _NORTC_MDAY > 31

67 #”rÜ 
Inv®id
 
_FS_NORTC
 
£‰šgs


69 
	#GET_FATTIME
(è((
DWORD
)(
_NORTC_YEAR
 - 1980è<< 25 | (DWORD)
_NORTC_MON
 << 21 | (DWORD)
_NORTC_MDAY
 << 16)

	)

71 
	#GET_FATTIME
(è
	`g‘_ç‰ime
()

	)

76 #ià
_FS_LOCK
 != 0

77 #ià
_FS_READONLY


78 #”rÜ 
_FS_LOCK
 
mu¡
 
be
 0 
©
 
»ad
-
Úly
 
cÚfigu¿tiÚ


82 
FATFS
 *
	mfs
;

83 
DWORD
 
	mşu
;

84 
DWORD
 
	mofs
;

85 
WORD
 
	mùr
;

86 } 
	tFILESEM
;

93 #ià
_CODE_PAGE
 == 932

94 
	#_DF1S
 0x81

	)

95 
	#_DF1E
 0x9F

	)

96 
	#_DF2S
 0xE0

	)

97 
	#_DF2E
 0xFC

	)

98 
	#_DS1S
 0x40

	)

99 
	#_DS1E
 0x7E

	)

100 
	#_DS2S
 0x80

	)

101 
	#_DS2E
 0xFC

	)

103 #–ià
_CODE_PAGE
 == 936

104 
	#_DF1S
 0x81

	)

105 
	#_DF1E
 0xFE

	)

106 
	#_DS1S
 0x40

	)

107 
	#_DS1E
 0x7E

	)

108 
	#_DS2S
 0x80

	)

109 
	#_DS2E
 0xFE

	)

111 #–ià
_CODE_PAGE
 == 949

112 
	#_DF1S
 0x81

	)

113 
	#_DF1E
 0xFE

	)

114 
	#_DS1S
 0x41

	)

115 
	#_DS1E
 0x5A

	)

116 
	#_DS2S
 0x61

	)

117 
	#_DS2E
 0x7A

	)

118 
	#_DS3S
 0x81

	)

119 
	#_DS3E
 0xFE

	)

121 #–ià
_CODE_PAGE
 == 950

122 
	#_DF1S
 0x81

	)

123 
	#_DF1E
 0xFE

	)

124 
	#_DS1S
 0x40

	)

125 
	#_DS1E
 0x7E

	)

126 
	#_DS2S
 0xA1

	)

127 
	#_DS2E
 0xFE

	)

129 #–ià
_CODE_PAGE
 == 437

130 
	#_DF1S
 0

	)

131 
	#_EXCVT
 {0x80,0x9A,0x45,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F, \

138 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

140 #–ià
_CODE_PAGE
 == 720

141 
	#_DF1S
 0

	)

142 
	#_EXCVT
 {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \

149 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

151 #–ià
_CODE_PAGE
 == 737

152 
	#_DF1S
 0

	)

153 
	#_EXCVT
 {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \

160 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

162 #–ià
_CODE_PAGE
 == 771

163 
	#_DF1S
 0

	)

164 
	#_EXCVT
 {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \

171 0xF0,0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF8,0xFA,0xFA,0xFC,0xFC,0xFE,0xFF}

	)

173 #–ià
_CODE_PAGE
 == 775

174 
	#_DF1S
 0

	)

175 
	#_EXCVT
 {0x80,0x9A,0x91,0xA0,0x8E,0x95,0x8F,0x80,0xAD,0xED,0x8A,0x8A,0xA1,0x8D,0x8E,0x8F, \

182 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

184 #–ià
_CODE_PAGE
 == 850

185 
	#_DF1S
 0

	)

186 
	#_EXCVT
 {0x43,0x55,0x45,0x41,0x41,0x41,0x41,0x43,0x45,0x45,0x45,0x49,0x49,0x49,0x41,0x41, \

193 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

195 #–ià
_CODE_PAGE
 == 852

196 
	#_DF1S
 0

	)

197 
	#_EXCVT
 {0x80,0x9A,0x90,0xB6,0x8E,0xDE,0x8F,0x80,0x9D,0xD3,0x8A,0x8A,0xD7,0x8D,0x8E,0x8F, \

204 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xEB,0xFC,0xFC,0xFE,0xFF}

	)

206 #–ià
_CODE_PAGE
 == 855

207 
	#_DF1S
 0

	)

208 
	#_EXCVT
 {0x81,0x81,0x83,0x83,0x85,0x85,0x87,0x87,0x89,0x89,0x8B,0x8B,0x8D,0x8D,0x8F,0x8F, \

215 0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF8,0xFA,0xFA,0xFC,0xFC,0xFD,0xFE,0xFF}

	)

217 #–ià
_CODE_PAGE
 == 857

218 
	#_DF1S
 0

	)

219 
	#_EXCVT
 {0x80,0x9A,0x90,0xB6,0x8E,0xB7,0x8F,0x80,0xD2,0xD3,0xD4,0xD8,0xD7,0x49,0x8E,0x8F, \

226 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

228 #–ià
_CODE_PAGE
 == 860

229 
	#_DF1S
 0

	)

230 
	#_EXCVT
 {0x80,0x9A,0x90,0x8F,0x8E,0x91,0x86,0x80,0x89,0x89,0x92,0x8B,0x8C,0x98,0x8E,0x8F, \

237 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

239 #–ià
_CODE_PAGE
 == 861

240 
	#_DF1S
 0

	)

241 
	#_EXCVT
 {0x80,0x9A,0x90,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x8B,0x8B,0x8D,0x8E,0x8F, \

248 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

250 #–ià
_CODE_PAGE
 == 862

251 
	#_DF1S
 0

	)

252 
	#_EXCVT
 {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \

259 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

261 #–ià
_CODE_PAGE
 == 863

262 
	#_DF1S
 0

	)

263 
	#_EXCVT
 {0x43,0x55,0x45,0x41,0x41,0x41,0x86,0x43,0x45,0x45,0x45,0x49,0x49,0x8D,0x41,0x8F, \

270 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

272 #–ià
_CODE_PAGE
 == 864

273 
	#_DF1S
 0

	)

274 
	#_EXCVT
 {0x80,0x9A,0x45,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F, \

281 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

283 #–ià
_CODE_PAGE
 == 865

284 
	#_DF1S
 0

	)

285 
	#_EXCVT
 {0x80,0x9A,0x90,0x41,0x8E,0x41,0x8F,0x80,0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F, \

292 0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

294 #–ià
_CODE_PAGE
 == 866

295 
	#_DF1S
 0

	)

296 
	#_EXCVT
 {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \

303 0xF0,0xF0,0xF2,0xF2,0xF4,0xF4,0xF6,0xF6,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF}

	)

305 #–ià
_CODE_PAGE
 == 869

306 
	#_DF1S
 0

	)

307 
	#_EXCVT
 {0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F, \

314 0xF0,0xF1,0xD1,0xD2,0xD3,0xF5,0xD4,0xF7,0xF8,0xF9,0xD5,0x96,0x95,0x98,0xFE,0xFF}

	)

316 #–ià
_CODE_PAGE
 == 1

317 #ià
_USE_LFN
 != 0

318 #”rÜ 
CªnÙ
 
’abË
 
LFN
 
w™hout
 
v®id
 
code
 
·ge
.

320 
	#_DF1S
 0

	)

323 #”rÜ 
Unknown
 
code
 
·ge


329 
	#IsUµ”
(
c
è(((c)>='A')&&((c)<='Z'))

	)

330 
	#IsLow”
(
c
è(((c)>='a')&&((c)<='z'))

	)

331 
	#IsDig™
(
c
è(((c)>='0')&&((c)<='9'))

	)

333 #ià
_DF1S
 != 0

335 #ifdeà
_DF2S


336 
	#IsDBCS1
(
c
è(((
BYTE
)(cè>ğ
_DF1S
 && (BYTE)(cè<ğ
_DF1E
è|| ((BYTE)(cè>ğ
_DF2S
 && (BYTE)(cè<ğ
_DF2E
))

	)

338 
	#IsDBCS1
(
c
è((
BYTE
)(cè>ğ
_DF1S
 && (BYTE)(cè<ğ
_DF1E
)

	)

341 #ifdeà
_DS3S


342 
	#IsDBCS2
(
c
è(((
BYTE
)(cè>ğ
_DS1S
 && (BYTE)(cè<ğ
_DS1E
è|| ((BYTE)(cè>ğ
_DS2S
 && (BYTE)(cè<ğ
_DS2E
è|| ((BYTE)(cè>ğ
_DS3S
 && (BYTE)(cè<ğ
_DS3E
))

	)

344 
	#IsDBCS2
(
c
è(((
BYTE
)(cè>ğ
_DS1S
 && (BYTE)(cè<ğ
_DS1E
è|| ((BYTE)(cè>ğ
_DS2S
 && (BYTE)(cè<ğ
_DS2E
))

	)

349 
	#IsDBCS1
(
c
è0

	)

350 
	#IsDBCS2
(
c
è0

	)

356 
	#AM_VOL
 0x08

	)

357 
	#AM_LFN
 0x0F

	)

358 
	#AM_MASK
 0x3F

	)

362 
	#FA_SEEKEND
 0x20

	)

363 
	#FA_MODIFIED
 0x40

	)

364 
	#FA_DIRTY
 0x80

	)

368 
	#NSFLAG
 11

	)

369 
	#NS_LOSS
 0x01

	)

370 
	#NS_LFN
 0x02

	)

371 
	#NS_LAST
 0x04

	)

372 
	#NS_BODY
 0x08

	)

373 
	#NS_EXT
 0x10

	)

374 
	#NS_DOT
 0x20

	)

375 
	#NS_NOLFN
 0x40

	)

376 
	#NS_NONAME
 0x80

	)

380 
	#MAX_FAT12
 0xFF5

	)

381 
	#MAX_FAT16
 0xFFF5

	)

382 
	#MAX_FAT32
 0xFFFFFF5

	)

383 
	#MAX_EXFAT
 0x7FFFFFFD

	)

384 
	#MAX_DIR
 0x200000

	)

385 
	#MAX_DIR_EX
 0x10000000

	)

392 
	#BS_JmpBoÙ
 0

	)

393 
	#BS_OEMName
 3

	)

394 
	#BPB_BytsP”Sec
 11

	)

395 
	#BPB_SecP”Clus
 13

	)

396 
	#BPB_RsvdSecCÁ
 14

	)

397 
	#BPB_NumFATs
 16

	)

398 
	#BPB_RoÙEÁCÁ
 17

	)

399 
	#BPB_TÙSec16
 19

	)

400 
	#BPB_MedŸ
 21

	)

401 
	#BPB_FATSz16
 22

	)

402 
	#BPB_SecP”Trk
 24

	)

403 
	#BPB_NumH—ds
 26

	)

404 
	#BPB_HiddSec
 28

	)

405 
	#BPB_TÙSec32
 32

	)

406 
	#BS_DrvNum
 36

	)

407 
	#BS_NT»s
 37

	)

408 
	#BS_BoÙSig
 38

	)

409 
	#BS_VŞID
 39

	)

410 
	#BS_VŞLab
 43

	)

411 
	#BS_FSysTy³
 54

	)

412 
	#BS_BoÙCode
 62

	)

413 
	#BS_55AA
 510

	)

415 
	#BPB_FATSz32
 36

	)

416 
	#BPB_ExtFÏgs32
 40

	)

417 
	#BPB_FSV”32
 42

	)

418 
	#BPB_RoÙClus32
 44

	)

419 
	#BPB_FSInfo32
 48

	)

420 
	#BPB_BkBoÙSec32
 50

	)

421 
	#BS_DrvNum32
 64

	)

422 
	#BS_NT»s32
 65

	)

423 
	#BS_BoÙSig32
 66

	)

424 
	#BS_VŞID32
 67

	)

425 
	#BS_VŞLab32
 71

	)

426 
	#BS_FSysTy³32
 82

	)

427 
	#BS_BoÙCode32
 90

	)

429 
	#BPB_Z”ÛdEx
 11

	)

430 
	#BPB_VŞOfsEx
 64

	)

431 
	#BPB_TÙSecEx
 72

	)

432 
	#BPB_F©OfsEx
 80

	)

433 
	#BPB_F©SzEx
 84

	)

434 
	#BPB_D©aOfsEx
 88

	)

435 
	#BPB_NumClusEx
 92

	)

436 
	#BPB_RoÙClusEx
 96

	)

437 
	#BPB_VŞIDEx
 100

	)

438 
	#BPB_FSV”Ex
 104

	)

439 
	#BPB_VŞFÏgEx
 106

	)

440 
	#BPB_AùF©Ex
 107

	)

441 
	#BPB_BytsP”SecEx
 108

	)

442 
	#BPB_SecP”ClusEx
 109

	)

443 
	#BPB_NumFATsEx
 110

	)

444 
	#BPB_DrvNumEx
 111

	)

445 
	#BPB_P”cInU£Ex
 112

	)

446 
	#BPB_RsvdEx
 113

	)

447 
	#BS_BoÙCodeEx
 120

	)

449 
	#FSI_L—dSig
 0

	)

450 
	#FSI_SŒucSig
 484

	)

451 
	#FSI_F»e_CouÁ
 488

	)

452 
	#FSI_Nxt_F»e
 492

	)

454 
	#MBR_TabË
 446

	)

455 
	#SZ_PTE
 16

	)

456 
	#PTE_BoÙ
 0

	)

457 
	#PTE_StH—d
 1

	)

458 
	#PTE_StSec
 2

	)

459 
	#PTE_StCyl
 3

	)

460 
	#PTE_Sy¡em
 4

	)

461 
	#PTE_EdH—d
 5

	)

462 
	#PTE_EdSec
 6

	)

463 
	#PTE_EdCyl
 7

	)

464 
	#PTE_StLba
 8

	)

465 
	#PTE_SizLba
 12

	)

467 
	#DIR_Name
 0

	)

468 
	#DIR_A‰r
 11

	)

469 
	#DIR_NT»s
 12

	)

470 
	#DIR_C¹Time10
 13

	)

471 
	#DIR_C¹Time
 14

	)

472 
	#DIR_L¡AccD©e
 18

	)

473 
	#DIR_F¡ClusHI
 20

	)

474 
	#DIR_ModTime
 22

	)

475 
	#DIR_F¡ClusLO
 26

	)

476 
	#DIR_FeSize
 28

	)

477 
	#LDIR_Ord
 0

	)

478 
	#LDIR_A‰r
 11

	)

479 
	#LDIR_Ty³
 12

	)

480 
	#LDIR_Chksum
 13

	)

481 
	#LDIR_F¡ClusLO
 26

	)

482 
	#XDIR_Ty³
 0

	)

483 
	#XDIR_NumLab–
 1

	)

484 
	#XDIR_Lab–
 2

	)

485 
	#XDIR_Ca£Sum
 4

	)

486 
	#XDIR_NumSec
 1

	)

487 
	#XDIR_S‘Sum
 2

	)

488 
	#XDIR_A‰r
 4

	)

489 
	#XDIR_C¹Time
 8

	)

490 
	#XDIR_ModTime
 12

	)

491 
	#XDIR_AccTime
 16

	)

492 
	#XDIR_C¹Time10
 20

	)

493 
	#XDIR_ModTime10
 21

	)

494 
	#XDIR_C¹TZ
 22

	)

495 
	#XDIR_ModTZ
 23

	)

496 
	#XDIR_AccTZ
 24

	)

497 
	#XDIR_G’FÏgs
 33

	)

498 
	#XDIR_NumName
 35

	)

499 
	#XDIR_NameHash
 36

	)

500 
	#XDIR_V®idFeSize
 40

	)

501 
	#XDIR_F¡Clus
 52

	)

502 
	#XDIR_FeSize
 56

	)

504 
	#SZDIRE
 32

	)

505 
	#LLEF
 0x40

	)

506 
	#DDEM
 0xE5

	)

507 
	#RDDEM
 0x05

	)

523 #ià
_VOLUMES
 < 1 || _VOLUMES > 9

524 #”rÜ 
WrÚg
 
_VOLUMES
 
£‰šg


526 
FATFS
 *
	gF©Fs
[
_VOLUMES
];

527 
WORD
 
	gFsid
;

529 #ià
_FS_RPATH
 !ğ0 && 
_VOLUMES
 >= 2

530 
BYTE
 
	gCu¼VŞ
;

533 #ià
_FS_LOCK
 != 0

534 
FILESEM
 
	gFes
[
_FS_LOCK
];

537 #ià
_USE_LFN
 == 0

538 
	#DEF_NAMBUF


	)

539 
	#INIT_NAMBUF
(
fs
)

	)

540 
	#FREE_NAMBUF
()

	)

542 #ià
_MAX_LFN
 < 12 || _MAX_LFN > 255

543 #”rÜ 
WrÚg
 
_MAX_LFN
 
£‰šg


546 #ià
_USE_LFN
 == 1

547 #ià
_FS_EXFAT


548 
BYTE
 
	gDœBuf
[
SZDIRE
 * 19];

550 
WCHAR
 
	gLâBuf
[
_MAX_LFN
 + 1];

551 
	#DEF_NAMBUF


	)

552 
	#INIT_NAMBUF
(
fs
)

	)

553 
	#FREE_NAMBUF
()

	)

555 #–ià
_USE_LFN
 == 2

556 #ià
_FS_EXFAT


557 
	#DEF_NAMBUF
 
WCHAR
 
lbuf
[
_MAX_LFN
+1]; 
BYTE
 
dbuf
[
SZDIRE
*19];

	)

558 
	#INIT_NAMBUF
(
fs
è{ (fs)->
lâbuf
 = 
lbuf
; (fs)->
dœbuf
 = 
dbuf
; }

	)

559 
	#FREE_NAMBUF
()

	)

561 
	#DEF_NAMBUF
 
WCHAR
 
lbuf
[
_MAX_LFN
+1];

	)

562 
	#INIT_NAMBUF
(
fs
è{ (fs)->
lâbuf
 = 
lbuf
; }

	)

563 
	#FREE_NAMBUF
()

	)

566 #–ià
_USE_LFN
 == 3

567 #ià
_FS_EXFAT


568 
	#DEF_NAMBUF
 
WCHAR
 *
lâ
;

	)

569 
	#INIT_NAMBUF
(
fs
è{ 
lâ
 = 
	`ff_mem®loc
((
_MAX_LFN
+1)*2 + 
SZDIRE
*19); ià(!lâè
	`LEAVE_FF
(fs, 
FR_NOT_ENOUGH_CORE
); (fs)->
lâbuf
 =†â; (fs)->
dœbuf
 = (
BYTE
*)Öâ+_MAX_LFN+1); }

	)

570 
	#FREE_NAMBUF
(è
	`ff_memä“
(
lâ
)

	)

572 
	#DEF_NAMBUF
 
WCHAR
 *
lâ
;

	)

573 
	#INIT_NAMBUF
(
fs
è{ 
lâ
 = 
	`ff_mem®loc
((
_MAX_LFN
+1)*2); ià(!lâè
	`LEAVE_FF
(fs, 
FR_NOT_ENOUGH_CORE
); (fs)->
lâbuf
 =†â; }

	)

574 
	#FREE_NAMBUF
(è
	`ff_memä“
(
lâ
)

	)

578 #”rÜ 
WrÚg
 
_USE_LFN
 
£‰šg


582 #ifdeà
_EXCVT


583 cÚ¡ 
BYTE
 
	gExCvt
[] = 
_EXCVT
;

603 
WORD
 
	$ld_wÜd
 (cÚ¡ 
BYTE
 *
±r
)

605 
WORD
 
rv
;

607 
rv
 = 
±r
[1];

608 
rv
 =„v << 8 | 
±r
[0];

609  
rv
;

610 
	}
}

613 
DWORD
 
	$ld_dwÜd
 (cÚ¡ 
BYTE
 *
±r
)

615 
DWORD
 
rv
;

617 
rv
 = 
±r
[3];

618 
rv
 =„v << 8 | 
±r
[2];

619 
rv
 =„v << 8 | 
±r
[1];

620 
rv
 =„v << 8 | 
±r
[0];

621  
rv
;

622 
	}
}

624 #ià
_FS_EXFAT


626 
QWORD
 
	$ld_qwÜd
 (cÚ¡ 
BYTE
 *
±r
)

628 
QWORD
 
rv
;

630 
rv
 = 
±r
[7];

631 
rv
 =„v << 8 | 
±r
[6];

632 
rv
 =„v << 8 | 
±r
[5];

633 
rv
 =„v << 8 | 
±r
[4];

634 
rv
 =„v << 8 | 
±r
[3];

635 
rv
 =„v << 8 | 
±r
[2];

636 
rv
 =„v << 8 | 
±r
[1];

637 
rv
 =„v << 8 | 
±r
[0];

638  
rv
;

639 
	}
}

642 #ià!
_FS_READONLY


644 
	$¡_wÜd
 (
BYTE
 *
±r
, 
WORD
 
v®
)

646 *
±r
++ = (
BYTE
)
v®
;

647 
v®
 >>= 8;

648 *
±r
++ = (
BYTE
)
v®
;

649 
	}
}

652 
	$¡_dwÜd
 (
BYTE
 *
±r
, 
DWORD
 
v®
)

654 *
±r
++ = (
BYTE
)
v®
;

655 
v®
 >>= 8;

656 *
±r
++ = (
BYTE
)
v®
;

657 
v®
 >>= 8;

658 *
±r
++ = (
BYTE
)
v®
;

659 
v®
 >>= 8;

660 *
±r
++ = (
BYTE
)
v®
;

661 
	}
}

663 #ià
_FS_EXFAT


665 
	$¡_qwÜd
 (
BYTE
 *
±r
, 
QWORD
 
v®
)

667 *
±r
++ = (
BYTE
)
v®
;

668 
v®
 >>= 8;

669 *
±r
++ = (
BYTE
)
v®
;

670 
v®
 >>= 8;

671 *
±r
++ = (
BYTE
)
v®
;

672 
v®
 >>= 8;

673 *
±r
++ = (
BYTE
)
v®
;

674 
v®
 >>= 8;

675 *
±r
++ = (
BYTE
)
v®
;

676 
v®
 >>= 8;

677 *
±r
++ = (
BYTE
)
v®
;

678 
v®
 >>= 8;

679 *
±r
++ = (
BYTE
)
v®
;

680 
v®
 >>= 8;

681 *
±r
++ = (
BYTE
)
v®
;

682 
	}
}

694 
	$mem_ıy
 (*
d¡
, cÚ¡ *
¤c
, 
UINT
 
út
)

696 
BYTE
 *
d
 = (BYTE *)
d¡
;

697 cÚ¡ 
BYTE
 *
s
 = (cÚ¡ BYTE *)
¤c
;

699 ià(
út
)

703 *
d
++ = *
s
++;

705 --
út
);

707 
	}
}

711 
	$mem_£t
 (*
d¡
, 
v®
, 
UINT
 
út
)

713 
BYTE
 *
d
 = (BYTE *)
d¡
;

717 *
d
++ = (
BYTE
)
v®
;

719 --
út
);

720 
	}
}

724 
	$mem_cmp
 (cÚ¡ *
d¡
, cÚ¡ *
¤c
, 
UINT
 
út
)

726 cÚ¡ 
BYTE
 *
d
 = (cÚ¡ BYTE *)
d¡
, *
s
 = (cÚ¡ BYTE *)
¤c
;

727 
r
 = 0;

731 
r
 = *
d
++ - *
s
++;

733 --
út
 && 
r
 == 0);

735  
r
;

736 
	}
}

740 
	$chk_chr
 (cÚ¡ *
¡r
, 
chr
)

742 *
¡r
 && *¡¸!ğ
chr
)

744 
¡r
++;

746  *
¡r
;

747 
	}
}

752 #ià
_FS_REENTRANT


757 
	$lock_fs
 (

758 
FATFS
 *
fs


761  
	`ff_»q_g¿Á
(
fs
->
sobj
);

762 
	}
}

766 
	$uÆock_fs
 (

767 
FATFS
 *
fs
,

768 
FRESULT
 
»s


771 ià(
fs
 && 
»s
 !ğ
FR_NOT_ENABLED
 &&„e !ğ
FR_INVALID_DRIVE
 &&„e !ğ
FR_TIMEOUT
)

773 
	`ff_»l_g¿Á
(
fs
->
sobj
);

775 
	}
}

781 #ià
_FS_LOCK
 != 0

787 
FRESULT
 
	$chk_lock
 (

788 
DIR
 *
dp
,

789 
acc


792 
UINT
 
i
, 
be
;

795 
i
 = 
be
 = 0; i < 
_FS_LOCK
; i++)

797 ià(
Fes
[
i
].
fs
)

799 ià(
Fes
[
i
].
fs
 =ğ
dp
->
obj
.fs &&

800 
Fes
[
i
].
şu
 =ğ
dp
->
obj
.
sşu¡
 &&

801 
Fes
[
i
].
ofs
 =ğ
dp
->
d±r
)

808 
be
 = 1;

811 ià(
i
 =ğ
_FS_LOCK
)

813  (
be
 || 
acc
 =ğ2è? 
FR_OK
 : 
FR_TOO_MANY_OPEN_FILES
;

817  (
acc
 || 
Fes
[
i
].
ùr
 =ğ0x100è? 
FR_LOCKED
 : 
FR_OK
;

818 
	}
}

822 
	$’q_lock
 ()

824 
UINT
 
i
;

826 
i
 = 0; i < 
_FS_LOCK
 && 
Fes
[i].
fs
; i++) ;

827  (
i
 =ğ
_FS_LOCK
) ? 0 : 1;

828 
	}
}

832 
UINT
 
	$šc_lock
 (

833 
DIR
 *
dp
,

834 
acc


837 
UINT
 
i
;

840 
i
 = 0; i < 
_FS_LOCK
; i++)

842 ià(
Fes
[
i
].
fs
 =ğ
dp
->
obj
.fs &&

843 
Fes
[
i
].
şu
 =ğ
dp
->
obj
.
sşu¡
 &&

844 
Fes
[
i
].
ofs
 =ğ
dp
->
d±r
)

850 ià(
i
 =ğ
_FS_LOCK
)

852 
i
 = 0; i < 
_FS_LOCK
 && 
Fes
[i].
fs
; i++) ;

853 ià(
i
 =ğ
_FS_LOCK
)

857 
Fes
[
i
].
fs
 = 
dp
->
obj
.fs;

858 
Fes
[
i
].
şu
 = 
dp
->
obj
.
sşu¡
;

859 
Fes
[
i
].
ofs
 = 
dp
->
d±r
;

860 
Fes
[
i
].
ùr
 = 0;

863 ià(
acc
 && 
Fes
[
i
].
ùr
)

868 
Fes
[
i
].
ùr
 = 
acc
 ? 0x100 : Files[i].ctr + 1;

870  
i
 + 1;

871 
	}
}

875 
FRESULT
 
	$dec_lock
 (

876 
UINT
 
i


879 
WORD
 
n
;

880 
FRESULT
 
»s
;

883 ià(--
i
 < 
_FS_LOCK
)

885 
n
 = 
Fes
[
i
].
ùr
;

886 ià(
n
 == 0x100)

888 
n
 = 0;

890 ià(
n
 > 0)

892 
n
--;

894 
Fes
[
i
].
ùr
 = 
n
;

895 ià(
n
 == 0)

897 
Fes
[
i
].
fs
 = 0;

899 
»s
 = 
FR_OK
;

903 
»s
 = 
FR_INT_ERR
;

905  
»s
;

906 
	}
}

910 
	$ş—r_lock
 (

911 
FATFS
 *
fs


914 
UINT
 
i
;

916 
i
 = 0; i < 
_FS_LOCK
; i++)

918 ià(
Fes
[
i
].
fs
 == fs)

920 
Fes
[
i
].
fs
 = 0;

923 
	}
}

932 #ià!
_FS_READONLY


934 
FRESULT
 
	$sync_wšdow
 (

935 
FATFS
 *
fs


938 
DWORD
 
w£ù
;

939 
UINT
 
nf
;

940 
FRESULT
 
»s
 = 
FR_OK
;

943 ià(
fs
->
wæag
)

945 
w£ù
 = 
fs
->
wš£ù
;

946 ià(
	`disk_wr™e
(
fs
->
drv
, fs->
wš
, 
w£ù
, 1è!ğ
RES_OK
)

948 
»s
 = 
FR_DISK_ERR
;

952 
fs
->
wæag
 = 0;

953 ià(
w£ù
 - 
fs
->
çtba£
 < fs->
fsize
)

955 
nf
 = 
fs
->
n_çts
;‚f >= 2;‚f--)

957 
w£ù
 +ğ
fs
->
fsize
;

958 
	`disk_wr™e
(
fs
->
drv
, fs->
wš
, 
w£ù
, 1);

963  
»s
;

964 
	}
}

969 
FRESULT
 
	$move_wšdow
 (

970 
FATFS
 *
fs
,

971 
DWORD
 
£ùÜ


974 
FRESULT
 
»s
 = 
FR_OK
;

977 ià(
£ùÜ
 !ğ
fs
->
wš£ù
)

979 #ià!
_FS_READONLY


980 
»s
 = 
	`sync_wšdow
(
fs
);

982 ià(
»s
 =ğ
FR_OK
)

984 ià(
	`disk_»ad
(
fs
->
drv
, fs->
wš
, 
£ùÜ
, 1è!ğ
RES_OK
)

986 
£ùÜ
 = 0xFFFFFFFF;

987 
»s
 = 
FR_DISK_ERR
;

989 
fs
->
wš£ù
 = 
£ùÜ
;

992  
»s
;

993 
	}
}

998 #ià!
_FS_READONLY


1004 
FRESULT
 
	$sync_fs
 (

1005 
FATFS
 *
fs


1008 
FRESULT
 
»s
;

1011 
»s
 = 
	`sync_wšdow
(
fs
);

1012 ià(
»s
 =ğ
FR_OK
)

1015 ià(
fs
->
fs_ty³
 =ğ
FS_FAT32
 && fs->
fsi_æag
 == 1)

1018 
	`mem_£t
(
fs
->
wš
, 0, 
	`SS
(fs));

1019 
	`¡_wÜd
(
fs
->
wš
 + 
BS_55AA
, 0xAA55);

1020 
	`¡_dwÜd
(
fs
->
wš
 + 
FSI_L—dSig
, 0x41615252);

1021 
	`¡_dwÜd
(
fs
->
wš
 + 
FSI_SŒucSig
, 0x61417272);

1022 
	`¡_dwÜd
(
fs
->
wš
 + 
FSI_F»e_CouÁ
, fs->
ä“_ş¡
);

1023 
	`¡_dwÜd
(
fs
->
wš
 + 
FSI_Nxt_F»e
, fs->
Ï¡_ş¡
);

1025 
fs
->
wš£ù
 = fs->
vŞba£
 + 1;

1026 
	`disk_wr™e
(
fs
->
drv
, fs->
wš
, fs->
wš£ù
, 1);

1027 
fs
->
fsi_æag
 = 0;

1030 ià(
	`disk_ioùl
(
fs
->
drv
, 
CTRL_SYNC
, 0è!ğ
RES_OK
)

1032 
»s
 = 
FR_DISK_ERR
;

1036  
»s
;

1037 
	}
}

1048 
DWORD
 
	$şu¡2£ù
 (

1049 
FATFS
 *
fs
,

1050 
DWORD
 
ş¡


1053 
ş¡
 -= 2;

1054 ià(
ş¡
 >ğ
fs
->
n_ç‹Á
 - 2)

1058  
ş¡
 * 
fs
->
csize
 + fs->
d©aba£
;

1059 
	}
}

1069 
DWORD
 
	$g‘_çt
 (

1070 
_FDID
 *
obj
,

1071 
DWORD
 
ş¡


1074 
UINT
 
wc
, 
bc
;

1075 
DWORD
 
v®
;

1076 
FATFS
 *
fs
 = 
obj
->fs;

1079 ià(
ş¡
 < 2 || cl¡ >ğ
fs
->
n_ç‹Á
)

1081 
v®
 = 1;

1086 
v®
 = 0xFFFFFFFF;

1088 
fs
->
fs_ty³
)

1090 
FS_FAT12
 :

1091 
bc
 = (
UINT
)
ş¡
;

1092 
bc
 += bc / 2;

1093 ià(
	`move_wšdow
(
fs
, fs->
çtba£
 + (
bc
 / 
	`SS
(fs))è!ğ
FR_OK
)

1097 
wc
 = 
fs
->
wš
[
bc
++ % 
	`SS
(fs)];

1098 ià(
	`move_wšdow
(
fs
, fs->
çtba£
 + (
bc
 / 
	`SS
(fs))è!ğ
FR_OK
)

1102 
wc
 |ğ
fs
->
wš
[
bc
 % 
	`SS
(fs)] << 8;

1103 
v®
 = (
ş¡
 & 1è? (
wc
 >> 4) : (wc & 0xFFF);

1106 
FS_FAT16
 :

1107 ià(
	`move_wšdow
(
fs
, fs->
çtba£
 + (
ş¡
 / (
	`SS
(fsè/ 2))è!ğ
FR_OK
)

1111 
v®
 = 
	`ld_wÜd
(
fs
->
wš
 + 
ş¡
 * 2 % 
	`SS
(fs));

1114 
FS_FAT32
 :

1115 ià(
	`move_wšdow
(
fs
, fs->
çtba£
 + (
ş¡
 / (
	`SS
(fsè/ 4))è!ğ
FR_OK
)

1119 
v®
 = 
	`ld_dwÜd
(
fs
->
wš
 + 
ş¡
 * 4 % 
	`SS
(fs)) & 0x0FFFFFFF;

1121 #ià
_FS_EXFAT


1122 
FS_EXFAT
 :

1123 ià(
obj
->
objsize
)

1125 
DWORD
 
cofs
 = 
ş¡
 - 
obj
->
sşu¡
;

1126 
DWORD
 
ş’
 = (DWORD)((
obj
->
objsize
 - 1è/ 
	`SS
(
fs
)è/ fs->
csize
;

1128 ià(
obj
->
¡©
 == 2)

1130 ià(
cofs
 <ğ
ş’
)

1132 
v®
 = (
cofs
 =ğ
ş’
è? 0x7FFFFFFF : 
ş¡
 + 1;

1136 ià(
obj
->
¡©
 =ğ3 && 
cofs
 < obj->
n_cÚt
)

1138 
v®
 = 
ş¡
 + 1;

1141 ià(
obj
->
¡©
 != 2)

1143 ià(
	`move_wšdow
(
fs
, fs->
çtba£
 + (
ş¡
 / (
	`SS
(fsè/ 4))è!ğ
FR_OK
)

1147 
v®
 = 
	`ld_dwÜd
(
fs
->
wš
 + 
ş¡
 * 4 % 
	`SS
(fs)) & 0x7FFFFFFF;

1154 
v®
 = 1;

1158  
v®
;

1159 
	}
}

1164 #ià!
_FS_READONLY


1170 
FRESULT
 
	$put_çt
 (

1171 
FATFS
 *
fs
,

1172 
DWORD
 
ş¡
,

1173 
DWORD
 
v®


1176 
UINT
 
bc
;

1177 
BYTE
 *
p
;

1178 
FRESULT
 
»s
 = 
FR_INT_ERR
;

1181 ià(
ş¡
 >ğ2 && cl¡ < 
fs
->
n_ç‹Á
)

1183 
fs
->
fs_ty³
)

1185 
FS_FAT12
 :

1186 
bc
 = (
UINT
)
ş¡
;

1187 
bc
 += bc / 2;

1188 
»s
 = 
	`move_wšdow
(
fs
, fs->
çtba£
 + (
bc
 / 
	`SS
(fs)));

1189 ià(
»s
 !ğ
FR_OK
)

1193 
p
 = 
fs
->
wš
 + 
bc
++ % 
	`SS
(fs);

1194 *
p
 = (
ş¡
 & 1è? ((*°& 0x0Fè| ((
BYTE
)
v®
 << 4)) : (BYTE)val;

1195 
fs
->
wæag
 = 1;

1196 
»s
 = 
	`move_wšdow
(
fs
, fs->
çtba£
 + (
bc
 / 
	`SS
(fs)));

1197 ià(
»s
 !ğ
FR_OK
)

1201 
p
 = 
fs
->
wš
 + 
bc
 % 
	`SS
(fs);

1202 *
p
 = (
ş¡
 & 1è? (
BYTE
)(
v®
 >> 4) : ((*p & 0xF0) | ((BYTE)(val >> 8) & 0x0F));

1203 
fs
->
wæag
 = 1;

1206 
FS_FAT16
 :

1207 
»s
 = 
	`move_wšdow
(
fs
, fs->
çtba£
 + (
ş¡
 / (
	`SS
(fs) / 2)));

1208 ià(
»s
 !ğ
FR_OK
)

1212 
	`¡_wÜd
(
fs
->
wš
 + 
ş¡
 * 2 % 
	`SS
(fs), (
WORD
)
v®
);

1213 
fs
->
wæag
 = 1;

1216 
FS_FAT32
 :

1217 #ià
_FS_EXFAT


1218 
FS_EXFAT
 :

1220 
»s
 = 
	`move_wšdow
(
fs
, fs->
çtba£
 + (
ş¡
 / (
	`SS
(fs) / 4)));

1221 ià(
»s
 !ğ
FR_OK
)

1225 ià(!
_FS_EXFAT
 || 
fs
->
fs_ty³
 !ğ
FS_EXFAT
)

1227 
v®
 = (v® & 0x0FFFFFFFè| (
	`ld_dwÜd
(
fs
->
wš
 + 
ş¡
 * 4 % 
	`SS
(fs)) & 0xF0000000);

1229 
	`¡_dwÜd
(
fs
->
wš
 + 
ş¡
 * 4 % 
	`SS
(fs), 
v®
);

1230 
fs
->
wæag
 = 1;

1234  
»s
;

1235 
	}
}

1242 #ià
_FS_EXFAT
 && !
_FS_READONLY


1252 
DWORD
 
	$fšd_b™m­
 (

1253 
FATFS
 *
fs
,

1254 
DWORD
 
ş¡
,

1255 
DWORD
 
nş


1258 
BYTE
 
bm
, 
bv
;

1259 
UINT
 
i
;

1260 
DWORD
 
v®
, 
sş
, 
ùr
;

1263 
ş¡
 -= 2;

1264 ià(
ş¡
 >ğ
fs
->
n_ç‹Á
 - 2)

1266 
ş¡
 = 0;

1268 
sş
 = 
v®
 = 
ş¡
;

1269 
ùr
 = 0;

1272 ià(
	`move_wšdow
(
fs
, fs->
d©aba£
 + 
v®
 / 8 / 
	`SS
(fs)è!ğ
FR_OK
)

1276 
i
 = 
v®
 / 8 % 
	`SS
(
fs
);

1277 
bm
 = 1 << (
v®
 % 8);

1282 
bv
 = 
fs
->
wš
[
i
] & 
bm
;

1283 
bm
 <<= 1;

1284 ià(++
v®
 >ğ
fs
->
n_ç‹Á
 - 2)

1286 
v®
 = 0;

1287 
bm
 = 0;

1288 
i
 = 4096;

1290 ià(!
bv
)

1292 ià(++
ùr
 =ğ
nş
)

1294  
sş
 + 2;

1299 
sş
 = 
v®
;

1300 
ùr
 = 0;

1302 ià(
v®
 =ğ
ş¡
)

1307 
bm
);

1308 
bm
 = 1;

1310 ++
i
 < 
	`SS
(
fs
));

1312 
	}
}

1320 
FRESULT
 
	$chªge_b™m­
 (

1321 
FATFS
 *
fs
,

1322 
DWORD
 
ş¡
,

1323 
DWORD
 
nş
,

1324 
bv


1327 
BYTE
 
bm
;

1328 
UINT
 
i
;

1329 
DWORD
 
£ù
;

1332 
ş¡
 -= 2;

1333 
£ù
 = 
fs
->
d©aba£
 + 
ş¡
 / 8 / 
	`SS
(fs);

1334 
i
 = 
ş¡
 / 8 % 
	`SS
(
fs
);

1335 
bm
 = 1 << (
ş¡
 % 8);

1338 ià(
	`move_wšdow
(
fs
, 
£ù
++è!ğ
FR_OK
)

1340  
FR_DISK_ERR
;

1346 ià(
bv
 =ğ()((
fs
->
wš
[
i
] & 
bm
) != 0))

1348  
FR_INT_ERR
;

1350 
fs
->
wš
[
i
] ^ğ
bm
;

1351 
fs
->
wæag
 = 1;

1352 ià(--
nş
 == 0)

1354  
FR_OK
;

1357 
bm
 <<= 1);

1358 
bm
 = 1;

1360 ++
i
 < 
	`SS
(
fs
));

1361 
i
 = 0;

1363 
	}
}

1371 
FRESULT
 
	$fl_çt_chaš
 (

1372 
_FDID
 *
obj


1375 
FRESULT
 
»s
;

1376 
DWORD
 
ş
, 
n
;

1378 ià(
obj
->
¡©
 == 3)

1380 
ş
 = 
obj
->
sşu¡
, 
n
 = obj->
n_cÚt
;‚; cl++,‚--)

1382 
»s
 = 
	`put_çt
(
obj
->
fs
, 
ş
, cl + 1);

1383 ià(
»s
 !ğ
FR_OK
)

1385  
»s
;

1388 
obj
->
¡©
 = 0;

1390  
FR_OK
;

1391 
	}
}

1397 #ià!
_FS_READONLY


1402 
FRESULT
 
	$»move_chaš
 (

1403 
_FDID
 *
obj
,

1404 
DWORD
 
ş¡
,

1405 
DWORD
 
pş¡


1408 
FRESULT
 
»s
 = 
FR_OK
;

1409 
DWORD
 
nxt
;

1410 
FATFS
 *
fs
 = 
obj
->fs;

1411 #ià
_FS_EXFAT
 || 
_USE_TRIM


1412 
DWORD
 
sş
 = 
ş¡
, 
eş
 = clst;

1414 #ià
_USE_TRIM


1415 
DWORD
 
¹
[2];

1418 ià(
ş¡
 < 2 || cl¡ >ğ
fs
->
n_ç‹Á
)

1420  
FR_INT_ERR
;

1424 ià(
pş¡
 && (!
_FS_EXFAT
 || 
fs
->
fs_ty³
 !ğ
FS_EXFAT
 || 
obj
->
¡©
 != 2))

1426 
»s
 = 
	`put_çt
(
fs
, 
pş¡
, 0xFFFFFFFF);

1427 ià(
»s
 !ğ
FR_OK
)

1429  
»s
;

1436 
nxt
 = 
	`g‘_çt
(
obj
, 
ş¡
);

1437 ià(
nxt
 == 0)

1441 ià(
nxt
 == 1)

1443  
FR_INT_ERR
;

1445 ià(
nxt
 == 0xFFFFFFFF)

1447  
FR_DISK_ERR
;

1449 ià(!
_FS_EXFAT
 || 
fs
->
fs_ty³
 !ğ
FS_EXFAT
)

1451 
»s
 = 
	`put_çt
(
fs
, 
ş¡
, 0);

1452 ià(
»s
 !ğ
FR_OK
)

1454  
»s
;

1457 ià(
fs
->
ä“_ş¡
 < fs->
n_ç‹Á
 - 2)

1459 
fs
->
ä“_ş¡
++;

1460 
fs
->
fsi_æag
 |= 1;

1462 #ià
_FS_EXFAT
 || 
_USE_TRIM


1463 ià(
eş
 + 1 =ğ
nxt
)

1465 
eş
 = 
nxt
;

1469 #ià
_FS_EXFAT


1470 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

1472 
»s
 = 
	`chªge_b™m­
(
fs
, 
sş
, 
eş
 - scl + 1, 0);

1473 ià(
»s
 !ğ
FR_OK
)

1475  
»s
;

1479 #ià
_USE_TRIM


1480 
¹
[0] = 
	`şu¡2£ù
(
fs
, 
sş
);

1481 
¹
[1] = 
	`şu¡2£ù
(
fs
, 
eş
è+ fs->
csize
 - 1;

1482 
	`disk_ioùl
(
fs
->
drv
, 
CTRL_TRIM
, 
¹
);

1484 
sş
 = 
eş
 = 
nxt
;

1487 
ş¡
 = 
nxt
;

1489 
ş¡
 < 
fs
->
n_ç‹Á
);

1491 #ià
_FS_EXFAT


1492 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

1494 ià(
pş¡
 == 0)

1496 
obj
->
¡©
 = 0;

1500 ià(
obj
->
¡©
 =ğ3 && 
pş¡
 >ğobj->
sşu¡
 &&…ş¡ <ğobj->sşu¡ + obj->
n_cÚt
)

1502 
obj
->
¡©
 = 2;

1507  
FR_OK
;

1508 
	}
}

1517 
DWORD
 
	$ü—‹_chaš
 (

1518 
_FDID
 *
obj
,

1519 
DWORD
 
ş¡


1522 
DWORD
 
cs
, 
nş
, 
sş
;

1523 
FRESULT
 
»s
;

1524 
FATFS
 *
fs
 = 
obj
->fs;

1527 ià(
ş¡
 == 0)

1529 
sş
 = 
fs
->
Ï¡_ş¡
;

1530 ià(
sş
 =ğ0 || sş >ğ
fs
->
n_ç‹Á
)

1532 
sş
 = 1;

1537 
cs
 = 
	`g‘_çt
(
obj
, 
ş¡
);

1538 ià(
cs
 < 2)

1542 ià(
cs
 == 0xFFFFFFFF)

1544  
cs
;

1546 ià(
cs
 < 
fs
->
n_ç‹Á
)

1548  
cs
;

1550 
sş
 = 
ş¡
;

1553 #ià
_FS_EXFAT


1554 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

1556 
nş
 = 
	`fšd_b™m­
(
fs
, 
sş
, 1);

1557 ià(
nş
 == 0 ||‚cl == 0xFFFFFFFF)

1559  
nş
;

1561 
»s
 = 
	`chªge_b™m­
(
fs
, 
nş
, 1, 1);

1562 ià(
»s
 =ğ
FR_INT_ERR
)

1566 ià(
»s
 =ğ
FR_DISK_ERR
)

1570 ià(
ş¡
 == 0)

1572 
obj
->
¡©
 = 2;

1576 ià(
obj
->
¡©
 =ğ2 && 
nş
 !ğ
sş
 + 1)

1578 
obj
->
n_cÚt
 = 
sş
 - obj->
sşu¡
;

1579 
obj
->
¡©
 = 3;

1587 
nş
 = 
sş
;

1590 
nş
++;

1591 ià(
nş
 >ğ
fs
->
n_ç‹Á
)

1593 
nş
 = 2;

1594 ià(
nş
 > 
sş
)

1599 
cs
 = 
	`g‘_çt
(
obj
, 
nş
);

1600 ià(
cs
 == 0)

1604 ià(
cs
 == 1 || cs == 0xFFFFFFFF)

1606  
cs
;

1608 ià(
nş
 =ğ
sş
)

1615 ià(
_FS_EXFAT
 && 
fs
->
fs_ty³
 =ğ
FS_EXFAT
 && 
obj
->
¡©
 == 2)

1617 
»s
 = 
FR_OK
;

1621 
»s
 = 
	`put_çt
(
fs
, 
nş
, 0xFFFFFFFF);

1622 ià(
»s
 =ğ
FR_OK
 && 
ş¡
)

1624 
»s
 = 
	`put_çt
(
fs
, 
ş¡
, 
nş
);

1628 ià(
»s
 =ğ
FR_OK
)

1630 
fs
->
Ï¡_ş¡
 = 
nş
;

1631 ià(
fs
->
ä“_ş¡
 < fs->
n_ç‹Á
 - 2)

1633 
fs
->
ä“_ş¡
--;

1635 
fs
->
fsi_æag
 |= 1;

1639 
nş
 = (
»s
 =ğ
FR_DISK_ERR
) ? 0xFFFFFFFF : 1;

1642  
nş
;

1643 
	}
}

1650 #ià
_USE_FASTSEEK


1656 
DWORD
 
	$şmt_şu¡
 (

1657 
FIL
 *
å
,

1658 
FSIZE_t
 
ofs


1661 
DWORD
 
ş
, 
nş
, *
tbl
;

1662 
FATFS
 *
fs
 = 
å
->
obj
.fs;

1665 
tbl
 = 
å
->
ştbl
 + 1;

1666 
ş
 = (
DWORD
)(
ofs
 / 
	`SS
(
fs
è/ fs->
csize
);

1669 
nş
 = *
tbl
++;

1670 ià(
nş
 == 0)

1674 ià(
ş
 < 
nş
)

1678 
ş
 -ğ
nş
;

1679 
tbl
++;

1681  
ş
 + *
tbl
;

1682 
	}
}

1694 
FRESULT
 
	$dœ_sdi
 (

1695 
DIR
 *
dp
,

1696 
DWORD
 
ofs


1699 
DWORD
 
csz
, 
ş¡
;

1700 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

1703 ià(
ofs
 >ğ(
DWORD
)((
_FS_EXFAT
 && 
fs
->
fs_ty³
 =ğ
FS_EXFAT
è? 
MAX_DIR_EX
 : 
MAX_DIR
è|| of % 
SZDIRE
)

1705  
FR_INT_ERR
;

1707 
dp
->
d±r
 = 
ofs
;

1708 
ş¡
 = 
dp
->
obj
.
sşu¡
;

1709 ià(
ş¡
 =ğ0 && 
fs
->
fs_ty³
 >ğ
FS_FAT32
)

1711 
ş¡
 = 
fs
->
dœba£
;

1712 ià(
_FS_EXFAT
)

1714 
dp
->
obj
.
¡©
 = 0;

1718 ià(
ş¡
 == 0)

1720 ià(
ofs
 / 
SZDIRE
 >ğ
fs
->
n_roÙdœ
)

1722  
FR_INT_ERR
;

1724 
dp
->
£ù
 = 
fs
->
dœba£
;

1729 
csz
 = (
DWORD
)
fs
->
csize
 * 
	`SS
(fs);

1730 
ofs
 >ğ
csz
)

1732 
ş¡
 = 
	`g‘_çt
(&
dp
->
obj
, clst);

1733 ià(
ş¡
 == 0xFFFFFFFF)

1735  
FR_DISK_ERR
;

1737 ià(
ş¡
 < 2 || cl¡ >ğ
fs
->
n_ç‹Á
)

1739  
FR_INT_ERR
;

1741 
ofs
 -ğ
csz
;

1743 
dp
->
£ù
 = 
	`şu¡2£ù
(
fs
, 
ş¡
);

1745 
dp
->
şu¡
 = 
ş¡
;

1746 ià(!
dp
->
£ù
)

1748  
FR_INT_ERR
;

1750 
dp
->
£ù
 +ğ
ofs
 / 
	`SS
(
fs
);

1751 
dp
->
dœ
 = 
fs
->
wš
 + (
ofs
 % 
	`SS
(fs));

1753  
FR_OK
;

1754 
	}
}

1764 
FRESULT
 
	$dœ_Ãxt
 (

1765 
DIR
 *
dp
,

1766 
¡»tch


1769 
DWORD
 
ofs
, 
ş¡
;

1770 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

1771 #ià!
_FS_READONLY


1772 
UINT
 
n
;

1775 
ofs
 = 
dp
->
d±r
 + 
SZDIRE
;

1776 ià(!
dp
->
£ù
 || 
ofs
 >ğ(
DWORD
)((
_FS_EXFAT
 && 
fs
->
fs_ty³
 =ğ
FS_EXFAT
è? 
MAX_DIR_EX
 : 
MAX_DIR
))

1778  
FR_NO_FILE
;

1781 ià(
ofs
 % 
	`SS
(
fs
) == 0)

1783 
dp
->
£ù
++;

1785 ià(!
dp
->
şu¡
)

1787 ià(
ofs
 / 
SZDIRE
 >ğ
fs
->
n_roÙdœ
)

1789 
dp
->
£ù
 = 0;

1790  
FR_NO_FILE
;

1795 ià((
ofs
 / 
	`SS
(
fs
è& (fs->
csize
 - 1)) == 0)

1797 
ş¡
 = 
	`g‘_çt
(&
dp
->
obj
, dp->
şu¡
);

1798 ià(
ş¡
 <= 1)

1800  
FR_INT_ERR
;

1802 ià(
ş¡
 == 0xFFFFFFFF)

1804  
FR_DISK_ERR
;

1806 ià(
ş¡
 >ğ
fs
->
n_ç‹Á
)

1808 #ià!
_FS_READONLY


1809 ià(!
¡»tch
)

1811 
dp
->
£ù
 = 0;

1812  
FR_NO_FILE
;

1814 
ş¡
 = 
	`ü—‹_chaš
(&
dp
->
obj
, dp->
şu¡
);

1815 ià(
ş¡
 == 0)

1817  
FR_DENIED
;

1819 ià(
ş¡
 == 1)

1821  
FR_INT_ERR
;

1823 ià(
ş¡
 == 0xFFFFFFFF)

1825  
FR_DISK_ERR
;

1828 ià(
_FS_EXFAT
)

1830 
dp
->
obj
.
¡©
 |= 4;

1832 ià(
	`sync_wšdow
(
fs
è!ğ
FR_OK
)

1834  
FR_DISK_ERR
;

1836 
	`mem_£t
(
fs
->
wš
, 0, 
	`SS
(fs));

1837 
n
 = 0, 
fs
->
wš£ù
 = 
	`şu¡2£ù
(fs, 
ş¡
);‚ < fs->
csize
;‚++, fs->winsect++)

1839 
fs
->
wæag
 = 1;

1840 ià(
	`sync_wšdow
(
fs
è!ğ
FR_OK
)

1842  
FR_DISK_ERR
;

1845 
fs
->
wš£ù
 -ğ
n
;

1847 ià(!
¡»tch
)

1849 
dp
->
£ù
 = 0;

1851 
dp
->
£ù
 = 0;

1852  
FR_NO_FILE
;

1855 
dp
->
şu¡
 = 
ş¡
;

1856 
dp
->
£ù
 = 
	`şu¡2£ù
(
fs
, 
ş¡
);

1860 
dp
->
d±r
 = 
ofs
;

1861 
dp
->
dœ
 = 
fs
->
wš
 + 
ofs
 % 
	`SS
(fs);

1863  
FR_OK
;

1864 
	}
}

1869 #ià!
_FS_READONLY


1875 
FRESULT
 
	$dœ_®loc
 (

1876 
DIR
 *
dp
,

1877 
UINT
 
ÃÁ


1880 
FRESULT
 
»s
;

1881 
UINT
 
n
;

1882 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

1885 
»s
 = 
	`dœ_sdi
(
dp
, 0);

1886 ià(
»s
 =ğ
FR_OK
)

1888 
n
 = 0;

1891 
»s
 = 
	`move_wšdow
(
fs
, 
dp
->
£ù
);

1892 ià(
»s
 !ğ
FR_OK
)

1896 #ià
_FS_EXFAT


1897 ià((
fs
->
fs_ty³
 =ğ
FS_EXFAT
è? ()((
dp
->
dœ
[
XDIR_Ty³
] & 0x80è=ğ0è: ()(dp->dœ[
DIR_Name
] =ğ
DDEM
 || dp->dir[DIR_Name] == 0))

1900 ià(
dp
->
dœ
[
DIR_Name
] =ğ
DDEM
 || dp->dir[DIR_Name] == 0)

1903 ià(++
n
 =ğ
ÃÁ
)

1910 
n
 = 0;

1912 
»s
 = 
	`dœ_Ãxt
(
dp
, 1);

1914 
»s
 =ğ
FR_OK
);

1917 ià(
»s
 =ğ
FR_NO_FILE
)

1919 
»s
 = 
FR_DENIED
;

1921  
»s
;

1922 
	}
}

1934 
DWORD
 
	$ld_şu¡
 (

1935 
FATFS
 *
fs
,

1936 cÚ¡ 
BYTE
 *
dœ


1939 
DWORD
 
ş
;

1941 
ş
 = 
	`ld_wÜd
(
dœ
 + 
DIR_F¡ClusLO
);

1942 ià(
fs
->
fs_ty³
 =ğ
FS_FAT32
)

1944 
ş
 |ğ(
DWORD
)
	`ld_wÜd
(
dœ
 + 
DIR_F¡ClusHI
) << 16;

1947  
ş
;

1948 
	}
}

1951 #ià!
_FS_READONLY


1953 
	$¡_şu¡
 (

1954 
FATFS
 *
fs
,

1955 
BYTE
 *
dœ
,

1956 
DWORD
 
ş


1959 
	`¡_wÜd
(
dœ
 + 
DIR_F¡ClusLO
, (
WORD
)
ş
);

1960 ià(
fs
->
fs_ty³
 =ğ
FS_FAT32
)

1962 
	`¡_wÜd
(
dœ
 + 
DIR_F¡ClusHI
, (
WORD
)(
ş
 >> 16));

1964 
	}
}

1969 #ià
_USE_LFN
 != 0

1974 cÚ¡ 
BYTE
 
	gLâOfs
[] = {1, 3, 5, 7, 9, 14, 16, 18, 20, 22, 24, 28, 30};

1981 
	$cmp_lâ
 (

1982 cÚ¡ 
WCHAR
 *
lâbuf
,

1983 
BYTE
 *
dœ


1986 
UINT
 
i
, 
s
;

1987 
WCHAR
 
wc
, 
uc
;

1990 ià(
	`ld_wÜd
(
dœ
 + 
LDIR_F¡ClusLO
) != 0)

1995 
i
 = ((
dœ
[
LDIR_Ord
] & 0x3F) - 1) * 13;

1997 
wc
 = 1, 
s
 = 0; s < 13; s++)

1999 
uc
 = 
	`ld_wÜd
(
dœ
 + 
LâOfs
[
s
]);

2000 ià(
wc
)

2002 ià(
i
 >ğ
_MAX_LFN
 || 
	`ff_wtouµ”
(
uc
è!ğff_wtouµ”(
lâbuf
[i++]))

2006 
wc
 = 
uc
;

2010 ià(
uc
 != 0xFFFF)

2017 ià((
dœ
[
LDIR_Ord
] & 
LLEF
è&& 
wc
 && 
lâbuf
[
i
])

2023 
	}
}

2026 #ià
_FS_MINIMIZE
 <ğ1 || 
_FS_RPATH
 >ğ2 || 
_USE_LABEL
 || 
_FS_EXFAT


2031 
	$pick_lâ
 (

2032 
WCHAR
 *
lâbuf
,

2033 
BYTE
 *
dœ


2036 
UINT
 
i
, 
s
;

2037 
WCHAR
 
wc
, 
uc
;

2040 ià(
	`ld_wÜd
(
dœ
 + 
LDIR_F¡ClusLO
) != 0)

2045 
i
 = ((
dœ
[
LDIR_Ord
] & 0x3F) - 1) * 13;

2047 
wc
 = 1, 
s
 = 0; s < 13; s++)

2049 
uc
 = 
	`ld_wÜd
(
dœ
 + 
LâOfs
[
s
]);

2050 ià(
wc
)

2052 ià(
i
 >ğ
_MAX_LFN
)

2056 
lâbuf
[
i
++] = 
wc
 = 
uc
;

2060 ià(
uc
 != 0xFFFF)

2067 ià(
dœ
[
LDIR_Ord
] & 
LLEF
)

2069 ià(
i
 >ğ
_MAX_LFN
)

2073 
lâbuf
[
i
] = 0;

2077 
	}
}

2081 #ià!
_FS_READONLY


2086 
	$put_lâ
 (

2087 cÚ¡ 
WCHAR
 *
lâ
,

2088 
BYTE
 *
dœ
,

2089 
BYTE
 
Üd
,

2090 
BYTE
 
sum


2093 
UINT
 
i
, 
s
;

2094 
WCHAR
 
wc
;

2097 
dœ
[
LDIR_Chksum
] = 
sum
;

2098 
dœ
[
LDIR_A‰r
] = 
AM_LFN
;

2099 
dœ
[
LDIR_Ty³
] = 0;

2100 
	`¡_wÜd
(
dœ
 + 
LDIR_F¡ClusLO
, 0);

2102 
i
 = (
Üd
 - 1) * 13;

2103 
s
 = 
wc
 = 0;

2106 ià(
wc
 != 0xFFFF)

2108 
wc
 = 
lâ
[
i
++];

2110 
	`¡_wÜd
(
dœ
 + 
LâOfs
[
s
], 
wc
);

2111 ià(
wc
 == 0)

2113 
wc
 = 0xFFFF;

2116 ++
s
 < 13);

2117 ià(
wc
 =ğ0xFFFF || !
lâ
[
i
])

2119 
Üd
 |ğ
LLEF
;

2121 
dœ
[
LDIR_Ord
] = 
Üd
;

2122 
	}
}

2129 #ià
_USE_LFN
 !ğ0 && !
_FS_READONLY


2135 
	$g’_numÇme
 (

2136 
BYTE
 *
d¡
,

2137 cÚ¡ 
BYTE
 *
¤c
,

2138 cÚ¡ 
WCHAR
 *
lâ
,

2139 
UINT
 
£q


2142 
BYTE
 
ns
[8], 
c
;

2143 
UINT
 
i
, 
j
;

2144 
WCHAR
 
wc
;

2145 
DWORD
 
¤
;

2148 
	`mem_ıy
(
d¡
, 
¤c
, 11);

2150 ià(
£q
 > 5)

2152 
¤
 = 
£q
;

2153 *
lâ
)

2155 
wc
 = *
lâ
++;

2156 
i
 = 0; i < 16; i++)

2158 
¤
 = (¤ << 1è+ (
wc
 & 1);

2159 
wc
 >>= 1;

2160 ià(
¤
 & 0x10000)

2162 
¤
 ^= 0x11021;

2166 
£q
 = (
UINT
)
¤
;

2170 
i
 = 7;

2173 
c
 = (
BYTE
)((
£q
 % 16) + '0');

2174 ià(
c
 > '9')

2176 
c
 += 7;

2178 
ns
[
i
--] = 
c
;

2179 
£q
 /= 16;

2181 
£q
);

2182 
ns
[
i
] = '~';

2185 
j
 = 0; j < 
i
 && 
d¡
[j] != ' '; j++)

2187 ià(
	`IsDBCS1
(
d¡
[
j
]))

2189 ià(
j
 =ğ
i
 - 1)

2193 
j
++;

2198 
d¡
[
j
++] = (
i
 < 8è? 
ns
[i++] : ' ';

2200 
j
 < 8);

2201 
	}
}

2206 #ià
_USE_LFN
 != 0

2212 
BYTE
 
	$sum_sâ
 (

2213 cÚ¡ 
BYTE
 *
dœ


2216 
BYTE
 
sum
 = 0;

2217 
UINT
 
n
 = 11;

2221 
sum
 = (sum >> 1è+ (sum << 7è+ *
dœ
++;

2223 --
n
);

2224  
sum
;

2225 
	}
}

2231 #ià
_FS_EXFAT


2237 
WORD
 
	$xdœ_sum
 (

2238 cÚ¡ 
BYTE
 *
dœ


2241 
UINT
 
i
, 
szblk
;

2242 
WORD
 
sum
;

2245 
szblk
 = (
dœ
[
XDIR_NumSec
] + 1è* 
SZDIRE
;

2246 
i
 = 
sum
 = 0; i < 
szblk
; i++)

2248 ià(
i
 =ğ
XDIR_S‘Sum
)

2250 
i
++;

2254 
sum
 = ((sum & 1è? 0x8000 : 0è+ (sum >> 1è+ 
dœ
[
i
];

2257  
sum
;

2258 
	}
}

2263 
WORD
 
	$xÇme_sum
 (

2264 cÚ¡ 
WCHAR
 *
Çme


2267 
WCHAR
 
chr
;

2268 
WORD
 
sum
 = 0;

2271 (
chr
 = *
Çme
++) != 0)

2273 
chr
 = 
	`ff_wtouµ”
(chr);

2274 
sum
 = ((sum & 1è? 0x8000 : 0è+ (sum >> 1è+ (
chr
 & 0xFF);

2275 
sum
 = ((sum & 1è? 0x8000 : 0è+ (sum >> 1è+ (
chr
 >> 8);

2277  
sum
;

2278 
	}
}

2281 #ià!
_FS_READONLY
 && 
_USE_MKFS


2283 
DWORD
 
	$xsum32
 (

2284 
BYTE
 
d©
,

2285 
DWORD
 
sum


2288 
sum
 = ((sum & 1è? 0x80000000 : 0è+ (sum >> 1è+ 
d©
;

2289  
sum
;

2290 
	}
}

2294 #ià
_FS_MINIMIZE
 <ğ1 || 
_FS_RPATH
 >= 2

2300 
	$g‘_xdœ_šfo
 (

2301 
BYTE
 *
dœb
,

2302 
FILINFO
 *
âo


2305 
UINT
 
di
, 
si
;

2306 
WCHAR
 
w
;

2307 #ià!
_LFN_UNICODE


2308 
UINT
 
nc
;

2312 #ià
_LFN_UNICODE


2313 ià(
dœb
[
XDIR_NumName
] <ğ
_MAX_LFN
)

2315 
si
 = 
SZDIRE
 * 2, 
di
 = 0; d˜< 
dœb
[
XDIR_NumName
]; si += 2, di++)

2317 ià((
si
 % 
SZDIRE
) == 0)

2319 
si
 += 2;

2321 
w
 = 
	`ld_wÜd
(
dœb
 + 
si
);

2322 
âo
->
âame
[
di
] = 
w
;

2327 
di
 = 0;

2330 
si
 = 
SZDIRE
 * 2, 
di
 = 
nc
 = 0;‚ø< 
dœb
[
XDIR_NumName
]; si += 2,‚c++)

2332 ià((
si
 % 
SZDIRE
) == 0)

2334 
si
 += 2;

2336 
w
 = 
	`ld_wÜd
(
dœb
 + 
si
);

2337 
w
 = 
	`ff_cÚv”t
(w, 0);

2338 ià(
w
 == 0)

2340 
di
 = 0;

2343 ià(
_DF1S
 && 
w
 >= 0x100)

2345 
âo
->
âame
[
di
++] = ()(
w
 >> 8);

2347 ià(
di
 >ğ
_MAX_LFN
)

2349 
di
 = 0;

2352 
âo
->
âame
[
di
++] = ()
w
;

2355 ià(
di
 == 0)

2357 
âo
->
âame
[
di
++] = '?';

2359 
âo
->
âame
[
di
] = 0;

2361 
âo
->
®Šame
[0] = 0;

2362 
âo
->
ç‰rib
 = 
dœb
[
XDIR_A‰r
];

2363 
âo
->
fsize
 = (âo->
ç‰rib
 & 
AM_DIR
è? 0 : 
	`ld_qwÜd
(
dœb
 + 
XDIR_FeSize
);

2364 
âo
->
áime
 = 
	`ld_wÜd
(
dœb
 + 
XDIR_ModTime
 + 0);

2365 
âo
->
fd©e
 = 
	`ld_wÜd
(
dœb
 + 
XDIR_ModTime
 + 2);

2366 
	}
}

2376 
FRESULT
 
	$lßd_xdœ
 (

2377 
DIR
 *
dp


2380 
FRESULT
 
»s
;

2381 
UINT
 
i
, 
ÃÁ
;

2382 
BYTE
 *
dœb
 = 
dp
->
obj
.
fs
->
dœbuf
;

2386 
»s
 = 
	`move_wšdow
(
dp
->
obj
.
fs
, dp->
£ù
);

2387 ià(
»s
 !ğ
FR_OK
)

2389  
»s
;

2391 ià(
dp
->
dœ
[
XDIR_Ty³
] != 0x85)

2393  
FR_INT_ERR
;

2395 
	`mem_ıy
(
dœb
, 
dp
->
dœ
, 
SZDIRE
);

2396 
ÃÁ
 = 
dœb
[
XDIR_NumSec
] + 1;

2399 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

2400 ià(
»s
 !ğ
FR_OK
)

2402  
»s
;

2404 
»s
 = 
	`move_wšdow
(
dp
->
obj
.
fs
, dp->
£ù
);

2405 ià(
»s
 !ğ
FR_OK
)

2407  
»s
;

2409 ià(
dp
->
dœ
[
XDIR_Ty³
] != 0xC0)

2411  
FR_INT_ERR
;

2413 
	`mem_ıy
(
dœb
 + 
SZDIRE
, 
dp
->
dœ
, SZDIRE);

2416 ià(
ÃÁ
 < 3 ||‚ent > 19)

2418  
FR_NO_FILE
;

2420 
i
 = 
SZDIRE
 * 2;

2421 
ÃÁ
 *ğ
SZDIRE
;

2424 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

2425 ià(
»s
 !ğ
FR_OK
)

2427  
»s
;

2429 
»s
 = 
	`move_wšdow
(
dp
->
obj
.
fs
, dp->
£ù
);

2430 ià(
»s
 !ğ
FR_OK
)

2432  
»s
;

2434 ià(
dp
->
dœ
[
XDIR_Ty³
] != 0xC1)

2436  
FR_INT_ERR
;

2438 
	`mem_ıy
(
dœb
 + 
i
, 
dp
->
dœ
, 
SZDIRE
);

2439 
i
 +ğ
SZDIRE
;

2441 
i
 < 
ÃÁ
);

2444 ià(
	`xdœ_sum
(
dœb
è!ğ
	`ld_wÜd
(dœb + 
XDIR_S‘Sum
))

2446  
FR_INT_ERR
;

2449  
FR_OK
;

2450 
	}
}

2453 #ià!
_FS_READONLY
 || 
_FS_RPATH
 != 0

2458 
FRESULT
 
	$lßd_obj_dœ
 (

2459 
DIR
 *
dp
,

2460 cÚ¡ 
_FDID
 *
obj


2463 
FRESULT
 
»s
;

2467 
dp
->
obj
.
fs
 = obj->fs;

2468 
dp
->
obj
.
sşu¡
 = obj->
c_sş
;

2469 
dp
->
obj
.
¡©
 = (
BYTE
)obj->
c_size
;

2470 
dp
->
obj
.
objsize
 = obj->
c_size
 & 0xFFFFFF00;

2471 
dp
->
blk_ofs
 = 
obj
->
c_ofs
;

2473 
»s
 = 
	`dœ_sdi
(
dp
, dp->
blk_ofs
);

2474 ià(
»s
 =ğ
FR_OK
)

2476 
»s
 = 
	`lßd_xdœ
(
dp
);

2478  
»s
;

2479 
	}
}

2483 #ià!
_FS_READONLY


2488 
FRESULT
 
	$¡Üe_xdœ
 (

2489 
DIR
 *
dp


2492 
FRESULT
 
»s
;

2493 
UINT
 
ÃÁ
;

2494 
BYTE
 *
dœb
 = 
dp
->
obj
.
fs
->
dœbuf
;

2497 
	`¡_wÜd
(
dœb
 + 
XDIR_S‘Sum
, 
	`xdœ_sum
(dirb));

2498 
ÃÁ
 = 
dœb
[
XDIR_NumSec
] + 1;

2501 
»s
 = 
	`dœ_sdi
(
dp
, dp->
blk_ofs
);

2502 
»s
 =ğ
FR_OK
)

2504 
»s
 = 
	`move_wšdow
(
dp
->
obj
.
fs
, dp->
£ù
);

2505 ià(
»s
 !ğ
FR_OK
)

2509 
	`mem_ıy
(
dp
->
dœ
, 
dœb
, 
SZDIRE
);

2510 
dp
->
obj
.
fs
->
wæag
 = 1;

2511 ià(--
ÃÁ
 == 0)

2515 
dœb
 +ğ
SZDIRE
;

2516 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

2518  (
»s
 =ğ
FR_OK
 ||„e =ğ
FR_DISK_ERR
è?„e : 
FR_INT_ERR
;

2519 
	}
}

2528 
	$ü—‹_xdœ
 (

2529 
BYTE
 *
dœb
,

2530 cÚ¡ 
WCHAR
 *
lâ


2533 
UINT
 
i
;

2534 
BYTE
 
nb
, 
nc
;

2535 
WCHAR
 
chr
;

2538 
	`mem_£t
(
dœb
, 0, 2 * 
SZDIRE
);

2539 
dœb
[
XDIR_Ty³
] = 0x85;

2540 
dœb
[
XDIR_Ty³
 + 
SZDIRE
] = 0xC0;

2541 
	`¡_wÜd
(
dœb
 + 
XDIR_NameHash
, 
	`xÇme_sum
(
lâ
));

2543 
i
 = 
SZDIRE
 * 2;

2544 
nc
 = 0;

2545 
nb
 = 1;

2546 
chr
 = 1;

2549 
dœb
[
i
++] = 0xC1;

2550 
dœb
[
i
++] = 0;

2553 ià(
chr
 && (ch¸ğ
lâ
[
nc
]) != 0)

2555 
nc
++;

2557 
	`¡_wÜd
(
dœb
 + 
i
, 
chr
);

2558 
i
 += 2;

2560 
i
 % 
SZDIRE
);

2561 
nb
++;

2563 
lâ
[
nc
]);

2565 
dœb
[
XDIR_NumName
] = 
nc
;

2566 
dœb
[
XDIR_NumSec
] = 
nb
;

2567 
	}
}

2574 #ià
_FS_MINIMIZE
 <ğ1 || 
_FS_RPATH
 >ğ2 || 
_USE_LABEL
 || 
_FS_EXFAT


2580 
FRESULT
 
	$dœ_»ad
 (

2581 
DIR
 *
dp
,

2582 
vŞ


2585 
FRESULT
 
»s
 = 
FR_NO_FILE
;

2586 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

2587 
BYTE
 
a
, 
c
;

2588 #ià
_USE_LFN
 != 0

2589 
BYTE
 
Üd
 = 0xFF, 
sum
 = 0xFF;

2592 
dp
->
£ù
)

2594 
»s
 = 
	`move_wšdow
(
fs
, 
dp
->
£ù
);

2595 ià(
»s
 !ğ
FR_OK
)

2599 
c
 = 
dp
->
dœ
[
DIR_Name
];

2600 ià(
c
 == 0)

2602 
»s
 = 
FR_NO_FILE
;

2605 #ià
_FS_EXFAT


2606 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

2608 ià(
_USE_LABEL
 && 
vŞ
)

2610 ià(
c
 == 0x83)

2617 ià(
c
 == 0x85)

2619 
dp
->
blk_ofs
 = dp->
d±r
;

2620 
»s
 = 
	`lßd_xdœ
(
dp
);

2621 ià(
»s
 =ğ
FR_OK
)

2623 
dp
->
obj
.
©Œ
 = 
fs
->
dœbuf
[
XDIR_A‰r
] & 
AM_MASK
;

2633 
dp
->
obj
.
©Œ
 = 
a
 = dp->
dœ
[
DIR_A‰r
] & 
AM_MASK
;

2634 #ià
_USE_LFN
 != 0

2635 ià(
c
 =ğ
DDEM
 || c =ğ'.' || ()((
a
 & ~
AM_ARC
è=ğ
AM_VOL
è!ğ
vŞ
)

2637 
Üd
 = 0xFF;

2641 ià(
a
 =ğ
AM_LFN
)

2643 ià(
c
 & 
LLEF
)

2645 
sum
 = 
dp
->
dœ
[
LDIR_Chksum
];

2646 
c
 &ğ(
BYTE
)~
LLEF
;

2647 
Üd
 = 
c
;

2648 
dp
->
blk_ofs
 = dp->
d±r
;

2651 
Üd
 = (
c
 =ğÜd && 
sum
 =ğ
dp
->
dœ
[
LDIR_Chksum
] && 
	`pick_lâ
(
fs
->
lâbuf
, dp->dir)) ? ord - 1 : 0xFF;

2655 ià(
Üd
 || 
sum
 !ğ
	`sum_sâ
(
dp
->
dœ
))

2657 
dp
->
blk_ofs
 = 0xFFFFFFFF;

2663 ià(
c
 !ğ
DDEM
 && c !ğ'.' && 
a
 !ğ
AM_LFN
 && ()(× & ~
AM_ARC
è=ğ
AM_VOL
è=ğ
vŞ
)

2669 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

2670 ià(
»s
 !ğ
FR_OK
)

2676 ià(
»s
 !ğ
FR_OK
)

2678 
dp
->
£ù
 = 0;

2680  
»s
;

2681 
	}
}

2692 
FRESULT
 
	$dœ_fšd
 (

2693 
DIR
 *
dp


2696 
FRESULT
 
»s
;

2697 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

2698 
BYTE
 
c
;

2699 #ià
_USE_LFN
 != 0

2700 
BYTE
 
a
, 
Üd
, 
sum
;

2703 
»s
 = 
	`dœ_sdi
(
dp
, 0);

2704 ià(
»s
 !ğ
FR_OK
)

2706  
»s
;

2708 #ià
_FS_EXFAT


2709 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

2711 
BYTE
 
nc
;

2712 
UINT
 
di
, 
ni
;

2713 
WORD
 
hash
 = 
	`xÇme_sum
(
fs
->
lâbuf
);

2715 (
»s
 = 
	`dœ_»ad
(
dp
, 0)è=ğ
FR_OK
)

2717 ià(
	`ld_wÜd
(
fs
->
dœbuf
 + 
XDIR_NameHash
è!ğ
hash
)

2721 
nc
 = 
fs
->
dœbuf
[
XDIR_NumName
], 
di
 = 
SZDIRE
 * 2, 
ni
 = 0;‚c;‚c--, di += 2,‚i++)

2723 ià((
di
 % 
SZDIRE
) == 0)

2725 
di
 += 2;

2727 ià(
	`ff_wtouµ”
(
	`ld_wÜd
(
fs
->
dœbuf
 + 
di
)è!ğff_wtouµ”(fs->
lâbuf
[
ni
]))

2732 ià(
nc
 =ğ0 && !
fs
->
lâbuf
[
ni
])

2737  
»s
;

2741 #ià
_USE_LFN
 != 0

2742 
Üd
 = 
sum
 = 0xFF;

2743 
dp
->
blk_ofs
 = 0xFFFFFFFF;

2747 
»s
 = 
	`move_wšdow
(
fs
, 
dp
->
£ù
);

2748 ià(
»s
 !ğ
FR_OK
)

2752 
c
 = 
dp
->
dœ
[
DIR_Name
];

2753 ià(
c
 == 0)

2755 
»s
 = 
FR_NO_FILE
;

2758 #ià
_USE_LFN
 != 0

2759 
dp
->
obj
.
©Œ
 = 
a
 = dp->
dœ
[
DIR_A‰r
] & 
AM_MASK
;

2760 ià(
c
 =ğ
DDEM
 || ((
a
 & 
AM_VOL
è&&‡ !ğ
AM_LFN
))

2762 
Üd
 = 0xFF;

2763 
dp
->
blk_ofs
 = 0xFFFFFFFF;

2767 ià(
a
 =ğ
AM_LFN
)

2769 ià(!(
dp
->
â
[
NSFLAG
] & 
NS_NOLFN
))

2771 ià(
c
 & 
LLEF
)

2773 
sum
 = 
dp
->
dœ
[
LDIR_Chksum
];

2774 
c
 &ğ(
BYTE
)~
LLEF
;

2775 
Üd
 = 
c
;

2776 
dp
->
blk_ofs
 = dp->
d±r
;

2779 
Üd
 = (
c
 =ğÜd && 
sum
 =ğ
dp
->
dœ
[
LDIR_Chksum
] && 
	`cmp_lâ
(
fs
->
lâbuf
, dp->dir)) ? ord - 1 : 0xFF;

2784 ià(!
Üd
 && 
sum
 =ğ
	`sum_sâ
(
dp
->
dœ
))

2788 ià(!(
dp
->
â
[
NSFLAG
] & 
NS_LOSS
è&& !
	`mem_cmp
(dp->
dœ
, dp->fn, 11))

2792 
Üd
 = 0xFF;

2793 
dp
->
blk_ofs
 = 0xFFFFFFFF;

2797 
dp
->
obj
.
©Œ
 = dp->
dœ
[
DIR_A‰r
] & 
AM_MASK
;

2798 ià(!(
dp
->
dœ
[
DIR_A‰r
] & 
AM_VOL
è&& !
	`mem_cmp
(dp->dœ, dp->
â
, 11))

2803 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

2805 
»s
 =ğ
FR_OK
);

2807  
»s
;

2808 
	}
}

2813 #ià!
_FS_READONLY


2819 
FRESULT
 
	$dœ_»gi¡”
 (

2820 
DIR
 *
dp


2823 
FRESULT
 
»s
;

2824 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

2825 #ià
_USE_LFN
 != 0

2826 
UINT
 
n
, 
Æ’
, 
ÃÁ
;

2827 
BYTE
 
¢
[12], 
sum
;

2830 ià(
dp
->
â
[
NSFLAG
] & (
NS_DOT
 | 
NS_NONAME
))

2832  
FR_INVALID_NAME
;

2834 
Æ’
 = 0; 
fs
->
lâbuf
[nlen];‚len++) ;

2836 #ià
_FS_EXFAT


2837 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

2839 
DIR
 
dj
;

2841 
ÃÁ
 = (
Æ’
 + 14) / 15 + 2;

2842 
»s
 = 
	`dœ_®loc
(
dp
, 
ÃÁ
);

2843 ià(
»s
 !ğ
FR_OK
)

2845  
»s
;

2847 
dp
->
blk_ofs
 = dp->
d±r
 - 
SZDIRE
 * (
ÃÁ
 - 1);

2849 ià(
dp
->
obj
.
sşu¡
 !ğ0 && (dp->obj.
¡©
 & 4))

2851 
dp
->
obj
.
¡©
 &= 3;

2852 
dp
->
obj
.
objsize
 +ğ(
DWORD
)
fs
->
csize
 * 
	`SS
(fs);

2853 
»s
 = 
	`fl_çt_chaš
(&
dp
->
obj
);

2854 ià(
»s
 !ğ
FR_OK
)

2856  
»s
;

2858 
»s
 = 
	`lßd_obj_dœ
(&
dj
, &
dp
->
obj
);

2859 ià(
»s
 !ğ
FR_OK
)

2861  
»s
;

2863 
	`¡_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
, 
dp
->
obj
.
objsize
);

2864 
	`¡_qwÜd
(
fs
->
dœbuf
 + 
XDIR_V®idFeSize
, 
dp
->
obj
.
objsize
);

2865 
fs
->
dœbuf
[
XDIR_G’FÏgs
] = 
dp
->
obj
.
¡©
 | 1;

2866 
»s
 = 
	`¡Üe_xdœ
(&
dj
);

2867 ià(
»s
 !ğ
FR_OK
)

2869  
»s
;

2873 
	`ü—‹_xdœ
(
fs
->
dœbuf
, fs->
lâbuf
);

2874  
FR_OK
;

2878 
	`mem_ıy
(
¢
, 
dp
->
â
, 12);

2879 ià(
¢
[
NSFLAG
] & 
NS_LOSS
)

2881 
dp
->
â
[
NSFLAG
] = 
NS_NOLFN
;

2882 
n
 = 1;‚ < 100;‚++)

2884 
	`g’_numÇme
(
dp
->
â
, 
¢
, 
fs
->
lâbuf
, 
n
);

2885 
»s
 = 
	`dœ_fšd
(
dp
);

2886 ià(
»s
 !ğ
FR_OK
)

2891 ià(
n
 == 100)

2893  
FR_DENIED
;

2895 ià(
»s
 !ğ
FR_NO_FILE
)

2897  
»s
;

2899 
dp
->
â
[
NSFLAG
] = 
¢
[NSFLAG];

2903 
ÃÁ
 = (
¢
[
NSFLAG
] & 
NS_LFN
è? (
Æ’
 + 12) / 13 + 1 : 1;

2904 
»s
 = 
	`dœ_®loc
(
dp
, 
ÃÁ
);

2905 ià(
»s
 =ğ
FR_OK
 && --
ÃÁ
)

2907 
»s
 = 
	`dœ_sdi
(
dp
, dp->
d±r
 - 
ÃÁ
 * 
SZDIRE
);

2908 ià(
»s
 =ğ
FR_OK
)

2910 
sum
 = 
	`sum_sâ
(
dp
->
â
);

2913 
»s
 = 
	`move_wšdow
(
fs
, 
dp
->
£ù
);

2914 ià(
»s
 !ğ
FR_OK
)

2918 
	`put_lâ
(
fs
->
lâbuf
, 
dp
->
dœ
, (
BYTE
)
ÃÁ
, 
sum
);

2919 
fs
->
wæag
 = 1;

2920 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

2922 
»s
 =ğ
FR_OK
 && --
ÃÁ
);

2927 
»s
 = 
	`dœ_®loc
(
dp
, 1);

2932 ià(
»s
 =ğ
FR_OK
)

2934 
»s
 = 
	`move_wšdow
(
fs
, 
dp
->
£ù
);

2935 ià(
»s
 =ğ
FR_OK
)

2937 
	`mem_£t
(
dp
->
dœ
, 0, 
SZDIRE
);

2938 
	`mem_ıy
(
dp
->
dœ
 + 
DIR_Name
, dp->
â
, 11);

2939 #ià
_USE_LFN
 != 0

2940 
dp
->
dœ
[
DIR_NT»s
] = dp->
â
[
NSFLAG
] & (
NS_BODY
 | 
NS_EXT
);

2942 
fs
->
wæag
 = 1;

2946  
»s
;

2947 
	}
}

2953 #ià!
_FS_READONLY
 && 
_FS_MINIMIZE
 == 0

2959 
FRESULT
 
	$dœ_»move
 (

2960 
DIR
 *
dp


2963 
FRESULT
 
»s
;

2964 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

2965 #ià
_USE_LFN
 != 0

2966 
DWORD
 
Ï¡
 = 
dp
->
d±r
;

2968 
»s
 = (
dp
->
blk_ofs
 =ğ0xFFFFFFFFè? 
FR_OK
 : 
	`dœ_sdi
(dp, dp->blk_ofs);

2969 ià(
»s
 =ğ
FR_OK
)

2973 
»s
 = 
	`move_wšdow
(
fs
, 
dp
->
£ù
);

2974 ià(
»s
 !ğ
FR_OK
)

2979 ià(
_FS_EXFAT
 && 
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

2981 
dp
->
dœ
[
XDIR_Ty³
] &= 0x7F;

2985 
dp
->
dœ
[
DIR_Name
] = 
DDEM
;

2987 
fs
->
wæag
 = 1;

2988 ià(
dp
->
d±r
 >ğ
Ï¡
)

2992 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

2994 
»s
 =ğ
FR_OK
);

2995 ià(
»s
 =ğ
FR_NO_FILE
)

2997 
»s
 = 
FR_INT_ERR
;

3002 
»s
 = 
	`move_wšdow
(
fs
, 
dp
->
£ù
);

3003 ià(
»s
 =ğ
FR_OK
)

3005 
dp
->
dœ
[
DIR_Name
] = 
DDEM
;

3006 
fs
->
wæag
 = 1;

3010  
»s
;

3011 
	}
}

3017 #ià
_FS_MINIMIZE
 <ğ1 || 
_FS_RPATH
 >= 2

3023 
	$g‘_fešfo
 (

3024 
DIR
 *
dp
,

3025 
FILINFO
 *
âo


3028 
UINT
 
i
, 
j
;

3029 
TCHAR
 
c
;

3030 
DWORD
 
tm
;

3031 #ià
_USE_LFN
 != 0

3032 
WCHAR
 
w
, 
lfv
;

3033 
FATFS
 *
fs
 = 
dp
->
obj
.fs;

3037 
âo
->
âame
[0] = 0;

3038 ià(!
dp
->
£ù
)

3043 #ià
_USE_LFN
 != 0

3044 #ià
_FS_EXFAT


3045 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

3047 
	`g‘_xdœ_šfo
(
fs
->
dœbuf
, 
âo
);

3054 ià(
dp
->
blk_ofs
 != 0xFFFFFFFF)

3056 
i
 = 
j
 = 0;

3057 (
w
 = 
fs
->
lâbuf
[
j
++]) != 0)

3059 #ià!
_LFN_UNICODE


3060 
w
 = 
	`ff_cÚv”t
(w, 0);

3061 ià(
w
 == 0)

3063 
i
 = 0;

3066 ià(
_DF1S
 && 
w
 >= 0x100)

3068 
âo
->
âame
[
i
++] = ()(
w
 >> 8);

3071 ià(
i
 >ğ
_MAX_LFN
)

3073 
i
 = 0;

3076 
âo
->
âame
[
i
++] = (
TCHAR
)
w
;

3078 
âo
->
âame
[
i
] = 0;

3082 
i
 = 
j
 = 0;

3083 
lfv
 = 
âo
->
âame
[
i
];

3084 
i
 < 11)

3086 
c
 = (
TCHAR
)
dp
->
dœ
[
i
++];

3087 ià(
c
 == ' ')

3091 ià(
c
 =ğ
RDDEM
)

3093 
c
 = (
TCHAR
)
DDEM
;

3095 ià(
i
 == 9)

3097 ià(!
lfv
)

3099 
âo
->
âame
[
j
] = '.';

3101 
âo
->
®Šame
[
j
++] = '.';

3103 #ià
_LFN_UNICODE


3104 ià(
	`IsDBCS1
(
c
è&& 
i
 !ğ8 && i !ğ11 && 
	`IsDBCS2
(
dp
->
dœ
[i]))

3106 
c
 = c << 8 | 
dp
->
dœ
[
i
++];

3108 
c
 = 
	`ff_cÚv”t
(c, 1);

3109 ià(!
c
)

3111 
c
 = '?';

3114 
âo
->
®Šame
[
j
] = 
c
;

3115 ià(!
lfv
)

3117 ià(
	`IsUµ”
(
c
è&& (
dp
->
dœ
[
DIR_NT»s
] & (
i
 >ğ9 ? 
NS_EXT
 : 
NS_BODY
)))

3119 
c
 += 0x20;

3121 
âo
->
âame
[
j
] = 
c
;

3123 
j
++;

3125 ià(!
lfv
)

3127 
âo
->
âame
[
j
] = 0;

3128 ià(!
dp
->
dœ
[
DIR_NT»s
])

3130 
j
 = 0;

3133 
âo
->
®Šame
[
j
] = 0;

3136 
i
 = 
j
 = 0;

3137 
i
 < 11)

3139 
c
 = (
TCHAR
)
dp
->
dœ
[
i
++];

3140 ià(
c
 == ' ')

3144 ià(
c
 =ğ
RDDEM
)

3146 
c
 = (
TCHAR
)
DDEM
;

3148 ià(
i
 == 9)

3150 
âo
->
âame
[
j
++] = '.';

3152 
âo
->
âame
[
j
++] = 
c
;

3154 
âo
->
âame
[
j
] = 0;

3157 
âo
->
ç‰rib
 = 
dp
->
dœ
[
DIR_A‰r
];

3158 
âo
->
fsize
 = 
	`ld_dwÜd
(
dp
->
dœ
 + 
DIR_FeSize
);

3159 
tm
 = 
	`ld_dwÜd
(
dp
->
dœ
 + 
DIR_ModTime
);

3160 
âo
->
áime
 = (
WORD
)
tm
;

3161 
âo
->
fd©e
 = (
WORD
)(
tm
 >> 16);

3162 
	}
}

3168 #ià
_USE_FIND
 && 
_FS_MINIMIZE
 <= 1

3174 
WCHAR
 
	$g‘_ach¬
 (

3175 cÚ¡ 
TCHAR
 **
±r


3178 #ià!
_LFN_UNICODE


3179 
WCHAR
 
chr
;

3181 
chr
 = (
BYTE
è* (*
±r
)++;

3182 ià(
	`IsLow”
(
chr
))

3184 
chr
 -= 0x20;

3186 #ifdeà
_EXCVT


3187 ià(
chr
 >= 0x80)

3189 
chr
 = 
ExCvt
[chr - 0x80];

3192 ià(
	`IsDBCS1
(
chr
è&& 
	`IsDBCS2
(**
±r
))

3194 
chr
 = ch¸<< 8 | (
BYTE
è* (*
±r
)++;

3197  
chr
;

3199  
	`ff_wtouµ”
(*(*
±r
)++);

3201 
	}
}

3205 
	$·‰”n_m©chšg
 (

3206 cÚ¡ 
TCHAR
 *
·t
,

3207 cÚ¡ 
TCHAR
 *
Çm
,

3208 
sk
,

3209 
šf


3212 cÚ¡ 
TCHAR
 *
µ
, *
Å
;

3213 
WCHAR
 
pc
, 
nc
;

3214 
nm
, 
nx
;

3217 
sk
--)

3219 ià(!
	`g‘_ach¬
(&
Çm
))

3224 ià(!*
·t
 && 
šf
)

3231 
µ
 = 
·t
;

3232 
Å
 = 
Çm
;

3235 ià(*
µ
 == '?' || *pp == '*')

3237 
nm
 = 
nx
 = 0;

3240 ià(*
µ
++ == '?')

3242 
nm
++;

3246 
nx
 = 1;

3249 *
µ
 == '?' || *pp == '*');

3250 ià(
	`·‰”n_m©chšg
(
µ
, 
Å
, 
nm
, 
nx
))

3254 
nc
 = *
Å
;

3257 
pc
 = 
	`g‘_ach¬
(&
µ
);

3258 
nc
 = 
	`g‘_ach¬
(&
Å
);

3259 ià(
pc
 !ğ
nc
)

3263 ià(
pc
 == 0)

3268 
	`g‘_ach¬
(&
Çm
);

3270 
šf
 && 
nc
);

3273 
	}
}

3284 
FRESULT
 
	$ü—‹_Çme
 (

3285 
DIR
 *
dp
,

3286 cÚ¡ 
TCHAR
 **
·th


3289 #ià
_USE_LFN
 != 0

3290 
BYTE
 
b
, 
cf
;

3291 
WCHAR
 
w
, *
lâ
;

3292 
UINT
 
i
, 
ni
, 
si
, 
di
;

3293 cÚ¡ 
TCHAR
 *
p
;

3296 
p
 = *
·th
;

3297 
lâ
 = 
dp
->
obj
.
fs
->
lâbuf
;

3298 
si
 = 
di
 = 0;

3301 
w
 = 
p
[
si
++];

3302 ià(
w
 < ' ')

3306 ià(
w
 == '/' || w == '\\')

3308 
p
[
si
] == '/' ||…[si] == '\\')

3310 
si
++;

3314 ià(
di
 >ğ
_MAX_LFN
)

3316  
FR_INVALID_NAME
;

3318 #ià!
_LFN_UNICODE


3319 
w
 &= 0xFF;

3320 ià(
	`IsDBCS1
(
w
))

3322 
b
 = (
BYTE
)
p
[
si
++];

3323 
w
 = (w << 8è+ 
b
;

3324 ià(!
	`IsDBCS2
(
b
))

3326  
FR_INVALID_NAME
;

3329 
w
 = 
	`ff_cÚv”t
(w, 1);

3330 ià(!
w
)

3332  
FR_INVALID_NAME
;

3335 ià(
w
 < 0x80 && 
	`chk_chr
("\"*:<>\?|\x7F", w))

3337  
FR_INVALID_NAME
;

3339 
lâ
[
di
++] = 
w
;

3341 *
·th
 = &
p
[
si
];

3342 
cf
 = (
w
 < ' 'è? 
NS_LAST
 : 0;

3343 #ià
_FS_RPATH
 != 0

3344 ià((
di
 =ğ1 && 
lâ
[di - 1] == '.') ||

3345 (
di
 =ğ2 && 
lâ
[di - 1] == '.' &&†fn[di - 2] == '.'))

3347 
lâ
[
di
] = 0;

3348 
i
 = 0; i < 11; i++)

3350 
dp
->
â
[
i
] = (˜< 
di
) ? '.' : ' ';

3352 
dp
->
â
[
i
] = 
cf
 | 
NS_DOT
;

3353  
FR_OK
;

3356 
di
)

3358 
w
 = 
lâ
[
di
 - 1];

3359 ià(
w
 != ' ' && w != '.')

3363 
di
--;

3365 
lâ
[
di
] = 0;

3366 ià(
di
 == 0)

3368  
FR_INVALID_NAME
;

3372 
	`mem_£t
(
dp
->
â
, ' ', 11);

3373 
si
 = 0; 
lâ
[si] == ' ' ||†fn[si] == '.'; si++) ;

3374 ià(
si
)

3376 
cf
 |ğ
NS_LOSS
 | 
NS_LFN
;

3378 
di
 && 
lâ
[di - 1] != '.')

3380 
di
--;

3383 
i
 = 
b
 = 0;

3384 
ni
 = 8;

3387 
w
 = 
lâ
[
si
++];

3388 ià(!
w
)

3392 ià(
w
 =ğ' ' || (w =ğ'.' && 
si
 !ğ
di
))

3394 
cf
 |ğ
NS_LOSS
 | 
NS_LFN
;

3398 ià(
i
 >ğ
ni
 || 
si
 =ğ
di
)

3400 ià(
ni
 == 11)

3402 
cf
 |ğ
NS_LOSS
 | 
NS_LFN
;

3405 ià(
si
 !ğ
di
)

3407 
cf
 |ğ
NS_LOSS
 | 
NS_LFN
;

3409 ià(
si
 > 
di
)

3413 
si
 = 
di
;

3414 
i
 = 8;

3415 
ni
 = 11;

3416 
b
 <<= 2;

3420 ià(
w
 >= 0x80)

3422 #ifdeà
_EXCVT


3423 
w
 = 
	`ff_cÚv”t
(w, 0);

3424 ià(
w
)

3426 
w
 = 
ExCvt
[w - 0x80];

3429 
w
 = 
	`ff_cÚv”t
(
	`ff_wtouµ”
(w), 0);

3431 
cf
 |ğ
NS_LFN
;

3434 ià(
_DF1S
 && 
w
 >= 0x100)

3436 ià(
i
 >ğ
ni
 - 1)

3438 
cf
 |ğ
NS_LOSS
 | 
NS_LFN
;

3439 
i
 = 
ni
;

3442 
dp
->
â
[
i
++] = (
BYTE
)(
w
 >> 8);

3446 ià(!
w
 || 
	`chk_chr
("+,;=[]", w))

3448 
w
 = '_';

3449 
cf
 |ğ
NS_LOSS
 | 
NS_LFN
;

3453 ià(
	`IsUµ”
(
w
))

3455 
b
 |= 2;

3459 ià(
	`IsLow”
(
w
))

3461 
b
 |= 1;

3462 
w
 -= 0x20;

3467 
dp
->
â
[
i
++] = (
BYTE
)
w
;

3470 ià(
dp
->
â
[0] =ğ
DDEM
)

3472 
dp
->
â
[0] = 
RDDEM
;

3475 ià(
ni
 == 8)

3477 
b
 <<= 2;

3479 ià((
b
 & 0x0C) == 0x0C || (b & 0x03) == 0x03)

3481 
cf
 |ğ
NS_LFN
;

3483 ià(!(
cf
 & 
NS_LFN
))

3485 ià((
b
 & 0x03) == 0x01)

3487 
cf
 |ğ
NS_EXT
;

3489 ià((
b
 & 0x0C) == 0x04)

3491 
cf
 |ğ
NS_BODY
;

3495 
dp
->
â
[
NSFLAG
] = 
cf
;

3497  
FR_OK
;

3501 
BYTE
 
c
, 
d
, *
sâ
;

3502 
UINT
 
ni
, 
si
, 
i
;

3503 cÚ¡ *
p
;

3506 
p
 = *
·th
;

3507 
sâ
 = 
dp
->
â
;

3508 
	`mem_£t
(
sâ
, ' ', 11);

3509 
si
 = 
i
 = 0;

3510 
ni
 = 8;

3511 #ià
_FS_RPATH
 != 0

3512 ià(
p
[
si
] == '.')

3516 
c
 = (
BYTE
)
p
[
si
++];

3517 ià(
c
 !ğ'.' || 
si
 >= 3)

3521 
sâ
[
i
++] = 
c
;

3523 ià(
c
 != '/' && c != '\\' && c > ' ')

3525  
FR_INVALID_NAME
;

3527 *
·th
 = 
p
 + 
si
;

3528 
sâ
[
NSFLAG
] = (
c
 <ğ' 'è? 
NS_LAST
 | 
NS_DOT
 : NS_DOT;

3529  
FR_OK
;

3534 
c
 = (
BYTE
)
p
[
si
++];

3535 ià(
c
 <= ' ')

3539 ià(
c
 == '/' || c == '\\')

3541 
p
[
si
] == '/' ||…[si] == '\\')

3543 
si
++;

3547 ià(
c
 =ğ'.' || 
i
 >ğ
ni
)

3549 ià(
ni
 =ğ11 || 
c
 != '.')

3551  
FR_INVALID_NAME
;

3553 
i
 = 8;

3554 
ni
 = 11;

3557 ià(
c
 >= 0x80)

3559 #ifdeà
_EXCVT


3560 
c
 = 
ExCvt
[c - 0x80];

3562 #ià!
_DF1S


3563  
FR_INVALID_NAME
;

3567 ià(
	`IsDBCS1
(
c
))

3569 
d
 = (
BYTE
)
p
[
si
++];

3570 ià(!
	`IsDBCS2
(
d
è|| 
i
 >ğ
ni
 - 1)

3572  
FR_INVALID_NAME
;

3574 
sâ
[
i
++] = 
c
;

3575 
sâ
[
i
++] = 
d
;

3579 ià(
	`chk_chr
("\"*+,:;<=>\?[]|\x7F", 
c
))

3581  
FR_INVALID_NAME
;

3583 ià(
	`IsLow”
(
c
))

3585 
c
 -= 0x20;

3587 
sâ
[
i
++] = 
c
;

3590 *
·th
 = 
p
 + 
si
;

3591 ià(
i
 == 0)

3593  
FR_INVALID_NAME
;

3596 ià(
sâ
[0] =ğ
DDEM
)

3598 
sâ
[0] = 
RDDEM
;

3600 
sâ
[
NSFLAG
] = (
c
 <ğ' 'è? 
NS_LAST
 : 0;

3602  
FR_OK
;

3604 
	}
}

3614 
FRESULT
 
	$fŞlow_·th
 (

3615 
DIR
 *
dp
,

3616 cÚ¡ 
TCHAR
 *
·th


3619 
FRESULT
 
»s
;

3620 
BYTE
 
ns
;

3621 
_FDID
 *
obj
 = &
dp
->obj;

3622 
FATFS
 *
fs
 = 
obj
->fs;

3625 #ià
_FS_RPATH
 != 0

3626 ià(*
·th
 != '/' && *path != '\\')

3628 
obj
->
sşu¡
 = 
fs
->
cdœ
;

3634 *
·th
 == '/' || *path == '\\')

3636 
·th
++;

3638 
obj
->
sşu¡
 = 0;

3640 #ià
_FS_EXFAT
 && 
_FS_RPATH
 != 0

3641 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
 && 
obj
->
sşu¡
)

3643 
DIR
 
dj
;

3645 
obj
->
c_sş
 = 
fs
->
cdc_sş
;

3646 
obj
->
c_size
 = 
fs
->
cdc_size
;

3647 
obj
->
c_ofs
 = 
fs
->
cdc_ofs
;

3648 
»s
 = 
	`lßd_obj_dœ
(&
dj
, 
obj
);

3649 ià(
»s
 !ğ
FR_OK
)

3651  
»s
;

3653 
obj
->
objsize
 = 
	`ld_dwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
);

3654 
obj
->
¡©
 = 
fs
->
dœbuf
[
XDIR_G’FÏgs
] & 2;

3658 ià((
UINT
)*
·th
 < ' ')

3660 
dp
->
â
[
NSFLAG
] = 
NS_NONAME
;

3661 
»s
 = 
	`dœ_sdi
(
dp
, 0);

3668 
»s
 = 
	`ü—‹_Çme
(
dp
, &
·th
);

3669 ià(
»s
 !ğ
FR_OK
)

3673 
»s
 = 
	`dœ_fšd
(
dp
);

3674 
ns
 = 
dp
->
â
[
NSFLAG
];

3675 ià(
»s
 !ğ
FR_OK
)

3677 ià(
»s
 =ğ
FR_NO_FILE
)

3679 ià(
_FS_RPATH
 && (
ns
 & 
NS_DOT
))

3681 ià(!(
ns
 & 
NS_LAST
))

3685 
dp
->
â
[
NSFLAG
] = 
NS_NONAME
;

3686 
»s
 = 
FR_OK
;

3690 ià(!(
ns
 & 
NS_LAST
))

3692 
»s
 = 
FR_NO_PATH
;

3698 ià(
ns
 & 
NS_LAST
)

3703 ià(!(
obj
->
©Œ
 & 
AM_DIR
))

3705 
»s
 = 
FR_NO_PATH
;

3708 #ià
_FS_EXFAT


3709 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

3711 
obj
->
c_sş
 = obj->
sşu¡
;

3712 
obj
->
c_size
 = ((
DWORD
)obj->
objsize
 & 0xFFFFFF00è| obj->
¡©
;

3713 
obj
->
c_ofs
 = 
dp
->
blk_ofs
;

3714 
obj
->
sşu¡
 = 
	`ld_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
);

3715 
obj
->
¡©
 = 
fs
->
dœbuf
[
XDIR_G’FÏgs
] & 2;

3716 
obj
->
objsize
 = 
	`ld_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
);

3721 
obj
->
sşu¡
 = 
	`ld_şu¡
(
fs
, fs->
wš
 + 
dp
->
d±r
 % 
	`SS
(fs));

3726  
»s
;

3727 
	}
}

3737 
	$g‘_ldnumb”
 (

3738 cÚ¡ 
TCHAR
 **
·th


3741 cÚ¡ 
TCHAR
 *

, *
‰
;

3742 
UINT
 
i
;

3743 
vŞ
 = -1;

3744 #ià
_STR_VOLUME_ID


3745 cÚ¡ *cÚ¡ 
¡r
[] = {
_VOLUME_STRS
};

3746 cÚ¡ *
¥
;

3747 
c
;

3748 
TCHAR
 
tc
;

3752 ià(*
·th
)

3754 
‰
 = *
·th
; (
UINT
)*‰ >ğ(
_USE_LFN
 ? ' ' : '!') && *tt != ':';t++) ;

3755 ià(*
‰
 == ':')

3757 

 = *
·th
;

3758 
i
 = *

++ - '0';

3759 ià(
i
 < 10 && 

 =ğ
‰
)

3761 ià(
i
 < 
_VOLUMES
)

3763 
vŞ
 = ()
i
;

3764 *
·th
 = ++
‰
;

3767 #ià
_STR_VOLUME_ID


3770 
i
 = 0;

3771 
‰
++;

3774 
¥
 = 
¡r
[
i
];

3775 

 = *
·th
;

3778 
c
 = *
¥
++;

3779 
tc
 = *

++;

3780 ià(
	`IsLow”
(
tc
))

3782 
tc
 -= 0x20;

3785 
c
 && (
TCHAR
)ø=ğ
tc
);

3787 (
c
 || 

 !ğ
‰
è&& ++
i
 < 
_VOLUMES
);

3788 ià(
i
 < 
_VOLUMES
)

3790 
vŞ
 = ()
i
;

3791 *
·th
 = 
‰
;

3795  
vŞ
;

3797 #ià
_FS_RPATH
 !ğ0 && 
_VOLUMES
 >= 2

3798 
vŞ
 = 
Cu¼VŞ
;

3800 
vŞ
 = 0;

3803  
vŞ
;

3804 
	}
}

3814 
BYTE
 
	$check_fs
 (

3815 
FATFS
 *
fs
,

3816 
DWORD
 
£ù


3819 
fs
->
wæag
 = 0;

3820 
fs
->
wš£ù
 = 0xFFFFFFFF;

3821 ià(
	`move_wšdow
(
fs
, 
£ù
è!ğ
FR_OK
)

3826 ià(
	`ld_wÜd
(
fs
->
wš
 + 
BS_55AA
) != 0xAA55)

3831 ià(
fs
->
wš
[
BS_JmpBoÙ
] == 0xE9 || (fs->win[BS_JmpBoot] == 0xEB && fs->win[BS_JmpBoot + 2] == 0x90))

3833 ià((
	`ld_dwÜd
(
fs
->
wš
 + 
BS_FSysTy³
) & 0xFFFFFF) == 0x544146)

3837 ià(
	`ld_dwÜd
(
fs
->
wš
 + 
BS_FSysTy³32
) == 0x33544146)

3842 #ià
_FS_EXFAT


3843 ià(!
	`mem_cmp
(
fs
->
wš
 + 
BS_JmpBoÙ
, "\xEB\x76\x90" "EXFAT ", 11))

3849 
	}
}

3859 
FRESULT
 
	$fšd_vŞume
 (

3860 cÚ¡ 
TCHAR
 **
·th
,

3861 
FATFS
 **
rfs
,

3862 
BYTE
 
mode


3865 
BYTE
 
fmt
, *
±
;

3866 
vŞ
;

3867 
DSTATUS
 
¡©
;

3868 
DWORD
 
b£ù
, 
çsize
, 
t£ù
, 
sy£ù
, 
nş¡
, 
szbçt
, 
br
[4];

3869 
WORD
 
Äsv
;

3870 
FATFS
 *
fs
;

3871 
UINT
 
i
;

3875 *
rfs
 = 0;

3876 
vŞ
 = 
	`g‘_ldnumb”
(
·th
);

3877 ià(
vŞ
 < 0)

3879  
FR_INVALID_DRIVE
;

3883 
fs
 = 
F©Fs
[
vŞ
];

3884 ià(!
fs
)

3886  
FR_NOT_ENABLED
;

3889 
	`ENTER_FF
(
fs
);

3890 *
rfs
 = 
fs
;

3892 
mode
 &ğ(
BYTE
)~
FA_READ
;

3893 ià(
fs
->
fs_ty³
)

3895 
¡©
 = 
	`disk_¡©us
(
fs
->
drv
);

3896 ià(!(
¡©
 & 
STA_NOINIT
))

3898 ià(!
_FS_READONLY
 && 
mode
 && (
¡©
 & 
STA_PROTECT
))

3900  
FR_WRITE_PROTECTED
;

3902  
FR_OK
;

3909 
fs
->
fs_ty³
 = 0;

3910 
fs
->
drv
 = 
	`LD2PD
(
vŞ
);

3911 
¡©
 = 
	`disk_š™Ÿlize
(
fs
->
drv
);

3912 ià(
¡©
 & 
STA_NOINIT
)

3914  
FR_NOT_READY
;

3916 ià(!
_FS_READONLY
 && 
mode
 && (
¡©
 & 
STA_PROTECT
))

3918  
FR_WRITE_PROTECTED
;

3920 #ià
_MAX_SS
 !ğ
_MIN_SS


3921 ià(
	`disk_ioùl
(
fs
->
drv
, 
GET_SECTOR_SIZE
, &
	`SS
(fs)è!ğ
RES_OK
)

3923  
FR_DISK_ERR
;

3925 ià(
	`SS
(
fs
è> 
_MAX_SS
 || SS(fsè< 
_MIN_SS
 || (SS(fs) & (SS(fs) - 1)))

3927  
FR_DISK_ERR
;

3931 
b£ù
 = 0;

3932 
fmt
 = 
	`check_fs
(
fs
, 
b£ù
);

3933 ià(
fmt
 =ğ2 || (fmˆ< 2 && 
	`LD2PT
(
vŞ
) != 0))

3935 
i
 = 0; i < 4; i++)

3937 
±
 = 
fs
->
wš
 + (
MBR_TabË
 + 
i
 * 
SZ_PTE
);

3938 
br
[
i
] = 
±
[
PTE_Sy¡em
] ? 
	`ld_dwÜd
Õˆ+ 
PTE_StLba
) : 0;

3940 
i
 = 
	`LD2PT
(
vŞ
);

3941 ià(
i
)

3943 
i
--;

3947 
b£ù
 = 
br
[
i
];

3948 
fmt
 = 
b£ù
 ? 
	`check_fs
(
fs
, bsect) : 3;

3950 !
	`LD2PT
(
vŞ
è&& 
fmt
 >ğ2 && ++
i
 < 4);

3952 ià(
fmt
 == 4)

3954  
FR_DISK_ERR
;

3956 ià(
fmt
 >= 2)

3958  
FR_NO_FILESYSTEM
;

3963 #ià
_FS_EXFAT


3964 ià(
fmt
 == 1)

3966 
QWORD
 
maxlba
;

3968 
i
 = 
BPB_Z”ÛdEx
; i < BPB_Z”ÛdEx + 53 && 
fs
->
wš
[i] == 0; i++) ;

3969 ià(
i
 < 
BPB_Z”ÛdEx
 + 53)

3971  
FR_NO_FILESYSTEM
;

3974 ià(
	`ld_wÜd
(
fs
->
wš
 + 
BPB_FSV”Ex
) != 0x100)

3976  
FR_NO_FILESYSTEM
;

3979 ià(1 << 
fs
->
wš
[
BPB_BytsP”SecEx
] !ğ
	`SS
(fs))

3981  
FR_NO_FILESYSTEM
;

3984 
maxlba
 = 
	`ld_qwÜd
(
fs
->
wš
 + 
BPB_TÙSecEx
è+ 
b£ù
;

3985 ià(
maxlba
 >= 0x100000000)

3987  
FR_NO_FILESYSTEM
;

3990 
fs
->
fsize
 = 
	`ld_dwÜd
(fs->
wš
 + 
BPB_F©SzEx
);

3992 
fs
->
n_çts
 = fs->
wš
[
BPB_NumFATsEx
];

3993 ià(
fs
->
n_çts
 != 1)

3995  
FR_NO_FILESYSTEM
;

3998 
fs
->
csize
 = 1 << fs->
wš
[
BPB_SecP”ClusEx
];

3999 ià(
fs
->
csize
 == 0)

4001  
FR_NO_FILESYSTEM
;

4004 
nş¡
 = 
	`ld_dwÜd
(
fs
->
wš
 + 
BPB_NumClusEx
);

4005 ià(
nş¡
 > 
MAX_EXFAT
)

4007  
FR_NO_FILESYSTEM
;

4009 
fs
->
n_ç‹Á
 = 
nş¡
 + 2;

4012 
fs
->
vŞba£
 = 
b£ù
;

4013 
fs
->
d©aba£
 = 
b£ù
 + 
	`ld_dwÜd
(fs->
wš
 + 
BPB_D©aOfsEx
);

4014 
fs
->
çtba£
 = 
b£ù
 + 
	`ld_dwÜd
(fs->
wš
 + 
BPB_F©OfsEx
);

4015 ià(
maxlba
 < (
QWORD
)
fs
->
d©aba£
 + 
nş¡
 * fs->
csize
)

4017  
FR_NO_FILESYSTEM
;

4019 
fs
->
dœba£
 = 
	`ld_dwÜd
(fs->
wš
 + 
BPB_RoÙClusEx
);

4022 ià(
	`move_wšdow
(
fs
, 
	`şu¡2£ù
(fs, fs->
dœba£
)è!ğ
FR_OK
)

4024  
FR_DISK_ERR
;

4026 
i
 = 0; i < 
	`SS
(
fs
); i +ğ
SZDIRE
)

4028 ià(
fs
->
wš
[
i
] =ğ0x81 && 
	`ld_dwÜd
(fs->win + i + 20) == 2)

4033 ià(
i
 =ğ
	`SS
(
fs
))

4035  
FR_NO_FILESYSTEM
;

4037 #ià!
_FS_READONLY


4038 
fs
->
Ï¡_ş¡
 = fs->
ä“_ş¡
 = 0xFFFFFFFF;

4040 
fmt
 = 
FS_EXFAT
;

4045 ià(
	`ld_wÜd
(
fs
->
wš
 + 
BPB_BytsP”Sec
è!ğ
	`SS
(fs))

4047  
FR_NO_FILESYSTEM
;

4050 
çsize
 = 
	`ld_wÜd
(
fs
->
wš
 + 
BPB_FATSz16
);

4051 ià(
çsize
 == 0)

4053 
çsize
 = 
	`ld_dwÜd
(
fs
->
wš
 + 
BPB_FATSz32
);

4055 
fs
->
fsize
 = 
çsize
;

4057 
fs
->
n_çts
 = fs->
wš
[
BPB_NumFATs
];

4058 ià(
fs
->
n_çts
 != 1 && fs->n_fats != 2)

4060  
FR_NO_FILESYSTEM
;

4062 
çsize
 *ğ
fs
->
n_çts
;

4064 
fs
->
csize
 = fs->
wš
[
BPB_SecP”Clus
];

4065 ià(
fs
->
csize
 == 0 || (fs->csize & (fs->csize - 1)))

4067  
FR_NO_FILESYSTEM
;

4070 
fs
->
n_roÙdœ
 = 
	`ld_wÜd
(fs->
wš
 + 
BPB_RoÙEÁCÁ
);

4071 ià(
fs
->
n_roÙdœ
 % (
	`SS
(fsè/ 
SZDIRE
))

4073  
FR_NO_FILESYSTEM
;

4076 
t£ù
 = 
	`ld_wÜd
(
fs
->
wš
 + 
BPB_TÙSec16
);

4077 ià(
t£ù
 == 0)

4079 
t£ù
 = 
	`ld_dwÜd
(
fs
->
wš
 + 
BPB_TÙSec32
);

4082 
Äsv
 = 
	`ld_wÜd
(
fs
->
wš
 + 
BPB_RsvdSecCÁ
);

4083 ià(
Äsv
 == 0)

4085  
FR_NO_FILESYSTEM
;

4089 
sy£ù
 = 
Äsv
 + 
çsize
 + 
fs
->
n_roÙdœ
 / (
	`SS
(fsè/ 
SZDIRE
);

4090 ià(
t£ù
 < 
sy£ù
)

4092  
FR_NO_FILESYSTEM
;

4094 
nş¡
 = (
t£ù
 - 
sy£ù
è/ 
fs
->
csize
;

4095 ià(
nş¡
 == 0)

4097  
FR_NO_FILESYSTEM
;

4099 
fmt
 = 
FS_FAT32
;

4100 ià(
nş¡
 <ğ
MAX_FAT16
)

4102 
fmt
 = 
FS_FAT16
;

4104 ià(
nş¡
 <ğ
MAX_FAT12
)

4106 
fmt
 = 
FS_FAT12
;

4110 
fs
->
n_ç‹Á
 = 
nş¡
 + 2;

4111 
fs
->
vŞba£
 = 
b£ù
;

4112 
fs
->
çtba£
 = 
b£ù
 + 
Äsv
;

4113 
fs
->
d©aba£
 = 
b£ù
 + 
sy£ù
;

4114 ià(
fmt
 =ğ
FS_FAT32
)

4116 ià(
	`ld_wÜd
(
fs
->
wš
 + 
BPB_FSV”32
) != 0)

4118  
FR_NO_FILESYSTEM
;

4120 ià(
fs
->
n_roÙdœ
)

4122  
FR_NO_FILESYSTEM
;

4124 
fs
->
dœba£
 = 
	`ld_dwÜd
(fs->
wš
 + 
BPB_RoÙClus32
);

4125 
szbçt
 = 
fs
->
n_ç‹Á
 * 4;

4129 ià(
fs
->
n_roÙdœ
 == 0)

4131  
FR_NO_FILESYSTEM
;

4133 
fs
->
dœba£
 = fs->
çtba£
 + 
çsize
;

4134 
szbçt
 = (
fmt
 =ğ
FS_FAT16
) ?

4135 
fs
->
n_ç‹Á
 * 2 : fs->n_fatent * 3 / 2 + (fs->n_fatent & 1);

4137 ià(
fs
->
fsize
 < (
szbçt
 + (
	`SS
(fs) - 1)) / SS(fs))

4139  
FR_NO_FILESYSTEM
;

4142 #ià!
_FS_READONLY


4144 
fs
->
Ï¡_ş¡
 = fs->
ä“_ş¡
 = 0xFFFFFFFF;

4145 
fs
->
fsi_æag
 = 0x80;

4146 #ià(
_FS_NOFSINFO
 & 3) != 3

4147 ià(
fmt
 =ğ
FS_FAT32


4148 && 
	`ld_wÜd
(
fs
->
wš
 + 
BPB_FSInfo32
) == 1

4149 && 
	`move_wšdow
(
fs
, 
b£ù
 + 1è=ğ
FR_OK
)

4151 
fs
->
fsi_æag
 = 0;

4152 ià(
	`ld_wÜd
(
fs
->
wš
 + 
BS_55AA
) == 0xAA55

4153 && 
	`ld_dwÜd
(
fs
->
wš
 + 
FSI_L—dSig
) == 0x41615252

4154 && 
	`ld_dwÜd
(
fs
->
wš
 + 
FSI_SŒucSig
) == 0x61417272)

4156 #ià(
_FS_NOFSINFO
 & 1) == 0

4157 
fs
->
ä“_ş¡
 = 
	`ld_dwÜd
(fs->
wš
 + 
FSI_F»e_CouÁ
);

4159 #ià(
_FS_NOFSINFO
 & 2) == 0

4160 
fs
->
Ï¡_ş¡
 = 
	`ld_dwÜd
(fs->
wš
 + 
FSI_Nxt_F»e
);

4168 
fs
->
fs_ty³
 = 
fmt
;

4169 
fs
->
id
 = ++
Fsid
;

4170 #ià
_USE_LFN
 == 1

4171 
fs
->
lâbuf
 = 
LâBuf
;

4172 #ià
_FS_EXFAT


4173 
fs
->
dœbuf
 = 
DœBuf
;

4176 #ià
_FS_RPATH
 != 0

4177 
fs
->
cdœ
 = 0;

4179 #ià
_FS_LOCK
 != 0

4180 
	`ş—r_lock
(
fs
);

4182  
FR_OK
;

4183 
	}
}

4193 
FRESULT
 
	$v®id©e
 (

4194 
_FDID
 *
obj
,

4195 
FATFS
 **
fs


4198 
FRESULT
 
»s
;

4201 ià(!
obj
 || !obj->
fs
 || !obj->fs->
fs_ty³
 || obj->fs->
id
 !ğobj->id || (
	`disk_¡©us
(obj->fs->
drv
è& 
STA_NOINIT
))

4203 *
fs
 = 0;

4204 
»s
 = 
FR_INVALID_OBJECT
;

4208 *
fs
 = 
obj
->fs;

4209 
	`ENTER_FF
(
obj
->
fs
);

4210 
»s
 = 
FR_OK
;

4212  
»s
;

4213 
	}
}

4230 
FRESULT
 
	$f_mouÁ
 (

4231 
FATFS
 *
fs
,

4232 cÚ¡ 
TCHAR
 *
·th
,

4233 
BYTE
 
İt


4236 
FATFS
 *
cfs
;

4237 
vŞ
;

4238 
FRESULT
 
»s
;

4239 cÚ¡ 
TCHAR
 *
½
 = 
·th
;

4243 
vŞ
 = 
	`g‘_ldnumb”
(&
½
);

4244 ià(
vŞ
 < 0)

4246  
FR_INVALID_DRIVE
;

4248 
cfs
 = 
F©Fs
[
vŞ
];

4250 ià(
cfs
)

4252 #ià
_FS_LOCK
 != 0

4253 
	`ş—r_lock
(
cfs
);

4255 #ià
_FS_REENTRANT


4256 ià(!
	`ff_d–_syncobj
(
cfs
->
sobj
))

4258  
FR_INT_ERR
;

4261 
cfs
->
fs_ty³
 = 0;

4264 ià(
fs
)

4266 
fs
->
fs_ty³
 = 0;

4267 #ià
_FS_REENTRANT


4268 ià(!
	`ff_üe_syncobj
((
BYTE
)
vŞ
, &
fs
->
sobj
))

4270  
FR_INT_ERR
;

4274 
F©Fs
[
vŞ
] = 
fs
;

4276 ià(!
fs
 || 
İt
 != 1)

4278  
FR_OK
;

4281 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 0);

4282 
	`LEAVE_FF
(
fs
, 
»s
);

4283 
	}
}

4292 
FRESULT
 
	$f_İ’
 (

4293 
FIL
 *
å
,

4294 cÚ¡ 
TCHAR
 *
·th
,

4295 
BYTE
 
mode


4298 
FRESULT
 
»s
;

4299 
DIR
 
dj
;

4300 
FATFS
 *
fs
;

4301 #ià!
_FS_READONLY


4302 
DWORD
 
dw
, 
ş
, 
bcs
, 
ş¡
, 
sc
;

4303 
FSIZE_t
 
ofs
;

4305 
DEF_NAMBUF


4308 ià(!
å
)

4310  
FR_INVALID_OBJECT
;

4314 
mode
 &ğ
_FS_READONLY
 ? 
FA_READ
 : FA_READ | 
FA_WRITE
 | 
FA_CREATE_ALWAYS
 | 
FA_CREATE_NEW
 | 
FA_OPEN_ALWAYS
 | 
FA_OPEN_APPEND
 | 
FA_SEEKEND
;

4315 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 
mode
);

4316 ià(
»s
 =ğ
FR_OK
)

4318 
dj
.
obj
.
fs
 = fs;

4319 
	`INIT_NAMBUF
(
fs
);

4320 
»s
 = 
	`fŞlow_·th
(&
dj
, 
·th
);

4321 #ià!
_FS_READONLY


4322 ià(
»s
 =ğ
FR_OK
)

4324 ià(
dj
.
â
[
NSFLAG
] & 
NS_NONAME
)

4326 
»s
 = 
FR_INVALID_NAME
;

4328 #ià
_FS_LOCK
 != 0

4331 
»s
 = 
	`chk_lock
(&
dj
, (
mode
 & ~
FA_READ
) ? 1 : 0);

4336 ià(
mode
 & (
FA_CREATE_ALWAYS
 | 
FA_OPEN_ALWAYS
 | 
FA_CREATE_NEW
))

4338 ià(
»s
 !ğ
FR_OK
)

4340 ià(
»s
 =ğ
FR_NO_FILE
)

4341 #ià
_FS_LOCK
 != 0

4342 
»s
 = 
	`’q_lock
(è? 
	`dœ_»gi¡”
(&
dj
è: 
FR_TOO_MANY_OPEN_FILES
;

4344 
»s
 = 
	`dœ_»gi¡”
(&
dj
);

4346 
mode
 |ğ
FA_CREATE_ALWAYS
;

4350 ià(
dj
.
obj
.
©Œ
 & (
AM_RDO
 | 
AM_DIR
))

4352 
»s
 = 
FR_DENIED
;

4356 ià(
mode
 & 
FA_CREATE_NEW
)

4358 
»s
 = 
FR_EXIST
;

4362 ià(
»s
 =ğ
FR_OK
 && (
mode
 & 
FA_CREATE_ALWAYS
))

4364 
dw
 = 
	`GET_FATTIME
();

4365 #ià
_FS_EXFAT


4366 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

4369 
å
->
obj
.
fs
 = fs;

4370 
å
->
obj
.
sşu¡
 = 
	`ld_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
);

4371 
å
->
obj
.
objsize
 = 
	`ld_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
);

4372 
å
->
obj
.
¡©
 = 
fs
->
dœbuf
[
XDIR_G’FÏgs
] & 2;

4374 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_C¹Time
, 
dw
);

4375 
fs
->
dœbuf
[
XDIR_C¹Time10
] = 0;

4376 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_ModTime
, 
dw
);

4377 
fs
->
dœbuf
[
XDIR_ModTime10
] = 0;

4378 
fs
->
dœbuf
[
XDIR_A‰r
] = 
AM_ARC
;

4379 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
, 0);

4380 
	`¡_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
, 0);

4381 
	`¡_qwÜd
(
fs
->
dœbuf
 + 
XDIR_V®idFeSize
, 0);

4382 
fs
->
dœbuf
[
XDIR_G’FÏgs
] = 1;

4383 
»s
 = 
	`¡Üe_xdœ
(&
dj
);

4384 ià(
»s
 =ğ
FR_OK
 && 
å
->
obj
.
sşu¡
)

4386 
»s
 = 
	`»move_chaš
(&
å
->
obj
, fp->obj.
sşu¡
, 0);

4387 
fs
->
Ï¡_ş¡
 = 
å
->
obj
.
sşu¡
 - 1;

4394 
	`¡_dwÜd
(
dj
.
dœ
 + 
DIR_C¹Time
, 
dw
);

4395 
	`¡_dwÜd
(
dj
.
dœ
 + 
DIR_ModTime
, 
dw
);

4396 
dj
.
dœ
[
DIR_A‰r
] = 
AM_ARC
;

4397 
ş
 = 
	`ld_şu¡
(
fs
, 
dj
.
dœ
);

4398 
	`¡_şu¡
(
fs
, 
dj
.
dœ
, 0);

4399 
	`¡_dwÜd
(
dj
.
dœ
 + 
DIR_FeSize
, 0);

4400 
fs
->
wæag
 = 1;

4402 ià(
ş
)

4404 
dw
 = 
fs
->
wš£ù
;

4405 
»s
 = 
	`»move_chaš
(&
dj
.
obj
, 
ş
, 0);

4406 ià(
»s
 =ğ
FR_OK
)

4408 
»s
 = 
	`move_wšdow
(
fs
, 
dw
);

4409 
fs
->
Ï¡_ş¡
 = 
ş
 - 1;

4417 ià(
»s
 =ğ
FR_OK
)

4419 ià(
dj
.
obj
.
©Œ
 & 
AM_DIR
)

4421 
»s
 = 
FR_NO_FILE
;

4425 ià((
mode
 & 
FA_WRITE
è&& (
dj
.
obj
.
©Œ
 & 
AM_RDO
))

4427 
»s
 = 
FR_DENIED
;

4432 ià(
»s
 =ğ
FR_OK
)

4434 ià(
mode
 & 
FA_CREATE_ALWAYS
)

4436 
mode
 |ğ
FA_MODIFIED
;

4438 
å
->
dœ_£ù
 = 
fs
->
wš£ù
;

4439 
å
->
dœ_±r
 = 
dj
.
dœ
;

4440 #ià
_FS_LOCK
 != 0

4441 
å
->
obj
.
lockid
 = 
	`šc_lock
(&
dj
, (
mode
 & ~
FA_READ
) ? 1 : 0);

4442 ià(!
å
->
obj
.
lockid
)

4444 
»s
 = 
FR_INT_ERR
;

4449 ià(
»s
 =ğ
FR_OK
)

4451 ià(
dj
.
â
[
NSFLAG
] & 
NS_NONAME
)

4453 
»s
 = 
FR_INVALID_NAME
;

4457 ià(
dj
.
obj
.
©Œ
 & 
AM_DIR
)

4459 
»s
 = 
FR_NO_FILE
;

4465 ià(
»s
 =ğ
FR_OK
)

4467 #ià
_FS_EXFAT


4468 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

4470 
å
->
obj
.
sşu¡
 = 
	`ld_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
);

4471 
å
->
obj
.
objsize
 = 
	`ld_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
);

4472 
å
->
obj
.
¡©
 = 
fs
->
dœbuf
[
XDIR_G’FÏgs
] & 2;

4473 
å
->
obj
.
c_sş
 = 
dj
.obj.
sşu¡
;

4474 
å
->
obj
.
c_size
 = ((
DWORD
)
dj
.obj.
objsize
 & 0xFFFFFF00è| dj.obj.
¡©
;

4475 
å
->
obj
.
c_ofs
 = 
dj
.
blk_ofs
;

4480 
å
->
obj
.
sşu¡
 = 
	`ld_şu¡
(
fs
, 
dj
.
dœ
);

4481 
å
->
obj
.
objsize
 = 
	`ld_dwÜd
(
dj
.
dœ
 + 
DIR_FeSize
);

4483 #ià
_USE_FASTSEEK


4484 
å
->
ştbl
 = 0;

4486 
å
->
obj
.
fs
 = fs;

4487 
å
->
obj
.
id
 = 
fs
->id;

4488 
å
->
æag
 = 
mode
;

4489 
å
->
”r
 = 0;

4490 
å
->
£ù
 = 0;

4491 
å
->
åŒ
 = 0;

4492 #ià!
_FS_READONLY


4493 #ià!
_FS_TINY


4494 
	`mem_£t
(
å
->
buf
, 0, 
_MAX_SS
);

4496 ià((
mode
 & 
FA_SEEKEND
è&& 
å
->
obj
.
objsize
 > 0)

4498 
å
->
åŒ
 = fp->
obj
.
objsize
;

4499 
bcs
 = (
DWORD
)
fs
->
csize
 * 
	`SS
(fs);

4500 
ş¡
 = 
å
->
obj
.
sşu¡
;

4501 
ofs
 = 
å
->
obj
.
objsize
; 
»s
 =ğ
FR_OK
 && of > 
bcs
; ofs -= bcs)

4503 
ş¡
 = 
	`g‘_çt
(&
å
->
obj
, clst);

4504 ià(
ş¡
 <= 1)

4506 
»s
 = 
FR_INT_ERR
;

4508 ià(
ş¡
 == 0xFFFFFFFF)

4510 
»s
 = 
FR_DISK_ERR
;

4513 
å
->
şu¡
 = 
ş¡
;

4514 ià(
»s
 =ğ
FR_OK
 && 
ofs
 % 
	`SS
(
fs
))

4516 ià((
sc
 = 
	`şu¡2£ù
(
fs
, 
ş¡
)) == 0)

4518 
»s
 = 
FR_INT_ERR
;

4522 
å
->
£ù
 = 
sc
 + (
DWORD
)(
ofs
 / 
	`SS
(
fs
));

4523 #ià!
_FS_TINY


4524 ià(
	`disk_»ad
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

4526 
»s
 = 
FR_DISK_ERR
;

4535 
	`FREE_NAMBUF
();

4538 ià(
»s
 !ğ
FR_OK
)

4540 
å
->
obj
.
fs
 = 0;

4543 
	`LEAVE_FF
(
fs
, 
»s
);

4544 
	}
}

4553 
FRESULT
 
	$f_»ad
 (

4554 
FIL
 *
å
,

4555 *
buff
,

4556 
UINT
 
bŒ
,

4557 
UINT
 *
br


4560 
FRESULT
 
»s
;

4561 
FATFS
 *
fs
;

4562 
DWORD
 
ş¡
, 
£ù
;

4563 
FSIZE_t
 
»maš
;

4564 
UINT
 
rút
, 
cc
, 
c£ù
;

4565 
BYTE
 *
rbuff
 = (BYTE *)
buff
;

4568 *
br
 = 0;

4569 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

4570 ià(
»s
 !ğ
FR_OK
 || (» ğ(
FRESULT
)
å
->
”r
) != FR_OK)

4572 
	`LEAVE_FF
(
fs
, 
»s
);

4574 ià(!(
å
->
æag
 & 
FA_READ
))

4576 
	`LEAVE_FF
(
fs
, 
FR_DENIED
);

4578 
»maš
 = 
å
->
obj
.
objsize
 - fp->
åŒ
;

4579 ià(
bŒ
 > 
»maš
)

4581 
bŒ
 = (
UINT
)
»maš
;

4584  ; 
bŒ
;

4585 
rbuff
 +ğ
rút
, 
å
->
åŒ
 +ğrút, *
br
 +ğrút, 
bŒ
 -=„cnt)

4587 ià(
å
->
åŒ
 % 
	`SS
(
fs
) == 0)

4589 
c£ù
 = (
UINT
)(
å
->
åŒ
 / 
	`SS
(
fs
è& (fs->
csize
 - 1));

4590 ià(
c£ù
 == 0)

4592 ià(
å
->
åŒ
 == 0)

4594 
ş¡
 = 
å
->
obj
.
sşu¡
;

4598 #ià
_USE_FASTSEEK


4599 ià(
å
->
ştbl
)

4601 
ş¡
 = 
	`şmt_şu¡
(
å
, fp->
åŒ
);

4606 
ş¡
 = 
	`g‘_çt
(&
å
->
obj
, fp->
şu¡
);

4609 ià(
ş¡
 < 2)

4611 
	`ABORT
(
fs
, 
FR_INT_ERR
);

4613 ià(
ş¡
 == 0xFFFFFFFF)

4615 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4617 
å
->
şu¡
 = 
ş¡
;

4619 
£ù
 = 
	`şu¡2£ù
(
fs
, 
å
->
şu¡
);

4620 ià(!
£ù
)

4622 
	`ABORT
(
fs
, 
FR_INT_ERR
);

4624 
£ù
 +ğ
c£ù
;

4625 
cc
 = 
bŒ
 / 
	`SS
(
fs
);

4626 ià(
cc
)

4628 ià(
c£ù
 + 
cc
 > 
fs
->
csize
)

4630 
cc
 = 
fs
->
csize
 - 
c£ù
;

4632 ià(
	`disk_»ad
(
fs
->
drv
, 
rbuff
, 
£ù
, 
cc
è!ğ
RES_OK
)

4634 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4636 #ià!
_FS_READONLY
 && 
_FS_MINIMIZE
 <= 2

4637 #ià
_FS_TINY


4638 ià(
fs
->
wæag
 && fs->
wš£ù
 - 
£ù
 < 
cc
)

4640 
	`mem_ıy
(
rbuff
 + ((
fs
->
wš£ù
 - 
£ù
è* 
	`SS
(fs)), fs->
wš
, SS(fs));

4643 ià((
å
->
æag
 & 
FA_DIRTY
è&& fp->
£ù
 - seù < 
cc
)

4645 
	`mem_ıy
(
rbuff
 + ((
å
->
£ù
 - seùè* 
	`SS
(
fs
)), fp->
buf
, SS(fs));

4649 
rút
 = 
	`SS
(
fs
è* 
cc
;

4652 #ià!
_FS_TINY


4653 ià(
å
->
£ù
 != sect)

4655 #ià!
_FS_READONLY


4656 ià(
å
->
æag
 & 
FA_DIRTY
)

4658 ià(
	`disk_wr™e
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

4660 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4662 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

4665 ià(
	`disk_»ad
(
fs
->
drv
, 
å
->
buf
, 
£ù
, 1è!ğ
RES_OK
)

4667 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4671 
å
->
£ù
 = sect;

4673 
rút
 = 
	`SS
(
fs
è- (
UINT
)
å
->
åŒ
 % SS(fs);

4674 ià(
rút
 > 
bŒ
)

4676 
rút
 = 
bŒ
;

4678 #ià
_FS_TINY


4679 ià(
	`move_wšdow
(
fs
, 
å
->
£ù
è!ğ
FR_OK
)

4681 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4683 
	`mem_ıy
(
rbuff
, 
fs
->
wš
 + 
å
->
åŒ
 % 
	`SS
(fs), 
rút
);

4685 
	`mem_ıy
(
rbuff
, 
å
->
buf
 + fp->
åŒ
 % 
	`SS
(
fs
), 
rút
);

4689 
	`LEAVE_FF
(
fs
, 
FR_OK
);

4690 
	}
}

4695 #ià!
_FS_READONLY


4700 
FRESULT
 
	$f_wr™e
 (

4701 
FIL
 *
å
,

4702 cÚ¡ *
buff
,

4703 
UINT
 
btw
,

4704 
UINT
 *
bw


4707 
FRESULT
 
»s
;

4708 
FATFS
 *
fs
;

4709 
DWORD
 
ş¡
, 
£ù
;

4710 
UINT
 
wút
, 
cc
, 
c£ù
;

4711 cÚ¡ 
BYTE
 *
wbuff
 = (cÚ¡ BYTE *)
buff
;

4714 *
bw
 = 0;

4715 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

4716 ià(
»s
 !ğ
FR_OK
 || (» ğ(
FRESULT
)
å
->
”r
) != FR_OK)

4718 
	`LEAVE_FF
(
fs
, 
»s
);

4720 ià(!(
å
->
æag
 & 
FA_WRITE
))

4722 
	`LEAVE_FF
(
fs
, 
FR_DENIED
);

4726 ià((!
_FS_EXFAT
 || 
fs
->
fs_ty³
 !ğ
FS_EXFAT
è&& (
DWORD
)(
å
->
åŒ
 + 
btw
) < (DWORD)fp->fptr)

4728 
btw
 = (
UINT
)(0xFFFFFFFF - (
DWORD
)
å
->
åŒ
);

4731  ; 
btw
;

4732 
wbuff
 +ğ
wút
, 
å
->
åŒ
 +ğwút, fp->
obj
.
objsize
 = (å->åŒ > fp->obj.objsizeè? fp->åŒ : fp->obj.objsize, *
bw
 +ğwút, 
btw
 -= wcnt)

4734 ià(
å
->
åŒ
 % 
	`SS
(
fs
) == 0)

4736 
c£ù
 = (
UINT
)(
å
->
åŒ
 / 
	`SS
(
fs
)è& (fs->
csize
 - 1);

4737 ià(
c£ù
 == 0)

4739 ià(
å
->
åŒ
 == 0)

4741 
ş¡
 = 
å
->
obj
.
sşu¡
;

4742 ià(
ş¡
 == 0)

4744 
ş¡
 = 
	`ü—‹_chaš
(&
å
->
obj
, 0);

4749 #ià
_USE_FASTSEEK


4750 ià(
å
->
ştbl
)

4752 
ş¡
 = 
	`şmt_şu¡
(
å
, fp->
åŒ
);

4757 
ş¡
 = 
	`ü—‹_chaš
(&
å
->
obj
, fp->
şu¡
);

4760 ià(
ş¡
 == 0)

4764 ià(
ş¡
 == 1)

4766 
	`ABORT
(
fs
, 
FR_INT_ERR
);

4768 ià(
ş¡
 == 0xFFFFFFFF)

4770 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4772 
å
->
şu¡
 = 
ş¡
;

4773 ià(
å
->
obj
.
sşu¡
 == 0)

4775 
å
->
obj
.
sşu¡
 = 
ş¡
;

4778 #ià
_FS_TINY


4779 ià(
fs
->
wš£ù
 =ğ
å
->
£ù
 && 
	`sync_wšdow
(fsè!ğ
FR_OK
)

4781 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4784 ià(
å
->
æag
 & 
FA_DIRTY
)

4786 ià(
	`disk_wr™e
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

4788 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4790 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

4793 
£ù
 = 
	`şu¡2£ù
(
fs
, 
å
->
şu¡
);

4794 ià(!
£ù
)

4796 
	`ABORT
(
fs
, 
FR_INT_ERR
);

4798 
£ù
 +ğ
c£ù
;

4799 
cc
 = 
btw
 / 
	`SS
(
fs
);

4800 ià(
cc
)

4802 ià(
c£ù
 + 
cc
 > 
fs
->
csize
)

4804 
cc
 = 
fs
->
csize
 - 
c£ù
;

4806 ià(
	`disk_wr™e
(
fs
->
drv
, 
wbuff
, 
£ù
, 
cc
è!ğ
RES_OK
)

4808 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4810 #ià
_FS_MINIMIZE
 <= 2

4811 #ià
_FS_TINY


4812 ià(
fs
->
wš£ù
 - 
£ù
 < 
cc
)

4814 
	`mem_ıy
(
fs
->
wš
, 
wbuff
 + ((fs->
wš£ù
 - 
£ù
è* 
	`SS
(fs)), SS(fs));

4815 
fs
->
wæag
 = 0;

4818 ià(
å
->
£ù
 - seù < 
cc
)

4820 
	`mem_ıy
(
å
->
buf
, 
wbuff
 + ((å->
£ù
 - seùè* 
	`SS
(
fs
)), SS(fs));

4821 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

4825 
wút
 = 
	`SS
(
fs
è* 
cc
;

4828 #ià
_FS_TINY


4829 ià(
å
->
åŒ
 >ğå->
obj
.
objsize
)

4831 ià(
	`sync_wšdow
(
fs
è!ğ
FR_OK
)

4833 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4835 
fs
->
wš£ù
 = 
£ù
;

4838 ià(
å
->
£ù
 != sect &&

4839 
å
->
åŒ
 < fp->
obj
.
objsize
 &&

4840 
	`disk_»ad
(
fs
->
drv
, 
å
->
buf
, 
£ù
, 1è!ğ
RES_OK
)

4842 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4845 
å
->
£ù
 = sect;

4847 
wút
 = 
	`SS
(
fs
è- (
UINT
)
å
->
åŒ
 % SS(fs);

4848 ià(
wút
 > 
btw
)

4850 
wút
 = 
btw
;

4852 #ià
_FS_TINY


4853 ià(
	`move_wšdow
(
fs
, 
å
->
£ù
è!ğ
FR_OK
)

4855 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

4857 
	`mem_ıy
(
fs
->
wš
 + 
å
->
åŒ
 % 
	`SS
(fs), 
wbuff
, 
wút
);

4858 
fs
->
wæag
 = 1;

4860 
	`mem_ıy
(
å
->
buf
 + fp->
åŒ
 % 
	`SS
(
fs
), 
wbuff
, 
wút
);

4861 
å
->
æag
 |ğ
FA_DIRTY
;

4865 
å
->
æag
 |ğ
FA_MODIFIED
;

4867 
	`LEAVE_FF
(
fs
, 
FR_OK
);

4868 
	}
}

4877 
FRESULT
 
	$f_sync
 (

4878 
FIL
 *
å


4881 
FRESULT
 
»s
;

4882 
FATFS
 *
fs
;

4883 
DWORD
 
tm
;

4884 
BYTE
 *
dœ
;

4885 
DEF_NAMBUF


4888 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

4889 ià(
»s
 =ğ
FR_OK
)

4891 ià(
å
->
æag
 & 
FA_MODIFIED
)

4893 #ià!
_FS_TINY


4894 ià(
å
->
æag
 & 
FA_DIRTY
)

4896 ià(
	`disk_wr™e
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

4898 
	`LEAVE_FF
(
fs
, 
FR_DISK_ERR
);

4900 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

4904 
tm
 = 
	`GET_FATTIME
();

4905 #ià
_FS_EXFAT


4906 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

4908 
»s
 = 
	`fl_çt_chaš
(&
å
->
obj
);

4909 ià(
»s
 =ğ
FR_OK
)

4911 
DIR
 
dj
;

4913 
	`INIT_NAMBUF
(
fs
);

4914 
»s
 = 
	`lßd_obj_dœ
(&
dj
, &
å
->
obj
);

4915 ià(
»s
 =ğ
FR_OK
)

4917 
fs
->
dœbuf
[
XDIR_A‰r
] |ğ
AM_ARC
;

4918 
fs
->
dœbuf
[
XDIR_G’FÏgs
] = 
å
->
obj
.
¡©
 | 1;

4919 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
, 
å
->
obj
.
sşu¡
);

4920 
	`¡_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
, 
å
->
obj
.
objsize
);

4921 
	`¡_qwÜd
(
fs
->
dœbuf
 + 
XDIR_V®idFeSize
, 
å
->
obj
.
objsize
);

4922 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_ModTime
, 
tm
);

4923 
fs
->
dœbuf
[
XDIR_ModTime10
] = 0;

4924 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_AccTime
, 0);

4925 
»s
 = 
	`¡Üe_xdœ
(&
dj
);

4926 ià(
»s
 =ğ
FR_OK
)

4928 
»s
 = 
	`sync_fs
(
fs
);

4929 
å
->
æag
 &ğ(
BYTE
)~
FA_MODIFIED
;

4932 
	`FREE_NAMBUF
();

4938 
»s
 = 
	`move_wšdow
(
fs
, 
å
->
dœ_£ù
);

4939 ià(
»s
 =ğ
FR_OK
)

4941 
dœ
 = 
å
->
dœ_±r
;

4942 
dœ
[
DIR_A‰r
] |ğ
AM_ARC
;

4943 
	`¡_şu¡
(
å
->
obj
.
fs
, 
dœ
, fp->obj.
sşu¡
);

4944 
	`¡_dwÜd
(
dœ
 + 
DIR_FeSize
, (
DWORD
)
å
->
obj
.
objsize
);

4945 
	`¡_dwÜd
(
dœ
 + 
DIR_ModTime
, 
tm
);

4946 
	`¡_wÜd
(
dœ
 + 
DIR_L¡AccD©e
, 0);

4947 
fs
->
wæag
 = 1;

4948 
»s
 = 
	`sync_fs
(
fs
);

4949 
å
->
æag
 &ğ(
BYTE
)~
FA_MODIFIED
;

4955 
	`LEAVE_FF
(
fs
, 
»s
);

4956 
	}
}

4967 
FRESULT
 
	$f_şo£
 (

4968 
FIL
 *
å


4971 
FRESULT
 
»s
;

4972 
FATFS
 *
fs
;

4974 #ià!
_FS_READONLY


4975 
»s
 = 
	`f_sync
(
å
);

4976 ià(
»s
 =ğ
FR_OK
)

4979 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

4980 ià(
»s
 =ğ
FR_OK
)

4982 #ià
_FS_LOCK
 != 0

4983 
»s
 = 
	`dec_lock
(
å
->
obj
.
lockid
);

4984 ià(
»s
 =ğ
FR_OK
)

4987 
å
->
obj
.
fs
 = 0;

4989 #ià
_FS_REENTRANT


4990 
	`uÆock_fs
(
fs
, 
FR_OK
);

4994  
»s
;

4995 
	}
}

5000 #ià
_FS_RPATH
 >= 1

5005 #ià
_VOLUMES
 >= 2

5006 
FRESULT
 
	$f_chdrive
 (

5007 cÚ¡ 
TCHAR
 *
·th


5010 
vŞ
;

5014 
vŞ
 = 
	`g‘_ldnumb”
(&
·th
);

5015 ià(
vŞ
 < 0)

5017  
FR_INVALID_DRIVE
;

5020 
Cu¼VŞ
 = (
BYTE
)
vŞ
;

5022  
FR_OK
;

5023 
	}
}

5027 
FRESULT
 
	$f_chdœ
 (

5028 cÚ¡ 
TCHAR
 *
·th


5031 
FRESULT
 
»s
;

5032 
DIR
 
dj
;

5033 
FATFS
 *
fs
;

5034 
DEF_NAMBUF


5037 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 0);

5038 ià(
»s
 =ğ
FR_OK
)

5040 
dj
.
obj
.
fs
 = fs;

5041 
	`INIT_NAMBUF
(
fs
);

5042 
»s
 = 
	`fŞlow_·th
(&
dj
, 
·th
);

5043 ià(
»s
 =ğ
FR_OK
)

5045 ià(
dj
.
â
[
NSFLAG
] & 
NS_NONAME
)

5047 
fs
->
cdœ
 = 
dj
.
obj
.
sşu¡
;

5048 #ià
_FS_EXFAT


5049 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

5051 
fs
->
cdc_sş
 = 
dj
.
obj
.
c_sş
;

5052 
fs
->
cdc_size
 = 
dj
.
obj
.
c_size
;

5053 
fs
->
cdc_ofs
 = 
dj
.
obj
.
c_ofs
;

5059 ià(
dj
.
obj
.
©Œ
 & 
AM_DIR
)

5061 #ià
_FS_EXFAT


5062 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

5064 
fs
->
cdœ
 = 
	`ld_dwÜd
(fs->
dœbuf
 + 
XDIR_F¡Clus
);

5065 
fs
->
cdc_sş
 = 
dj
.
obj
.
sşu¡
;

5066 
fs
->
cdc_size
 = ((
DWORD
)
dj
.
obj
.
objsize
 & 0xFFFFFF00è| dj.obj.
¡©
;

5067 
fs
->
cdc_ofs
 = 
dj
.
blk_ofs
;

5072 
fs
->
cdœ
 = 
	`ld_şu¡
(fs, 
dj
.
dœ
);

5077 
»s
 = 
FR_NO_PATH
;

5081 
	`FREE_NAMBUF
();

5082 ià(
»s
 =ğ
FR_NO_FILE
)

5084 
»s
 = 
FR_NO_PATH
;

5088 
	`LEAVE_FF
(
fs
, 
»s
);

5089 
	}
}

5092 #ià
_FS_RPATH
 >= 2

5093 
FRESULT
 
	$f_g‘cwd
 (

5094 
TCHAR
 *
buff
,

5095 
UINT
 
Ën


5098 
FRESULT
 
»s
;

5099 
DIR
 
dj
;

5100 
FATFS
 *
fs
;

5101 
UINT
 
i
, 
n
;

5102 
DWORD
 
cş
;

5103 
TCHAR
 *

;

5104 
FILINFO
 
âo
;

5105 
DEF_NAMBUF


5108 *
buff
 = 0;

5110 
»s
 = 
	`fšd_vŞume
((cÚ¡ 
TCHAR
 **)&
buff
, &
fs
, 0);

5111 ià(
»s
 =ğ
FR_OK
)

5113 
dj
.
obj
.
fs
 = fs;

5114 
	`INIT_NAMBUF
(
fs
);

5115 
i
 = 
Ën
;

5116 ià(!
_FS_EXFAT
 || 
fs
->
fs_ty³
 !ğ
FS_EXFAT
)

5118 
dj
.
obj
.
sşu¡
 = 
fs
->
cdœ
;

5119 (
cş
 = 
dj
.
obj
.
sşu¡
) != 0)

5121 
»s
 = 
	`dœ_sdi
(&
dj
, 1 * 
SZDIRE
);

5122 ià(
»s
 !ğ
FR_OK
)

5126 
»s
 = 
	`move_wšdow
(
fs
, 
dj
.
£ù
);

5127 ià(
»s
 !ğ
FR_OK
)

5131 
dj
.
obj
.
sşu¡
 = 
	`ld_şu¡
(
fs
, dj.
dœ
);

5132 
»s
 = 
	`dœ_sdi
(&
dj
, 0);

5133 ià(
»s
 !ğ
FR_OK
)

5139 
»s
 = 
	`dœ_»ad
(&
dj
, 0);

5140 ià(
»s
 !ğ
FR_OK
)

5144 ià(
cş
 =ğ
	`ld_şu¡
(
fs
, 
dj
.
dœ
))

5148 
»s
 = 
	`dœ_Ãxt
(&
dj
, 0);

5150 
»s
 =ğ
FR_OK
);

5151 ià(
»s
 =ğ
FR_NO_FILE
)

5153 
»s
 = 
FR_INT_ERR
;

5155 ià(
»s
 !ğ
FR_OK
)

5159 
	`g‘_fešfo
(&
dj
, &
âo
);

5160 
n
 = 0; 
âo
.
âame
[n];‚++) ;

5161 ià(
i
 < 
n
 + 3)

5163 
»s
 = 
FR_NOT_ENOUGH_CORE
;

5166 
n
)

5168 
buff
[--
i
] = 
âo
.
âame
[--
n
];

5170 
buff
[--
i
] = '/';

5173 

 = 
buff
;

5174 ià(
»s
 =ğ
FR_OK
)

5176 #ià
_VOLUMES
 >= 2

5177 *

++ = '0' + 
Cu¼VŞ
;

5178 *

++ = ':';

5180 ià(
i
 =ğ
Ën
)

5182 *

++ = '/';

5188 *

++ = 
buff
[
i
++];

5190 
i
 < 
Ën
);

5193 *

 = 0;

5194 
	`FREE_NAMBUF
();

5197 
	`LEAVE_FF
(
fs
, 
»s
);

5198 
	}
}

5205 #ià
_FS_MINIMIZE
 <= 2

5210 
FRESULT
 
	$f_l£ek
 (

5211 
FIL
 *
å
,

5212 
FSIZE_t
 
ofs


5215 
FRESULT
 
»s
;

5216 
FATFS
 *
fs
;

5217 
DWORD
 
ş¡
, 
bcs
, 
n£ù
;

5218 
FSIZE_t
 
iåŒ
;

5219 #ià
_USE_FASTSEEK


5220 
DWORD
 
ş
, 
pş
, 
nş
, 
tş
, 
dsc
, 
’
, 
uËn
, *
tbl
;

5223 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

5224 ià(
»s
 !ğ
FR_OK
 || (» ğ(
FRESULT
)
å
->
”r
) != FR_OK)

5226 
	`LEAVE_FF
(
fs
, 
»s
);

5228 #ià
_USE_FASTSEEK


5229 ià(
å
->
ştbl
)

5231 ià(
ofs
 =ğ
CREATE_LINKMAP
)

5233 
tbl
 = 
å
->
ştbl
;

5234 
’
 = *
tbl
++;

5235 
uËn
 = 2;

5236 
ş
 = 
å
->
obj
.
sşu¡
;

5237 ià(
ş
)

5242 
tş
 = 
ş
;

5243 
nş
 = 0;

5244 
uËn
 += 2;

5247 
pş
 = 
ş
;

5248 
nş
++;

5249 
ş
 = 
	`g‘_çt
(&
å
->
obj
, cl);

5250 ià(
ş
 <= 1)

5252 
	`ABORT
(
fs
, 
FR_INT_ERR
);

5254 ià(
ş
 == 0xFFFFFFFF)

5256 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

5259 
ş
 =ğ
pş
 + 1);

5260 ià(
uËn
 <ğ
’
)

5262 *
tbl
++ = 
nş
;

5263 *
tbl
++ = 
tş
;

5266 
ş
 < 
fs
->
n_ç‹Á
);

5268 *
å
->
ştbl
 = 
uËn
;

5269 ià(
uËn
 <ğ
’
)

5271 *
tbl
 = 0;

5275 
»s
 = 
FR_NOT_ENOUGH_CORE
;

5280 ià(
ofs
 > 
å
->
obj
.
objsize
)

5282 
ofs
 = 
å
->
obj
.
objsize
;

5284 
å
->
åŒ
 = 
ofs
;

5285 ià(
ofs
)

5287 
å
->
şu¡
 = 
	`şmt_şu¡
(å, 
ofs
 - 1);

5288 
dsc
 = 
	`şu¡2£ù
(
fs
, 
å
->
şu¡
);

5289 ià(!
dsc
)

5291 
	`ABORT
(
fs
, 
FR_INT_ERR
);

5293 
dsc
 +ğ(
DWORD
)((
ofs
 - 1è/ 
	`SS
(
fs
)è& (fs->
csize
 - 1);

5294 ià(
å
->
åŒ
 % 
	`SS
(
fs
è&& 
dsc
 !ğå->
£ù
)

5296 #ià!
_FS_TINY


5297 #ià!
_FS_READONLY


5298 ià(
å
->
æag
 & 
FA_DIRTY
)

5300 ià(
	`disk_wr™e
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

5302 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

5304 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

5307 ià(
	`disk_»ad
(
fs
->
drv
, 
å
->
buf
, 
dsc
, 1è!ğ
RES_OK
)

5309 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

5312 
å
->
£ù
 = 
dsc
;

5322 #ià
_FS_EXFAT


5323 ià(
fs
->
fs_ty³
 !ğ
FS_EXFAT
 && 
ofs
 >= 0x100000000)

5325 
ofs
 = 0xFFFFFFFF;

5328 ià(
ofs
 > 
å
->
obj
.
objsize
 && (
_FS_READONLY
 || !(å->
æag
 & 
FA_WRITE
)))

5330 
ofs
 = 
å
->
obj
.
objsize
;

5332 
iåŒ
 = 
å
->
åŒ
;

5333 
å
->
åŒ
 = 
n£ù
 = 0;

5334 ià(
ofs
)

5336 
bcs
 = (
DWORD
)
fs
->
csize
 * 
	`SS
(fs);

5337 ià(
iåŒ
 > 0 &&

5338 (
ofs
 - 1è/ 
bcs
 >ğ(
iåŒ
 - 1) / bcs)

5340 
å
->
åŒ
 = (
iåŒ
 - 1è& ~(
FSIZE_t
)(
bcs
 - 1);

5341 
ofs
 -ğ
å
->
åŒ
;

5342 
ş¡
 = 
å
->
şu¡
;

5346 
ş¡
 = 
å
->
obj
.
sşu¡
;

5347 #ià!
_FS_READONLY


5348 ià(
ş¡
 == 0)

5350 
ş¡
 = 
	`ü—‹_chaš
(&
å
->
obj
, 0);

5351 ià(
ş¡
 == 1)

5353 
	`ABORT
(
fs
, 
FR_INT_ERR
);

5355 ià(
ş¡
 == 0xFFFFFFFF)

5357 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

5359 
å
->
obj
.
sşu¡
 = 
ş¡
;

5362 
å
->
şu¡
 = 
ş¡
;

5364 ià(
ş¡
 != 0)

5366 
ofs
 > 
bcs
)

5368 
ofs
 -ğ
bcs
;

5369 
å
->
åŒ
 +ğ
bcs
;

5370 #ià!
_FS_READONLY


5371 ià(
å
->
æag
 & 
FA_WRITE
)

5373 ià(
_FS_EXFAT
 && 
å
->
åŒ
 > fp->
obj
.
objsize
)

5375 
å
->
obj
.
objsize
 = fp->
åŒ
;

5376 
å
->
æag
 |ğ
FA_MODIFIED
;

5378 
ş¡
 = 
	`ü—‹_chaš
(&
å
->
obj
, clst);

5379 ià(
ş¡
 == 0)

5381 
ofs
 = 0;

5388 
ş¡
 = 
	`g‘_çt
(&
å
->
obj
, clst);

5390 ià(
ş¡
 == 0xFFFFFFFF)

5392 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

5394 ià(
ş¡
 <ğ1 || cl¡ >ğ
fs
->
n_ç‹Á
)

5396 
	`ABORT
(
fs
, 
FR_INT_ERR
);

5398 
å
->
şu¡
 = 
ş¡
;

5400 
å
->
åŒ
 +ğ
ofs
;

5401 ià(
ofs
 % 
	`SS
(
fs
))

5403 
n£ù
 = 
	`şu¡2£ù
(
fs
, 
ş¡
);

5404 ià(!
n£ù
)

5406 
	`ABORT
(
fs
, 
FR_INT_ERR
);

5408 
n£ù
 +ğ(
DWORD
)(
ofs
 / 
	`SS
(
fs
));

5412 ià(!
_FS_READONLY
 && 
å
->
åŒ
 > fp->
obj
.
objsize
)

5414 
å
->
obj
.
objsize
 = fp->
åŒ
;

5415 
å
->
æag
 |ğ
FA_MODIFIED
;

5417 ià(
å
->
åŒ
 % 
	`SS
(
fs
è&& 
n£ù
 !ğå->
£ù
)

5419 #ià!
_FS_TINY


5420 #ià!
_FS_READONLY


5421 ià(
å
->
æag
 & 
FA_DIRTY
)

5423 ià(
	`disk_wr™e
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

5425 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

5427 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

5430 ià(
	`disk_»ad
(
fs
->
drv
, 
å
->
buf
, 
n£ù
, 1è!ğ
RES_OK
)

5432 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

5435 
å
->
£ù
 = 
n£ù
;

5439 
	`LEAVE_FF
(
fs
, 
»s
);

5440 
	}
}

5444 #ià
_FS_MINIMIZE
 <= 1

5449 
FRESULT
 
	$f_İ’dœ
 (

5450 
DIR
 *
dp
,

5451 cÚ¡ 
TCHAR
 *
·th


5454 
FRESULT
 
»s
;

5455 
FATFS
 *
fs
;

5456 
_FDID
 *
obj
;

5457 
DEF_NAMBUF


5460 ià(!
dp
)

5462  
FR_INVALID_OBJECT
;

5466 
obj
 = &
dp
->obj;

5467 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 0);

5468 ià(
»s
 =ğ
FR_OK
)

5470 
obj
->
fs
 = fs;

5471 
	`INIT_NAMBUF
(
fs
);

5472 
»s
 = 
	`fŞlow_·th
(
dp
, 
·th
);

5473 ià(
»s
 =ğ
FR_OK
)

5475 ià(!(
dp
->
â
[
NSFLAG
] & 
NS_NONAME
))

5477 ià(
obj
->
©Œ
 & 
AM_DIR
)

5479 #ià
_FS_EXFAT


5480 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

5482 
obj
->
c_sş
 = obj->
sşu¡
;

5483 
obj
->
c_size
 = ((
DWORD
)obj->
objsize
 & 0xFFFFFF00è| obj->
¡©
;

5484 
obj
->
c_ofs
 = 
dp
->
blk_ofs
;

5485 
obj
->
sşu¡
 = 
	`ld_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
);

5486 
obj
->
objsize
 = 
	`ld_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
);

5487 
obj
->
¡©
 = 
fs
->
dœbuf
[
XDIR_G’FÏgs
] & 2;

5492 
obj
->
sşu¡
 = 
	`ld_şu¡
(
fs
, 
dp
->
dœ
);

5497 
»s
 = 
FR_NO_PATH
;

5500 ià(
»s
 =ğ
FR_OK
)

5502 
obj
->
id
 = 
fs
->id;

5503 
»s
 = 
	`dœ_sdi
(
dp
, 0);

5504 #ià
_FS_LOCK
 != 0

5505 ià(
»s
 =ğ
FR_OK
)

5507 ià(
obj
->
sşu¡
)

5509 
obj
->
lockid
 = 
	`šc_lock
(
dp
, 0);

5510 ià(!
obj
->
lockid
)

5512 
»s
 = 
FR_TOO_MANY_OPEN_FILES
;

5517 
obj
->
lockid
 = 0;

5523 
	`FREE_NAMBUF
();

5524 ià(
»s
 =ğ
FR_NO_FILE
)

5526 
»s
 = 
FR_NO_PATH
;

5529 ià(
»s
 !ğ
FR_OK
)

5531 
obj
->
fs
 = 0;

5534 
	`LEAVE_FF
(
fs
, 
»s
);

5535 
	}
}

5544 
FRESULT
 
	$f_şo£dœ
 (

5545 
DIR
 *
dp


5548 
FRESULT
 
»s
;

5549 
FATFS
 *
fs
;

5552 
»s
 = 
	`v®id©e
(&
dp
->
obj
, &
fs
);

5553 ià(
»s
 =ğ
FR_OK
)

5555 #ià
_FS_LOCK
 != 0

5556 ià(
dp
->
obj
.
lockid
)

5558 
»s
 = 
	`dec_lock
(
dp
->
obj
.
lockid
);

5560 ià(
»s
 =ğ
FR_OK
)

5563 
dp
->
obj
.
fs
 = 0;

5565 #ià
_FS_REENTRANT


5566 
	`uÆock_fs
(
fs
, 
FR_OK
);

5569  
»s
;

5570 
	}
}

5579 
FRESULT
 
	$f_»addœ
 (

5580 
DIR
 *
dp
,

5581 
FILINFO
 *
âo


5584 
FRESULT
 
»s
;

5585 
FATFS
 *
fs
;

5586 
DEF_NAMBUF


5589 
»s
 = 
	`v®id©e
(&
dp
->
obj
, &
fs
);

5590 ià(
»s
 =ğ
FR_OK
)

5592 ià(!
âo
)

5594 
»s
 = 
	`dœ_sdi
(
dp
, 0);

5598 
	`INIT_NAMBUF
(
fs
);

5599 
»s
 = 
	`dœ_»ad
(
dp
, 0);

5600 ià(
»s
 =ğ
FR_NO_FILE
)

5602 
»s
 = 
FR_OK
;

5604 ià(
»s
 =ğ
FR_OK
)

5606 
	`g‘_fešfo
(
dp
, 
âo
);

5607 
»s
 = 
	`dœ_Ãxt
(
dp
, 0);

5608 ià(
»s
 =ğ
FR_NO_FILE
)

5610 
»s
 = 
FR_OK
;

5613 
	`FREE_NAMBUF
();

5616 
	`LEAVE_FF
(
fs
, 
»s
);

5617 
	}
}

5621 #ià
_USE_FIND


5626 
FRESULT
 
	$f_fšdÃxt
 (

5627 
DIR
 *
dp
,

5628 
FILINFO
 *
âo


5631 
FRESULT
 
»s
;

5636 
»s
 = 
	`f_»addœ
(
dp
, 
âo
);

5637 ià(
»s
 !ğ
FR_OK
 || !
âo
 || !âo->
âame
[0])

5641 ià(
	`·‰”n_m©chšg
(
dp
->
·t
, 
âo
->
âame
, 0, 0))

5645 #ià
_USE_LFN
 !ğ0 && 
_USE_FIND
 == 2

5646 ià(
	`·‰”n_m©chšg
(
dp
->
·t
, 
âo
->
®Šame
, 0, 0))

5652  
»s
;

5653 
	}
}

5661 
FRESULT
 
	$f_fšdfœ¡
 (

5662 
DIR
 *
dp
,

5663 
FILINFO
 *
âo
,

5664 cÚ¡ 
TCHAR
 *
·th
,

5665 cÚ¡ 
TCHAR
 *
·‰”n


5668 
FRESULT
 
»s
;

5671 
dp
->
·t
 = 
·‰”n
;

5672 
»s
 = 
	`f_İ’dœ
(
dp
, 
·th
);

5673 ià(
»s
 =ğ
FR_OK
)

5675 
»s
 = 
	`f_fšdÃxt
(
dp
, 
âo
);

5677  
»s
;

5678 
	}
}

5684 #ià
_FS_MINIMIZE
 == 0

5689 
FRESULT
 
	$f_¡©
 (

5690 cÚ¡ 
TCHAR
 *
·th
,

5691 
FILINFO
 *
âo


5694 
FRESULT
 
»s
;

5695 
DIR
 
dj
;

5696 
DEF_NAMBUF


5700 
»s
 = 
	`fšd_vŞume
(&
·th
, &
dj
.
obj
.
fs
, 0);

5701 ià(
»s
 =ğ
FR_OK
)

5703 
	`INIT_NAMBUF
(
dj
.
obj
.
fs
);

5704 
»s
 = 
	`fŞlow_·th
(&
dj
, 
·th
);

5705 ià(
»s
 =ğ
FR_OK
)

5707 ià(
dj
.
â
[
NSFLAG
] & 
NS_NONAME
)

5709 
»s
 = 
FR_INVALID_NAME
;

5713 ià(
âo
)

5715 
	`g‘_fešfo
(&
dj
, 
âo
);

5719 
	`FREE_NAMBUF
();

5722 
	`LEAVE_FF
(
dj
.
obj
.
fs
, 
»s
);

5723 
	}
}

5727 #ià!
_FS_READONLY


5732 
FRESULT
 
	$f_g‘ä“
 (

5733 cÚ¡ 
TCHAR
 *
·th
,

5734 
DWORD
 *
nş¡
,

5735 
FATFS
 **
çtfs


5738 
FRESULT
 
»s
;

5739 
FATFS
 *
fs
;

5740 
DWORD
 
nä“
, 
ş¡
, 
£ù
, 
¡©
;

5741 
UINT
 
i
;

5742 
BYTE
 *
p
;

5743 
_FDID
 
obj
;

5747 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 0);

5748 ià(
»s
 =ğ
FR_OK
)

5750 *
çtfs
 = 
fs
;

5752 ià(
fs
->
ä“_ş¡
 <ğfs->
n_ç‹Á
 - 2)

5754 *
nş¡
 = 
fs
->
ä“_ş¡
;

5759 
nä“
 = 0;

5760 ià(
fs
->
fs_ty³
 =ğ
FS_FAT12
)

5762 
ş¡
 = 2;

5763 
obj
.
fs
 = fs;

5766 
¡©
 = 
	`g‘_çt
(&
obj
, 
ş¡
);

5767 ià(
¡©
 == 0xFFFFFFFF)

5769 
»s
 = 
FR_DISK_ERR
;

5772 ià(
¡©
 == 1)

5774 
»s
 = 
FR_INT_ERR
;

5777 ià(
¡©
 == 0)

5779 
nä“
++;

5782 ++
ş¡
 < 
fs
->
n_ç‹Á
);

5786 #ià
_FS_EXFAT


5787 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

5789 
BYTE
 
bm
;

5790 
UINT
 
b
;

5792 
ş¡
 = 
fs
->
n_ç‹Á
 - 2;

5793 
£ù
 = 
fs
->
d©aba£
;

5794 
i
 = 0;

5797 ià(
i
 =ğ0 && (
»s
 = 
	`move_wšdow
(
fs
, 
£ù
++)è!ğ
FR_OK
)

5801 
b
 = 8, 
bm
 = 
fs
->
wš
[
i
]; b && 
ş¡
; b--, clst--)

5803 ià(!(
bm
 & 1))

5805 
nä“
++;

5807 
bm
 >>= 1;

5809 
i
 = (˜+ 1è% 
	`SS
(
fs
);

5811 
ş¡
);

5817 
ş¡
 = 
fs
->
n_ç‹Á
;

5818 
£ù
 = 
fs
->
çtba£
;

5819 
i
 = 0;

5820 
p
 = 0;

5823 ià(
i
 == 0)

5825 
»s
 = 
	`move_wšdow
(
fs
, 
£ù
++);

5826 ià(
»s
 !ğ
FR_OK
)

5830 
p
 = 
fs
->
wš
;

5831 
i
 = 
	`SS
(
fs
);

5833 ià(
fs
->
fs_ty³
 =ğ
FS_FAT16
)

5835 ià(
	`ld_wÜd
(
p
) == 0)

5837 
nä“
++;

5839 
p
 += 2;

5840 
i
 -= 2;

5844 ià((
	`ld_dwÜd
(
p
) & 0x0FFFFFFF) == 0)

5846 
nä“
++;

5848 
p
 += 4;

5849 
i
 -= 4;

5852 --
ş¡
);

5855 *
nş¡
 = 
nä“
;

5856 
fs
->
ä“_ş¡
 = 
nä“
;

5857 
fs
->
fsi_æag
 |= 1;

5861 
	`LEAVE_FF
(
fs
, 
»s
);

5862 
	}
}

5871 
FRESULT
 
	$f_Œunÿ‹
 (

5872 
FIL
 *
å


5875 
FRESULT
 
»s
;

5876 
FATFS
 *
fs
;

5877 
DWORD
 
nş
;

5880 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

5881 ià(
»s
 !ğ
FR_OK
 || (» ğ(
FRESULT
)
å
->
”r
) != FR_OK)

5883 
	`LEAVE_FF
(
fs
, 
»s
);

5885 ià(!(
å
->
æag
 & 
FA_WRITE
))

5887 
	`LEAVE_FF
(
fs
, 
FR_DENIED
);

5890 ià(
å
->
obj
.
objsize
 > fp->
åŒ
)

5892 ià(
å
->
åŒ
 == 0)

5894 
»s
 = 
	`»move_chaš
(&
å
->
obj
, fp->obj.
sşu¡
, 0);

5895 
å
->
obj
.
sşu¡
 = 0;

5899 
nş
 = 
	`g‘_çt
(&
å
->
obj
, fp->
şu¡
);

5900 
»s
 = 
FR_OK
;

5901 ià(
nş
 == 0xFFFFFFFF)

5903 
»s
 = 
FR_DISK_ERR
;

5905 ià(
nş
 == 1)

5907 
»s
 = 
FR_INT_ERR
;

5909 ià(
»s
 =ğ
FR_OK
 && 
nş
 < 
fs
->
n_ç‹Á
)

5911 
»s
 = 
	`»move_chaš
(&
å
->
obj
, 
nş
, fp->
şu¡
);

5914 
å
->
obj
.
objsize
 = fp->
åŒ
;

5915 
å
->
æag
 |ğ
FA_MODIFIED
;

5916 #ià!
_FS_TINY


5917 ià(
»s
 =ğ
FR_OK
 && (
å
->
æag
 & 
FA_DIRTY
))

5919 ià(
	`disk_wr™e
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

5921 
»s
 = 
FR_DISK_ERR
;

5925 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

5929 ià(
»s
 !ğ
FR_OK
)

5931 
	`ABORT
(
fs
, 
»s
);

5935 
	`LEAVE_FF
(
fs
, 
»s
);

5936 
	}
}

5945 
FRESULT
 
	$f_uÆšk
 (

5946 cÚ¡ 
TCHAR
 *
·th


5949 
FRESULT
 
»s
;

5950 
DIR
 
dj
, 
sdj
;

5951 
DWORD
 
dş¡
 = 0;

5952 
FATFS
 *
fs
;

5953 #ià
_FS_EXFAT


5954 
_FDID
 
obj
;

5956 
DEF_NAMBUF


5960 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 
FA_WRITE
);

5961 
dj
.
obj
.
fs
 = fs;

5962 ià(
»s
 =ğ
FR_OK
)

5964 
	`INIT_NAMBUF
(
fs
);

5965 
»s
 = 
	`fŞlow_·th
(&
dj
, 
·th
);

5966 ià(
_FS_RPATH
 && 
»s
 =ğ
FR_OK
 && (
dj
.
â
[
NSFLAG
] & 
NS_DOT
))

5968 
»s
 = 
FR_INVALID_NAME
;

5970 #ià
_FS_LOCK
 != 0

5971 ià(
»s
 =ğ
FR_OK
)

5973 
»s
 = 
	`chk_lock
(&
dj
, 2);

5976 ià(
»s
 =ğ
FR_OK
)

5978 ià(
dj
.
â
[
NSFLAG
] & 
NS_NONAME
)

5980 
»s
 = 
FR_INVALID_NAME
;

5984 ià(
dj
.
obj
.
©Œ
 & 
AM_RDO
)

5986 
»s
 = 
FR_DENIED
;

5989 ià(
»s
 =ğ
FR_OK
)

5991 #ià
_FS_EXFAT


5992 
obj
.
fs
 = fs;

5993 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

5995 
obj
.
sşu¡
 = 
dş¡
 = 
	`ld_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
);

5996 
obj
.
objsize
 = 
	`ld_qwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
);

5997 
obj
.
¡©
 = 
fs
->
dœbuf
[
XDIR_G’FÏgs
] & 2;

6002 
dş¡
 = 
	`ld_şu¡
(
fs
, 
dj
.
dœ
);

6004 ià(
dj
.
obj
.
©Œ
 & 
AM_DIR
)

6006 #ià
_FS_RPATH
 != 0

6007 ià(
dş¡
 =ğ
fs
->
cdœ
)

6009 
»s
 = 
FR_DENIED
;

6014 
sdj
.
obj
.
fs
 = fs;

6015 
sdj
.
obj
.
sşu¡
 = 
dş¡
;

6016 #ià
_FS_EXFAT


6017 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6019 
sdj
.
obj
.
objsize
 = obj.objsize;

6020 
sdj
.
obj
.
¡©
 = obj.stat;

6023 
»s
 = 
	`dœ_sdi
(&
sdj
, 0);

6024 ià(
»s
 =ğ
FR_OK
)

6026 
»s
 = 
	`dœ_»ad
(&
sdj
, 0);

6027 ià(
»s
 =ğ
FR_OK
)

6029 
»s
 = 
FR_DENIED
;

6031 ià(
»s
 =ğ
FR_NO_FILE
)

6033 
»s
 = 
FR_OK
;

6039 ià(
»s
 =ğ
FR_OK
)

6041 
»s
 = 
	`dœ_»move
(&
dj
);

6042 ià(
»s
 =ğ
FR_OK
 && 
dş¡
)

6044 #ià
_FS_EXFAT


6045 
»s
 = 
	`»move_chaš
(&
obj
, 
dş¡
, 0);

6047 
»s
 = 
	`»move_chaš
(&
dj
.
obj
, 
dş¡
, 0);

6050 ià(
»s
 =ğ
FR_OK
)

6052 
»s
 = 
	`sync_fs
(
fs
);

6056 
	`FREE_NAMBUF
();

6059 
	`LEAVE_FF
(
fs
, 
»s
);

6060 
	}
}

6069 
FRESULT
 
	$f_mkdœ
 (

6070 cÚ¡ 
TCHAR
 *
·th


6073 
FRESULT
 
»s
;

6074 
DIR
 
dj
;

6075 
FATFS
 *
fs
;

6076 
BYTE
 *
dœ
;

6077 
UINT
 
n
;

6078 
DWORD
 
dsc
, 
dş
, 
pş
, 
tm
;

6079 
DEF_NAMBUF


6083 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 
FA_WRITE
);

6084 
dj
.
obj
.
fs
 = fs;

6085 ià(
»s
 =ğ
FR_OK
)

6087 
	`INIT_NAMBUF
(
fs
);

6088 
»s
 = 
	`fŞlow_·th
(&
dj
, 
·th
);

6089 ià(
»s
 =ğ
FR_OK
)

6091 
»s
 = 
FR_EXIST
;

6093 ià(
_FS_RPATH
 && 
»s
 =ğ
FR_NO_FILE
 && (
dj
.
â
[
NSFLAG
] & 
NS_DOT
))

6095 
»s
 = 
FR_INVALID_NAME
;

6097 ià(
»s
 =ğ
FR_NO_FILE
)

6099 
dş
 = 
	`ü—‹_chaš
(&
dj
.
obj
, 0);

6100 
dj
.
obj
.
objsize
 = (
DWORD
)
fs
->
csize
 * 
	`SS
(fs);

6101 
»s
 = 
FR_OK
;

6102 ià(
dş
 == 0)

6104 
»s
 = 
FR_DENIED
;

6106 ià(
dş
 == 1)

6108 
»s
 = 
FR_INT_ERR
;

6110 ià(
dş
 == 0xFFFFFFFF)

6112 
»s
 = 
FR_DISK_ERR
;

6114 ià(
»s
 =ğ
FR_OK
)

6116 
»s
 = 
	`sync_wšdow
(
fs
);

6118 
tm
 = 
	`GET_FATTIME
();

6119 ià(
»s
 =ğ
FR_OK
)

6121 
dsc
 = 
	`şu¡2£ù
(
fs
, 
dş
);

6122 
dœ
 = 
fs
->
wš
;

6123 
	`mem_£t
(
dœ
, 0, 
	`SS
(
fs
));

6124 ià(!
_FS_EXFAT
 || 
fs
->
fs_ty³
 !ğ
FS_EXFAT
)

6126 
	`mem_£t
(
dœ
 + 
DIR_Name
, ' ', 11);

6127 
dœ
[
DIR_Name
] = '.';

6128 
dœ
[
DIR_A‰r
] = 
AM_DIR
;

6129 
	`¡_dwÜd
(
dœ
 + 
DIR_ModTime
, 
tm
);

6130 
	`¡_şu¡
(
fs
, 
dœ
, 
dş
);

6131 
	`mem_ıy
(
dœ
 + 
SZDIRE
, dir, SZDIRE);

6132 
dœ
[
SZDIRE
 + 1] = '.';

6133 
pş
 = 
dj
.
obj
.
sşu¡
;

6134 ià(
fs
->
fs_ty³
 =ğ
FS_FAT32
 && 
pş
 =ğfs->
dœba£
)

6136 
pş
 = 0;

6138 
	`¡_şu¡
(
fs
, 
dœ
 + 
SZDIRE
, 
pş
);

6140 
n
 = 
fs
->
csize
;‚;‚--)

6142 
fs
->
wš£ù
 = 
dsc
++;

6143 
fs
->
wæag
 = 1;

6144 
»s
 = 
	`sync_wšdow
(
fs
);

6145 ià(
»s
 !ğ
FR_OK
)

6149 
	`mem_£t
(
dœ
, 0, 
	`SS
(
fs
));

6152 ià(
»s
 =ğ
FR_OK
)

6154 
»s
 = 
	`dœ_»gi¡”
(&
dj
);

6156 ià(
»s
 =ğ
FR_OK
)

6158 #ià
_FS_EXFAT


6159 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6161 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_ModTime
, 
tm
);

6162 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_F¡Clus
, 
dş
);

6163 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_FeSize
, (
DWORD
)
dj
.
obj
.
objsize
);

6164 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_V®idFeSize
, (
DWORD
)
dj
.
obj
.
objsize
);

6165 
fs
->
dœbuf
[
XDIR_G’FÏgs
] = 3;

6166 
fs
->
dœbuf
[
XDIR_A‰r
] = 
AM_DIR
;

6167 
»s
 = 
	`¡Üe_xdœ
(&
dj
);

6172 
dœ
 = 
dj
.dir;

6173 
	`¡_dwÜd
(
dœ
 + 
DIR_ModTime
, 
tm
);

6174 
	`¡_şu¡
(
fs
, 
dœ
, 
dş
);

6175 
dœ
[
DIR_A‰r
] = 
AM_DIR
;

6176 
fs
->
wæag
 = 1;

6178 ià(
»s
 =ğ
FR_OK
)

6180 
»s
 = 
	`sync_fs
(
fs
);

6185 
	`»move_chaš
(&
dj
.
obj
, 
dş
, 0);

6188 
	`FREE_NAMBUF
();

6191 
	`LEAVE_FF
(
fs
, 
»s
);

6192 
	}
}

6201 
FRESULT
 
	$f_»Çme
 (

6202 cÚ¡ 
TCHAR
 *
·th_Şd
,

6203 cÚ¡ 
TCHAR
 *
·th_Ãw


6206 
FRESULT
 
»s
;

6207 
DIR
 
djo
, 
djn
;

6208 
FATFS
 *
fs
;

6209 
BYTE
 
buf
[
_FS_EXFAT
 ? 
SZDIRE
 * 2 : 24], *
dœ
;

6210 
DWORD
 
dw
;

6211 
DEF_NAMBUF


6214 
	`g‘_ldnumb”
(&
·th_Ãw
);

6215 
»s
 = 
	`fšd_vŞume
(&
·th_Şd
, &
fs
, 
FA_WRITE
);

6216 ià(
»s
 =ğ
FR_OK
)

6218 
djo
.
obj
.
fs
 = fs;

6219 
	`INIT_NAMBUF
(
fs
);

6220 
»s
 = 
	`fŞlow_·th
(&
djo
, 
·th_Şd
);

6221 ià(
»s
 =ğ
FR_OK
 && (
djo
.
â
[
NSFLAG
] & (
NS_DOT
 | 
NS_NONAME
)))

6223 
»s
 = 
FR_INVALID_NAME
;

6225 #ià
_FS_LOCK
 != 0

6226 ià(
»s
 =ğ
FR_OK
)

6228 
»s
 = 
	`chk_lock
(&
djo
, 2);

6231 ià(
»s
 =ğ
FR_OK
)

6233 #ià
_FS_EXFAT


6234 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6236 
BYTE
 
nf
, 
Â
;

6237 
WORD
 
nh
;

6239 
	`mem_ıy
(
buf
, 
fs
->
dœbuf
, 
SZDIRE
 * 2);

6240 
	`mem_ıy
(&
djn
, &
djo
,  djo);

6241 
»s
 = 
	`fŞlow_·th
(&
djn
, 
·th_Ãw
);

6242 ià(
»s
 =ğ
FR_OK
)

6244 
»s
 = (
djn
.
obj
.
sşu¡
 =ğ
djo
.obj.sşu¡ && djn.
d±r
 =ğdjo.d±rè? 
FR_NO_FILE
 : 
FR_EXIST
;

6246 ià(
»s
 =ğ
FR_NO_FILE
)

6248 
»s
 = 
	`dœ_»gi¡”
(&
djn
);

6249 ià(
»s
 =ğ
FR_OK
)

6251 
nf
 = 
fs
->
dœbuf
[
XDIR_NumSec
];

6252 
Â
 = 
fs
->
dœbuf
[
XDIR_NumName
];

6253 
nh
 = 
	`ld_wÜd
(
fs
->
dœbuf
 + 
XDIR_NameHash
);

6254 
	`mem_ıy
(
fs
->
dœbuf
, 
buf
, 
SZDIRE
 * 2);

6255 
fs
->
dœbuf
[
XDIR_NumSec
] = 
nf
;

6256 
fs
->
dœbuf
[
XDIR_NumName
] = 
Â
;

6257 
	`¡_wÜd
(
fs
->
dœbuf
 + 
XDIR_NameHash
, 
nh
);

6259 
»s
 = 
	`¡Üe_xdœ
(&
djn
);

6267 
	`mem_ıy
(
buf
, 
djo
.
dœ
 + 
DIR_A‰r
, 21);

6268 
	`mem_ıy
(&
djn
, &
djo
,  (
DIR
));

6269 
»s
 = 
	`fŞlow_·th
(&
djn
, 
·th_Ãw
);

6270 ià(
»s
 =ğ
FR_OK
)

6272 
»s
 = (
djn
.
obj
.
sşu¡
 =ğ
djo
.obj.sşu¡ && djn.
d±r
 =ğdjo.d±rè? 
FR_NO_FILE
 : 
FR_EXIST
;

6274 ià(
»s
 =ğ
FR_NO_FILE
)

6276 
»s
 = 
	`dœ_»gi¡”
(&
djn
);

6277 ià(
»s
 =ğ
FR_OK
)

6279 
dœ
 = 
djn
.dir;

6280 
	`mem_ıy
(
dœ
 + 13, 
buf
 + 2, 19);

6281 
dœ
[
DIR_A‰r
] = 
buf
[0] | 
AM_ARC
;

6282 
fs
->
wæag
 = 1;

6283 ià((
dœ
[
DIR_A‰r
] & 
AM_DIR
è&& 
djo
.
obj
.
sşu¡
 !ğ
djn
.obj.sclust)

6285 
dw
 = 
	`şu¡2£ù
(
fs
, 
	`ld_şu¡
(fs, 
dœ
));

6286 ià(!
dw
)

6288 
»s
 = 
FR_INT_ERR
;

6293 
»s
 = 
	`move_wšdow
(
fs
, 
dw
);

6294 
dœ
 = 
fs
->
wš
 + 
SZDIRE
 * 1;

6295 ià(
»s
 =ğ
FR_OK
 && 
dœ
[1] == '.')

6297 
	`¡_şu¡
(
fs
, 
dœ
, 
djn
.
obj
.
sşu¡
);

6298 
fs
->
wæag
 = 1;

6305 ià(
»s
 =ğ
FR_OK
)

6307 
»s
 = 
	`dœ_»move
(&
djo
);

6308 ià(
»s
 =ğ
FR_OK
)

6310 
»s
 = 
	`sync_fs
(
fs
);

6315 
	`FREE_NAMBUF
();

6318 
	`LEAVE_FF
(
fs
, 
»s
);

6319 
	}
}

6328 #ià
_USE_CHMOD
 && !
_FS_READONLY


6333 
FRESULT
 
	$f_chmod
 (

6334 cÚ¡ 
TCHAR
 *
·th
,

6335 
BYTE
 
©Œ
,

6336 
BYTE
 
mask


6339 
FRESULT
 
»s
;

6340 
DIR
 
dj
;

6341 
FATFS
 *
fs
;

6342 
DEF_NAMBUF


6345 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 
FA_WRITE
);

6346 
dj
.
obj
.
fs
 = fs;

6347 ià(
»s
 =ğ
FR_OK
)

6349 
	`INIT_NAMBUF
(
fs
);

6350 
»s
 = 
	`fŞlow_·th
(&
dj
, 
·th
);

6351 ià(
»s
 =ğ
FR_OK
 && (
dj
.
â
[
NSFLAG
] & (
NS_DOT
 | 
NS_NONAME
)))

6353 
»s
 = 
FR_INVALID_NAME
;

6355 ià(
»s
 =ğ
FR_OK
)

6357 
mask
 &ğ
AM_RDO
 | 
AM_HID
 | 
AM_SYS
 | 
AM_ARC
;

6358 #ià
_FS_EXFAT


6359 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6361 
fs
->
dœbuf
[
XDIR_A‰r
] = (
©Œ
 & 
mask
è| (fs->dœbuf[XDIR_A‰r] & (
BYTE
)~mask);

6362 
»s
 = 
	`¡Üe_xdœ
(&
dj
);

6367 
dj
.
dœ
[
DIR_A‰r
] = (
©Œ
 & 
mask
è| (dj.dœ[DIR_A‰r] & (
BYTE
)~mask);

6368 
fs
->
wæag
 = 1;

6370 ià(
»s
 =ğ
FR_OK
)

6372 
»s
 = 
	`sync_fs
(
fs
);

6375 
	`FREE_NAMBUF
();

6378 
	`LEAVE_FF
(
fs
, 
»s
);

6379 
	}
}

6388 
FRESULT
 
	$f_utime
 (

6389 cÚ¡ 
TCHAR
 *
·th
,

6390 cÚ¡ 
FILINFO
 *
âo


6393 
FRESULT
 
»s
;

6394 
DIR
 
dj
;

6395 
FATFS
 *
fs
;

6396 
DEF_NAMBUF


6399 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 
FA_WRITE
);

6400 
dj
.
obj
.
fs
 = fs;

6401 ià(
»s
 =ğ
FR_OK
)

6403 
	`INIT_NAMBUF
(
fs
);

6404 
»s
 = 
	`fŞlow_·th
(&
dj
, 
·th
);

6405 ià(
»s
 =ğ
FR_OK
 && (
dj
.
â
[
NSFLAG
] & (
NS_DOT
 | 
NS_NONAME
)))

6407 
»s
 = 
FR_INVALID_NAME
;

6409 ià(
»s
 =ğ
FR_OK
)

6411 #ià
_FS_EXFAT


6412 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6414 
	`¡_dwÜd
(
fs
->
dœbuf
 + 
XDIR_ModTime
, (
DWORD
)
âo
->
fd©e
 << 16 | fno->
áime
);

6415 
»s
 = 
	`¡Üe_xdœ
(&
dj
);

6420 
	`¡_dwÜd
(
dj
.
dœ
 + 
DIR_ModTime
, (
DWORD
)
âo
->
fd©e
 << 16 | fno->
áime
);

6421 
fs
->
wæag
 = 1;

6423 ià(
»s
 =ğ
FR_OK
)

6425 
»s
 = 
	`sync_fs
(
fs
);

6428 
	`FREE_NAMBUF
();

6431 
	`LEAVE_FF
(
fs
, 
»s
);

6432 
	}
}

6438 #ià
_USE_LABEL


6443 
FRESULT
 
	$f_g‘Ïb–
 (

6444 cÚ¡ 
TCHAR
 *
·th
,

6445 
TCHAR
 *
Ïb–
,

6446 
DWORD
 *
v¢


6449 
FRESULT
 
»s
;

6450 
DIR
 
dj
;

6451 
FATFS
 *
fs
;

6452 
UINT
 
si
, 
di
;

6453 #ià
_LFN_UNICODE
 || 
_FS_EXFAT


6454 
WCHAR
 
w
;

6458 
»s
 = 
	`fšd_vŞume
(&
·th
, &
fs
, 0);

6461 ià(
»s
 =ğ
FR_OK
 && 
Ïb–
)

6463 
dj
.
obj
.
fs
 = fs;

6464 
dj
.
obj
.
sşu¡
 = 0;

6465 
»s
 = 
	`dœ_sdi
(&
dj
, 0);

6466 ià(
»s
 =ğ
FR_OK
)

6468 
»s
 = 
	`dœ_»ad
(&
dj
, 1);

6469 ià(
»s
 =ğ
FR_OK
)

6471 #ià
_FS_EXFAT


6472 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6474 
si
 = 
di
 = 0; s˜< 
dj
.
dœ
[
XDIR_NumLab–
]; si++)

6476 
w
 = 
	`ld_wÜd
(
dj
.
dœ
 + 
XDIR_Lab–
 + 
si
 * 2);

6477 #ià
_LFN_UNICODE


6478 
Ïb–
[
di
++] = 
w
;

6480 
w
 = 
	`ff_cÚv”t
(w, 0);

6481 ià(
w
 == 0)

6483 
w
 = '?';

6485 ià(
_DF1S
 && 
w
 >= 0x100)

6487 
Ïb–
[
di
++] = ()(
w
 >> 8);

6489 
Ïb–
[
di
++] = ()
w
;

6492 
Ïb–
[
di
] = 0;

6497 
si
 = 
di
 = 0;

6500 #ià
_LFN_UNICODE


6501 
w
 = (
si
 < 11è? 
dj
.
dœ
[si++] : ' ';

6502 ià(
	`IsDBCS1
(
w
è&& 
si
 < 11 && 
	`IsDBCS2
(
dj
.
dœ
[si]))

6504 
w
 = w << 8 | 
dj
.
dœ
[
si
++];

6506 
Ïb–
[
di
++] = 
	`ff_cÚv”t
(
w
, 1);

6508 
Ïb–
[
di
++] = 
dj
.
dœ
[
si
++];

6511 
di
 < 11);

6514 
Ïb–
[
di
] = 0;

6515 ià(
di
 == 0)

6520 
Ïb–
[--
di
] == ' ');

6524 ià(
»s
 =ğ
FR_NO_FILE
)

6526 
Ïb–
[0] = 0;

6527 
»s
 = 
FR_OK
;

6532 ià(
»s
 =ğ
FR_OK
 && 
v¢
)

6534 
»s
 = 
	`move_wšdow
(
fs
, fs->
vŞba£
);

6535 ià(
»s
 =ğ
FR_OK
)

6537 
fs
->
fs_ty³
)

6539 
FS_EXFAT
:

6540 
di
 = 
BPB_VŞIDEx
;

6542 
FS_FAT32
:

6543 
di
 = 
BS_VŞID32
;

6546 
di
 = 
BS_VŞID
;

6548 *
v¢
 = 
	`ld_dwÜd
(
fs
->
wš
 + 
di
);

6552 
	`LEAVE_FF
(
fs
, 
»s
);

6553 
	}
}

6557 #ià!
_FS_READONLY


6562 
FRESULT
 
	$f_£ab–
 (

6563 cÚ¡ 
TCHAR
 *
Ïb–


6566 
FRESULT
 
»s
;

6567 
DIR
 
dj
;

6568 
FATFS
 *
fs
;

6569 
BYTE
 
dœvn
[22];

6570 
UINT
 
i
, 
j
, 
¦’
;

6571 
WCHAR
 
w
;

6572 cÚ¡ 
badchr
[] = "\"*+,.:;<=>\?[]|\x7F";

6576 
»s
 = 
	`fšd_vŞume
(&
Ïb–
, &
fs
, 
FA_WRITE
);

6577 ià(
»s
 !ğ
FR_OK
)

6579 
	`LEAVE_FF
(
fs
, 
»s
);

6581 
dj
.
obj
.
fs
 = fs;

6584 
¦’
 = 0; (
UINT
)
Ïb–
[slen] >= ' '; slen++) ;

6586 #ià
_FS_EXFAT


6587 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6589 
i
 = 
j
 = 0; i < 
¦’
; )

6591 
w
 = 
Ïb–
[
i
++];

6592 #ià!
_LFN_UNICODE


6593 ià(
	`IsDBCS1
(
w
))

6595 
w
 = (
i
 < 
¦’
 && 
	`IsDBCS2
(
Ïb–
[i])è? w << 8 | (
BYTE
)label[i++] : 0;

6597 
w
 = 
	`ff_cÚv”t
(w, 1);

6599 ià(
w
 =ğ0 || 
	`chk_chr
(
badchr
, wè|| 
j
 == 22)

6601 
	`LEAVE_FF
(
fs
, 
FR_INVALID_NAME
);

6603 
	`¡_wÜd
(
dœvn
 + 
j
, 
w
);

6604 
j
 += 2;

6606 
¦’
 = 
j
;

6612  ; 
¦’
 && 
Ïb–
[slen - 1] == ' '; slen--) ;

6613 ià(
¦’
)

6615 
dœvn
[0] = 0;

6616 
i
 = 
j
 = 0;

6619 #ià
_LFN_UNICODE


6620 
w
 = 
	`ff_cÚv”t
(
	`ff_wtouµ”
(
Ïb–
[
i
++]), 0);

6622 
w
 = (
BYTE
)
Ïb–
[
i
++];

6623 ià(
	`IsDBCS1
(
w
))

6625 
w
 = (
j
 < 10 && 
i
 < 
¦’
 && 
	`IsDBCS2
(
Ïb–
[i])è? w << 8 | (
BYTE
)label[i++] : 0;

6627 #ià
_USE_LFN
 != 0

6628 
w
 = 
	`ff_cÚv”t
(
	`ff_wtouµ”
(ff_convert(w, 1)), 0);

6630 ià(
	`IsLow”
(
w
))

6632 
w
 -= 0x20;

6634 #ifdeà
_EXCVT


6635 ià(
w
 >= 0x80)

6637 
w
 = 
ExCvt
[w - 0x80];

6640 ià(!
_DF1S
 && 
w
 >= 0x80)

6642 
w
 = 0;

6647 ià(
w
 =ğ0 || 
	`chk_chr
(
badchr
, wè|| 
j
 >ğ(
UINT
)((w >= 0x100) ? 10 : 11))

6649 
	`LEAVE_FF
(
fs
, 
FR_INVALID_NAME
);

6651 ià(
w
 >= 0x100)

6653 
dœvn
[
j
++] = (
BYTE
)(
w
 >> 8);

6655 
dœvn
[
j
++] = (
BYTE
)
w
;

6657 
i
 < 
¦’
);

6658 
j
 < 11)

6660 
dœvn
[
j
++] = ' ';

6662 ià(
dœvn
[0] =ğ
DDEM
)

6664 
	`LEAVE_FF
(
fs
, 
FR_INVALID_NAME
);

6670 
dj
.
obj
.
sşu¡
 = 0;

6671 
»s
 = 
	`dœ_sdi
(&
dj
, 0);

6672 ià(
»s
 =ğ
FR_OK
)

6674 
»s
 = 
	`dœ_»ad
(&
dj
, 1);

6675 ià(
»s
 =ğ
FR_OK
)

6677 ià(
_FS_EXFAT
 && 
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6679 
dj
.
dœ
[
XDIR_NumLab–
] = (
BYTE
)(
¦’
 / 2);

6680 
	`mem_ıy
(
dj
.
dœ
 + 
XDIR_Lab–
, 
dœvn
, 
¦’
);

6684 ià(
¦’
)

6686 
	`mem_ıy
(
dj
.
dœ
, 
dœvn
, 11);

6690 
dj
.
dœ
[
DIR_Name
] = 
DDEM
;

6693 
fs
->
wæag
 = 1;

6694 
»s
 = 
	`sync_fs
(
fs
);

6698 ià(
»s
 =ğ
FR_NO_FILE
)

6700 
»s
 = 
FR_OK
;

6701 ià(
¦’
)

6703 
»s
 = 
	`dœ_®loc
(&
dj
, 1);

6704 ià(
»s
 =ğ
FR_OK
)

6706 
	`mem_£t
(
dj
.
dœ
, 0, 
SZDIRE
);

6707 ià(
_FS_EXFAT
 && 
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6709 
dj
.
dœ
[
XDIR_Ty³
] = 0x83;

6710 
dj
.
dœ
[
XDIR_NumLab–
] = (
BYTE
)(
¦’
 / 2);

6711 
	`mem_ıy
(
dj
.
dœ
 + 
XDIR_Lab–
, 
dœvn
, 
¦’
);

6715 
dj
.
dœ
[
DIR_A‰r
] = 
AM_VOL
;

6716 
	`mem_ıy
(
dj
.
dœ
, 
dœvn
, 11);

6718 
fs
->
wæag
 = 1;

6719 
»s
 = 
	`sync_fs
(
fs
);

6726 
	`LEAVE_FF
(
fs
, 
»s
);

6727 
	}
}

6734 #ià
_USE_EXPAND
 && !
_FS_READONLY


6739 
FRESULT
 
	$f_ex·nd
 (

6740 
FIL
 *
å
,

6741 
FSIZE_t
 
fsz
,

6742 
BYTE
 
İt


6745 
FRESULT
 
»s
;

6746 
FATFS
 *
fs
;

6747 
DWORD
 
n
, 
ş¡
, 
¡ş
, 
sş
, 
nş
, 
tş
, 
lş¡
;

6750 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

6751 ià(
»s
 !ğ
FR_OK
 || (» ğ(
FRESULT
)
å
->
”r
) != FR_OK)

6753 
	`LEAVE_FF
(
fs
, 
»s
);

6755 ià(
fsz
 =ğ0 || 
å
->
obj
.
objsize
 !ğ0 || !(å->
æag
 & 
FA_WRITE
))

6757 
	`LEAVE_FF
(
fs
, 
FR_DENIED
);

6759 #ià
_FS_EXFAT


6760 ià(
fs
->
fs_ty³
 !ğ
FS_EXFAT
 && 
fsz
 >= 0x100000000)

6762 
	`LEAVE_FF
(
fs
, 
FR_DENIED
);

6765 
n
 = (
DWORD
)
fs
->
csize
 * 
	`SS
(fs);

6766 
tş
 = (
DWORD
)(
fsz
 / 
n
) + ((fsz & (n - 1)) ? 1 : 0);

6767 
¡ş
 = 
fs
->
Ï¡_ş¡
;

6768 
lş¡
 = 0;

6769 ià(
¡ş
 < 2 || stş >ğ
fs
->
n_ç‹Á
)

6771 
¡ş
 = 2;

6774 #ià
_FS_EXFAT


6775 ià(
fs
->
fs_ty³
 =ğ
FS_EXFAT
)

6777 
sş
 = 
	`fšd_b™m­
(
fs
, 
¡ş
, 
tş
);

6778 ià(
sş
 == 0)

6780 
»s
 = 
FR_DENIED
;

6782 ià(
sş
 == 0xFFFFFFFF)

6784 
»s
 = 
FR_DISK_ERR
;

6786 ià(
»s
 =ğ
FR_OK
)

6788 ià(
İt
)

6790 
»s
 = 
	`chªge_b™m­
(
fs
, 
sş
, 
tş
, 1);

6791 
lş¡
 = 
sş
 + 
tş
 - 1;

6795 
lş¡
 = 
sş
 - 1;

6802 
sş
 = 
ş¡
 = 
¡ş
;

6803 
nş
 = 0;

6806 
n
 = 
	`g‘_çt
(&
å
->
obj
, 
ş¡
);

6807 ià(++
ş¡
 >ğ
fs
->
n_ç‹Á
)

6809 
ş¡
 = 2;

6811 ià(
n
 == 1)

6813 
»s
 = 
FR_INT_ERR
;

6816 ià(
n
 == 0xFFFFFFFF)

6818 
»s
 = 
FR_DISK_ERR
;

6821 ià(
n
 == 0)

6823 ià(++
nş
 =ğ
tş
)

6830 
sş
 = 
ş¡
;

6831 
nş
 = 0;

6833 ià(
ş¡
 =ğ
¡ş
)

6835 
»s
 = 
FR_DENIED
;

6839 ià(
»s
 =ğ
FR_OK
)

6841 ià(
İt
)

6843 
ş¡
 = 
sş
, 
n
 = 
tş
;‚; clst++,‚--)

6845 
»s
 = 
	`put_çt
(
fs
, 
ş¡
, (
n
 == 1) ? 0xFFFFFFFF : clst + 1);

6846 ià(
»s
 !ğ
FR_OK
)

6850 
lş¡
 = 
ş¡
;

6855 
lş¡
 = 
sş
 - 1;

6860 ià(
»s
 =ğ
FR_OK
)

6862 
fs
->
Ï¡_ş¡
 = 
lş¡
;

6863 ià(
İt
)

6865 
å
->
obj
.
sşu¡
 = 
sş
;

6866 
å
->
obj
.
objsize
 = 
fsz
;

6867 ià(
_FS_EXFAT
)

6869 
å
->
obj
.
¡©
 = 2;

6871 
å
->
æag
 |ğ
FA_MODIFIED
;

6872 ià(
fs
->
ä“_ş¡
 < fs->
n_ç‹Á
 - 2)

6874 
fs
->
ä“_ş¡
 -ğ
tş
;

6875 
fs
->
fsi_æag
 |= 1;

6880 
	`LEAVE_FF
(
fs
, 
»s
);

6881 
	}
}

6887 #ià
_USE_FORWARD


6892 
FRESULT
 
f_fÜw¬d
 (

6893 
FIL
 *
å
,

6894 
	$UINT
 (*
func
)(cÚ¡ 
BYTE
 *, 
UINT
),

6895 
UINT
 
btf
,

6896 
UINT
 *
bf


6899 
FRESULT
 
»s
;

6900 
FATFS
 *
fs
;

6901 
DWORD
 
ş¡
, 
£ù
;

6902 
FSIZE_t
 
»maš
;

6903 
UINT
 
rút
, 
c£ù
;

6904 
BYTE
 *
dbuf
;

6907 *
bf
 = 0;

6908 
»s
 = 
	`v®id©e
(&
å
->
obj
, &
fs
);

6909 ià(
»s
 !ğ
FR_OK
 || (» ğ(
FRESULT
)
å
->
”r
) != FR_OK)

6911 
	`LEAVE_FF
(
fs
, 
»s
);

6913 ià(!(
å
->
æag
 & 
FA_READ
))

6915 
	`LEAVE_FF
(
fs
, 
FR_DENIED
);

6918 
»maš
 = 
å
->
obj
.
objsize
 - fp->
åŒ
;

6919 ià(
btf
 > 
»maš
)

6921 
btf
 = (
UINT
)
»maš
;

6924  ; 
btf
 && (*
func
)(0, 0);

6925 
å
->
åŒ
 +ğ
rút
, *
bf
 +ğrút, 
btf
 -=„cnt)

6927 
c£ù
 = (
UINT
)(
å
->
åŒ
 / 
	`SS
(
fs
è& (fs->
csize
 - 1));

6928 ià(
å
->
åŒ
 % 
	`SS
(
fs
) == 0)

6930 ià(
c£ù
 == 0)

6932 
ş¡
 = (
å
->
åŒ
 == 0) ?

6933 
å
->
obj
.
sşu¡
 : 
	`g‘_çt
(&å->obj, fp->
şu¡
);

6934 ià(
ş¡
 <= 1)

6936 
	`ABORT
(
fs
, 
FR_INT_ERR
);

6938 ià(
ş¡
 == 0xFFFFFFFF)

6940 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

6942 
å
->
şu¡
 = 
ş¡
;

6945 
£ù
 = 
	`şu¡2£ù
(
fs
, 
å
->
şu¡
);

6946 ià(!
£ù
)

6948 
	`ABORT
(
fs
, 
FR_INT_ERR
);

6950 
£ù
 +ğ
c£ù
;

6951 #ià
_FS_TINY


6952 ià(
	`move_wšdow
(
fs
, 
£ù
è!ğ
FR_OK
)

6954 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

6956 
dbuf
 = 
fs
->
wš
;

6958 ià(
å
->
£ù
 != sect)

6960 #ià!
_FS_READONLY


6961 ià(
å
->
æag
 & 
FA_DIRTY
)

6963 ià(
	`disk_wr™e
(
fs
->
drv
, 
å
->
buf
, fp->
£ù
, 1è!ğ
RES_OK
)

6965 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

6967 
å
->
æag
 &ğ(
BYTE
)~
FA_DIRTY
;

6970 ià(
	`disk_»ad
(
fs
->
drv
, 
å
->
buf
, 
£ù
, 1è!ğ
RES_OK
)

6972 
	`ABORT
(
fs
, 
FR_DISK_ERR
);

6975 
dbuf
 = 
å
->
buf
;

6977 
å
->
£ù
 = sect;

6978 
rút
 = 
	`SS
(
fs
è- (
UINT
)
å
->
åŒ
 % SS(fs);

6979 ià(
rút
 > 
btf
)

6981 
rút
 = 
btf
;

6983 
rút
 = (*
func
)(
dbuf
 + ((
UINT
)
å
->
åŒ
 % 
	`SS
(
fs
)),„cnt);

6984 ià(!
rút
)

6986 
	`ABORT
(
fs
, 
FR_INT_ERR
);

6990 
	`LEAVE_FF
(
fs
, 
FR_OK
);

6991 
	}
}

6996 #ià
_USE_MKFS
 && !
_FS_READONLY


7001 
FRESULT
 
	$f_mkfs
 (

7002 cÚ¡ 
TCHAR
 *
·th
,

7003 
BYTE
 
İt
,

7004 
DWORD
 
au
,

7005 *
wÜk
,

7006 
UINT
 
Ën


7009 cÚ¡ 
UINT
 
n_çts
 = 1;

7010 cÚ¡ 
UINT
 
n_roÙdœ
 = 512;

7011 cÚ¡ 
WORD
 
c¡
[] = {1, 4, 16, 64, 256, 512, 0};

7012 cÚ¡ 
WORD
 
c¡32
[] = {1, 2, 4, 8, 16, 32, 0};

7013 
BYTE
 
fmt
, 
sys
, *
buf
, *
±e
, 
pdrv
, 
·¹
;

7014 
WORD
 
ss
;

7015 
DWORD
 
szb_buf
, 
sz_buf
, 
sz_blk
, 
n_ş¡
, 
·u
, 
£ù
, 
n£ù
, 
n
;

7016 
DWORD
 
b_vŞ
, 
b_çt
, 
b_d©a
;

7017 
DWORD
 
sz_vŞ
, 
sz_rsv
, 
sz_çt
, 
sz_dœ
;

7018 
UINT
 
i
;

7019 
vŞ
;

7020 
DSTATUS
 
¡©
;

7021 #ià
_USE_TRIM
 || 
_FS_EXFAT


7022 
DWORD
 
tbl
[3];

7027 
vŞ
 = 
	`g‘_ldnumb”
(&
·th
);

7028 ià(
vŞ
 < 0)

7030  
FR_INVALID_DRIVE
;

7032 ià(
F©Fs
[
vŞ
])

7034 
F©Fs
[
vŞ
]->
fs_ty³
 = 0;

7036 
pdrv
 = 
	`LD2PD
(
vŞ
);

7037 
·¹
 = 
	`LD2PT
(
vŞ
);

7040 
¡©
 = 
	`disk_š™Ÿlize
(
pdrv
);

7041 ià(
¡©
 & 
STA_NOINIT
)

7043  
FR_NOT_READY
;

7045 ià(
¡©
 & 
STA_PROTECT
)

7047  
FR_WRITE_PROTECTED
;

7049 ià(
	`disk_ioùl
(
pdrv
, 
GET_BLOCK_SIZE
, &
sz_blk
è!ğ
RES_OK
 || !sz_blk || sz_blk > 32768 || (sz_blk & (sz_blk - 1)))

7051 
sz_blk
 = 1;

7053 #ià
_MAX_SS
 !ğ
_MIN_SS


7054 ià(
	`disk_ioùl
(
pdrv
, 
GET_SECTOR_SIZE
, &
ss
è!ğ
RES_OK
)

7056  
FR_DISK_ERR
;

7058 ià(
ss
 > 
_MAX_SS
 || s < 
_MIN_SS
 || (ss & (ss - 1)))

7060  
FR_DISK_ERR
;

7063 
ss
 = 
_MAX_SS
;

7065 ià((
au
 !ğ0 &&‡u < 
ss
) ||‡u > 0x1000000 || (au & (au - 1)))

7067  
FR_INVALID_PARAMETER
;

7069 
au
 /ğ
ss
;

7072 
buf
 = (
BYTE
 *)
wÜk
;

7073 
sz_buf
 = 
Ën
 / 
ss
;

7074 
szb_buf
 = 
sz_buf
 * 
ss
;

7075 ià(!
szb_buf
)

7077  
FR_MKFS_ABORTED
;

7081 ià(
_MULTI_PARTITION
 && 
·¹
 != 0)

7084 ià(
	`disk_»ad
(
pdrv
, 
buf
, 0, 1è!ğ
RES_OK
)

7086  
FR_DISK_ERR
;

7088 ià(
	`ld_wÜd
(
buf
 + 
BS_55AA
) != 0xAA55)

7090  
FR_MKFS_ABORTED
;

7092 
±e
 = 
buf
 + (
MBR_TabË
 + (
·¹
 - 1è* 
SZ_PTE
);

7093 ià(!
±e
[
PTE_Sy¡em
])

7095  
FR_MKFS_ABORTED
;

7097 
b_vŞ
 = 
	`ld_dwÜd
(
±e
 + 
PTE_StLba
);

7098 
sz_vŞ
 = 
	`ld_dwÜd
(
±e
 + 
PTE_SizLba
);

7103 ià(
	`disk_ioùl
(
pdrv
, 
GET_SECTOR_COUNT
, &
sz_vŞ
è!ğ
RES_OK
)

7105  
FR_DISK_ERR
;

7107 
b_vŞ
 = (
İt
 & 
FM_SFD
) ? 0 : 63;

7108 ià(
sz_vŞ
 < 
b_vŞ
)

7110  
FR_MKFS_ABORTED
;

7112 
sz_vŞ
 -ğ
b_vŞ
;

7114 ià(
sz_vŞ
 < 128)

7116  
FR_MKFS_ABORTED
;

7122 ià(
_FS_EXFAT
 && (
İt
 & 
FM_EXFAT
))

7124 ià((
İt
 & 
FM_ANY
è=ğ
FM_EXFAT
 || 
sz_vŞ
 >ğ0x4000000 || 
au
 > 128)

7126 
fmt
 = 
FS_EXFAT
;

7130 ià(
au
 > 128)

7132  
FR_INVALID_PARAMETER
;

7134 ià(
İt
 & 
FM_FAT32
)

7136 ià((
İt
 & 
FM_ANY
è=ğ
FM_FAT32
 || !(İˆ& 
FM_FAT
))

7138 
fmt
 = 
FS_FAT32
;

7142 ià(!(
İt
 & 
FM_FAT
))

7144  
FR_INVALID_PARAMETER
;

7146 
fmt
 = 
FS_FAT16
;

7150 #ià
_FS_EXFAT


7151 ià(
fmt
 =ğ
FS_EXFAT
)

7153 
DWORD
 
szb_b™
, 
szb_ÿ£
, 
sum
, 
nb
, 
ş
;

7154 
WCHAR
 
ch
, 
si
;

7155 
UINT
 
j
, 
¡
;

7156 
BYTE
 
b
;

7158 ià(
sz_vŞ
 < 0x1000)

7160  
FR_MKFS_ABORTED
;

7162 #ià
_USE_TRIM


7163 
tbl
[0] = 
b_vŞ
;

7164 
tbl
[1] = 
b_vŞ
 + 
sz_vŞ
 - 1;

7165 
	`disk_ioùl
(
pdrv
, 
CTRL_TRIM
, 
tbl
);

7168 ià(!
au
)

7170 
au
 = 8;

7171 ià(
sz_vŞ
 >= 0x80000)

7173 
au
 = 64;

7175 ià(
sz_vŞ
 >= 0x4000000)

7177 
au
 = 256;

7180 
b_çt
 = 
b_vŞ
 + 32;

7181 
sz_çt
 = ((
sz_vŞ
 / 
au
 + 2è* 4 + 
ss
 - 1) / ss;

7182 
b_d©a
 = (
b_çt
 + 
sz_çt
 + 
sz_blk
 - 1) & ~(sz_blk - 1);

7183 ià(
b_d©a
 >ğ
sz_vŞ
 / 2)

7185  
FR_MKFS_ABORTED
;

7187 
n_ş¡
 = (
sz_vŞ
 - (
b_d©a
 - 
b_vŞ
)è/ 
au
;

7188 ià(
n_ş¡
 < 16)

7190  
FR_MKFS_ABORTED
;

7192 ià(
n_ş¡
 > 
MAX_EXFAT
)

7194  
FR_MKFS_ABORTED
;

7197 
szb_b™
 = (
n_ş¡
 + 7) / 8;

7198 
tbl
[0] = (
szb_b™
 + 
au
 * 
ss
 - 1) / (au * ss);

7201 
£ù
 = 
b_d©a
 + 
au
 * 
tbl
[0];

7202 
sum
 = 0;

7203 
¡
 = 
si
 = 
i
 = 
j
 = 
szb_ÿ£
 = 0;

7206 
¡
)

7209 
ch
 = 
	`ff_wtouµ”
(
si
);

7210 ià(
ch
 !ğ
si
)

7212 
si
++;

7215 
j
 = 1; (
WCHAR
)(
si
 + jè&& (WCHAR)(s˜+ jè=ğ
	`ff_wtouµ”
((WCHAR)(si + j)); j++) ;

7216 ià(
j
 >= 128)

7218 
ch
 = 0xFFFF;

7219 
¡
 = 2;

7222 
¡
 = 1;

7225 
ch
 = 
si
++;

7226 ià(--
j
 == 0)

7228 
¡
 = 0;

7232 
ch
 = (
WCHAR
)
j
;

7233 
si
 +ğ
j
;

7234 
¡
 = 0;

7236 
sum
 = 
	`xsum32
(
buf
[
i
 + 0] = (
BYTE
)
ch
, sum);

7237 
sum
 = 
	`xsum32
(
buf
[
i
 + 1] = (
BYTE
)(
ch
 >> 8), sum);

7238 
i
 += 2;

7239 
szb_ÿ£
 += 2;

7240 ià(!
si
 || 
i
 =ğ
szb_buf
)

7242 
n
 = (
i
 + 
ss
 - 1) / ss;

7243 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
, 
n
è!ğ
RES_OK
)

7245  
FR_DISK_ERR
;

7247 
£ù
 +ğ
n
;

7248 
i
 = 0;

7251 
si
);

7252 
tbl
[1] = (
szb_ÿ£
 + 
au
 * 
ss
 - 1) / (au * ss);

7253 
tbl
[2] = 1;

7256 
£ù
 = 
b_d©a
;

7257 
n£ù
 = (
szb_b™
 + 
ss
 - 1) / ss;

7258 
nb
 = 
tbl
[0] +bl[1] +bl[2];

7261 
	`mem_£t
(
buf
, 0, 
szb_buf
);

7262 
i
 = 0; 
nb
 >ğ8 && i < 
szb_buf
; 
buf
[i++] = 0xFF,‚b -= 8) ;

7263 
b
 = 1; 
nb
 && 
i
 < 
szb_buf
; 
buf
[i] |= b, b <<= 1,‚b--) ;

7264 
n
 = (
n£ù
 > 
sz_buf
) ? sz_buf :‚sect;

7265 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
, 
n
è!ğ
RES_OK
)

7267  
FR_DISK_ERR
;

7269 
£ù
 +ğ
n
;

7270 
n£ù
 -ğ
n
;

7272 
n£ù
);

7275 
£ù
 = 
b_çt
;

7276 
n£ù
 = 
sz_çt
;

7277 
j
 = 
nb
 = 
ş
 = 0;

7280 
	`mem_£t
(
buf
, 0, 
szb_buf
);

7281 
i
 = 0;

7282 ià(
ş
 == 0)

7284 
	`¡_dwÜd
(
buf
 + 
i
, 0xFFFFFFF8);

7285 
i
 += 4;

7286 
ş
++;

7287 
	`¡_dwÜd
(
buf
 + 
i
, 0xFFFFFFFF);

7288 
i
 += 4;

7289 
ş
++;

7293 
nb
 && 
i
 < 
szb_buf
)

7295 
	`¡_dwÜd
(
buf
 + 
i
, (
nb
 > 1è? 
ş
 + 1 : 0xFFFFFFFF);

7296 
i
 += 4;

7297 
ş
++;

7298 
nb
--;

7300 ià(!
nb
 && 
j
 < 3)

7302 
nb
 = 
tbl
[
j
++];

7305 
nb
 && 
i
 < 
szb_buf
);

7306 
n
 = (
n£ù
 > 
sz_buf
) ? sz_buf :‚sect;

7307 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
, 
n
è!ğ
RES_OK
)

7309  
FR_DISK_ERR
;

7311 
£ù
 +ğ
n
;

7312 
n£ù
 -ğ
n
;

7314 
n£ù
);

7317 
	`mem_£t
(
buf
, 0, 
szb_buf
);

7318 
buf
[
SZDIRE
 * 0 + 0] = 0x83;

7319 
buf
[
SZDIRE
 * 1 + 0] = 0x81;

7320 
	`¡_dwÜd
(
buf
 + 
SZDIRE
 * 1 + 20, 2);

7321 
	`¡_dwÜd
(
buf
 + 
SZDIRE
 * 1 + 24, 
szb_b™
);

7322 
buf
[
SZDIRE
 * 2 + 0] = 0x82;

7323 
	`¡_dwÜd
(
buf
 + 
SZDIRE
 * 2 + 4, 
sum
);

7324 
	`¡_dwÜd
(
buf
 + 
SZDIRE
 * 2 + 20, 2 + 
tbl
[0]);

7325 
	`¡_dwÜd
(
buf
 + 
SZDIRE
 * 2 + 24, 
szb_ÿ£
);

7326 
£ù
 = 
b_d©a
 + 
au
 * (
tbl
[0] +bl[1]);

7327 
n£ù
 = 
au
;

7330 
n
 = (
n£ù
 > 
sz_buf
) ? sz_buf :‚sect;

7331 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
, 
n
è!ğ
RES_OK
)

7333  
FR_DISK_ERR
;

7335 
	`mem_£t
(
buf
, 0, 
ss
);

7336 
£ù
 +ğ
n
;

7337 
n£ù
 -ğ
n
;

7339 
n£ù
);

7342 
£ù
 = 
b_vŞ
;

7343 
n
 = 0;‚ < 2;‚++)

7346 
	`mem_£t
(
buf
, 0, 
ss
);

7347 
	`mem_ıy
(
buf
 + 
BS_JmpBoÙ
, "\xEB\x76\x90" "EXFAT ", 11);

7348 
	`¡_dwÜd
(
buf
 + 
BPB_VŞOfsEx
, 
b_vŞ
);

7349 
	`¡_dwÜd
(
buf
 + 
BPB_TÙSecEx
, 
sz_vŞ
);

7350 
	`¡_dwÜd
(
buf
 + 
BPB_F©OfsEx
, 
b_çt
 - 
b_vŞ
);

7351 
	`¡_dwÜd
(
buf
 + 
BPB_F©SzEx
, 
sz_çt
);

7352 
	`¡_dwÜd
(
buf
 + 
BPB_D©aOfsEx
, 
b_d©a
 - 
b_vŞ
);

7353 
	`¡_dwÜd
(
buf
 + 
BPB_NumClusEx
, 
n_ş¡
);

7354 
	`¡_dwÜd
(
buf
 + 
BPB_RoÙClusEx
, 2 + 
tbl
[0] +bl[1]);

7355 
	`¡_dwÜd
(
buf
 + 
BPB_VŞIDEx
, 
	`GET_FATTIME
());

7356 
	`¡_wÜd
(
buf
 + 
BPB_FSV”Ex
, 0x100);

7357 
buf
[
BPB_BytsP”SecEx
] = 0, 
i
 = 
ss
; i >>= 1; buf[BPB_BytsPerSecEx]++) ;

7358 
buf
[
BPB_SecP”ClusEx
] = 0, 
i
 = 
au
; i >>= 1; buf[BPB_SecPerClusEx]++) ;

7359 
buf
[
BPB_NumFATsEx
] = 1;

7360 
buf
[
BPB_DrvNumEx
] = 0x80;

7361 
	`¡_wÜd
(
buf
 + 
BS_BoÙCodeEx
, 0xFEEB);

7362 
	`¡_wÜd
(
buf
 + 
BS_55AA
, 0xAA55);

7363 
i
 = 
sum
 = 0; i < 
ss
; i++)

7365 ià(
i
 !ğ
BPB_VŞFÏgEx
 && i !ğBPB_VŞFÏgEx + 1 && i !ğ
BPB_P”cInU£Ex
)

7367 
sum
 = 
	`xsum32
(
buf
[
i
], sum);

7370 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
++, 1è!ğ
RES_OK
)

7372  
FR_DISK_ERR
;

7375 
	`mem_£t
(
buf
, 0, 
ss
);

7376 
	`¡_wÜd
(
buf
 + 
ss
 - 2, 0xAA55);

7377 
j
 = 1; j < 9; j++)

7379 
i
 = 0; i < 
ss
; 
sum
 = 
	`xsum32
(
buf
[i++], sum)) ;

7380 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
++, 1è!ğ
RES_OK
)

7382  
FR_DISK_ERR
;

7386 
	`mem_£t
(
buf
, 0, 
ss
);

7387  ; 
j
 < 11; j++)

7389 
i
 = 0; i < 
ss
; 
sum
 = 
	`xsum32
(
buf
[i++], sum)) ;

7390 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
++, 1è!ğ
RES_OK
)

7392  
FR_DISK_ERR
;

7396 
i
 = 0; i < 
ss
; i += 4)

7398 
	`¡_dwÜd
(
buf
 + 
i
, 
sum
);

7400 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
++, 1è!ğ
RES_OK
)

7402  
FR_DISK_ERR
;

7413 
·u
 = 
au
;

7415 ià(
fmt
 =ğ
FS_FAT32
)

7417 ià(!
·u
)

7419 
n
 = 
sz_vŞ
 / 0x20000;

7420 
i
 = 0, 
·u
 = 1; 
c¡32
[i] && c¡32[i] <ğ
n
; i++,…au <<= 1) ;

7422 
n_ş¡
 = 
sz_vŞ
 / 
·u
;

7423 
sz_çt
 = (
n_ş¡
 * 4 + 8 + 
ss
 - 1) / ss;

7424 
sz_rsv
 = 32;

7425 
sz_dœ
 = 0;

7426 ià(
n_ş¡
 <ğ
MAX_FAT16
 ||‚_ş¡ > 
MAX_FAT32
)

7428  
FR_MKFS_ABORTED
;

7433 ià(!
·u
)

7435 
n
 = 
sz_vŞ
 / 0x1000;

7436 
i
 = 0, 
·u
 = 1; 
c¡
[i] && c¡[i] <ğ
n
; i++,…au <<= 1) ;

7438 
n_ş¡
 = 
sz_vŞ
 / 
·u
;

7439 ià(
n_ş¡
 > 
MAX_FAT12
)

7441 
n
 = 
n_ş¡
 * 2 + 4;

7445 
fmt
 = 
FS_FAT12
;

7446 
n
 = (
n_ş¡
 * 3 + 1) / 2 + 3;

7448 
sz_çt
 = (
n
 + 
ss
 - 1) / ss;

7449 
sz_rsv
 = 1;

7450 
sz_dœ
 = (
DWORD
)
n_roÙdœ
 * 
SZDIRE
 / 
ss
;

7452 
b_çt
 = 
b_vŞ
 + 
sz_rsv
;

7453 
b_d©a
 = 
b_çt
 + 
sz_çt
 * 
n_çts
 + 
sz_dœ
;

7456 
n
 = ((
b_d©a
 + 
sz_blk
 - 1) & ~(sz_blk - 1)) - b_data;

7457 ià(
fmt
 =ğ
FS_FAT32
)

7459 
sz_rsv
 +ğ
n
;

7460 
b_çt
 +ğ
n
;

7464 
sz_çt
 +ğ
n
 / 
n_çts
;

7468 ià(
sz_vŞ
 < 
b_d©a
 + 
·u
 * 16 - 
b_vŞ
)

7470  
FR_MKFS_ABORTED
;

7472 
n_ş¡
 = (
sz_vŞ
 - 
sz_rsv
 - 
sz_çt
 * 
n_çts
 - 
sz_dœ
è/ 
·u
;

7473 ià(
fmt
 =ğ
FS_FAT32
)

7475 ià(
n_ş¡
 <ğ
MAX_FAT16
)

7477 ià(!
au
 && (au = 
·u
 / 2) != 0)

7481  
FR_MKFS_ABORTED
;

7484 ià(
fmt
 =ğ
FS_FAT16
)

7486 ià(
n_ş¡
 > 
MAX_FAT16
)

7488 ià(!
au
 && (
·u
 * 2) <= 64)

7490 
au
 = 
·u
 * 2;

7493 ià((
İt
 & 
FM_FAT32
))

7495 
fmt
 = 
FS_FAT32
;

7498 ià(!
au
 && (au = 
·u
 * 2) <= 128)

7502  
FR_MKFS_ABORTED
;

7504 ià(
n_ş¡
 <ğ
MAX_FAT12
)

7506 ià(!
au
 && (au = 
·u
 * 2) <= 128)

7510  
FR_MKFS_ABORTED
;

7513 ià(
fmt
 =ğ
FS_FAT12
 && 
n_ş¡
 > 
MAX_FAT12
)

7515  
FR_MKFS_ABORTED
;

7523 #ià
_USE_TRIM


7524 
tbl
[0] = 
b_vŞ
;

7525 
tbl
[1] = 
b_vŞ
 + 
sz_vŞ
 - 1;

7526 
	`disk_ioùl
(
pdrv
, 
CTRL_TRIM
, 
tbl
);

7529 
	`mem_£t
(
buf
, 0, 
ss
);

7530 
	`mem_ıy
(
buf
 + 
BS_JmpBoÙ
, "\xEB\xFE\x90" "MSDOS5.0", 11);

7531 
	`¡_wÜd
(
buf
 + 
BPB_BytsP”Sec
, 
ss
);

7532 
buf
[
BPB_SecP”Clus
] = (
BYTE
)
·u
;

7533 
	`¡_wÜd
(
buf
 + 
BPB_RsvdSecCÁ
, (
WORD
)
sz_rsv
);

7534 
buf
[
BPB_NumFATs
] = (
BYTE
)
n_çts
;

7535 
	`¡_wÜd
(
buf
 + 
BPB_RoÙEÁCÁ
, (
WORD
)((
fmt
 =ğ
FS_FAT32
è? 0 : 
n_roÙdœ
));

7536 ià(
sz_vŞ
 < 0x10000)

7538 
	`¡_wÜd
(
buf
 + 
BPB_TÙSec16
, (
WORD
)
sz_vŞ
);

7542 
	`¡_dwÜd
(
buf
 + 
BPB_TÙSec32
, 
sz_vŞ
);

7544 
buf
[
BPB_MedŸ
] = 0xF8;

7545 
	`¡_wÜd
(
buf
 + 
BPB_SecP”Trk
, 63);

7546 
	`¡_wÜd
(
buf
 + 
BPB_NumH—ds
, 255);

7547 
	`¡_dwÜd
(
buf
 + 
BPB_HiddSec
, 
b_vŞ
);

7548 ià(
fmt
 =ğ
FS_FAT32
)

7550 
	`¡_dwÜd
(
buf
 + 
BS_VŞID32
, 
	`GET_FATTIME
());

7551 
	`¡_dwÜd
(
buf
 + 
BPB_FATSz32
, 
sz_çt
);

7552 
	`¡_dwÜd
(
buf
 + 
BPB_RoÙClus32
, 2);

7553 
	`¡_wÜd
(
buf
 + 
BPB_FSInfo32
, 1);

7554 
	`¡_wÜd
(
buf
 + 
BPB_BkBoÙSec32
, 6);

7555 
buf
[
BS_DrvNum32
] = 0x80;

7556 
buf
[
BS_BoÙSig32
] = 0x29;

7557 
	`mem_ıy
(
buf
 + 
BS_VŞLab32
, "NO NAME " "FAT32 ", 19);

7561 
	`¡_dwÜd
(
buf
 + 
BS_VŞID
, 
	`GET_FATTIME
());

7562 
	`¡_wÜd
(
buf
 + 
BPB_FATSz16
, (
WORD
)
sz_çt
);

7563 
buf
[
BS_DrvNum
] = 0x80;

7564 
buf
[
BS_BoÙSig
] = 0x29;

7565 
	`mem_ıy
(
buf
 + 
BS_VŞLab
, "NO NAME " "FAT ", 19);

7567 
	`¡_wÜd
(
buf
 + 
BS_55AA
, 0xAA55);

7568 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
b_vŞ
, 1è!ğ
RES_OK
)

7570  
FR_DISK_ERR
;

7574 ià(
fmt
 =ğ
FS_FAT32
)

7576 
	`disk_wr™e
(
pdrv
, 
buf
, 
b_vŞ
 + 6, 1);

7577 
	`mem_£t
(
buf
, 0, 
ss
);

7578 
	`¡_dwÜd
(
buf
 + 
FSI_L—dSig
, 0x41615252);

7579 
	`¡_dwÜd
(
buf
 + 
FSI_SŒucSig
, 0x61417272);

7580 
	`¡_dwÜd
(
buf
 + 
FSI_F»e_CouÁ
, 
n_ş¡
 - 1);

7581 
	`¡_dwÜd
(
buf
 + 
FSI_Nxt_F»e
, 2);

7582 
	`¡_wÜd
(
buf
 + 
BS_55AA
, 0xAA55);

7583 
	`disk_wr™e
(
pdrv
, 
buf
, 
b_vŞ
 + 7, 1);

7584 
	`disk_wr™e
(
pdrv
, 
buf
, 
b_vŞ
 + 1, 1);

7588 
	`mem_£t
(
buf
, 0, (
UINT
)
szb_buf
);

7589 
£ù
 = 
b_çt
;

7590 
i
 = 0; i < 
n_çts
; i++)

7592 ià(
fmt
 =ğ
FS_FAT32
)

7594 
	`¡_dwÜd
(
buf
 + 0, 0xFFFFFFF8);

7595 
	`¡_dwÜd
(
buf
 + 4, 0xFFFFFFFF);

7596 
	`¡_dwÜd
(
buf
 + 8, 0x0FFFFFFF);

7600 
	`¡_dwÜd
(
buf
 + 0, (
fmt
 =ğ
FS_FAT12
) ? 0xFFFFF8 : 0xFFFFFFF8);

7602 
n£ù
 = 
sz_çt
;

7605 
n
 = (
n£ù
 > 
sz_buf
) ? sz_buf :‚sect;

7606 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
, (
UINT
)
n
è!ğ
RES_OK
)

7608  
FR_DISK_ERR
;

7610 
	`mem_£t
(
buf
, 0, 
ss
);

7611 
£ù
 +ğ
n
;

7612 
n£ù
 -ğ
n
;

7614 
n£ù
);

7618 
n£ù
 = (
fmt
 =ğ
FS_FAT32
è? 
·u
 : 
sz_dœ
;

7621 
n
 = (
n£ù
 > 
sz_buf
) ? sz_buf :‚sect;

7622 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 
£ù
, (
UINT
)
n
è!ğ
RES_OK
)

7624  
FR_DISK_ERR
;

7626 
£ù
 +ğ
n
;

7627 
n£ù
 -ğ
n
;

7629 
n£ù
);

7633 ià(
_FS_EXFAT
 && 
fmt
 =ğ
FS_EXFAT
)

7635 
sys
 = 0x07;

7639 ià(
fmt
 =ğ
FS_FAT32
)

7641 
sys
 = 0x0C;

7645 ià(
sz_vŞ
 >= 0x10000)

7647 
sys
 = 0x06;

7651 
sys
 = (
fmt
 =ğ
FS_FAT16
) ? 0x04 : 0x01;

7656 ià(
_MULTI_PARTITION
 && 
·¹
 != 0)

7659 ià(
	`disk_»ad
(
pdrv
, 
buf
, 0, 1è!ğ
RES_OK
)

7661  
FR_DISK_ERR
;

7663 
buf
[
MBR_TabË
 + (
·¹
 - 1è* 
SZ_PTE
 + 
PTE_Sy¡em
] = 
sys
;

7664 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 0, 1è!ğ
RES_OK
)

7666  
FR_DISK_ERR
;

7671 ià(!(
İt
 & 
FM_SFD
))

7674 
	`mem_£t
(
buf
, 0, 
ss
);

7675 
	`¡_wÜd
(
buf
 + 
BS_55AA
, 0xAA55);

7676 
±e
 = 
buf
 + 
MBR_TabË
;

7677 
±e
[
PTE_BoÙ
] = 0;

7678 
±e
[
PTE_StH—d
] = 1;

7679 
±e
[
PTE_StSec
] = 1;

7680 
±e
[
PTE_StCyl
] = 0;

7681 
±e
[
PTE_Sy¡em
] = 
sys
;

7682 
n
 = (
b_vŞ
 + 
sz_vŞ
) / (63 * 255);

7683 
±e
[
PTE_EdH—d
] = 254;

7684 
±e
[
PTE_EdSec
] = (
BYTE
)(
n
 >> 2 | 63);

7685 
±e
[
PTE_EdCyl
] = (
BYTE
)
n
;

7686 
	`¡_dwÜd
(
±e
 + 
PTE_StLba
, 
b_vŞ
);

7687 
	`¡_dwÜd
(
±e
 + 
PTE_SizLba
, 
sz_vŞ
);

7688 ià(
	`disk_wr™e
(
pdrv
, 
buf
, 0, 1è!ğ
RES_OK
)

7690  
FR_DISK_ERR
;

7695 ià(
	`disk_ioùl
(
pdrv
, 
CTRL_SYNC
, 0è!ğ
RES_OK
)

7697  
FR_DISK_ERR
;

7700  
FR_OK
;

7701 
	}
}

7705 #ià
_MULTI_PARTITION


7710 
FRESULT
 
	$f_fdisk
 (

7711 
BYTE
 
pdrv
,

7712 cÚ¡ 
DWORD
 *
szt
,

7713 *
wÜk


7716 
UINT
 
i
, 
n
, 
sz_cyl
, 
tÙ_cyl
, 
b_cyl
, 
e_cyl
, 
p_cyl
;

7717 
BYTE
 
s_hd
, 
e_hd
, *
p
, *
buf
 = (BYTE *)
wÜk
;

7718 
DSTATUS
 
¡©
;

7719 
DWORD
 
sz_disk
, 
sz_·¹
, 
s_·¹
;

7722 
¡©
 = 
	`disk_š™Ÿlize
(
pdrv
);

7723 ià(
¡©
 & 
STA_NOINIT
)

7725  
FR_NOT_READY
;

7727 ià(
¡©
 & 
STA_PROTECT
)

7729  
FR_WRITE_PROTECTED
;

7731 ià(
	`disk_ioùl
(
pdrv
, 
GET_SECTOR_COUNT
, &
sz_disk
))

7733  
FR_DISK_ERR
;

7737 
n
 = 16;‚ < 256 && 
sz_disk
 /‚ / 63 > 1024;‚ *= 2) ;

7738 ià(
n
 == 256)

7740 
n
--;

7742 
e_hd
 = 
n
 - 1;

7743 
sz_cyl
 = 63 * 
n
;

7744 
tÙ_cyl
 = 
sz_disk
 / 
sz_cyl
;

7747 
	`mem_£t
(
buf
, 0, 
_MAX_SS
);

7748 
p
 = 
buf
 + 
MBR_TabË
;

7749 
b_cyl
 = 0;

7750 
i
 = 0; i < 4; i++, 
p
 +ğ
SZ_PTE
)

7752 
p_cyl
 = (
szt
[
i
] <ğ100Uè? (
DWORD
)
tÙ_cyl
 * szt[i] / 100 : szt[i] / 
sz_cyl
;

7753 ià(!
p_cyl
)

7757 
s_·¹
 = (
DWORD
)
sz_cyl
 * 
b_cyl
;

7758 
sz_·¹
 = (
DWORD
)
sz_cyl
 * 
p_cyl
;

7759 ià(
i
 == 0)

7761 
s_hd
 = 1;

7762 
s_·¹
 += 63;

7763 
sz_·¹
 -= 63;

7767 
s_hd
 = 0;

7769 
e_cyl
 = 
b_cyl
 + 
p_cyl
 - 1;

7770 ià(
e_cyl
 >ğ
tÙ_cyl
)

7772  
FR_INVALID_PARAMETER
;

7776 
p
[1] = 
s_hd
;

7777 
p
[2] = (
BYTE
)((
b_cyl
 >> 2) + 1);

7778 
p
[3] = (
BYTE
)
b_cyl
;

7779 
p
[4] = 0x06;

7780 
p
[5] = 
e_hd
;

7781 
p
[6] = (
BYTE
)((
e_cyl
 >> 2) + 63);

7782 
p
[7] = (
BYTE
)
e_cyl
;

7783 
	`¡_dwÜd
(
p
 + 8, 
s_·¹
);

7784 
	`¡_dwÜd
(
p
 + 12, 
sz_·¹
);

7787 
b_cyl
 +ğ
p_cyl
;

7789 
	`¡_wÜd
(
p
, 0xAA55);

7792  (
	`disk_wr™e
(
pdrv
, 
buf
, 0, 1è!ğ
RES_OK
 || 
	`disk_ioùl
Õdrv, 
CTRL_SYNC
, 0è!ğRES_OKè? 
FR_DISK_ERR
 : 
FR_OK
;

7793 
	}
}

7801 #ià
_USE_STRFUNC


7806 
TCHAR
 *
	$f_g‘s
 (

7807 
TCHAR
 *
buff
,

7808 
Ën
,

7809 
FIL
 *
å


7812 
n
 = 0;

7813 
TCHAR
 
c
, *
p
 = 
buff
;

7814 
BYTE
 
s
[2];

7815 
UINT
 
rc
;

7818 
n
 < 
Ën
 - 1)

7820 #ià
_LFN_UNICODE


7821 #ià
_STRF_ENCODE
 == 3

7822 
	`f_»ad
(
å
, 
s
, 1, &
rc
);

7823 ià(
rc
 != 1)

7827 
c
 = 
s
[0];

7828 ià(
c
 >= 0x80)

7830 ià(
c
 < 0xC0)

7834 ià(
c
 < 0xE0)

7836 
	`f_»ad
(
å
, 
s
, 1, &
rc
);

7837 ià(
rc
 != 1)

7841 
c
 = (ø& 0x1Fè<< 6 | (
s
[0] & 0x3F);

7842 ià(
c
 < 0x80)

7844 
c
 = '?';

7849 ià(
c
 < 0xF0)

7851 
	`f_»ad
(
å
, 
s
, 2, &
rc
);

7852 ià(
rc
 != 2)

7856 
c
 = c << 12 | (
s
[0] & 0x3F) << 6 | (s[1] & 0x3F);

7857 ià(
c
 < 0x800)

7859 
c
 = '?';

7864 
c
 = '?';

7868 #–ià
_STRF_ENCODE
 == 2

7869 
	`f_»ad
(
å
, 
s
, 2, &
rc
);

7870 ià(
rc
 != 2)

7874 
c
 = 
s
[1] + (s[0] << 8);

7875 #–ià
_STRF_ENCODE
 == 1

7876 
	`f_»ad
(
å
, 
s
, 2, &
rc
);

7877 ià(
rc
 != 2)

7881 
c
 = 
s
[0] + (s[1] << 8);

7883 
	`f_»ad
(
å
, 
s
, 1, &
rc
);

7884 ià(
rc
 != 1)

7888 
c
 = 
s
[0];

7889 ià(
	`IsDBCS1
(
c
))

7891 
	`f_»ad
(
å
, 
s
, 1, &
rc
);

7892 ià(
rc
 != 1)

7896 
c
 = (ø<< 8è+ 
s
[0];

7898 
c
 = 
	`ff_cÚv”t
(c, 1);

7899 ià(!
c
)

7901 
c
 = '?';

7905 
	`f_»ad
(
å
, 
s
, 1, &
rc
);

7906 ià(
rc
 != 1)

7910 
c
 = 
s
[0];

7912 ià(
_USE_STRFUNC
 =ğ2 && 
c
 == '\r')

7916 *
p
++ = 
c
;

7917 
n
++;

7918 ià(
c
 == '\n')

7923 *
p
 = 0;

7924  
n
 ? 
buff
 : 0;

7925 
	}
}

7930 #ià!
_FS_READONLY


7931 
	~<¡d¬g.h
>

7938 
FIL
 *
	må
;

7939 
	midx
, 
	mnchr
;

7940 
BYTE
 
	mbuf
[64];

7941 } 
	tputbuff
;

7945 
	$putc_bfd
 (

7946 
putbuff
 *
pb
,

7947 
TCHAR
 
c


7950 
UINT
 
bw
;

7951 
i
;

7954 ià(
_USE_STRFUNC
 =ğ2 && 
c
 == '\n')

7956 
	`putc_bfd
(
pb
, '\r');

7959 
i
 = 
pb
->
idx
;

7960 ià(
i
 < 0)

7965 #ià
_LFN_UNICODE


7966 #ià
_STRF_ENCODE
 == 3

7967 ià(
c
 < 0x80)

7969 
pb
->
buf
[
i
++] = (
BYTE
)
c
;

7973 ià(
c
 < 0x800)

7975 
pb
->
buf
[
i
++] = (
BYTE
)(0xC0 | 
c
 >> 6);

7979 
pb
->
buf
[
i
++] = (
BYTE
)(0xE0 | 
c
 >> 12);

7980 
pb
->
buf
[
i
++] = (
BYTE
)(0x80 | (
c
 >> 6 & 0x3F));

7982 
pb
->
buf
[
i
++] = (
BYTE
)(0x80 | (
c
 & 0x3F));

7984 #–ià
_STRF_ENCODE
 == 2

7985 
pb
->
buf
[
i
++] = (
BYTE
)(
c
 >> 8);

7986 
pb
->
buf
[
i
++] = (
BYTE
)
c
;

7987 #–ià
_STRF_ENCODE
 == 1

7988 
pb
->
buf
[
i
++] = (
BYTE
)
c
;

7989 
pb
->
buf
[
i
++] = (
BYTE
)(
c
 >> 8);

7991 
c
 = 
	`ff_cÚv”t
(c, 0);

7992 ià(!
c
)

7994 
c
 = '?';

7996 ià(
c
 >= 0x100)

7998 
pb
->
buf
[
i
++] = (
BYTE
)(
c
 >> 8);

8000 
pb
->
buf
[
i
++] = (
BYTE
)
c
;

8003 
pb
->
buf
[
i
++] = (
BYTE
)
c
;

8006 ià(
i
 >ğ()( 
pb
->
buf
) - 3)

8008 
	`f_wr™e
(
pb
->
å
,…b->
buf
, (
UINT
)
i
, &
bw
);

8009 
i
 = (
bw
 =ğ(
UINT
)i) ? 0 : -1;

8011 
pb
->
idx
 = 
i
;

8012 
pb
->
nchr
++;

8013 
	}
}

8017 
	$putc_æush
 (

8018 
putbuff
 *
pb


8021 
UINT
 
nw
;

8023 iàĞ
pb
->
idx
 >= 0

8024 && 
	`f_wr™e
(
pb
->
å
,…b->
buf
, (
UINT
íb->
idx
, &
nw
è=ğ
FR_OK


8025 && (
UINT
)
pb
->
idx
 =ğ
nw
)

8027  
pb
->
nchr
;

8029  
EOF
;

8030 
	}
}

8034 
	$putc_š™
 (

8035 
putbuff
 *
pb
,

8036 
FIL
 *
å


8039 
pb
->
å
 = fp;

8040 
pb
->
nchr
 =…b->
idx
 = 0;

8041 
	}
}

8045 
	$f_putc
 (

8046 
TCHAR
 
c
,

8047 
FIL
 *
å


8050 
putbuff
 
pb
;

8053 
	`putc_š™
(&
pb
, 
å
);

8054 
	`putc_bfd
(&
pb
, 
c
);

8055  
	`putc_æush
(&
pb
);

8056 
	}
}

8065 
	$f_puts
 (

8066 cÚ¡ 
TCHAR
 *
¡r
,

8067 
FIL
 *
å


8070 
putbuff
 
pb
;

8073 
	`putc_š™
(&
pb
, 
å
);

8074 *
¡r
)

8076 
	`putc_bfd
(&
pb
, *
¡r
++);

8078  
	`putc_æush
(&
pb
);

8079 
	}
}

8088 
	$f_´štf
 (

8089 
FIL
 *
å
,

8090 cÚ¡ 
TCHAR
 *
fmt
,

8094 
va_li¡
 
¬p
;

8095 
putbuff
 
pb
;

8096 
BYTE
 
f
, 
r
;

8097 
UINT
 
i
, 
j
, 
w
;

8098 
DWORD
 
v
;

8099 
TCHAR
 
c
, 
d
, 
¡r
[32], *
p
;

8102 
	`putc_š™
(&
pb
, 
å
);

8104 
	`va_¡¬t
(
¬p
, 
fmt
);

8108 
c
 = *
fmt
++;

8109 ià(
c
 == 0)

8113 ià(
c
 != '%')

8115 
	`putc_bfd
(&
pb
, 
c
);

8118 
w
 = 
f
 = 0;

8119 
c
 = *
fmt
++;

8120 ià(
c
 == '0')

8122 
f
 = 1;

8123 
c
 = *
fmt
++;

8127 ià(
c
 == '-')

8129 
f
 = 2;

8130 
c
 = *
fmt
++;

8133 
	`IsDig™
(
c
))

8135 
w
 = w * 10 + 
c
 - '0';

8136 
c
 = *
fmt
++;

8138 ià(
c
 == 'l' || c == 'L')

8140 
f
 |= 4;

8141 
c
 = *
fmt
++;

8143 ià(!
c
)

8147 
d
 = 
c
;

8148 ià(
	`IsLow”
(
d
))

8150 
d
 -= 0x20;

8152 
d
)

8155 
p
 = 
	`va_¬g
(
¬p
, 
TCHAR
 *);

8156 
j
 = 0; 
p
[j]; j++) ;

8157 ià(!(
f
 & 2))

8159 
j
++ < 
w
)

8161 
	`putc_bfd
(&
pb
, ' ');

8164 *
p
)

8166 
	`putc_bfd
(&
pb
, *
p
++);

8168 
j
++ < 
w
)

8170 
	`putc_bfd
(&
pb
, ' ');

8174 
	`putc_bfd
(&
pb
, (
TCHAR
)
	`va_¬g
(
¬p
, ));

8177 
r
 = 2;

8180 
r
 = 8;

8184 
r
 = 10;

8187 
r
 = 16;

8190 
	`putc_bfd
(&
pb
, 
c
);

8195 
v
 = (
f
 & 4è? (
DWORD
)
	`va_¬g
(
¬p
, è: ((
d
 == 'D') ? (DWORD)()va_arg(arp, ) : (DWORD)va_arg(arp, ));

8196 ià(
d
 =ğ'D' && (
v
 & 0x80000000))

8198 
v
 = 0 - v;

8199 
f
 |= 8;

8201 
i
 = 0;

8204 
d
 = (
TCHAR
)(
v
 % 
r
);

8205 
v
 /ğ
r
;

8206 ià(
d
 > 9)

8208 
d
 +ğ(
c
 == 'x') ? 0x27 : 0x07;

8210 
¡r
[
i
++] = 
d
 + '0';

8212 
v
 && 
i
 <  
¡r
 /  str[0]);

8213 ià(
f
 & 8)

8215 
¡r
[
i
++] = '-';

8217 
j
 = 
i
;

8218 
d
 = (
f
 & 1) ? '0' : ' ';

8219 !(
f
 & 2è&& 
j
++ < 
w
)

8221 
	`putc_bfd
(&
pb
, 
d
);

8225 
	`putc_bfd
(&
pb
, 
¡r
[--
i
]);

8227 
i
);

8228 
j
++ < 
w
)

8230 
	`putc_bfd
(&
pb
, 
d
);

8234 
	`va_’d
(
¬p
);

8236  
	`putc_æush
(&
pb
);

8237 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\ff_ex.c

8 
	~"ff.h
"

10 
	$f_g‘c
 (

11 
FIL
 *
å


14 
BYTE
 
c
;

15 
UINT
 
rc
;

16 
	`f_»ad
(
å
, &
c
, 1, &
rc
);

17 ià(
rc
 != 1 ||„c < 1)

19  
EOF
;

21  
c
;

22 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\ffconf.h

5 
	#_FFCONF
 68020

	)

11 
	#_FS_READONLY
 0

	)

18 
	#_FS_MINIMIZE
 0

	)

28 
	#_USE_STRFUNC
 1

29 

	)

37 
	#_USE_FIND
 0

	)

42 
	#_USE_MKFS
 1

43 

	)

46 
	#_USE_FASTSEEK
 1

47 

	)

50 
	#_USE_EXPAND
 0

	)

54 
	#_USE_CHMOD
 0

	)

59 
	#_USE_LABEL
 1

60 

	)

64 
	#_USE_FORWARD
 0

	)

72 
	#_CODE_PAGE
 936

73 

	)

101 
	#_USE_LFN
 3

102 
	#_MAX_LFN
 255

	)

119 
	#_LFN_UNICODE
 0

	)

125 
	#_STRF_ENCODE
 3

	)

137 
	#_FS_RPATH
 0

	)

150 
	#_VOLUMES
 2

151 

	)

154 
	#_STR_VOLUME_ID
 0

	)

155 
	#_VOLUME_STRS
 "RAM","NAND","CF","SD","SD2","USB","USB2","USB3"

	)

163 
	#_MULTI_PARTITION
 0

	)

172 
	#_MIN_SS
 512

	)

173 
	#_MAX_SS
 512

	)

182 
	#_USE_TRIM
 0

	)

188 
	#_FS_NOFSINFO
 0

	)

205 
	#_FS_TINY
 0

	)

212 
	#_FS_EXFAT
 1

213 

	)

218 
	#_FS_NORTC
 0

	)

219 
	#_NORTC_MON
 1

	)

220 
	#_NORTC_MDAY
 1

	)

221 
	#_NORTC_YEAR
 2016

	)

232 
	#_FS_LOCK
 1

	)

244 
	#_FS_REENTRANT
 1

	)

245 
	#_FS_TIMEOUT
 1000

	)

246 
	#_SYNC_t
 
xSem­hÜeHªdË


247 

	)

264 #ià
_FS_REENTRANT


265 
	~"F»eRTOS.h
"

266 
	~"£mphr.h
"

	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\option\syscall.c

6 
	~<¡dlib.h
>

7 
	~"../ff.h
"

9 #ià
_FS_REENTRANT


18 
	$ff_üe_syncobj
 (

19 
BYTE
 
vŞ
,

20 
_SYNC_t
 *
sobj


23 
»t
;

35 *
sobj
 = 
	`xSem­hÜeC»©eMu‹x
();

36 
»t
 = ()(*
sobj
 !ğ
NULL
);

38  
»t
;

39 
	}
}

51 
	$ff_d–_syncobj
 (

52 
_SYNC_t
 
sobj


55 
»t
;

65 
	`vSem­hÜeD–‘e
(
sobj
);

66 
»t
 = 1;

68  
»t
;

69 
	}
}

80 
	$ff_»q_g¿Á
 (

81 
_SYNC_t
 
sobj


84 
»t
;

93 
»t
 = ()(
	`xSem­hÜeTake
(
sobj
, 
_FS_TIMEOUT
è=ğ
pdTRUE
);

95  
»t
;

96 
	}
}

106 
	$ff_»l_g¿Á
 (

107 
_SYNC_t
 
sobj


116 
	`xSem­hÜeGive
(
sobj
);

117 
	}
}

124 #ià
_USE_LFN
 == 3

131 * 
	$ff_mem®loc
 (

132 
UINT
 
msize


135  
	`m®loc
(
msize
);

136 
	}
}

143 
	$ff_memä“
 (

144 * 
mblock


147 
	`ä“
(
mblock
);

148 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\option\unicode.c

1 
	~"../ff.h
"

3 #ià
_USE_LFN
 != 0

5 #ià 
_CODE_PAGE
 == 932

6 
	~"cc932.c
"

7 #–ià
_CODE_PAGE
 == 936

8 
	~"cc936.c
"

9 #–ià
_CODE_PAGE
 == 949

10 
	~"cc949.c
"

11 #–ià
_CODE_PAGE
 == 950

12 
	~"cc950.c
"

14 
	~"ccsbcs.c
"

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-attr.c

21 
	~"cÚfig.h
"

22 
	~"mxml.h
"

29 
mxml_£t_©Œ
(
mxml_node_t
 *
node
, cÚ¡ *
Çme
,

30 *
v®ue
);

40 
	$mxmlEËm’tD–‘eA‰r
(
mxml_node_t
 *
node
,

41 cÚ¡ *
Çme
)

43 
i
;

44 
mxml_©Œ_t
 *
©Œ
;

47 #ifdeà
DEBUG


48 
	`årštf
(
¡d”r
, "mxmlElementDeleteAttr(node=%p,‚ame=\"%s\")\n",

49 
node
, 
Çme
 ?‚ame : "(null)");

56 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
 || !
Çme
)

63 
i
 = 
node
->
v®ue
.
–em’t
.
num_©Œs
, 
©Œ
 =‚ode->v®ue.–em’t.
©Œs
;

64 
i
 > 0;

65 
i
 --, 
©Œ
 ++)

67 #ifdeà
DEBUG


68 
	`´štf
(" %s=\"%s\"\n", 
©Œ
->
Çme
,‡‰r->
v®ue
);

71 ià(!
	`¡rcmp
(
©Œ
->
Çme
,‚ame))

77 
	`ä“
(
©Œ
->
Çme
);

78 
	`ä“
(
©Œ
->
v®ue
);

80 
i
 --;

81 ià(
i
 > 0)

82 
	`memmove
(
©Œ
,‡‰¸+ 1, 
i
 * (
mxml_©Œ_t
));

84 
node
->
v®ue
.
–em’t
.
num_©Œs
 --;

86 ià(
node
->
v®ue
.
–em’t
.
num_©Œs
 == 0)

87 
	`ä“
(
node
->
v®ue
.
–em’t
.
©Œs
);

91 
	}
}

102 
	$mxmlEËm’tG‘A‰r
(
mxml_node_t
 *
node
,

103 cÚ¡ *
Çme
)

105 
i
;

106 
mxml_©Œ_t
 *
©Œ
;

109 #ifdeà
DEBUG


110 
	`årštf
(
¡d”r
, "mxmlElementGetAttr(node=%p,‚ame=\"%s\")\n",

111 
node
, 
Çme
 ?‚ame : "(null)");

118 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
 || !
Çme
)

119  (
NULL
);

125 
i
 = 
node
->
v®ue
.
–em’t
.
num_©Œs
, 
©Œ
 =‚ode->v®ue.–em’t.
©Œs
;

126 
i
 > 0;

127 
i
 --, 
©Œ
 ++)

129 #ifdeà
DEBUG


130 
	`´štf
(" %s=\"%s\"\n", 
©Œ
->
Çme
,‡‰r->
v®ue
);

133 ià(!
	`¡rcmp
(
©Œ
->
Çme
,‚ame))

135 #ifdeà
DEBUG


136 
	`´štf
(" R‘uºšg \"%s\"!\n", 
©Œ
->
v®ue
);

138  (
©Œ
->
v®ue
);

146 #ifdeà
DEBUG


147 
	`puts
(" Returning NULL!\n");

150  (
NULL
);

151 
	}
}

164 
	$mxmlEËm’tS‘A‰r
(
mxml_node_t
 *
node
,

165 cÚ¡ *
Çme
,

166 cÚ¡ *
v®ue
)

168 *
v®uec
;

171 #ifdeà
DEBUG


172 
	`årštf
(
¡d”r
, "mxmlElementSetAttr(node=%p,‚ame=\"%s\", value=\"%s\")\n",

173 
node
, 
Çme
 ?‚am: "ÒuÎ)", 
v®ue
 ? value : "(null)");

180 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
 || !
Çme
)

183 ià(
v®ue
)

184 
v®uec
 = 
	`¡rdup
(
v®ue
);

186 
v®uec
 = 
NULL
;

188 ià(
	`mxml_£t_©Œ
(
node
, 
Çme
, 
v®uec
))

189 
	`ä“
(
v®uec
);

190 
	}
}

205 
	$mxmlEËm’tS‘A‰rf
(
mxml_node_t
 *
node
,

206 cÚ¡ *
Çme
,

207 cÚ¡ *
fÜm©
,

210 
va_li¡
 
­
;

211 *
v®ue
;

214 #ifdeà
DEBUG


215 
	`årštf
(
¡d”r
,

217 
node
, 
Çme
 ?‚am: "ÒuÎ)", 
fÜm©
 ? format : "(null)");

224 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
 || !
Çme
 || !
fÜm©
)

231 
	`va_¡¬t
(
­
, 
fÜm©
);

232 
v®ue
 = 
	`_mxml_v¡rdupf
(
fÜm©
, 
­
);

233 
	`va_’d
(
­
);

235 ià(!
v®ue
)

236 
	`mxml_”rÜ
("Unableo‡llocate memory for‡ttribute '%s' inƒlement %s!",

237 
Çme
, 
node
->
v®ue
.
–em’t
.name);

238 ià(
	`mxml_£t_©Œ
(
node
, 
Çme
, 
v®ue
))

239 
	`ä“
(
v®ue
);

240 
	}
}

248 
	$mxml_£t_©Œ
(
mxml_node_t
 *
node
,

249 cÚ¡ *
Çme
,

250 *
v®ue
)

252 
i
;

253 
mxml_©Œ_t
 *
©Œ
;

260 
i
 = 
node
->
v®ue
.
–em’t
.
num_©Œs
, 
©Œ
 =‚ode->v®ue.–em’t.
©Œs
;

261 
i
 > 0;

262 
i
 --, 
©Œ
 ++)

263 ià(!
	`¡rcmp
(
©Œ
->
Çme
,‚ame))

269 ià(
©Œ
->
v®ue
)

270 
	`ä“
(
©Œ
->
v®ue
);

272 
©Œ
->
v®ue
 = value;

281 ià(
node
->
v®ue
.
–em’t
.
num_©Œs
 == 0)

282 
©Œ
 = 
	`m®loc
((
mxml_©Œ_t
));

284 
©Œ
 = 
	`»®loc
(
node
->
v®ue
.
–em’t
.
©Œs
,

285 (
node
->
v®ue
.
–em’t
.
num_©Œs
 + 1è* (
mxml_©Œ_t
));

287 ià(!
©Œ
)

289 
	`mxml_”rÜ
("Unableo‡llocate memory for‡ttribute '%s' inƒlement %s!",

290 
Çme
, 
node
->
v®ue
.
–em’t
.name);

294 
node
->
v®ue
.
–em’t
.
©Œs
 = 
©Œ
;

295 
©Œ
 +ğ
node
->
v®ue
.
–em’t
.
num_©Œs
;

297 ià((
©Œ
->
Çme
 = 
	`¡rdup
Òame)è=ğ
NULL
)

299 
	`mxml_”rÜ
("Unableo‡llocate memory for‡ttribute '%s' inƒlement %s!",

300 
Çme
, 
node
->
v®ue
.
–em’t
.name);

304 
©Œ
->
v®ue
 = value;

306 
node
->
v®ue
.
–em’t
.
num_©Œs
 ++;

309 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-cb.c

1 
	~"cÚfig.h
"

2 
	~"mxml.h
"

4 
ev’t_couÁs
[6];

10 
	$§x_cb
(
mxml_node_t
 *
node
,

11 
mxml_§x_ev’t_t
 
ev’t
,

12 *
d©a
)

14 cÚ¡ * cÚ¡ 
ev’ts
[] =

29 ià(!
node
)

30 
	`årštf
(
¡d”r
, "ERROR: SAX c®lback fÜƒv’ˆ% ha NULL‚ode.\n", 
ev’ts
[
ev’t
]);

32 
ev’t_couÁs
[
ev’t
] ++;

33 
	}
}

40 
mxml_ty³_t


41 
	$ty³_cb
(
mxml_node_t
 *
node
)

43 cÚ¡ *
ty³
;

50 ià((
ty³
 = 
	`mxmlEËm’tG‘A‰r
(
node
, "ty³")è=ğ
NULL
)

51 
ty³
 = 
node
->
v®ue
.
–em’t
.
Çme
;

53 ià(!
	`¡rcmp
(
ty³
, "integer"))

54  (
MXML_INTEGER
);

55 ià(!
	`¡rcmp
(
ty³
, "opaque") || !strcmp(type, "pre"))

56  (
MXML_OPAQUE
);

57 ià(!
	`¡rcmp
(
ty³
, "real"))

58  (
MXML_REAL
);

60  (
MXML_TEXT
);

61 
	}
}

70 
	$wh™e¥aû_cb
(
mxml_node_t
 *
node
,

71 
wh”e
)

73 
mxml_node_t
 *
·»Á
;

74 
Ëv–
;

75 cÚ¡ *
Çme
;

76 cÚ¡ *
bs
 = "\t\t\t\t\t\t\t\t";

85 
Çme
 = 
node
->
v®ue
.
–em’t
.name;

87 ià(!
	`¡rcmp
(
Çme
, "html") || !strcmp(name, "head") || !strcmp(name, "body") ||

88 !
	`¡rcmp
(
Çme
, "pre") || !strcmp(name, "p") ||

89 !
	`¡rcmp
(
Çme
, "h1") || !strcmp(name, "h2") || !strcmp(name, "h3") ||

90 !
	`¡rcmp
(
Çme
, "h4") || !strcmp(name, "h5") || !strcmp(name, "h6"))

96 ià(
wh”e
 =ğ
MXML_WS_BEFORE_OPEN
 || wh”=ğ
MXML_WS_AFTER_CLOSE
)

99 ià(!
	`¡rcmp
(
Çme
, "dl") || !strcmp(name, "ol") || !strcmp(name, "ul"))

107 ià(!
	`¡rcmp
(
Çme
, "dd") || !strcmp(name, "dt") || !strcmp(name, "li"))

113 ià(
wh”e
 =ğ
MXML_WS_BEFORE_OPEN
)

115 ià(
wh”e
 =ğ
MXML_WS_AFTER_CLOSE
)

118 ià(!
	`¡ºcmp
(
Çme
, "?xml", 4))

120 ià(
wh”e
 =ğ
MXML_WS_AFTER_OPEN
)

123  (
NULL
);

125 ià(
wh”e
 =ğ
MXML_WS_BEFORE_OPEN
 ||

126 ((!
	`¡rcmp
(
Çme
, "choice") || !strcmp(name, "option")) &&

127 
wh”e
 =ğ
MXML_WS_BEFORE_CLOSE
))

129 
Ëv–
 = -1, 
·»Á
 = 
node
->parent;

130 
·»Á
;

131 
Ëv–
 ++, 
·»Á
 =…arent->parent);

133 ià(
Ëv–
 > 8)

134 
Ëv–
 = 8;

135 ià(
Ëv–
 < 0)

136 
Ëv–
 = 0;

138  (
bs
 + 8 - 
Ëv–
);

140 ià(
wh”e
 =ğ
MXML_WS_AFTER_CLOSE
 ||

141 ((!
	`¡rcmp
(
Çme
, "group") || !strcmp(name, "option") ||

142 !
	`¡rcmp
(
Çme
, "choice")) &&

143 
wh”e
 =ğ
MXML_WS_AFTER_OPEN
))

145 ià(
wh”e
 =ğ
MXML_WS_AFTER_OPEN
 && !
node
->
chd
)

152  (
NULL
);

153 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-entity.c

22 
	~"mxml-´iv©e.h
"

30 
	$mxmlEÁ™yAddC®lback
(

31 
mxml_’t™y_cb_t
 
cb
)

33 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

37 ià(
glob®
->
num_’t™y_cbs
 < ()((glob®->
’t™y_cbs
) / (global->entity_cbs[0])))

39 
glob®
->
’t™y_cbs
[glob®->
num_’t™y_cbs
] = 
cb
;

40 
glob®
->
num_’t™y_cbs
 ++;

46 
	`mxml_”rÜ
("Unableo‡ddƒntity callback!");

50 
	}
}

60 
	$mxmlEÁ™yG‘Name
(
v®
)

62 
v®
)

77  (
NULL
);

79 
	}
}

90 
	$mxmlEÁ™yG‘V®ue
(cÚ¡ *
Çme
)

92 
i
;

93 
ch
;

94 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

98 
i
 = 0; i < 
glob®
->
num_’t™y_cbs
; i ++)

99 ià((
ch
 = (
glob®
->
’t™y_cbs
[
i
])(
Çme
)) >= 0)

100  (
ch
);

103 
	}
}

111 
	$mxmlEÁ™yRemoveC®lback
(

112 
mxml_’t™y_cb_t
 
cb
)

114 
i
;

115 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

119 
i
 = 0; i < 
glob®
->
num_’t™y_cbs
; i ++)

120 ià(
cb
 =ğ
glob®
->
’t™y_cbs
[
i
])

126 
glob®
->
num_’t™y_cbs
 --;

128 ià(
i
 < 
glob®
->
num_’t™y_cbs
)

129 
	`memmove
(
glob®
->
’t™y_cbs
 + 
i
, global->entity_cbs + i + 1,

130 (
glob®
->
num_’t™y_cbs
 - 
i
è* (glob®->
’t™y_cbs
[0]));

134 
	}
}

142 
	$_mxml_’t™y_cb
(cÚ¡ *
Çme
)

144 
diff
,

145 
cu¼’t
,

146 
fœ¡
,

147 
Ï¡
;

150 cÚ¡ *
Çme
;

151 
v®
;

152 } 
’t™›s
[] =

418 
fœ¡
 = 0;

419 
Ï¡
 = ()((
’t™›s
) / (entities[0]) - 1);

421 (
Ï¡
 - 
fœ¡
) > 1)

423 
cu¼’t
 = (
fœ¡
 + 
Ï¡
) / 2;

425 ià((
diff
 = 
	`¡rcmp
(
Çme
, 
’t™›s
[
cu¼’t
].name)) == 0)

426  (
’t™›s
[
cu¼’t
].
v®
);

427 ià(
diff
 < 0)

428 
Ï¡
 = 
cu¼’t
;

430 
fœ¡
 = 
cu¼’t
;

438 ià(!
	`¡rcmp
(
Çme
, 
’t™›s
[
fœ¡
].name))

439  (
’t™›s
[
fœ¡
].
v®
);

440 ià(!
	`¡rcmp
(
Çme
, 
’t™›s
[
Ï¡
].name))

441  (
’t™›s
[
Ï¡
].
v®
);

444 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-file-fatfs.c

21 
	~"ff.h
"

22 
	~"ff_ex.h
"

23 
	~"mxml-´iv©e.h
"

26 
	#FILE
 
FIL


	)

27 
	#g‘c
 
f_g‘c


	)

28 
	#putc
 
f_putc


	)

35 
	#ENCODE_UTF8
 0

	)

36 
	#ENCODE_UTF16BE
 1

	)

37 
	#ENCODE_UTF16LE
 2

	)

44 
	#mxml_bad_ch¬
(
ch
è((chè< ' ' && (chè!ğ'\n' && (chè!ğ'\r' && (chè!ğ'\t')

	)

51 (*
	t_mxml_g‘c_cb_t
)(*, *);

52 (*
	t_mxml_putc_cb_t
)(, *);

59 
	`mxml_add_ch¬
(
ch
, **
±r
, **
bufãr
,

60 *
bufsize
);

61 
	`mxml_fe_g‘c
(*
p
, *
’codšg
);

62 
	`mxml_fe_putc
(
ch
, *
p
);

63 
	`mxml_g‘_’t™y
(
mxml_node_t
 *
·»Á
, *
p
,

64 *
’codšg
,

65 
_mxml_g‘c_cb_t
 
g‘c_cb
);

66 
šlše
 
	$mxml_is¥aû
(
ch
)

68  (
ch
 == ' ' || ch == '\t' || ch == '\r' ||

69 
ch
 == '\n');

70 
	}
}

71 
mxml_node_t
 *
mxml_lßd_d©a
(mxml_node_ˆ*
tİ
, *
p
,

72 
mxml_lßd_cb_t
 
cb
,

73 
_mxml_g‘c_cb_t
 
g‘c_cb
,

74 
mxml_§x_cb_t
 
§x_cb
, *
§x_d©a
);

75 
mxml_·r£_–em’t
(
mxml_node_t
 *
node
, *
p
,

76 *
’codšg
,

77 
_mxml_g‘c_cb_t
 
g‘c_cb
);

78 
mxml_¡ršg_g‘c
(*
p
, *
’codšg
);

79 
mxml_¡ršg_putc
(
ch
, *
p
);

80 
mxml_wr™e_Çme
(cÚ¡ *
s
, *
p
,

81 
_mxml_putc_cb_t
 
putc_cb
);

82 
mxml_wr™e_node
(
mxml_node_t
 *
node
, *
p
,

83 
mxml_§ve_cb_t
 
cb
, 
cŞ
,

84 
_mxml_putc_cb_t
 
putc_cb
,

85 
_mxml_glob®_t
 *
glob®
);

86 
mxml_wr™e_¡ršg
(cÚ¡ *
s
, *
p
,

87 
_mxml_putc_cb_t
 
putc_cb
);

88 
mxml_wr™e_ws
(
mxml_node_t
 *
node
, *
p
,

89 
mxml_§ve_cb_t
 
cb
, 
ws
,

90 
cŞ
, 
_mxml_putc_cb_t
 
putc_cb
);

109 
mxml_node_t
 *

110 
	$mxmlLßdFe
(
mxml_node_t
 *
tİ
,

111 
FILE
 *
å
,

112 
mxml_lßd_cb_t
 
cb
)

118  (
	`mxml_lßd_d©a
(
tİ
, 
å
, 
cb
, 
mxml_fe_g‘c
, 
MXML_NO_CALLBACK
, 
NULL
));

119 
	}
}

137 
mxml_node_t
 *

138 
	$mxmlLßdSŒšg
(
mxml_node_t
 *
tİ
,

139 cÚ¡ *
s
,

140 
mxml_lßd_cb_t
 
cb
)

146  (
	`mxml_lßd_d©a
(
tİ
, (*)&
s
, 
cb
, 
mxml_¡ršg_g‘c
, 
MXML_NO_CALLBACK
,

147 
NULL
));

148 
	}
}

168 
	$mxmlSaveAÎocSŒšg
(

169 
mxml_node_t
 *
node
,

170 
mxml_§ve_cb_t
 
cb
)

172 
by‹s
;

173 
bufãr
[8192];

174 *
s
;

181 
by‹s
 = 
	`mxmlSaveSŒšg
(
node
, 
bufãr
, (bufãr), 
cb
);

183 ià(
by‹s
 <= 0)

184  (
NULL
);

186 ià(
by‹s
 < ()((
bufãr
) - 1))

193  (
	`¡rdup
(
bufãr
));

201 ià((
s
 = 
	`m®loc
(
by‹s
 + 1)è=ğ
NULL
)

202  (
NULL
);

204 
	`mxmlSaveSŒšg
(
node
, 
s
, 
by‹s
 + 1, 
cb
);

210  (
s
);

211 
	}
}

225 
	$mxmlSaveFe
(
mxml_node_t
 *
node
,

226 
FILE
 *
å
,

227 
mxml_§ve_cb_t
 
cb
)

229 
cŞ
;

230 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

238 ià((
cŞ
 = 
	`mxml_wr™e_node
(
node
, 
å
, 
cb
, 0, 
mxml_fe_putc
, 
glob®
)) < 0)

241 ià(
cŞ
 > 0)

242 ià(
	`putc
('\n', 
å
) < 0)

250 
	}
}

268 
	$mxmlSaveSŒšg
(
mxml_node_t
 *
node
,

269 *
bufãr
,

270 
bufsize
,

271 
mxml_§ve_cb_t
 
cb
)

273 
cŞ
;

274 *
±r
[2];

275 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

283 
±r
[0] = 
bufãr
;

284 
±r
[1] = 
bufãr
 + 
bufsize
;

286 ià((
cŞ
 = 
	`mxml_wr™e_node
(
node
, 
±r
, 
cb
, 0, 
mxml_¡ršg_putc
, 
glob®
)) < 0)

289 ià(
cŞ
 > 0)

290 
	`mxml_¡ršg_putc
('\n', 
±r
);

296 ià(
±r
[0] >=…tr[1])

297 
bufãr
[
bufsize
 - 1] = '\0';

299 
±r
[0][0] = '\0';

305  (
±r
[0] - 
bufãr
);

306 
	}
}

331 
mxml_node_t
 *

332 
	$mxmlSAXLßdFe
(

333 
mxml_node_t
 *
tİ
,

334 
FILE
 *
å
,

335 
mxml_lßd_cb_t
 
cb
,

336 
mxml_§x_cb_t
 
§x_cb
,

337 *
§x_d©a
)

343  (
	`mxml_lßd_d©a
(
tİ
, 
å
, 
cb
, 
mxml_fe_g‘c
, 
§x_cb
, 
§x_d©a
));

344 
	}
}

369 
mxml_node_t
 *

370 
	$mxmlSAXLßdSŒšg
(

371 
mxml_node_t
 *
tİ
,

372 cÚ¡ *
s
,

373 
mxml_lßd_cb_t
 
cb
,

374 
mxml_§x_cb_t
 
§x_cb
,

375 *
§x_d©a
)

381  (
	`mxml_lßd_d©a
(
tİ
, (*)&
s
, 
cb
, 
mxml_¡ršg_g‘c
, 
§x_cb
, 
§x_d©a
));

382 
	}
}

397 
	$mxmlS‘Cu¡omHªdËrs
(

398 
mxml_cu¡om_lßd_cb_t
 
lßd
,

399 
mxml_cu¡om_§ve_cb_t
 
§ve
)

401 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

405 
glob®
->
cu¡om_lßd_cb
 = 
lßd
;

406 
glob®
->
cu¡om_§ve_cb
 = 
§ve
;

407 
	}
}

415 
	$mxmlS‘E¼ÜC®lback
(
mxml_”rÜ_cb_t
 
cb
)

417 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

421 
glob®
->
”rÜ_cb
 = 
cb
;

422 
	}
}

434 
	$mxmlS‘W¿pM¬gš
(
cŞumn
)

436 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

440 
glob®
->
w¿p
 = 
cŞumn
;

441 
	}
}

449 
	$mxml_add_ch¬
(
ch
,

450 **
buåŒ
,

451 **
bufãr
,

452 *
bufsize
)

454 *
Ãwbufãr
;

457 ià(*
buåŒ
 >ğ(*
bufãr
 + *
bufsize
 - 4))

463 ià(*
bufsize
 < 1024)

464 (*
bufsize
) *= 2;

466 (*
bufsize
) += 1024;

468 ià((
Ãwbufãr
 = 
	`»®loc
(*
bufãr
, *
bufsize
)è=ğ
NULL
)

470 
	`ä“
(*
bufãr
);

472 
	`mxml_”rÜ
("UÇbËØex·nd sŒšg bufã¸tØ%d by‹s!", *
bufsize
);

477 *
buåŒ
 = 
Ãwbufãr
 + (*buåŒ - *
bufãr
);

478 *
bufãr
 = 
Ãwbufãr
;

481 ià(
ch
 < 0x80)

487 *(*
buåŒ
)++ = 
ch
;

489 ià(
ch
 < 0x800)

495 *(*
buåŒ
)++ = 0xc0 | (
ch
 >> 6);

496 *(*
buåŒ
)++ = 0x80 | (
ch
 & 0x3f);

498 ià(
ch
 < 0x10000)

504 *(*
buåŒ
)++ = 0xe0 | (
ch
 >> 12);

505 *(*
buåŒ
)++ = 0x80 | ((
ch
 >> 6) & 0x3f);

506 *(*
buåŒ
)++ = 0x80 | (
ch
 & 0x3f);

514 *(*
buåŒ
)++ = 0xf0 | (
ch
 >> 18);

515 *(*
buåŒ
)++ = 0x80 | ((
ch
 >> 12) & 0x3f);

516 *(*
buåŒ
)++ = 0x80 | ((
ch
 >> 6) & 0x3f);

517 *(*
buåŒ
)++ = 0x80 | (
ch
 & 0x3f);

521 
	}
}

529 
	$mxml_fe_g‘c
(*
p
,

530 *
’codšg
)

532 
ch
,

533 
‹mp
;

534 
FILE
 *
å
;

541 
å
 = (
FILE
 *)
p
;

542 
ch
 = 
	`g‘c
(
å
);

544 ià(
ch
 =ğ
EOF
)

545  (
EOF
);

547 *
’codšg
)

549 
ENCODE_UTF8
 :

554 ià(!(
ch
 & 0x80))

556 ià(
	`mxml_bad_ch¬
(
ch
))

558 
	`mxml_”rÜ
("Bad control character 0x%02x‚ot‡llowed by XML standard!",

559 
ch
);

560  (
EOF
);

563 #ià
DEBUG
 > 1

564 
	`´štf
("mxml_fe_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

567  (
ch
);

569 ià(
ch
 == 0xfe)

575 
ch
 = 
	`g‘c
(
å
);

576 ià(
ch
 != 0xff)

577  (
EOF
);

579 *
’codšg
 = 
ENCODE_UTF16BE
;

581  (
	`mxml_fe_g‘c
(
p
, 
’codšg
));

583 ià(
ch
 == 0xff)

589 
ch
 = 
	`g‘c
(
å
);

590 ià(
ch
 != 0xfe)

591  (
EOF
);

593 *
’codšg
 = 
ENCODE_UTF16LE
;

595  (
	`mxml_fe_g‘c
(
p
, 
’codšg
));

597 ià((
ch
 & 0xe0) == 0xc0)

603 ià((
‹mp
 = 
	`g‘c
(
å
)è=ğ
EOF
 || (temp & 0xc0) != 0x80)

604  (
EOF
);

606 
ch
 = ((ch & 0x1fè<< 6è| (
‹mp
 & 0x3f);

608 ià(
ch
 < 0x80)

610 
	`mxml_”rÜ
("Inv®id UTF-8 sequ’û fÜ ch¬aù” 0x%04x!", 
ch
);

611  (
EOF
);

614 ià((
ch
 & 0xf0) == 0xe0)

620 ià((
‹mp
 = 
	`g‘c
(
å
)è=ğ
EOF
 || (temp & 0xc0) != 0x80)

621  (
EOF
);

623 
ch
 = ((ch & 0x0fè<< 6è| (
‹mp
 & 0x3f);

625 ià((
‹mp
 = 
	`g‘c
(
å
)è=ğ
EOF
 || (temp & 0xc0) != 0x80)

626  (
EOF
);

628 
ch
 = (ch << 6è| (
‹mp
 & 0x3f);

630 ià(
ch
 < 0x800)

632 
	`mxml_”rÜ
("Inv®id UTF-8 sequ’û fÜ ch¬aù” 0x%04x!", 
ch
);

633  (
EOF
);

640 ià(
ch
 == 0xfeff)

641  (
	`mxml_fe_g‘c
(
p
, 
’codšg
));

643 ià((
ch
 & 0xf8) == 0xf0)

649 ià((
‹mp
 = 
	`g‘c
(
å
)è=ğ
EOF
 || (temp & 0xc0) != 0x80)

650  (
EOF
);

652 
ch
 = ((ch & 0x07è<< 6è| (
‹mp
 & 0x3f);

654 ià((
‹mp
 = 
	`g‘c
(
å
)è=ğ
EOF
 || (temp & 0xc0) != 0x80)

655  (
EOF
);

657 
ch
 = (ch << 6è| (
‹mp
 & 0x3f);

659 ià((
‹mp
 = 
	`g‘c
(
å
)è=ğ
EOF
 || (temp & 0xc0) != 0x80)

660  (
EOF
);

662 
ch
 = (ch << 6è| (
‹mp
 & 0x3f);

664 ià(
ch
 < 0x10000)

666 
	`mxml_”rÜ
("Inv®id UTF-8 sequ’û fÜ ch¬aù” 0x%04x!", 
ch
);

667  (
EOF
);

671  (
EOF
);

674 
ENCODE_UTF16BE
 :

679 
ch
 = (ch << 8è| 
	`g‘c
(
å
);

681 ià(
	`mxml_bad_ch¬
(
ch
))

683 
	`mxml_”rÜ
("Bad control character 0x%02x‚ot‡llowed by XML standard!",

684 
ch
);

685  (
EOF
);

687 ià(
ch
 >= 0xd800 && ch <= 0xdbff)

693 
lch
 = 
	`g‘c
(
å
);

694 
lch
 = (lch << 8è| 
	`g‘c
(
å
);

696 ià(
lch
 < 0xdc00 ||†ch >= 0xdfff)

697  (
EOF
);

699 
ch
 = (((ch & 0x3ffè<< 10è| (
lch
 & 0x3ff)) + 0x10000;

703 
ENCODE_UTF16LE
 :

708 
ch
 |ğ(
	`g‘c
(
å
) << 8);

710 ià(
	`mxml_bad_ch¬
(
ch
))

712 
	`mxml_”rÜ
("Bad control character 0x%02x‚ot‡llowed by XML standard!",

713 
ch
);

714  (
EOF
);

716 ià(
ch
 >= 0xd800 && ch <= 0xdbff)

722 
lch
 = 
	`g‘c
(
å
);

723 
lch
 |ğ(
	`g‘c
(
å
) << 8);

725 ià(
lch
 < 0xdc00 ||†ch >= 0xdfff)

726  (
EOF
);

728 
ch
 = (((ch & 0x3ffè<< 10è| (
lch
 & 0x3ff)) + 0x10000;

733 #ià
DEBUG
 > 1

734 
	`´štf
("mxml_fe_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

737  (
ch
);

738 
	}
}

746 
	$mxml_fe_putc
(
ch
,

747 *
p
)

749  (
	`putc
(
ch
, (
FILE
 *)
p
è=ğ
EOF
 ? -1 : 0);

750 
	}
}

758 
mxml_g‘_’t™y
(
mxml_node_t
 *
·»Á
,

759 *
p
,

760 *
’codšg
,

761 (*
g‘c_cb
)(*, *))

764 
ch
;

765 
’t™y
[64],

766 *
’Œ
;

769 
’Œ
 = 
’t™y
;

771 (
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
)è!ğ
EOF
)

772 ià(
ch
 > 126 || (!
	`i§Êum
(ch) && ch != '#'))

774 ià(
’Œ
 < (
’t™y
 + (entity) - 1))

775 *
’Œ
++ = 
ch
;

778 
	`mxml_”rÜ
("Entity‚ameoo†ong under…arent <%s>!",

779 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

783 *
’Œ
 = '\0';

785 ià(
ch
 != ';')

787 
	`mxml_”rÜ
("Characterƒntity \"%s\"‚oterminated under…arent <%s>!",

788 
’t™y
, 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

789  (
EOF
);

792 ià(
’t™y
[0] == '#')

794 ià(
’t™y
[1] == 'x')

795 
ch
 = 
	`¡¹Ş
(
’t™y
 + 2, 
NULL
, 16);

797 
ch
 = 
	`¡¹Ş
(
’t™y
 + 1, 
NULL
, 10);

799 ià((
ch
 = 
	`mxmlEÁ™yG‘V®ue
(
’t™y
)) < 0)

800 
	`mxml_”rÜ
("Entity‚ame \"%s;\"‚ot supported under…arent <%s>!",

801 
’t™y
, 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

803 ià(
	`mxml_bad_ch¬
(
ch
))

805 
	`mxml_”rÜ
("Bad control character 0x%02x under…arent <%s>‚ot‡llowed by XML standard!",

806 
ch
, 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

807  (
EOF
);

810  (
ch
);

811 
	}
}

818 
mxml_node_t
 *

819 
	$mxml_lßd_d©a
(

820 
mxml_node_t
 *
tİ
,

821 *
p
,

822 
mxml_lßd_cb_t
 
cb
,

823 
_mxml_g‘c_cb_t
 
g‘c_cb
,

824 
mxml_§x_cb_t
 
§x_cb
,

825 *
§x_d©a
)

827 
mxml_node_t
 *
node
,

828 *
fœ¡
,

829 *
·»Á
;

830 
ch
,

831 
wh™e¥aû
;

832 *
bufãr
,

833 *
buåŒ
;

834 
bufsize
;

835 
mxml_ty³_t
 
ty³
;

836 
’codšg
;

837 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

839 cÚ¡ * cÚ¡ 
ty³s
[] =

854 ià((
bufãr
 = 
	`m®loc
(64)è=ğ
NULL
)

856 
	`mxml_”rÜ
("Unableo‡llocate string buffer!");

857  (
NULL
);

860 
bufsize
 = 64;

861 
buåŒ
 = 
bufãr
;

862 
·»Á
 = 
tİ
;

863 
fœ¡
 = 
NULL
;

864 
wh™e¥aû
 = 0;

865 
’codšg
 = 
ENCODE_UTF8
;

867 ià(
cb
 && 
·»Á
)

868 
ty³
 = (*
cb
)(
·»Á
);

869 ià(
·»Á
)

870 
ty³
 = 
MXML_TEXT
;

872 
ty³
 = 
MXML_IGNORE
;

874 (
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
)è!ğ
EOF
)

876 ià((
ch
 == '<' ||

877 (
	`mxml_is¥aû
(
ch
è&& 
ty³
 !ğ
MXML_OPAQUE
 &&y³ !ğ
MXML_CUSTOM
)) &&

878 
buåŒ
 > 
bufãr
)

884 *
buåŒ
 = '\0';

886 
ty³
)

888 
MXML_INTEGER
 :

889 
node
 = 
	`mxmlNewIÁeg”
(
·»Á
, 
	`¡¹Ş
(
bufãr
, &
buåŒ
, 0));

892 
MXML_OPAQUE
 :

893 
node
 = 
	`mxmlNewO·que
(
·»Á
, 
bufãr
);

896 
MXML_REAL
 :

897 
node
 = 
	`mxmlNewR—l
(
·»Á
, 
	`¡¹od
(
bufãr
, &
buåŒ
));

900 
MXML_TEXT
 :

901 
node
 = 
	`mxmlNewText
(
·»Á
, 
wh™e¥aû
, 
bufãr
);

904 
MXML_CUSTOM
 :

905 ià(
glob®
->
cu¡om_lßd_cb
)

911 
node
 = 
	`mxmlNewCu¡om
(
·»Á
, 
NULL
, NULL);

913 ià((*
glob®
->
cu¡om_lßd_cb
)(
node
, 
bufãr
))

915 
	`mxml_”rÜ
("Bad custom value '%s' in…arent <%s>!",

916 
bufãr
, 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

917 
	`mxmlD–‘e
(
node
);

918 
node
 = 
NULL
;

924 
node
 = 
NULL
;

928 ià(*
buåŒ
)

934 
	`mxml_”rÜ
("Bad %s value '%s' in…arent <%s>!",

935 
ty³
 =ğ
MXML_INTEGER
 ? "š‹g”" : "»®", 
bufãr
,

936 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

940 
buåŒ
 = 
bufãr
;

941 
wh™e¥aû
 = 
	`mxml_is¥aû
(
ch
è&& 
ty³
 =ğ
MXML_TEXT
;

943 ià(!
node
 && 
ty³
 !ğ
MXML_IGNORE
)

949 
	`mxml_”rÜ
("Unableo‡dd value‚ode ofype %so…arent <%s>!",

950 
ty³s
[
ty³
], 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

951 
”rÜ
;

954 ià(
§x_cb
)

956 (*
§x_cb
)(
node
, 
MXML_SAX_DATA
, 
§x_d©a
);

958 ià(!
	`mxmlR–—£
(
node
))

959 
node
 = 
NULL
;

962 ià(!
fœ¡
 && 
node
)

963 
fœ¡
 = 
node
;

965 ià(
	`mxml_is¥aû
(
ch
è&& 
ty³
 =ğ
MXML_TEXT
)

966 
wh™e¥aû
 = 1;

973 ià(
ch
 =ğ'<' && 
wh™e¥aû
 && 
ty³
 =ğ
MXML_TEXT
)

975 ià(
·»Á
)

977 
node
 = 
	`mxmlNewText
(
·»Á
, 
wh™e¥aû
, "");

979 ià(
§x_cb
)

981 (*
§x_cb
)(
node
, 
MXML_SAX_DATA
, 
§x_d©a
);

983 ià(!
	`mxmlR–—£
(
node
))

984 
node
 = 
NULL
;

987 ià(!
fœ¡
 && 
node
)

988 
fœ¡
 = 
node
;

991 
wh™e¥aû
 = 0;

994 ià(
ch
 == '<')

1000 
buåŒ
 = 
bufãr
;

1002 (
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
)è!ğ
EOF
)

1003 ià(
	`mxml_is¥aû
(
ch
è|| ch =ğ'>' || (ch =ğ'/' && 
buåŒ
 > 
bufãr
))

1005 ià(
ch
 == '<')

1007 
	`mxml_”rÜ
("Bare < inƒlement!");

1008 
”rÜ
;

1010 ià(
ch
 == '&')

1012 ià((
ch
 = 
	`mxml_g‘_’t™y
(
·»Á
, 
p
, &
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1013 
”rÜ
;

1015 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1016 
”rÜ
;

1018 ià(
ch
 < '0' && ch != '!' && ch != '-' && ch != '.' && ch != '/')

1019 
”rÜ
;

1020 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1021 
”rÜ
;

1022 ià(((
buåŒ
 - 
bufãr
) == 1 && buffer[0] == '?') ||

1023 ((
buåŒ
 - 
bufãr
è=ğ3 && !
	`¡ºcmp
(buffer, "!--", 3)) ||

1024 ((
buåŒ
 - 
bufãr
è=ğ8 && !
	`¡ºcmp
(buffer, "![CDATA[", 8)))

1027 *
buåŒ
 = '\0';

1029 ià(!
	`¡rcmp
(
bufãr
, "!--"))

1035 (
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
)è!ğ
EOF
)

1037 ià(
ch
 =ğ'>' && 
buåŒ
 > (
bufãr
 + 4) &&

1038 
buåŒ
[-3] != '-' && bufptr[-2] == '-' && bufptr[-1] == '-')

1040 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1041 
”rÜ
;

1048 ià(
ch
 != '>')

1054 
	`mxml_”rÜ
("Early EOF in comment‚ode!");

1055 
”rÜ
;

1063 *
buåŒ
 = '\0';

1065 ià(!
·»Á
 && 
fœ¡
)

1071 
	`mxml_”rÜ
("<%s> cannot be‡ second„oot‚ode‡fter <%s>",

1072 
bufãr
, 
fœ¡
->
v®ue
.
–em’t
.
Çme
);

1073 
”rÜ
;

1076 ià((
node
 = 
	`mxmlNewEËm’t
(
·»Á
, 
bufãr
)è=ğ
NULL
)

1082 
	`mxml_”rÜ
("Unableo‡dd comment‚odeo…arent <%s>!",

1083 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

1087 ià(
§x_cb
)

1089 (*
§x_cb
)(
node
, 
MXML_SAX_COMMENT
, 
§x_d©a
);

1091 ià(!
	`mxmlR–—£
(
node
))

1092 
node
 = 
NULL
;

1095 ià(
node
 && !
fœ¡
)

1096 
fœ¡
 = 
node
;

1098 ià(!
	`¡rcmp
(
bufãr
, "![CDATA["))

1104 (
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
)è!ğ
EOF
)

1106 ià(
ch
 =ğ'>' && !
	`¡ºcmp
(
buåŒ
 - 2, "]]", 2))

1108 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1109 
”rÜ
;

1116 ià(
ch
 != '>')

1122 
	`mxml_”rÜ
("Early EOF in CDATA‚ode!");

1123 
”rÜ
;

1131 *
buåŒ
 = '\0';

1133 ià(!
·»Á
 && 
fœ¡
)

1139 
	`mxml_”rÜ
("<%s> cannot be‡ second„oot‚ode‡fter <%s>",

1140 
bufãr
, 
fœ¡
->
v®ue
.
–em’t
.
Çme
);

1141 
”rÜ
;

1144 ià((
node
 = 
	`mxmlNewEËm’t
(
·»Á
, 
bufãr
)è=ğ
NULL
)

1150 
	`mxml_”rÜ
("Unableo‡dd CDATA‚odeo…arent <%s>!",

1151 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

1152 
”rÜ
;

1155 ià(
§x_cb
)

1157 (*
§x_cb
)(
node
, 
MXML_SAX_CDATA
, 
§x_d©a
);

1159 ià(!
	`mxmlR–—£
(
node
))

1160 
node
 = 
NULL
;

1163 ià(
node
 && !
fœ¡
)

1164 
fœ¡
 = 
node
;

1166 ià(
bufãr
[0] == '?')

1172 (
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
)è!ğ
EOF
)

1174 ià(
ch
 =ğ'>' && 
buåŒ
 > 
bufãr
 && bufptr[-1] == '?')

1176 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1177 
”rÜ
;

1184 ià(
ch
 != '>')

1190 
	`mxml_”rÜ
("Early EOF in…rocessing instruction‚ode!");

1191 
”rÜ
;

1198 *
buåŒ
 = '\0';

1200 ià(!
·»Á
 && 
fœ¡
)

1206 
	`mxml_”rÜ
("<%s> cannot be‡ second„oot‚ode‡fter <%s>",

1207 
bufãr
, 
fœ¡
->
v®ue
.
–em’t
.
Çme
);

1208 
”rÜ
;

1211 ià((
node
 = 
	`mxmlNewEËm’t
(
·»Á
, 
bufãr
)è=ğ
NULL
)

1217 
	`mxml_”rÜ
("Unableo‡dd…rocessing instruction‚odeo…arent <%s>!",

1218 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

1219 
”rÜ
;

1222 ià(
§x_cb
)

1224 (*
§x_cb
)(
node
, 
MXML_SAX_DIRECTIVE
, 
§x_d©a
);

1226 ià(!
	`mxmlR–—£
(
node
))

1227 
node
 = 
NULL
;

1230 ià(
node
)

1232 ià(!
fœ¡
)

1233 
fœ¡
 = 
node
;

1235 ià(!
·»Á
)

1237 
·»Á
 = 
node
;

1239 ià(
cb
)

1240 
ty³
 = (*
cb
)(
·»Á
);

1242 
ty³
 = 
MXML_TEXT
;

1246 ià(
bufãr
[0] == '!')

1254 ià(
ch
 == '>')

1258 ià(
ch
 == '&')

1259 ià((
ch
 = 
	`mxml_g‘_’t™y
(
·»Á
, 
p
, &
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1260 
”rÜ
;

1262 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1263 
”rÜ
;

1266 (
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
)è!ğ
EOF
);

1272 ià(
ch
 != '>')

1278 
	`mxml_”rÜ
("Early EOF in declaration‚ode!");

1279 
”rÜ
;

1286 *
buåŒ
 = '\0';

1288 ià(!
·»Á
 && 
fœ¡
)

1294 
	`mxml_”rÜ
("<%s> cannot be‡ second„oot‚ode‡fter <%s>",

1295 
bufãr
, 
fœ¡
->
v®ue
.
–em’t
.
Çme
);

1296 
”rÜ
;

1299 ià((
node
 = 
	`mxmlNewEËm’t
(
·»Á
, 
bufãr
)è=ğ
NULL
)

1305 
	`mxml_”rÜ
("Unableo‡dd declaration‚odeo…arent <%s>!",

1306 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

1307 
”rÜ
;

1310 ià(
§x_cb
)

1312 (*
§x_cb
)(
node
, 
MXML_SAX_DIRECTIVE
, 
§x_d©a
);

1314 ià(!
	`mxmlR–—£
(
node
))

1315 
node
 = 
NULL
;

1318 ià(
node
)

1320 ià(!
fœ¡
)

1321 
fœ¡
 = 
node
;

1323 ià(!
·»Á
)

1325 
·»Á
 = 
node
;

1327 ià(
cb
)

1328 
ty³
 = (*
cb
)(
·»Á
);

1330 
ty³
 = 
MXML_TEXT
;

1334 ià(
bufãr
[0] == '/')

1340 ià(!
·»Á
 || 
	`¡rcmp
(
bufãr
 + 1,…¬’t->
v®ue
.
–em’t
.
Çme
))

1346 
	`mxml_”rÜ
("Mismatched closeag <%s> under…arent <%s>!",

1347 
bufãr
, 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "(null)");

1348 
”rÜ
;

1355 
ch
 !ğ'>' && ch !ğ
EOF
)

1356 
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
);

1358 
node
 = 
·»Á
;

1359 
·»Á
 =…arent->parent;

1361 ià(
§x_cb
)

1363 (*
§x_cb
)(
node
, 
MXML_SAX_ELEMENT_CLOSE
, 
§x_d©a
);

1365 ià(!
	`mxmlR–—£
(
node
è&& 
fœ¡
 ==‚ode)

1366 
fœ¡
 = 
NULL
;

1373 ià(
cb
 && 
·»Á
)

1374 
ty³
 = (*
cb
)(
·»Á
);

1382 ià(!
·»Á
 && 
fœ¡
)

1388 
	`mxml_”rÜ
("<%s> cannot be‡ second„oot‚ode‡fter <%s>",

1389 
bufãr
, 
fœ¡
->
v®ue
.
–em’t
.
Çme
);

1390 
”rÜ
;

1393 ià((
node
 = 
	`mxmlNewEËm’t
(
·»Á
, 
bufãr
)è=ğ
NULL
)

1399 
	`mxml_”rÜ
("Unableo‡ddƒlement‚odeo…arent <%s>!",

1400 
·»Á
 ?…¬’t->
v®ue
.
–em’t
.
Çme
 : "null");

1401 
”rÜ
;

1404 ià(
	`mxml_is¥aû
(
ch
))

1406 ià((
ch
 = 
	`mxml_·r£_–em’t
(
node
, 
p
, &
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1407 
”rÜ
;

1409 ià(
ch
 == '/')

1411 ià((
ch
 = (*
g‘c_cb
)(
p
, &
’codšg
)) != '>')

1413 
	`mxml_”rÜ
("Expected > but got '%c' instead forƒlement <%s/>!",

1414 
ch
, 
bufãr
);

1415 
	`mxmlD–‘e
(
node
);

1416 
”rÜ
;

1419 
ch
 = '/';

1422 ià(
§x_cb
)

1423 (*
§x_cb
)(
node
, 
MXML_SAX_ELEMENT_OPEN
, 
§x_d©a
);

1425 ià(!
fœ¡
)

1426 
fœ¡
 = 
node
;

1428 ià(
ch
 =ğ
EOF
)

1431 ià(
ch
 != '/')

1437 
·»Á
 = 
node
;

1439 ià(
cb
 && 
·»Á
)

1440 
ty³
 = (*
cb
)(
·»Á
);

1442 
ty³
 = 
MXML_TEXT
;

1444 ià(
§x_cb
)

1446 (*
§x_cb
)(
node
, 
MXML_SAX_ELEMENT_CLOSE
, 
§x_d©a
);

1448 ià(!
	`mxmlR–—£
(
node
è&& 
fœ¡
 ==‚ode)

1449 
fœ¡
 = 
NULL
;

1453 
buåŒ
 = 
bufãr
;

1455 ià(
ch
 == '&')

1461 ià((
ch
 = 
	`mxml_g‘_’t™y
(
·»Á
, 
p
, &
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1462 
”rÜ
;

1464 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1465 
”rÜ
;

1467 ià(
ty³
 =ğ
MXML_OPAQUE
 ||y³ =ğ
MXML_CUSTOM
 || !
	`mxml_is¥aû
(
ch
))

1473 ià(
	`mxml_add_ch¬
(
ch
, &
buåŒ
, &
bufãr
, &
bufsize
))

1474 
”rÜ
;

1482 
	`ä“
(
bufãr
);

1488 ià(
·»Á
)

1490 
node
 = 
·»Á
;

1492 
·»Á
 !ğ
tİ
 &&…arent->parent)

1493 
·»Á
 =…arent->parent;

1495 ià(
node
 !ğ
·»Á
)

1497 
	`mxml_”rÜ
("Missing closeag </%s> under…arent <%s>!",

1498 
node
->
v®ue
.
–em’t
.
Çme
,

1499 
node
->
·»Á
 ?‚ode->·»Á->
v®ue
.
–em’t
.
Çme
 : "(null)");

1501 
	`mxmlD–‘e
(
fœ¡
);

1503  (
NULL
);

1507 ià(
·»Á
)

1508  (
·»Á
);

1510  (
fœ¡
);

1516 
”rÜ
:

1518 
	`mxmlD–‘e
(
fœ¡
);

1520 
	`ä“
(
bufãr
);

1522  (
NULL
);

1523 
	}
}

1531 
	$mxml_·r£_–em’t
(

1532 
mxml_node_t
 *
node
,

1533 *
p
,

1534 *
’codšg
,

1535 
_mxml_g‘c_cb_t
 
g‘c_cb
)

1537 
ch
,

1538 
quÙe
;

1539 *
Çme
,

1540 *
v®ue
,

1541 *
±r
;

1542 
Çmesize
,

1543 
v®size
;

1550 ià((
Çme
 = 
	`m®loc
(64)è=ğ
NULL
)

1552 
	`mxml_”rÜ
("Unableo‡llocate memory for‚ame!");

1553  (
EOF
);

1556 
Çmesize
 = 64;

1558 ià((
v®ue
 = 
	`m®loc
(64)è=ğ
NULL
)

1560 
	`ä“
(
Çme
);

1561 
	`mxml_”rÜ
("Unableo‡llocate memory for value!");

1562  (
EOF
);

1565 
v®size
 = 64;

1571 (
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
)è!ğ
EOF
)

1573 #ià
DEBUG
 > 1

1574 
	`årštf
(
¡d”r
, "·r£_–em’t: ch='%c'\n", 
ch
);

1581 ià(
	`mxml_is¥aû
(
ch
))

1588 ià(
ch
 == '/' || ch == '?')

1594 
quÙe
 = (*
g‘c_cb
)(
p
, 
’codšg
);

1596 ià(
quÙe
 != '>')

1598 
	`mxml_”rÜ
("Expected '>'‡fter '%c' forƒlement %s, but got '%c'!",

1599 
ch
, 
node
->
v®ue
.
–em’t
.
Çme
, 
quÙe
);

1600 
”rÜ
;

1605 ià(
ch
 == '<')

1607 
	`mxml_”rÜ
("B¬< iÀ–em’ˆ%s!", 
node
->
v®ue
.
–em’t
.
Çme
);

1608 
”rÜ
;

1610 ià(
ch
 == '>')

1617 
Çme
[0] = 
ch
;

1618 
±r
 = 
Çme
 + 1;

1620 ià(
ch
 == '\"' || ch == '\'')

1626 
quÙe
 = 
ch
;

1628 (
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
)è!ğ
EOF
)

1630 ià(
ch
 == '&')

1631 ià((
ch
 = 
	`mxml_g‘_’t™y
(
node
, 
p
, 
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1632 
”rÜ
;

1634 ià(
	`mxml_add_ch¬
(
ch
, &
±r
, &
Çme
, &
Çmesize
))

1635 
”rÜ
;

1637 ià(
ch
 =ğ
quÙe
)

1647 (
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
)è!ğ
EOF
)

1648 ià(
	`mxml_is¥aû
(
ch
) || ch == '=' || ch == '/' || ch == '>' ||

1649 
ch
 == '?')

1653 ià(
ch
 == '&')

1654 ià((
ch
 = 
	`mxml_g‘_’t™y
(
node
, 
p
, 
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1655 
”rÜ
;

1657 ià(
	`mxml_add_ch¬
(
ch
, &
±r
, &
Çme
, &
Çmesize
))

1658 
”rÜ
;

1662 *
±r
 = '\0';

1664 ià(
	`mxmlEËm’tG‘A‰r
(
node
, 
Çme
))

1665 
”rÜ
;

1667 
ch
 !ğ
EOF
 && 
	`mxml_is¥aû
(ch))

1668 
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
);

1670 ià(
ch
 == '=')

1676 (
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
)è!ğ
EOF
 && 
	`mxml_is¥aû
(ch));

1678 ià(
ch
 =ğ
EOF
)

1680 
	`mxml_”rÜ
("Missing value for‡ttribute '%s' inƒlement %s!",

1681 
Çme
, 
node
->
v®ue
.
–em’t
.name);

1682 
”rÜ
;

1685 ià(
ch
 == '\'' || ch == '\"')

1691 
quÙe
 = 
ch
;

1692 
±r
 = 
v®ue
;

1694 (
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
)è!ğ
EOF
)

1695 ià(
ch
 =ğ
quÙe
)

1699 ià(
ch
 == '&')

1700 ià((
ch
 = 
	`mxml_g‘_’t™y
(
node
, 
p
, 
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1701 
”rÜ
;

1703 ià(
	`mxml_add_ch¬
(
ch
, &
±r
, &
v®ue
, &
v®size
))

1704 
”rÜ
;

1707 *
±r
 = '\0';

1715 
v®ue
[0] = 
ch
;

1716 
±r
 = 
v®ue
 + 1;

1718 (
ch
 = (*
g‘c_cb
)(
p
, 
’codšg
)è!ğ
EOF
)

1719 ià(
	`mxml_is¥aû
(
ch
) || ch == '=' || ch == '/' || ch == '>')

1723 ià(
ch
 == '&')

1724 ià((
ch
 = 
	`mxml_g‘_’t™y
(
node
, 
p
, 
’codšg
, 
g‘c_cb
)è=ğ
EOF
)

1725 
”rÜ
;

1727 ià(
	`mxml_add_ch¬
(
ch
, &
±r
, &
v®ue
, &
v®size
))

1728 
”rÜ
;

1731 *
±r
 = '\0';

1738 
	`mxmlEËm’tS‘A‰r
(
node
, 
Çme
, 
v®ue
);

1742 
	`mxml_”rÜ
("Missing value for‡ttribute '%s' inƒlement %s!",

1743 
Çme
, 
node
->
v®ue
.
–em’t
.name);

1744 
”rÜ
;

1751 ià(
ch
 == '/' || ch == '?')

1757 
quÙe
 = (*
g‘c_cb
)(
p
, 
’codšg
);

1759 ià(
quÙe
 != '>')

1761 
	`mxml_”rÜ
("Expected '>'‡fter '%c' forƒlement %s, but got '%c'!",

1762 
ch
, 
node
->
v®ue
.
–em’t
.
Çme
, 
quÙe
);

1763 
ch
 = 
EOF
;

1768 ià(
ch
 == '>')

1776 
	`ä“
(
Çme
);

1777 
	`ä“
(
v®ue
);

1779  (
ch
);

1785 
”rÜ
:

1787 
	`ä“
(
Çme
);

1788 
	`ä“
(
v®ue
);

1790  (
EOF
);

1791 
	}
}

1799 
	$mxml_¡ršg_g‘c
(*
p
,

1800 *
’codšg
)

1802 
ch
;

1803 cÚ¡ **
s
;

1806 
s
 = (cÚ¡ **)
p
;

1808 ià((
ch
 = (*
s
)[0] & 255è!ğ0 || *
’codšg
 =ğ
ENCODE_UTF16LE
)

1814 (*
s
)++;

1816 *
’codšg
)

1818 
ENCODE_UTF8
 :

1819 ià(!(
ch
 & 0x80))

1821 #ià
DEBUG
 > 1

1822 
	`´štf
("mxml_¡ršg_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

1825 ià(
	`mxml_bad_ch¬
(
ch
))

1827 
	`mxml_”rÜ
("Bad control character 0x%02x‚ot‡llowed by XML standard!",

1828 
ch
);

1829  (
EOF
);

1832  (
ch
);

1834 ià(
ch
 == 0xfe)

1840 ià(((*
s
)[0] & 255) != 0xff)

1841  (
EOF
);

1843 *
’codšg
 = 
ENCODE_UTF16BE
;

1844 (*
s
)++;

1846  (
	`mxml_¡ršg_g‘c
(
p
, 
’codšg
));

1848 ià(
ch
 == 0xff)

1854 ià(((*
s
)[0] & 255) != 0xfe)

1855  (
EOF
);

1857 *
’codšg
 = 
ENCODE_UTF16LE
;

1858 (*
s
)++;

1860  (
	`mxml_¡ršg_g‘c
(
p
, 
’codšg
));

1862 ià((
ch
 & 0xe0) == 0xc0)

1868 ià(((*
s
)[0] & 0xc0) != 0x80)

1869  (
EOF
);

1871 
ch
 = ((ch & 0x1fè<< 6è| ((*
s
)[0] & 0x3f);

1873 (*
s
)++;

1875 ià(
ch
 < 0x80)

1877 
	`mxml_”rÜ
("Inv®id UTF-8 sequ’û fÜ ch¬aù” 0x%04x!", 
ch
);

1878  (
EOF
);

1881 #ià
DEBUG
 > 1

1882 
	`´štf
("mxml_¡ršg_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

1885  (
ch
);

1887 ià((
ch
 & 0xf0) == 0xe0)

1893 ià(((*
s
)[0] & 0xc0) != 0x80 ||

1894 ((*
s
)[1] & 0xc0) != 0x80)

1895  (
EOF
);

1897 
ch
 = ((((ch & 0x0fè<< 6è| ((*
s
)[0] & 0x3f)) << 6) | ((*s)[1] & 0x3f);

1899 (*
s
) += 2;

1901 ià(
ch
 < 0x800)

1903 
	`mxml_”rÜ
("Inv®id UTF-8 sequ’û fÜ ch¬aù” 0x%04x!", 
ch
);

1904  (
EOF
);

1911 ià(
ch
 == 0xfeff)

1912  (
	`mxml_¡ršg_g‘c
(
p
, 
’codšg
));

1914 #ià
DEBUG
 > 1

1915 
	`´štf
("mxml_¡ršg_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

1918  (
ch
);

1920 ià((
ch
 & 0xf8) == 0xf0)

1926 ià(((*
s
)[0] & 0xc0) != 0x80 ||

1927 ((*
s
)[1] & 0xc0) != 0x80 ||

1928 ((*
s
)[2] & 0xc0) != 0x80)

1929  (
EOF
);

1931 
ch
 = ((((((ch & 0x07è<< 6è| ((*
s
)[0] & 0x3f)) << 6) |

1932 ((*
s
)[1] & 0x3f)) << 6) | ((*s)[2] & 0x3f);

1934 (*
s
) += 3;

1936 ià(
ch
 < 0x10000)

1938 
	`mxml_”rÜ
("Inv®id UTF-8 sequ’û fÜ ch¬aù” 0x%04x!", 
ch
);

1939  (
EOF
);

1942 #ià
DEBUG
 > 1

1943 
	`´štf
("mxml_¡ršg_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

1946  (
ch
);

1949  (
EOF
);

1951 
ENCODE_UTF16BE
 :

1956 
ch
 = (ch << 8è| ((*
s
)[0] & 255);

1957 (*
s
) ++;

1959 ià(
	`mxml_bad_ch¬
(
ch
))

1961 
	`mxml_”rÜ
("Bad control character 0x%02x‚ot‡llowed by XML standard!",

1962 
ch
);

1963  (
EOF
);

1965 ià(
ch
 >= 0xd800 && ch <= 0xdbff)

1971 
lch
;

1974 ià(!(*
s
)[0])

1975  (
EOF
);

1977 
lch
 = (((*
s
)[0] & 255) << 8) | ((*s)[1] & 255);

1978 (*
s
) += 2;

1980 ià(
lch
 < 0xdc00 ||†ch >= 0xdfff)

1981  (
EOF
);

1983 
ch
 = (((ch & 0x3ffè<< 10è| (
lch
 & 0x3ff)) + 0x10000;

1986 #ià
DEBUG
 > 1

1987 
	`´štf
("mxml_¡ršg_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

1990  (
ch
);

1992 
ENCODE_UTF16LE
 :

1997 
ch
 = ch | (((*
s
)[0] & 255) << 8);

1999 ià(!
ch
)

2001 (*
s
) --;

2002  (
EOF
);

2005 (*
s
) ++;

2007 ià(
	`mxml_bad_ch¬
(
ch
))

2009 
	`mxml_”rÜ
("Bad control character 0x%02x‚ot‡llowed by XML standard!",

2010 
ch
);

2011  (
EOF
);

2013 ià(
ch
 >= 0xd800 && ch <= 0xdbff)

2019 
lch
;

2022 ià(!(*
s
)[1])

2023  (
EOF
);

2025 
lch
 = (((*
s
)[1] & 255) << 8) | ((*s)[0] & 255);

2026 (*
s
) += 2;

2028 ià(
lch
 < 0xdc00 ||†ch >= 0xdfff)

2029  (
EOF
);

2031 
ch
 = (((ch & 0x3ffè<< 10è| (
lch
 & 0x3ff)) + 0x10000;

2034 #ià
DEBUG
 > 1

2035 
	`´štf
("mxml_¡ršg_g‘c: %ø(0x%04x)\n", 
ch
 < ' ' ? '.' : ch, ch);

2038  (
ch
);

2042  (
EOF
);

2043 
	}
}

2051 
	$mxml_¡ršg_putc
(
ch
,

2052 *
p
)

2054 **
µ
;

2057 
µ
 = (**)
p
;

2059 ià(
µ
[0] <…p[1])

2060 
µ
[0][0] = 
ch
;

2062 
µ
[0] ++;

2065 
	}
}

2073 
mxml_wr™e_Çme
(cÚ¡ *
s
,

2074 *
p
,

2075 (*
putc_cb
)(, *))

2078 
quÙe
;

2079 cÚ¡ *
Çme
;

2082 ià(*
s
 == '\"' || *s == '\'')

2088 ià((*
putc_cb
)(*
s
, 
p
) < 0)

2091 
quÙe
 = *
s
++;

2093 *
s
 && * !ğ
quÙe
)

2095 ià((
Çme
 = 
	`mxmlEÁ™yG‘Name
(*
s
)è!ğ
NULL
)

2097 ià((*
putc_cb
)('&', 
p
) < 0)

2100 *
Çme
)

2102 ià((*
putc_cb
)(*
Çme
, 
p
) < 0)

2105 
Çme
 ++;

2108 ià((*
putc_cb
)(';', 
p
) < 0)

2111 ià((*
putc_cb
)(*
s
, 
p
) < 0)

2114 
s
 ++;

2121 ià((*
putc_cb
)(
quÙe
, 
p
) < 0)

2130 *
s
)

2132 ià((*
putc_cb
)(*
s
, 
p
) < 0)

2135 
s
 ++;

2140 
	}
}

2148 
	$mxml_wr™e_node
(
mxml_node_t
 *
node
,

2149 *
p
,

2150 
mxml_§ve_cb_t
 
cb
,

2151 
cŞ
,

2152 
_mxml_putc_cb_t
 
putc_cb
,

2153 
_mxml_glob®_t
 *
glob®
)

2155 
mxml_node_t
 *
cu¼’t
,

2156 *
Ãxt
;

2157 
i
,

2158 
width
;

2159 
mxml_©Œ_t
 *
©Œ
;

2160 
s
[255];

2167 
cu¼’t
 = 
node
; cu¼’t; cu¼’ˆğ
Ãxt
)

2173 
cu¼’t
->
ty³
)

2175 
MXML_ELEMENT
 :

2176 
cŞ
 = 
	`mxml_wr™e_ws
(
cu¼’t
, 
p
, 
cb
, 
MXML_WS_BEFORE_OPEN
, cŞ, 
putc_cb
);

2178 ià((*
putc_cb
)('<', 
p
) < 0)

2180 ià(
cu¼’t
->
v®ue
.
–em’t
.
Çme
[0] == '?' ||

2181 !
	`¡ºcmp
(
cu¼’t
->
v®ue
.
–em’t
.
Çme
, "!--", 3) ||

2182 !
	`¡ºcmp
(
cu¼’t
->
v®ue
.
–em’t
.
Çme
, "![CDATA[", 8))

2189 cÚ¡ *
±r
;

2191 
±r
 = 
cu¼’t
->
v®ue
.
–em’t
.
Çme
; *ptr;…tr ++)

2192 ià((*
putc_cb
)(*
±r
, 
p
) < 0)

2195 ià(
	`mxml_wr™e_Çme
(
cu¼’t
->
v®ue
.
–em’t
.
Çme
, 
p
, 
putc_cb
) < 0)

2198 
cŞ
 +ğ
	`¡¾’
(
cu¼’t
->
v®ue
.
–em’t
.
Çme
) + 1;

2200 
i
 = 
cu¼’t
->
v®ue
.
–em’t
.
num_©Œs
, 
©Œ
 = cu¼’t->v®ue.–em’t.
©Œs
;

2201 
i
 > 0;

2202 
i
 --, 
©Œ
 ++)

2204 
width
 = 
	`¡¾’
(
©Œ
->
Çme
);

2206 ià(
©Œ
->
v®ue
)

2207 
width
 +ğ
	`¡¾’
(
©Œ
->
v®ue
) + 3;

2209 ià(
glob®
->
w¿p
 > 0 && (
cŞ
 + 
width
) > global->wrap)

2211 ià((*
putc_cb
)('\n', 
p
) < 0)

2214 
cŞ
 = 0;

2218 ià((*
putc_cb
)(' ', 
p
) < 0)

2221 
cŞ
 ++;

2224 ià(
	`mxml_wr™e_Çme
(
©Œ
->
Çme
, 
p
, 
putc_cb
) < 0)

2227 ià(
©Œ
->
v®ue
)

2229 ià((*
putc_cb
)('=', 
p
) < 0)

2231 ià((*
putc_cb
)('\"', 
p
) < 0)

2233 ià(
	`mxml_wr™e_¡ršg
(
©Œ
->
v®ue
, 
p
, 
putc_cb
) < 0)

2235 ià((*
putc_cb
)('\"', 
p
) < 0)

2239 
cŞ
 +ğ
width
;

2242 ià(
cu¼’t
->
chd
)

2248 ià((*
putc_cb
)('>', 
p
) < 0)

2251 
cŞ
 ++;

2253 
cŞ
 = 
	`mxml_wr™e_ws
(
cu¼’t
, 
p
, 
cb
, 
MXML_WS_AFTER_OPEN
, cŞ, 
putc_cb
);

2255 ià(
cu¼’t
->
v®ue
.
–em’t
.
Çme
[0] == '!' ||

2256 
cu¼’t
->
v®ue
.
–em’t
.
Çme
[0] == '?')

2262 ià((*
putc_cb
)('>', 
p
) < 0)

2265 
cŞ
 ++;

2267 
cŞ
 = 
	`mxml_wr™e_ws
(
cu¼’t
, 
p
, 
cb
, 
MXML_WS_AFTER_OPEN
, cŞ, 
putc_cb
);

2271 ià((*
putc_cb
)(' ', 
p
) < 0)

2273 ià((*
putc_cb
)('/', 
p
) < 0)

2275 ià((*
putc_cb
)('>', 
p
) < 0)

2278 
cŞ
 += 3;

2280 
cŞ
 = 
	`mxml_wr™e_ws
(
cu¼’t
, 
p
, 
cb
, 
MXML_WS_AFTER_OPEN
, cŞ, 
putc_cb
);

2284 
MXML_INTEGER
 :

2285 ià(
cu¼’t
->
´ev
)

2287 ià(
glob®
->
w¿p
 > 0 && 
cŞ
 > global->wrap)

2289 ià((*
putc_cb
)('\n', 
p
) < 0)

2292 
cŞ
 = 0;

2294 ià((*
putc_cb
)(' ', 
p
) < 0)

2297 
cŞ
 ++;

2300 
	`¥rštf
(
s
, "%d", 
cu¼’t
->
v®ue
.
š‹g”
);

2301 ià(
	`mxml_wr™e_¡ršg
(
s
, 
p
, 
putc_cb
) < 0)

2304 
cŞ
 +ğ
	`¡¾’
(
s
);

2307 
MXML_OPAQUE
 :

2308 ià(
	`mxml_wr™e_¡ršg
(
cu¼’t
->
v®ue
.
İaque
, 
p
, 
putc_cb
) < 0)

2311 
cŞ
 +ğ
	`¡¾’
(
cu¼’t
->
v®ue
.
İaque
);

2314 
MXML_REAL
 :

2315 ià(
cu¼’t
->
´ev
)

2317 ià(
glob®
->
w¿p
 > 0 && 
cŞ
 > global->wrap)

2319 ià((*
putc_cb
)('\n', 
p
) < 0)

2322 
cŞ
 = 0;

2324 ià((*
putc_cb
)(' ', 
p
) < 0)

2327 
cŞ
 ++;

2330 
	`¥rštf
(
s
, "%f", 
cu¼’t
->
v®ue
.
»®
);

2331 ià(
	`mxml_wr™e_¡ršg
(
s
, 
p
, 
putc_cb
) < 0)

2334 
cŞ
 +ğ
	`¡¾’
(
s
);

2337 
MXML_TEXT
 :

2338 ià(
cu¼’t
->
v®ue
.
‹xt
.
wh™e¥aû
 && 
cŞ
 > 0)

2340 ià(
glob®
->
w¿p
 > 0 && 
cŞ
 > global->wrap)

2342 ià((*
putc_cb
)('\n', 
p
) < 0)

2345 
cŞ
 = 0;

2347 ià((*
putc_cb
)(' ', 
p
) < 0)

2350 
cŞ
 ++;

2353 ià(
	`mxml_wr™e_¡ršg
(
cu¼’t
->
v®ue
.
‹xt
.
¡ršg
, 
p
, 
putc_cb
) < 0)

2356 
cŞ
 +ğ
	`¡¾’
(
cu¼’t
->
v®ue
.
‹xt
.
¡ršg
);

2359 
MXML_CUSTOM
 :

2360 ià(
glob®
->
cu¡om_§ve_cb
)

2362 *
d©a
;

2363 cÚ¡ *
Ãwlše
;

2366 ià((
d©a
 = (*
glob®
->
cu¡om_§ve_cb
)(
node
)è=ğ
NULL
)

2369 ià(
	`mxml_wr™e_¡ršg
(
d©a
, 
p
, 
putc_cb
) < 0)

2372 ià((
Ãwlše
 = 
	`¡¼chr
(
d©a
, '\n')è=ğ
NULL
)

2373 
cŞ
 +ğ
	`¡¾’
(
d©a
);

2375 
cŞ
 = 
	`¡¾’
(
Ãwlše
);

2377 
	`ä“
(
d©a
);

2389 ià((
Ãxt
 = 
cu¼’t
->
chd
è=ğ
NULL
)

2391 (
Ãxt
 = 
cu¼’t
->Ãxtè=ğ
NULL
)

2393 ià(
cu¼’t
 =ğ
node
)

2400 
cu¼’t
 = cu¼’t->
·»Á
;

2402 ià(
cu¼’t
->
v®ue
.
–em’t
.
Çme
[0] != '!' &&

2403 
cu¼’t
->
v®ue
.
–em’t
.
Çme
[0] != '?')

2405 
cŞ
 = 
	`mxml_wr™e_ws
(
cu¼’t
, 
p
, 
cb
, 
MXML_WS_BEFORE_CLOSE
, cŞ, 
putc_cb
);

2407 ià((*
putc_cb
)('<', 
p
) < 0)

2409 ià((*
putc_cb
)('/', 
p
) < 0)

2411 ià(
	`mxml_wr™e_¡ršg
(
cu¼’t
->
v®ue
.
–em’t
.
Çme
, 
p
, 
putc_cb
) < 0)

2413 ià((*
putc_cb
)('>', 
p
) < 0)

2416 
cŞ
 +ğ
	`¡¾’
(
cu¼’t
->
v®ue
.
–em’t
.
Çme
) + 3;

2418 
cŞ
 = 
	`mxml_wr™e_ws
(
cu¼’t
, 
p
, 
cb
, 
MXML_WS_AFTER_CLOSE
, cŞ, 
putc_cb
);

2424  (
cŞ
);

2425 
	}
}

2433 
	$mxml_wr™e_¡ršg
(

2434 cÚ¡ *
s
,

2435 *
p
,

2436 
_mxml_putc_cb_t
 
putc_cb
)

2438 cÚ¡ *
Çme
;

2441 *
s
)

2443 ià((
Çme
 = 
	`mxmlEÁ™yG‘Name
(*
s
)è!ğ
NULL
)

2445 ià((*
putc_cb
)('&', 
p
) < 0)

2448 *
Çme
)

2450 ià((*
putc_cb
)(*
Çme
, 
p
) < 0)

2452 
Çme
 ++;

2455 ià((*
putc_cb
)(';', 
p
) < 0)

2458 ià((*
putc_cb
)(*
s
, 
p
) < 0)

2461 
s
 ++;

2465 
	}
}

2473 
	$mxml_wr™e_ws
(
mxml_node_t
 *
node
,

2474 *
p
,

2475 
mxml_§ve_cb_t
 
cb
,

2476 
ws
,

2477 
cŞ
,

2478 
_mxml_putc_cb_t
 
putc_cb
)

2480 cÚ¡ *
s
;

2483 ià(
cb
 && (
s
 = (*cb)(
node
, 
ws
)è!ğ
NULL
)

2485 *
s
)

2487 ià((*
putc_cb
)(*
s
, 
p
) < 0)

2489 ià(*
s
 == '\n')

2490 
cŞ
 = 0;

2491 ià(*
s
 == '\t')

2493 
cŞ
 +ğ
MXML_TAB
;

2494 
cŞ
 = cŞ - (cŞ % 
MXML_TAB
);

2497 
cŞ
 ++;

2499 
s
 ++;

2503  (
cŞ
);

2504 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-get.c

21 
	~"cÚfig.h
"

22 
	~"mxml.h
"

34 
	$mxmlG‘CDATA
(
mxml_node_t
 *
node
)

40 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
 ||

41 
	`¡ºcmp
(
node
->
v®ue
.
–em’t
.
Çme
, "![CDATA[", 8))

42  (
NULL
);

48  (
node
->
v®ue
.
–em’t
.
Çme
 + 8);

49 
	}
}

62 
	$mxmlG‘Cu¡om
(
mxml_node_t
 *
node
)

68 ià(!
node
)

69  (
NULL
);

75 ià(
node
->
ty³
 =ğ
MXML_CUSTOM
)

76  (
node
->
v®ue
.
cu¡om
.
d©a
);

77 ià(
node
->
ty³
 =ğ
MXML_ELEMENT
 &&

78 
node
->
chd
 &&

79 
node
->
chd
->
ty³
 =ğ
MXML_CUSTOM
)

80  (
node
->
chd
->
v®ue
.
cu¡om
.
d©a
);

82  (
NULL
);

83 
	}
}

95 
	$mxmlG‘EËm’t
(
mxml_node_t
 *
node
)

101 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
)

102  (
NULL
);

108  (
node
->
v®ue
.
–em’t
.
Çme
);

109 
	}
}

121 
mxml_node_t
 *

122 
	$mxmlG‘Fœ¡Chd
(
mxml_node_t
 *
node
)

128 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
)

129  (
NULL
);

135  (
node
->
chd
);

136 
	}
}

149 
	$mxmlG‘IÁeg”
(
mxml_node_t
 *
node
)

155 ià(!
node
)

162 ià(
node
->
ty³
 =ğ
MXML_INTEGER
)

163  (
node
->
v®ue
.
š‹g”
);

164 ià(
node
->
ty³
 =ğ
MXML_ELEMENT
 &&

165 
node
->
chd
 &&

166 
node
->
chd
->
ty³
 =ğ
MXML_INTEGER
)

167  (
node
->
chd
->
v®ue
.
š‹g”
);

170 
	}
}

182 
mxml_node_t
 *

183 
	$mxmlG‘La¡Chd
(
mxml_node_t
 *
node
)

189 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
)

190  (
NULL
);

196  (
node
->
Ï¡_chd
);

197 
	}
}

208 
mxml_node_t
 *

209 
	$mxmlG‘NextSiblšg
(
mxml_node_t
 *
node
)

215 ià(!
node
)

216  (
NULL
);

222  (
node
->
Ãxt
);

223 
	}
}

236 
	$mxmlG‘O·que
(
mxml_node_t
 *
node
)

242 ià(!
node
)

243  (
NULL
);

249 ià(
node
->
ty³
 =ğ
MXML_OPAQUE
)

250  (
node
->
v®ue
.
İaque
);

251 ià(
node
->
ty³
 =ğ
MXML_ELEMENT
 &&

252 
node
->
chd
 &&

253 
node
->
chd
->
ty³
 =ğ
MXML_OPAQUE
)

254  (
node
->
chd
->
v®ue
.
İaque
);

256  (
NULL
);

257 
	}
}

268 
mxml_node_t
 *

269 
	$mxmlG‘P¬’t
(
mxml_node_t
 *
node
)

275 ià(!
node
)

276  (
NULL
);

282  (
node
->
·»Á
);

283 
	}
}

294 
mxml_node_t
 *

295 
	$mxmlG‘P»vSiblšg
(
mxml_node_t
 *
node
)

301 ià(!
node
)

302  (
NULL
);

308  (
node
->
´ev
);

309 
	}
}

321 
	$mxmlG‘R—l
(
mxml_node_t
 *
node
)

327 ià(!
node
)

334 ià(
node
->
ty³
 =ğ
MXML_REAL
)

335  (
node
->
v®ue
.
»®
);

336 ià(
node
->
ty³
 =ğ
MXML_ELEMENT
 &&

337 
node
->
chd
 &&

338 
node
->
chd
->
ty³
 =ğ
MXML_REAL
)

339  (
node
->
chd
->
v®ue
.
»®
);

342 
	}
}

355 
	$mxmlG‘Text
(
mxml_node_t
 *
node
,

356 *
wh™e¥aû
)

362 ià(!
node
)

364 ià(
wh™e¥aû
)

365 *
wh™e¥aû
 = 0;

367  (
NULL
);

374 ià(
node
->
ty³
 =ğ
MXML_TEXT
)

376 ià(
wh™e¥aû
)

377 *
wh™e¥aû
 = 
node
->
v®ue
.
‹xt
.whitespace;

379  (
node
->
v®ue
.
‹xt
.
¡ršg
);

381 ià(
node
->
ty³
 =ğ
MXML_ELEMENT
 &&

382 
node
->
chd
 &&

383 
node
->
chd
->
ty³
 =ğ
MXML_TEXT
)

385 ià(
wh™e¥aû
)

386 *
wh™e¥aû
 = 
node
->
chd
->
v®ue
.
‹xt
.whitespace;

388  (
node
->
chd
->
v®ue
.
‹xt
.
¡ršg
);

392 ià(
wh™e¥aû
)

393 *
wh™e¥aû
 = 0;

395  (
NULL
);

397 
	}
}

408 
mxml_ty³_t


409 
	$mxmlG‘Ty³
(
mxml_node_t
 *
node
)

415 ià(!
node
)

416  (
MXML_IGNORE
);

422  (
node
->
ty³
);

423 
	}
}

433 
	$mxmlG‘U£rD©a
(
mxml_node_t
 *
node
)

439 ià(!
node
)

440  (
NULL
);

446  (
node
->
u£r_d©a
);

447 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-index.c

21 
	~"cÚfig.h
"

22 
	~"mxml.h
"

29 
šdex_com·»
(
mxml_šdex_t
 *
šd
, 
mxml_node_t
 *
fœ¡
,

30 
mxml_node_t
 *
£cÚd
);

31 
šdex_fšd
(
mxml_šdex_t
 *
šd
, cÚ¡ *
–em’t
,

32 cÚ¡ *
v®ue
, 
mxml_node_t
 *
node
);

33 
šdex_sÜt
(
mxml_šdex_t
 *
šd
, 
Ëá
, 
right
);

41 
	$mxmlIndexD–‘e
(
mxml_šdex_t
 *
šd
)

47 ià(!
šd
)

54 ià(
šd
->
©Œ
)

55 
	`ä“
(
šd
->
©Œ
);

57 ià(
šd
->
®loc_nodes
)

58 
	`ä“
(
šd
->
nodes
);

60 
	`ä“
(
šd
);

61 
	}
}

70 
mxml_node_t
 *

71 
	$mxmlIndexEnum
(
mxml_šdex_t
 *
šd
)

77 ià(!
šd
)

78  (
NULL
);

84 ià(
šd
->
cur_node
 < ind->
num_nodes
)

85  (
šd
->
nodes
[šd->
cur_node
 ++]);

87  (
NULL
);

88 
	}
}

100 
mxml_node_t
 *

101 
	$mxmlIndexFšd
(
mxml_šdex_t
 *
šd
,

102 cÚ¡ *
–em’t
,

103 cÚ¡ *
v®ue
)

105 
diff
,

106 
cu¼’t
,

107 
fœ¡
,

108 
Ï¡
;

111 #ifdeà
DEBUG


112 
	`´štf
("mxmlIndexFind(ind=%p,ƒlement=\"%s\", value=\"%s\")\n",

113 
šd
, 
–em’t
 ?ƒËm’ˆ: "ÒuÎ)", 
v®ue
 ? value : "(null)");

120 ià(!
šd
 || (!šd->
©Œ
 && 
v®ue
))

122 #ifdeà
DEBUG


123 
	`puts
("„eturning NULL...");

124 
	`´štf
(" ind->©Œ=\"%s\"\n", 
šd
->
©Œ
 ? ind->attr : "(null)");

127  (
NULL
);

135 ià(!
–em’t
 && !
v®ue
)

136  (
	`mxmlIndexEnum
(
šd
));

142 ià(!
šd
->
num_nodes
)

144 #ifdeà
DEBUG


145 
	`puts
("„eturning NULL...");

146 
	`puts
("‚o‚odes!");

149  (
NULL
);

156 ià(
šd
->
cur_node
 == 0)

162 
fœ¡
 = 0;

163 
Ï¡
 = 
šd
->
num_nodes
 - 1;

165 #ifdeà
DEBUG


166 
	`´štf
(" fšd fœ¡ime,‚um_nodes=%d...\n", 
šd
->
num_nodes
);

169 (
Ï¡
 - 
fœ¡
) > 1)

171 
cu¼’t
 = (
fœ¡
 + 
Ï¡
) / 2;

173 #ifdeà
DEBUG


174 
	`´štf
(" fœ¡=%d,†a¡=%d, cu¼’t=%d\n", 
fœ¡
, 
Ï¡
, 
cu¼’t
);

177 ià((
diff
 = 
	`šdex_fšd
(
šd
, 
–em’t
, 
v®ue
, ind->
nodes
[
cu¼’t
])) == 0)

183 #ifdeà
DEBUG


184 
	`puts
(" match!");

187 
cu¼’t
 > 0 &&

188 !
	`šdex_fšd
(
šd
, 
–em’t
, 
v®ue
, ind->
nodes
[
cu¼’t
 - 1]))

189 
cu¼’t
 --;

191 #ifdeà
DEBUG


192 
	`´štf
("„‘uºšg fœ¡ m©ch=%d\n", 
cu¼’t
);

199 
šd
->
cur_node
 = 
cu¼’t
 + 1;

201  (
šd
->
nodes
[
cu¼’t
]);

203 ià(
diff
 < 0)

204 
Ï¡
 = 
cu¼’t
;

206 
fœ¡
 = 
cu¼’t
;

208 #ifdeà
DEBUG


209 
	`´štf
(" diff=%d\n", 
diff
);

217 
cu¼’t
 = 
fœ¡
; cu¼’ˆ<ğ
Ï¡
; current ++)

218 ià(!
	`šdex_fšd
(
šd
, 
–em’t
, 
v®ue
, ind->
nodes
[
cu¼’t
]))

224 #ifdeà
DEBUG


225 
	`´štf
("„‘uºšg oÆy m©ch %d...\n", 
cu¼’t
);

228 
šd
->
cur_node
 = 
cu¼’t
 + 1;

230  (
šd
->
nodes
[
cu¼’t
]);

237 
šd
->
cur_node
 = ind->
num_nodes
;

239 #ifdeà
DEBUG


240 
	`puts
("„eturning NULL...");

243  (
NULL
);

245 ià(
šd
->
cur_node
 < ind->
num_nodes
 &&

246 !
	`šdex_fšd
(
šd
, 
–em’t
, 
v®ue
, ind->
nodes
[šd->
cur_node
]))

252 #ifdeà
DEBUG


253 
	`´štf
("„‘uºšg‚exˆm©ch %d...\n", 
šd
->
cur_node
);

256  (
šd
->
nodes
[šd->
cur_node
 ++]);

263 
šd
->
cur_node
 = ind->
num_nodes
;

265 #ifdeà
DEBUG


266 
	`puts
("„eturning NULL...");

269  (
NULL
);

270 
	}
}

280 
	$mxmlIndexG‘CouÁ
(
mxml_šdex_t
 *
šd
)

286 ià(!
šd
)

293  (
šd
->
num_nodes
);

294 
	}
}

307 
mxml_šdex_t
 *

308 
	$mxmlIndexNew
(
mxml_node_t
 *
node
,

309 cÚ¡ *
–em’t
,

310 cÚ¡ *
©Œ
)

312 
mxml_šdex_t
 *
šd
;

313 
mxml_node_t
 *
cu¼’t
,

314 **
‹mp
;

321 #ifdeà
DEBUG


322 
	`´štf
("mxmlIndexNew(node=%p,ƒlement=\"%s\",‡ttr=\"%s\")\n",

323 
node
, 
–em’t
 ?ƒËm’ˆ: "ÒuÎ)", 
©Œ
 ?‡ttr : "(null)");

326 ià(!
node
)

327  (
NULL
);

333 ià((
šd
 = 
	`ÿÎoc
(1, (
mxml_šdex_t
))è=ğ
NULL
)

335 
	`mxml_”rÜ
("Unableo‡llocate %d bytes for index - %s",

336 (
mxml_šdex_t
), 
	`¡»¼Ü
(
”ºo
));

337  (
NULL
);

340 ià(
©Œ
)

341 
šd
->
©Œ
 = 
	`¡rdup
(attr);

343 ià(!
–em’t
 && !
©Œ
)

344 
cu¼’t
 = 
node
;

346 
cu¼’t
 = 
	`mxmlFšdEËm’t
(
node
,‚ode, 
–em’t
, 
©Œ
, 
NULL
, 
MXML_DESCEND
);

348 
cu¼’t
)

350 ià(
šd
->
num_nodes
 >ğšd->
®loc_nodes
)

352 ià(!
šd
->
®loc_nodes
)

353 
‹mp
 = 
	`m®loc
(64 * (
mxml_node_t
 *));

355 
‹mp
 = 
	`»®loc
(
šd
->
nodes
, (šd->
®loc_nodes
 + 64è* (
mxml_node_t
 *));

357 ià(!
‹mp
)

363 
	`mxml_”rÜ
("Unableo‡llocate %d bytes for index: %s",

364 (
šd
->
®loc_nodes
 + 64è* (
mxml_node_t
 *),

365 
	`¡»¼Ü
(
”ºo
));

367 
	`mxmlIndexD–‘e
(
šd
);

368  (
NULL
);

371 
šd
->
nodes
 = 
‹mp
;

372 
šd
->
®loc_nodes
 += 64;

375 
šd
->
nodes
[šd->
num_nodes
 ++] = 
cu¼’t
;

377 
cu¼’t
 = 
	`mxmlFšdEËm’t
(cu¼’t, 
node
, 
–em’t
, 
©Œ
, 
NULL
, 
MXML_DESCEND
);

384 #ifdeà
DEBUG


386 
i
;

389 
	`´štf
("%d‚ode(sèš index.\n\n", 
šd
->
num_nodes
);

391 ià(
©Œ
)

393 
	`´štf
("Nod Add»s  EËm’ˆ %s\n", 
©Œ
);

394 
	`puts
("-------- -------- -------------- ------------------------------");

396 
i
 = 0; i < 
šd
->
num_nodes
; i ++)

397 
	`´štf
("%8d %-8° %-14.14  %s\n", 
i
, 
šd
->
nodes
[i],

398 
šd
->
nodes
[
i
]->
v®ue
.
–em’t
.
Çme
,

399 
	`mxmlEËm’tG‘A‰r
(
šd
->
nodes
[
i
], 
©Œ
));

403 
	`puts
("Node Address Element");

404 
	`puts
("-------- -------- --------------");

406 
i
 = 0; i < 
šd
->
num_nodes
; i ++)

407 
	`´štf
("%8d %-8° %s\n", 
i
, 
šd
->
nodes
[i],

408 
šd
->
nodes
[
i
]->
v®ue
.
–em’t
.
Çme
);

411 
	`putch¬
('\n');

415 ià(
šd
->
num_nodes
 > 1)

416 
	`šdex_sÜt
(
šd
, 0, ind->
num_nodes
 - 1);

418 #ifdeà
DEBUG


420 
i
;

423 
	`puts
("After sorting:\n");

425 ià(
©Œ
)

427 
	`´štf
("Nod Add»s  EËm’ˆ %s\n", 
©Œ
);

428 
	`puts
("-------- -------- -------------- ------------------------------");

430 
i
 = 0; i < 
šd
->
num_nodes
; i ++)

431 
	`´štf
("%8d %-8° %-14.14  %s\n", 
i
, 
šd
->
nodes
[i],

432 
šd
->
nodes
[
i
]->
v®ue
.
–em’t
.
Çme
,

433 
	`mxmlEËm’tG‘A‰r
(
šd
->
nodes
[
i
], 
©Œ
));

437 
	`puts
("Node Address Element");

438 
	`puts
("-------- -------- --------------");

440 
i
 = 0; i < 
šd
->
num_nodes
; i ++)

441 
	`´štf
("%8d %-8° %s\n", 
i
, 
šd
->
nodes
[i],

442 
šd
->
nodes
[
i
]->
v®ue
.
–em’t
.
Çme
);

445 
	`putch¬
('\n');

453  (
šd
);

454 
	}
}

465 
mxml_node_t
 *

466 
	$mxmlIndexRe£t
(
mxml_šdex_t
 *
šd
)

468 #ifdeà
DEBUG


469 
	`´štf
("mxmlIndexRe£t(šd=%p)\n", 
šd
);

476 ià(!
šd
)

477  (
NULL
);

483 
šd
->
cur_node
 = 0;

489 ià(
šd
->
num_nodes
)

490  (
šd
->
nodes
[0]);

492  (
NULL
);

493 
	}
}

501 
	$šdex_com·»
(
mxml_šdex_t
 *
šd
,

502 
mxml_node_t
 *
fœ¡
,

503 
mxml_node_t
 *
£cÚd
)

505 
diff
;

512 ià((
diff
 = 
	`¡rcmp
(
fœ¡
->
v®ue
.
–em’t
.
Çme
,

513 
£cÚd
->
v®ue
.
–em’t
.
Çme
)) != 0)

514  (
diff
);

520 ià(
šd
->
©Œ
)

522 ià((
diff
 = 
	`¡rcmp
(
	`mxmlEËm’tG‘A‰r
(
fœ¡
, 
šd
->
©Œ
),

523 
	`mxmlEËm’tG‘A‰r
(
£cÚd
, 
šd
->
©Œ
))) != 0)

524  (
diff
);

532 
	}
}

540 
	$šdex_fšd
(
mxml_šdex_t
 *
šd
,

541 cÚ¡ *
–em’t
,

542 cÚ¡ *
v®ue
,

543 
mxml_node_t
 *
node
)

545 
diff
;

552 ià(
–em’t
)

554 ià((
diff
 = 
	`¡rcmp
(
–em’t
, 
node
->
v®ue
.–em’t.
Çme
)) != 0)

555  (
diff
);

562 ià(
v®ue
)

564 ià((
diff
 = 
	`¡rcmp
(
v®ue
, 
	`mxmlEËm’tG‘A‰r
(
node
, 
šd
->
©Œ
))) != 0)

565  (
diff
);

573 
	}
}

583 
	$šdex_sÜt
(
mxml_šdex_t
 *
šd
,

584 
Ëá
,

585 
right
)

587 
mxml_node_t
 *
pivÙ
,

588 *
‹mp
;

589 
‹m¶
,

590 
‹m´
;

603 
pivÙ
 = 
šd
->
nodes
[
Ëá
];

605 
‹m¶
 = 
Ëá
, 
‹m´
 = 
right
;empl <empr;)

611 (
‹m¶
 < 
right
) &&

612 
	`šdex_com·»
(
šd
, ind->
nodes
[
‹m¶
], 
pivÙ
) <= 0)

613 
‹m¶
 ++;

619 (
‹m´
 > 
Ëá
) &&

620 
	`šdex_com·»
(
šd
, ind->
nodes
[
‹m´
], 
pivÙ
) > 0)

621 
‹m´
 --;

627 ià(
‹m¶
 < 
‹m´
)

629 
‹mp
 = 
šd
->
nodes
[
‹m¶
];

630 
šd
->
nodes
[
‹m¶
] = ind->nodes[
‹m´
];

631 
šd
->
nodes
[
‹m´
] = 
‹mp
;

640 ià(
	`šdex_com·»
(
šd
, 
pivÙ
, ind->
nodes
[
‹m´
]) > 0)

642 
šd
->
nodes
[
Ëá
] = ind->nodes[
‹m´
];

643 
šd
->
nodes
[
‹m´
] = 
pivÙ
;

650 ià(
Ëá
 < (
‹m´
 - 1))

651 
	`šdex_sÜt
(
šd
, 
Ëá
, 
‹m´
 - 1);

653 
right
 > (
Ëá
 = 
‹m´
 + 1));

654 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-node.c

21 
	~"cÚfig.h
"

22 
	~"mxml.h
"

29 
mxml_ä“
(
mxml_node_t
 *
node
);

30 
mxml_node_t
 *
mxml_Ãw
(mxml_node_ˆ*
·»Á
, 
mxml_ty³_t
 
ty³
);

45 
	$mxmlAdd
(
mxml_node_t
 *
·»Á
,

46 
wh”e
,

47 
mxml_node_t
 *
chd
,

48 
mxml_node_t
 *
node
)

50 #ifdeà
DEBUG


51 
	`årštf
(
¡d”r
, "mxmlAddÕ¬’t=%p, wh”e=%d, chd=%p,‚ode=%p)\n", 
·»Á
,

52 
wh”e
, 
chd
, 
node
);

59 ià(!
·»Á
 || !
node
)

62 #ià
DEBUG
 > 1

63 
	`årštf
(
¡d”r
, " BEFORE:‚ode->·»Á=%p\n", 
node
->
·»Á
);

64 ià(
·»Á
)

66 
	`årštf
(
¡d”r
, " BEFORE:…¬’t->chd=%p\n", 
·»Á
->
chd
);

67 
	`årštf
(
¡d”r
, " BEFORE:…¬’t->Ï¡_chd=%p\n", 
·»Á
->
Ï¡_chd
);

68 
	`årštf
(
¡d”r
, " BEFORE:…¬’t->´ev=%p\n", 
·»Á
->
´ev
);

69 
	`årštf
(
¡d”r
, " BEFORE:…¬’t->Ãxt=%p\n", 
·»Á
->
Ãxt
);

77 ià(
node
->
·»Á
)

78 
	`mxmlRemove
(
node
);

84 
node
->
·»Á
 =…arent;

86 
wh”e
)

88 
MXML_ADD_BEFORE
 :

89 ià(!
chd
 || chd =ğ
·»Á
->child || child->parent !=…arent)

95 
node
->
Ãxt
 = 
·»Á
->
chd
;

97 ià(
·»Á
->
chd
)

98 
·»Á
->
chd
->
´ev
 = 
node
;

100 
·»Á
->
Ï¡_chd
 = 
node
;

102 
·»Á
->
chd
 = 
node
;

110 
node
->
Ãxt
 = 
chd
;

111 
node
->
´ev
 = 
chd
->prev;

113 ià(
chd
->
´ev
)

114 
chd
->
´ev
->
Ãxt
 = 
node
;

116 
·»Á
->
chd
 = 
node
;

118 
chd
->
´ev
 = 
node
;

122 
MXML_ADD_AFTER
 :

123 ià(!
chd
 || chd =ğ
·»Á
->
Ï¡_chd
 || child->parent !=…arent)

129 
node
->
·»Á
 =…arent;

130 
node
->
´ev
 = 
·»Á
->
Ï¡_chd
;

132 ià(
·»Á
->
Ï¡_chd
)

133 
·»Á
->
Ï¡_chd
->
Ãxt
 = 
node
;

135 
·»Á
->
chd
 = 
node
;

137 
·»Á
->
Ï¡_chd
 = 
node
;

145 
node
->
´ev
 = 
chd
;

146 
node
->
Ãxt
 = 
chd
->next;

148 ià(
chd
->
Ãxt
)

149 
chd
->
Ãxt
->
´ev
 = 
node
;

151 
·»Á
->
Ï¡_chd
 = 
node
;

153 
chd
->
Ãxt
 = 
node
;

158 #ià
DEBUG
 > 1

159 
	`årštf
(
¡d”r
, " AFTER:‚ode->·»Á=%p\n", 
node
->
·»Á
);

160 ià(
·»Á
)

162 
	`årštf
(
¡d”r
, " AFTER:…¬’t->chd=%p\n", 
·»Á
->
chd
);

163 
	`årštf
(
¡d”r
, " AFTER:…¬’t->Ï¡_chd=%p\n", 
·»Á
->
Ï¡_chd
);

164 
	`årštf
(
¡d”r
, " AFTER:…¬’t->´ev=%p\n", 
·»Á
->
´ev
);

165 
	`årštf
(
¡d”r
, " AFTER:…¬’t->Ãxt=%p\n", 
·»Á
->
Ãxt
);

168 
	}
}

179 
	$mxmlD–‘e
(
mxml_node_t
 *
node
)

181 
mxml_node_t
 *
cu¼’t
,

182 *
Ãxt
;

185 #ifdeà
DEBUG


186 
	`årštf
(
¡d”r
, "mxmlD–‘eÒode=%p)\n", 
node
);

193 ià(!
node
)

200 
	`mxmlRemove
(
node
);

206 
cu¼’t
 = 
node
->
chd
; cu¼’t; cu¼’ˆğ
Ãxt
)

212 ià((
Ãxt
 = 
cu¼’t
->
chd
è!ğ
NULL
)

218 
cu¼’t
->
chd
 = 
NULL
;

222 ià((
Ãxt
 = 
cu¼’t
->Ãxtè=ğ
NULL
)

224 
mxml_node_t
 *
‹mp
 = 
cu¼’t
->
·»Á
;

227 ià(
‹mp
 =ğ
node
)

233 
Ãxt
 = 
NULL
;

235 ià((
Ãxt
 = 
‹mp
->Ãxtè=ğ
NULL
)

237 ià((
Ãxt
 = 
‹mp
->
·»Á
è=ğ
node
)

238 
Ãxt
 = 
NULL
;

242 
	`mxml_ä“
(
cu¼’t
);

249 
	`mxml_ä“
(
node
);

250 
	}
}

264 
	$mxmlG‘RefCouÁ
(
mxml_node_t
 *
node
)

270 ià(!
node
)

277  (
node
->
»f_couÁ
);

278 
	}
}

292 
mxml_node_t
 *

293 
	$mxmlNewCDATA
(
mxml_node_t
 *
·»Á
,

294 cÚ¡ *
d©a
)

296 
mxml_node_t
 *
node
;

299 #ifdeà
DEBUG


300 
	`årštf
(
¡d”r
, "mxmlNewCDATA(parent=%p, data=\"%s\")\n",

301 
·»Á
, 
d©a
 ? data : "(null)");

308 ià(!
d©a
)

309  (
NULL
);

315 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_ELEMENT
)è!ğ
NULL
)

316 
node
->
v®ue
.
–em’t
.
Çme
 = 
	`_mxml_¡rdupf
("![CDATA[%s]]", 
d©a
);

318  (
node
);

319 
	}
}

333 
mxml_node_t
 *

334 
	$mxmlNewCu¡om
(

335 
mxml_node_t
 *
·»Á
,

336 *
d©a
,

337 
mxml_cu¡om_de¡roy_cb_t
 
de¡roy
)

339 
mxml_node_t
 *
node
;

342 #ifdeà
DEBUG


343 
	`årštf
(
¡d”r
, "mxmlNewCu¡omÕ¬’t=%p, d©a=%p, de¡roy=%p)\n", 
·»Á
,

344 
d©a
, 
de¡roy
);

351 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_CUSTOM
)è!ğ
NULL
)

353 
node
->
v®ue
.
cu¡om
.
d©a
 = data;

354 
node
->
v®ue
.
cu¡om
.
de¡roy
 = destroy;

357  (
node
);

358 
	}
}

369 
mxml_node_t
 *

370 
	$mxmlNewEËm’t
(
mxml_node_t
 *
·»Á
,

371 cÚ¡ *
Çme
)

373 
mxml_node_t
 *
node
;

376 #ifdeà
DEBUG


377 
	`årštf
(
¡d”r
, "mxmlNewEËm’tÕ¬’t=%p,‚ame=\"%s\")\n", 
·»Á
,

378 
Çme
 ?‚ame : "(null)");

385 ià(!
Çme
)

386  (
NULL
);

392 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_ELEMENT
)è!ğ
NULL
)

393 
node
->
v®ue
.
–em’t
.
Çme
 = 
	`¡rdup
(name);

395  (
node
);

396 
	}
}

407 
mxml_node_t
 *

408 
	$mxmlNewIÁeg”
(
mxml_node_t
 *
·»Á
,

409 
š‹g”
)

411 
mxml_node_t
 *
node
;

414 #ifdeà
DEBUG


415 
	`årštf
(
¡d”r
, "mxmlNewIÁeg”Õ¬’t=%p, iÁeg”=%d)\n", 
·»Á
, 
š‹g”
);

422 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_INTEGER
)è!ğ
NULL
)

423 
node
->
v®ue
.
š‹g”
 = integer;

425  (
node
);

426 
	}
}

438 
mxml_node_t
 *

439 
	$mxmlNewO·que
(
mxml_node_t
 *
·»Á
,

440 cÚ¡ *
İaque
)

442 
mxml_node_t
 *
node
;

445 #ifdeà
DEBUG


446 
	`årštf
(
¡d”r
, "mxmlNewO·queÕ¬’t=%p, o·que=\"%s\")\n", 
·»Á
,

447 
İaque
 ? opaque : "(null)");

454 ià(!
İaque
)

455  (
NULL
);

461 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_OPAQUE
)è!ğ
NULL
)

462 
node
->
v®ue
.
İaque
 = 
	`¡rdup
(opaque);

464  (
node
);

465 
	}
}

476 
mxml_node_t
 *

477 
	$mxmlNewR—l
(
mxml_node_t
 *
·»Á
,

478 
»®
)

480 
mxml_node_t
 *
node
;

483 #ifdeà
DEBUG


484 
	`årštf
(
¡d”r
, "mxmlNewR—lÕ¬’t=%p,„—l=%g)\n", 
·»Á
, 
»®
);

491 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_REAL
)è!ğ
NULL
)

492 
node
->
v®ue
.
»®
 =„eal;

494  (
node
);

495 
	}
}

508 
mxml_node_t
 *

509 
	$mxmlNewText
(
mxml_node_t
 *
·»Á
,

510 
wh™e¥aû
,

511 cÚ¡ *
¡ršg
)

513 
mxml_node_t
 *
node
;

516 #ifdeà
DEBUG


517 
	`årštf
(
¡d”r
, "mxmlNewText(parent=%p, whitespace=%d, string=\"%s\")\n",

518 
·»Á
, 
wh™e¥aû
, 
¡ršg
 ? string : "(null)");

525 ià(!
¡ršg
)

526  (
NULL
);

532 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_TEXT
)è!ğ
NULL
)

534 
node
->
v®ue
.
‹xt
.
wh™e¥aû
 = whitespace;

535 
node
->
v®ue
.
‹xt
.
¡ršg
 = 
	`¡rdup
(string);

538  (
node
);

539 
	}
}

552 
mxml_node_t
 *

553 
	$mxmlNewTextf
(
mxml_node_t
 *
·»Á
,

554 
wh™e¥aû
,

555 cÚ¡ *
fÜm©
,

558 
mxml_node_t
 *
node
;

559 
va_li¡
 
­
;

562 #ifdeà
DEBUG


563 
	`årštf
(
¡d”r
, "mxmlNewTextf(parent=%p, whitespace=%d, format=\"%s\", ...)\n",

564 
·»Á
, 
wh™e¥aû
, 
fÜm©
 ? format : "(null)");

571 ià(!
fÜm©
)

572  (
NULL
);

578 ià((
node
 = 
	`mxml_Ãw
(
·»Á
, 
MXML_TEXT
)è!ğ
NULL
)

580 
	`va_¡¬t
(
­
, 
fÜm©
);

582 
node
->
v®ue
.
‹xt
.
wh™e¥aû
 = whitespace;

583 
node
->
v®ue
.
‹xt
.
¡ršg
 = 
	`_mxml_v¡rdupf
(
fÜm©
, 
­
);

585 
	`va_’d
(
­
);

588  (
node
);

589 
	}
}

600 
	$mxmlRemove
(
mxml_node_t
 *
node
)

602 #ifdeà
DEBUG


603 
	`årštf
(
¡d”r
, "mxmlRemoveÒode=%p)\n", 
node
);

610 ià(!
node
 || !node->
·»Á
)

617 #ià
DEBUG
 > 1

618 
	`årštf
(
¡d”r
, " BEFORE:‚ode->·»Á=%p\n", 
node
->
·»Á
);

619 ià(
node
->
·»Á
)

621 
	`årštf
(
¡d”r
, " BEFORE:‚ode->·»Á->chd=%p\n", 
node
->
·»Á
->
chd
);

622 
	`årštf
(
¡d”r
, " BEFORE:‚ode->·»Á->Ï¡_chd=%p\n", 
node
->
·»Á
->
Ï¡_chd
);

624 
	`årštf
(
¡d”r
, " BEFORE:‚ode->chd=%p\n", 
node
->
chd
);

625 
	`årštf
(
¡d”r
, " BEFORE:‚ode->Ï¡_chd=%p\n", 
node
->
Ï¡_chd
);

626 
	`årštf
(
¡d”r
, " BEFORE:‚ode->´ev=%p\n", 
node
->
´ev
);

627 
	`årštf
(
¡d”r
, " BEFORE:‚ode->Ãxt=%p\n", 
node
->
Ãxt
);

630 ià(
node
->
´ev
)

631 
node
->
´ev
->
Ãxt
 =‚ode->next;

633 
node
->
·»Á
->
chd
 =‚ode->
Ãxt
;

635 ià(
node
->
Ãxt
)

636 
node
->
Ãxt
->
´ev
 =‚ode->prev;

638 
node
->
·»Á
->
Ï¡_chd
 =‚ode->
´ev
;

640 
node
->
·»Á
 = 
NULL
;

641 
node
->
´ev
 = 
NULL
;

642 
node
->
Ãxt
 = 
NULL
;

644 #ià
DEBUG
 > 1

645 
	`årštf
(
¡d”r
, " AFTER:‚ode->·»Á=%p\n", 
node
->
·»Á
);

646 ià(
node
->
·»Á
)

648 
	`årštf
(
¡d”r
, " AFTER:‚ode->·»Á->chd=%p\n", 
node
->
·»Á
->
chd
);

649 
	`årštf
(
¡d”r
, " AFTER:‚ode->·»Á->Ï¡_chd=%p\n", 
node
->
·»Á
->
Ï¡_chd
);

651 
	`årštf
(
¡d”r
, " AFTER:‚ode->chd=%p\n", 
node
->
chd
);

652 
	`årštf
(
¡d”r
, " AFTER:‚ode->Ï¡_chd=%p\n", 
node
->
Ï¡_chd
);

653 
	`årštf
(
¡d”r
, " AFTER:‚ode->´ev=%p\n", 
node
->
´ev
);

654 
	`årštf
(
¡d”r
, " AFTER:‚ode->Ãxt=%p\n", 
node
->
Ãxt
);

656 
	}
}

668 
mxml_node_t
 *

669 
	$mxmlNewXML
(cÚ¡ *
v”siÚ
)

671 
–em’t
[1024];

674 
	`¢´štf
(
–em’t
, (element), "?xml version=\"%s\"ƒncoding=\"utf-8\"?",

675 
v”siÚ
 ? version : "1.0");

677  (
	`mxmlNewEËm’t
(
NULL
, 
–em’t
));

678 
	}
}

691 
	$mxmlR–—£
(
mxml_node_t
 *
node
)

693 ià(
node
)

695 ià((-- 
node
->
»f_couÁ
) <= 0)

697 
	`mxmlD–‘e
(
node
);

701  (
node
->
»f_couÁ
);

705 
	}
}

715 
	$mxmlR‘aš
(
mxml_node_t
 *
node
)

717 ià(
node
)

718  (++ 
node
->
»f_couÁ
);

721 
	}
}

731 
	$mxml_ä“
(
mxml_node_t
 *
node
)

733 
i
;

736 
node
->
ty³
)

738 
MXML_ELEMENT
 :

739 ià(
node
->
v®ue
.
–em’t
.
Çme
)

740 
	`ä“
(
node
->
v®ue
.
–em’t
.
Çme
);

742 ià(
node
->
v®ue
.
–em’t
.
num_©Œs
)

744 
i
 = 0; i < 
node
->
v®ue
.
–em’t
.
num_©Œs
; i ++)

746 ià(
node
->
v®ue
.
–em’t
.
©Œs
[
i
].
Çme
)

747 
	`ä“
(
node
->
v®ue
.
–em’t
.
©Œs
[
i
].
Çme
);

748 ià(
node
->
v®ue
.
–em’t
.
©Œs
[
i
].value)

749 
	`ä“
(
node
->
v®ue
.
–em’t
.
©Œs
[
i
].value);

752 
	`ä“
(
node
->
v®ue
.
–em’t
.
©Œs
);

755 
MXML_INTEGER
 :

758 
MXML_OPAQUE
 :

759 ià(
node
->
v®ue
.
İaque
)

760 
	`ä“
(
node
->
v®ue
.
İaque
);

762 
MXML_REAL
 :

765 
MXML_TEXT
 :

766 ià(
node
->
v®ue
.
‹xt
.
¡ršg
)

767 
	`ä“
(
node
->
v®ue
.
‹xt
.
¡ršg
);

769 
MXML_CUSTOM
 :

770 ià(
node
->
v®ue
.
cu¡om
.
d©a
 &&

771 
node
->
v®ue
.
cu¡om
.
de¡roy
)

772 (*(
node
->
v®ue
.
cu¡om
.
de¡roy
))Òode->v®ue.cu¡om.
d©a
);

782 
	`ä“
(
node
);

783 
	}
}

790 
mxml_node_t
 *

791 
	$mxml_Ãw
(
mxml_node_t
 *
·»Á
,

792 
mxml_ty³_t
 
ty³
)

794 
mxml_node_t
 *
node
;

797 #ià
DEBUG
 > 1

798 
	`årštf
(
¡d”r
, "mxml_ÃwÕ¬’t=%p,y³=%d)\n", 
·»Á
, 
ty³
);

805 ià((
node
 = 
	`ÿÎoc
(1, (
mxml_node_t
))è=ğ
NULL
)

807 #ià
DEBUG
 > 1

808 
	`åuts
("„‘uºšg NULL\n", 
¡d”r
);

811  (
NULL
);

814 #ià
DEBUG
 > 1

815 
	`årštf
(
¡d”r
, "„‘uºšg %p\n", 
node
);

822 
node
->
ty³
 =ype;

823 
node
->
»f_couÁ
 = 1;

829 ià(
·»Á
)

830 
	`mxmlAdd
(
·»Á
, 
MXML_ADD_AFTER
, 
MXML_ADD_TO_PARENT
, 
node
);

836  (
node
);

837 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-private.c

21 
	~"mxml-´iv©e.h
"

38 #ià
defšed
(
__sun
è|| defšed(
_AIX
)

39 #´agm¨
fši
(
_mxml_fši
)

40 
	#_MXML_FINI
 
_mxml_fši


	)

41 #–ià
defšed
(
__hpux
)

42 #´agm¨
FINI
 
_mxml_fši


43 
	#_MXML_FINI
 
_mxml_fši


	)

44 #–ià
defšed
(
__GNUC__
)

45 
	#_MXML_FINI
 
	`__©Œibu‹
((
de¡ruùÜ
)è
_mxml_fši


	)

47 
	#_MXML_FINI
 
_fši


	)

56 
	$mxml_”rÜ
(cÚ¡ *
fÜm©
,

59 
va_li¡
 
­
;

60 
s
[1024];

61 
_mxml_glob®_t
 *
glob®
 = 
	`_mxml_glob®
();

69 ià(!
fÜm©
)

76 
	`va_¡¬t
(
­
, 
fÜm©
);

78 
	`v¢´štf
(
s
, (s), 
fÜm©
, 
­
);

80 
	`va_’d
(
­
);

86 ià(
glob®
->
”rÜ_cb
)

87 (*
glob®
->
”rÜ_cb
)(
s
);

89 
	`årštf
(
¡d”r
, "mxml: %s\n", 
s
);

90 
	}
}

97 
mxml_ty³_t


98 
	$mxml_ignÜe_cb
(
mxml_node_t
 *
node
)

100 ()
node
;

102  (
MXML_IGNORE
);

103 
	}
}

110 
mxml_ty³_t


111 
	$mxml_š‹g”_cb
(
mxml_node_t
 *
node
)

113 ()
node
;

115  (
MXML_INTEGER
);

116 
	}
}

123 
mxml_ty³_t


124 
	$mxml_İaque_cb
(
mxml_node_t
 *
node
)

126 ()
node
;

128  (
MXML_OPAQUE
);

129 
	}
}

136 
mxml_ty³_t


137 
	$mxml_»®_cb
(
mxml_node_t
 *
node
)

139 ()
node
;

141  (
MXML_REAL
);

142 
	}
}

145 #ifdeà
HAVE_PTHREAD_H


146 
	~<±h»ad.h
>

148 
±h»ad_key_t
 
	g_mxml_key
 = -1;

149 
±h»ad_Úû_t
 
	g_mxml_key_Úû
 = 
PTHREAD_ONCE_INIT
;

151 
_mxml_š™
();

152 
_mxml_de¡ruùÜ
(*
g
);

160 
	$_mxml_de¡ruùÜ
(*
g
)

162 
	`ä“
(
g
);

163 
	}
}

171 
	$_MXML_FINI
()

173 
_mxml_glob®_t
 *
glob®
;

176 ià(
_mxml_key
 != -1)

178 ià((
glob®
 = (
_mxml_glob®_t
 *)
	`±h»ad_g‘¥ecific
(
_mxml_key
)è!ğ
NULL
)

179 
	`_mxml_de¡ruùÜ
(
glob®
);

181 
	`±h»ad_key_d–‘e
(
_mxml_key
);

182 
_mxml_key
 = -1;

184 
	}
}

191 
_mxml_glob®_t
 *

192 
	$_mxml_glob®
()

194 
_mxml_glob®_t
 *
glob®
;

197 
	`±h»ad_Úû
(&
_mxml_key_Úû
, 
_mxml_š™
);

199 ià((
glob®
 = (
_mxml_glob®_t
 *)
	`±h»ad_g‘¥ecific
(
_mxml_key
)è=ğ
NULL
)

201 
glob®
 = (
_mxml_glob®_t
 *)
	`ÿÎoc
(1, (_mxml_global_t));

202 
	`±h»ad_£t¥ecific
(
_mxml_key
, 
glob®
);

204 
glob®
->
num_’t™y_cbs
 = 1;

205 
glob®
->
’t™y_cbs
[0] = 
_mxml_’t™y_cb
;

206 
glob®
->
w¿p
 = 72;

209  (
glob®
);

210 
	}
}

218 
	$_mxml_š™
()

220 
	`±h»ad_key_ü—‹
(&
_mxml_key
, 
_mxml_de¡ruùÜ
);

221 
	}
}

224 #–ià
defšed
(
WIN32
è&& defšed(
MXML1_EXPORTS
)

225 
	~<wšdows.h
>

227 
DWORD
 
	g_mxml_s_šdex
;

234 
BOOL
 
WINAPI


235 
	$DÎMaš
(
HINSTANCE
 
hš¡
,

236 
DWORD
 
»asÚ
,

237 
LPVOID
 
»£rved
)

239 
_mxml_glob®_t
 *
glob®
;

242 ()
hš¡
;

243 ()
»£rved
;

245 
»asÚ
)

247 
DLL_PROCESS_ATTACH
 :

248 ià((
_mxml_s_šdex
 = 
	`TlsAÎoc
()è=ğ
TLS_OUT_OF_INDEXES
)

249  (
FALSE
);

252 
DLL_THREAD_DETACH
 :

253 ià((
glob®
 = (
_mxml_glob®_t
 *)
	`TlsG‘V®ue
(
_mxml_s_šdex
)è!ğ
NULL
)

254 
	`ä“
(
glob®
);

257 
DLL_PROCESS_DETACH
 :

258 ià((
glob®
 = (
_mxml_glob®_t
 *)
	`TlsG‘V®ue
(
_mxml_s_šdex
)è!ğ
NULL
)

259 
	`ä“
(
glob®
);

261 
	`TlsF»e
(
_mxml_s_šdex
);

268  (
TRUE
);

269 
	}
}

276 
_mxml_glob®_t
 *

277 
	$_mxml_glob®
()

279 
_mxml_glob®_t
 *
glob®
;

282 ià((
glob®
 = (
_mxml_glob®_t
 *)
	`TlsG‘V®ue
(
_mxml_s_šdex
)è=ğ
NULL
)

284 
glob®
 = (
_mxml_glob®_t
 *)
	`ÿÎoc
(1, (_mxml_global_t));

286 
glob®
->
num_’t™y_cbs
 = 1;

287 
glob®
->
’t™y_cbs
[0] = 
_mxml_’t™y_cb
;

288 
glob®
->
w¿p
 = 72;

290 
	`TlsS‘V®ue
(
_mxml_s_šdex
, (
LPVOID
)
glob®
);

293  (
glob®
);

294 
	}
}

302 
_mxml_glob®_t
 *

303 
	$_mxml_glob®
()

305 
_mxml_glob®_t
 
glob®
 =

307 
NULL
,

309 { 
_mxml_’t™y_cb
 },

311 
NULL
,

312 
NULL


316  (&
glob®
);

317 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-search.c

22 
	~"cÚfig.h
"

23 
	~"mxml.h
"

39 
mxml_node_t
 *

40 
	$mxmlFšdEËm’t
(
mxml_node_t
 *
node
,

41 
mxml_node_t
 *
tİ
,

42 cÚ¡ *
Çme
,

43 cÚ¡ *
©Œ
,

44 cÚ¡ *
v®ue
,

45 
desûnd
)

47 cÚ¡ *
‹mp
;

54 ià(!
node
 || !
tİ
 || (!
©Œ
 && 
v®ue
))

55  (
NULL
);

61 
node
 = 
	`mxmlW®kNext
Òode, 
tİ
, 
desûnd
);

67 
node
 !ğ
NULL
)

73 ià(
node
->
ty³
 =ğ
MXML_ELEMENT
 &&

74 
node
->
v®ue
.
–em’t
.
Çme
 &&

75 (!
Çme
 || !
	`¡rcmp
(
node
->
v®ue
.
–em’t
.name,‚ame)))

81 ià(!
©Œ
)

82  (
node
);

88 ià((
‹mp
 = 
	`mxmlEËm’tG‘A‰r
(
node
, 
©Œ
)è!ğ
NULL
)

94 ià(!
v®ue
 || !
	`¡rcmp
(v®ue, 
‹mp
))

95  (
node
);

103 ià(
desûnd
 =ğ
MXML_DESCEND
)

104 
node
 = 
	`mxmlW®kNext
Òode, 
tİ
, 
MXML_DESCEND
);

106 
node
 =‚ode->
Ãxt
;

109  (
NULL
);

110 
	}
}

126 
mxml_node_t
 *

127 
	$mxmlFšdP©h
(
mxml_node_t
 *
tİ
,

128 cÚ¡ *
·th
)

130 
mxml_node_t
 *
node
;

131 
–em’t
[256];

132 cÚ¡ *
·th£p
;

133 
desûnd
;

140 ià(!
tİ
 || !
·th
 || !*path)

141  (
NULL
);

147 
node
 = 
tİ
;

148 *
·th
)

154 ià(!
	`¡ºcmp
(
·th
, "*/", 2))

156 
·th
 += 2;

157 
desûnd
 = 
MXML_DESCEND
;

160 
desûnd
 = 
MXML_DESCEND_FIRST
;

166 ià((
·th£p
 = 
	`¡rchr
(
·th
, '/')è=ğ
NULL
)

167 
·th£p
 = 
·th
 + 
	`¡¾’
(path);

169 ià(
·th£p
 =ğ
·th
 || (·th£°-…©hè>ğ(
–em’t
))

170  (
NULL
);

172 
	`memıy
(
–em’t
, 
·th
, 
·th£p
 -…ath);

173 
–em’t
[
·th£p
 - 
·th
] = '\0';

175 ià(*
·th£p
)

176 
·th
 = 
·th£p
 + 1;

178 
·th
 = 
·th£p
;

184 ià((
node
 = 
	`mxmlFšdEËm’t
Òode,‚ode, 
–em’t
, 
NULL
, NULL,

185 
desûnd
)è=ğ
NULL
)

186  (
NULL
);

193 ià(
node
->
chd
 &&‚ode->chd->
ty³
 !ğ
MXML_ELEMENT
)

194  (
node
->
chd
);

196  (
node
);

197 
	}
}

208 
mxml_node_t
 *

209 
	$mxmlW®kNext
(
mxml_node_t
 *
node
,

210 
mxml_node_t
 *
tİ
,

211 
desûnd
)

213 ià(!
node
)

214  (
NULL
);

215 ià(
node
->
chd
 && 
desûnd
)

216  (
node
->
chd
);

217 ià(
node
 =ğ
tİ
)

218  (
NULL
);

219 ià(
node
->
Ãxt
)

220  (
node
->
Ãxt
);

221 ià(
node
->
·»Á
 &&‚ode->·»Á !ğ
tİ
)

223 
node
 =‚ode->
·»Á
;

225 !
node
->
Ãxt
)

226 ià(
node
->
·»Á
 =ğ
tİ
 || !node->parent)

227  (
NULL
);

229 
node
 =‚ode->
·»Á
;

231  (
node
->
Ãxt
);

234  (
NULL
);

235 
	}
}

246 
mxml_node_t
 *

247 
	$mxmlW®kP»v
(
mxml_node_t
 *
node
,

248 
mxml_node_t
 *
tİ
,

249 
desûnd
)

251 ià(!
node
 ||‚od=ğ
tİ
)

252  (
NULL
);

253 ià(
node
->
´ev
)

255 ià(
node
->
´ev
->
Ï¡_chd
 && 
desûnd
)

261 
node
 =‚ode->
´ev
->
Ï¡_chd
;

263 
node
->
Ï¡_chd
)

264 
node
 =‚ode->
Ï¡_chd
;

266  (
node
);

269  (
node
->
´ev
);

271 ià(
node
->
·»Á
 !ğ
tİ
)

272  (
node
->
·»Á
);

274  (
NULL
);

275 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-set.c

21 
	~"cÚfig.h
"

22 
	~"mxml.h
"

34 
	$mxmlS‘CDATA
(
mxml_node_t
 *
node
,

35 cÚ¡ *
d©a
)

41 ià(
node
 &&‚ode->
ty³
 =ğ
MXML_ELEMENT
 &&

42 
	`¡ºcmp
(
node
->
v®ue
.
–em’t
.
Çme
, "![CDATA[", 8) &&

43 
node
->
chd
 &&‚ode->chd->
ty³
 =ğ
MXML_ELEMENT
 &&

44 !
	`¡ºcmp
(
node
->
chd
->
v®ue
.
–em’t
.
Çme
, "![CDATA[", 8))

45 
node
 =‚ode->
chd
;

47 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
 || !
d©a
 ||

48 
	`¡ºcmp
(
node
->
v®ue
.
–em’t
.
Çme
, "![CDATA[", 8))

55 ià(
node
->
v®ue
.
–em’t
.
Çme
)

56 
	`ä“
(
node
->
v®ue
.
–em’t
.
Çme
);

58 
node
->
v®ue
.
–em’t
.
Çme
 = 
	`_mxml_¡rdupf
("![CDATA[%s]]", 
d©a
);

61 
	}
}

73 
	$mxmlS‘Cu¡om
(

74 
mxml_node_t
 *
node
,

75 *
d©a
,

76 
mxml_cu¡om_de¡roy_cb_t
 
de¡roy
)

82 ià(
node
 &&‚ode->
ty³
 =ğ
MXML_ELEMENT
 &&

83 
node
->
chd
 &&‚ode->chd->
ty³
 =ğ
MXML_CUSTOM
)

84 
node
 =‚ode->
chd
;

86 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_CUSTOM
)

93 ià(
node
->
v®ue
.
cu¡om
.
d©a
 &&‚ode->v®ue.cu¡om.
de¡roy
)

94 (*(
node
->
v®ue
.
cu¡om
.
de¡roy
))Òode->v®ue.cu¡om.
d©a
);

96 
node
->
v®ue
.
cu¡om
.
d©a
 = data;

97 
node
->
v®ue
.
cu¡om
.
de¡roy
 = destroy;

100 
	}
}

110 
	$mxmlS‘EËm’t
(
mxml_node_t
 *
node
,

111 cÚ¡ *
Çme
)

117 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_ELEMENT
 || !
Çme
)

124 ià(
node
->
v®ue
.
–em’t
.
Çme
)

125 
	`ä“
(
node
->
v®ue
.
–em’t
.
Çme
);

127 
node
->
v®ue
.
–em’t
.
Çme
 = 
	`¡rdup
(name);

130 
	}
}

140 
	$mxmlS‘IÁeg”
(
mxml_node_t
 *
node
,

141 
š‹g”
)

147 ià(
node
 &&‚ode->
ty³
 =ğ
MXML_ELEMENT
 &&

148 
node
->
chd
 &&‚ode->chd->
ty³
 =ğ
MXML_INTEGER
)

149 
node
 =‚ode->
chd
;

151 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_INTEGER
)

158 
node
->
v®ue
.
š‹g”
 = integer;

161 
	}
}

171 
	$mxmlS‘O·que
(
mxml_node_t
 *
node
,

172 cÚ¡ *
İaque
)

178 ià(
node
 &&‚ode->
ty³
 =ğ
MXML_ELEMENT
 &&

179 
node
->
chd
 &&‚ode->chd->
ty³
 =ğ
MXML_OPAQUE
)

180 
node
 =‚ode->
chd
;

182 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_OPAQUE
 || !
İaque
)

189 ià(
node
->
v®ue
.
İaque
)

190 
	`ä“
(
node
->
v®ue
.
İaque
);

192 
node
->
v®ue
.
İaque
 = 
	`¡rdup
(opaque);

195 
	}
}

205 
	$mxmlS‘R—l
(
mxml_node_t
 *
node
,

206 
»®
)

212 ià(
node
 &&‚ode->
ty³
 =ğ
MXML_ELEMENT
 &&

213 
node
->
chd
 &&‚ode->chd->
ty³
 =ğ
MXML_REAL
)

214 
node
 =‚ode->
chd
;

216 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_REAL
)

223 
node
->
v®ue
.
»®
 =„eal;

226 
	}
}

236 
	$mxmlS‘Text
(
mxml_node_t
 *
node
,

237 
wh™e¥aû
,

238 cÚ¡ *
¡ršg
)

244 ià(
node
 &&‚ode->
ty³
 =ğ
MXML_ELEMENT
 &&

245 
node
->
chd
 &&‚ode->chd->
ty³
 =ğ
MXML_TEXT
)

246 
node
 =‚ode->
chd
;

248 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_TEXT
 || !
¡ršg
)

255 ià(
node
->
v®ue
.
‹xt
.
¡ršg
)

256 
	`ä“
(
node
->
v®ue
.
‹xt
.
¡ršg
);

258 
node
->
v®ue
.
‹xt
.
wh™e¥aû
 = whitespace;

259 
node
->
v®ue
.
‹xt
.
¡ršg
 = 
	`¡rdup
(string);

262 
	}
}

272 
	$mxmlS‘Textf
(
mxml_node_t
 *
node
,

273 
wh™e¥aû
,

274 cÚ¡ *
fÜm©
,

277 
va_li¡
 
­
;

284 ià(
node
 &&‚ode->
ty³
 =ğ
MXML_ELEMENT
 &&

285 
node
->
chd
 &&‚ode->chd->
ty³
 =ğ
MXML_TEXT
)

286 
node
 =‚ode->
chd
;

288 ià(!
node
 ||‚ode->
ty³
 !ğ
MXML_TEXT
 || !
fÜm©
)

295 ià(
node
->
v®ue
.
‹xt
.
¡ršg
)

296 
	`ä“
(
node
->
v®ue
.
‹xt
.
¡ršg
);

298 
	`va_¡¬t
(
­
, 
fÜm©
);

300 
node
->
v®ue
.
‹xt
.
wh™e¥aû
 = whitespace;

301 
node
->
v®ue
.
‹xt
.
¡ršg
 = 
	`_mxml_¡rdupf
(
fÜm©
, 
­
);

303 
	`va_’d
(
­
);

306 
	}
}

316 
	$mxmlS‘U£rD©a
(
mxml_node_t
 *
node
,

317 *
d©a
)

323 ià(!
node
)

330 
node
->
u£r_d©a
 = 
d©a
;

332 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-string.c

21 
	~"cÚfig.h
"

29 #iâdeà
va_cİy


30 #ifdeà
__va_cİy


31 
	#va_cİy
(
d¡
,
¤c
è
	`__va_cİy
(d¡,¤c)

	)

33 
	#va_cİy
(
d¡
,
¤c
è
	`memıy
(&d¡, src, (
va_li¡
))

	)

38 #iâdeà
HAVE_SNPRINTF


44 
	$_mxml_¢´štf
(*
bufãr
,

45 
size_t
 
bufsize
,

46 cÚ¡ *
fÜm©
,

49 
va_li¡
 
­
;

50 
by‹s
;

53 
	`va_¡¬t
(
­
, 
fÜm©
);

54 
by‹s
 = 
	`v¢´štf
(
bufãr
, 
bufsize
, 
fÜm©
, 
­
);

55 
	`va_’d
(
­
);

57  (
by‹s
);

58 
	}
}

66 #iâdeà
HAVE_STRDUP


68 
	$_mxml_¡rdup
(cÚ¡ *
s
)

70 *
t
;

73 ià(
s
 =ğ
NULL
)

74  (
NULL
);

76 ià((
t
 = 
	`m®loc
(
	`¡¾’
(
s
è+ 1)è=ğ
NULL
)

77  (
NULL
);

79  (
	`¡rıy
(
t
, 
s
));

80 
	}
}

89 
	$_mxml_¡rdupf
(cÚ¡ *
fÜm©
,

92 
va_li¡
 
­
;

93 *
s
;

101 
	`va_¡¬t
(
­
, 
fÜm©
);

102 
s
 = 
	`_mxml_v¡rdupf
(
fÜm©
, 
­
);

103 
	`va_’d
(
­
);

105  (
s
);

106 
	}
}

109 #iâdeà
HAVE_VSNPRINTF


115 
	$_mxml_v¢´štf
(*
bufãr
,

116 
size_t
 
bufsize
,

117 cÚ¡ *
fÜm©
,

118 
va_li¡
 
­
)

120 *
buåŒ
,

121 *
buãnd
,

122 
sign
,

123 
size
,

124 
ty³
;

125 
width
,

126 
´ec
;

127 
tfÜm©
[100],

128 *
Œ
,

129 
‹mp
[1024];

130 *
s
;

131 
¦’
;

132 
by‹s
;

139 
buåŒ
 = 
bufãr
;

140 
buãnd
 = 
bufãr
 + 
bufsize
 - 1;

141 
by‹s
 = 0;

143 *
fÜm©
)

145 ià(*
fÜm©
 == '%')

147 
Œ
 = 
tfÜm©
;

148 *
Œ
++ = *
fÜm©
++;

150 ià(*
fÜm©
 == '%')

152 ià(
buåŒ
 && buåŒ < 
buãnd
)

153 *
buåŒ
++ = *
fÜm©
;

154 
by‹s
 ++;

155 
fÜm©
 ++;

158 ià(
	`¡rchr
(" -+#\'", *
fÜm©
))

160 *
Œ
++ = *
fÜm©
;

161 
sign
 = *
fÜm©
++;

164 
sign
 = 0;

166 ià(*
fÜm©
 == '*')

172 
fÜm©
 ++;

173 
width
 = 
	`va_¬g
(
­
, );

175 
	`¢´štf
(
Œ
, (
tfÜm©
è- (Œ -fÜm©), "%d", 
width
);

176 
Œ
 +ğ
	`¡¾’
(tptr);

180 
width
 = 0;

182 
	`isdig™
(*
fÜm©
 & 255))

184 ià(
Œ
 < (
tfÜm©
 + (tformat) - 1))

185 *
Œ
++ = *
fÜm©
;

187 
width
 = width * 10 + *
fÜm©
++ - '0';

191 ià(*
fÜm©
 == '.')

193 ià(
Œ
 < (
tfÜm©
 + (tformat) - 1))

194 *
Œ
++ = *
fÜm©
;

196 
fÜm©
 ++;

198 ià(*
fÜm©
 == '*')

204 
fÜm©
 ++;

205 
´ec
 = 
	`va_¬g
(
­
, );

207 
	`¢´štf
(
Œ
, (
tfÜm©
è- (Œ -fÜm©), "%d", 
´ec
);

208 
Œ
 +ğ
	`¡¾’
(tptr);

212 
´ec
 = 0;

214 
	`isdig™
(*
fÜm©
 & 255))

216 ià(
Œ
 < (
tfÜm©
 + (tformat) - 1))

217 *
Œ
++ = *
fÜm©
;

219 
´ec
 =…»ø* 10 + *
fÜm©
++ - '0';

224 
´ec
 = -1;

226 ià(*
fÜm©
 == 'l' && format[1] == 'l')

228 
size
 = 'L';

230 ià(
Œ
 < (
tfÜm©
 + (tformat) - 2))

232 *
Œ
++ = 'l';

233 *
Œ
++ = 'l';

236 
fÜm©
 += 2;

238 ià(*
fÜm©
 == 'h' || *format == 'l' || *format == 'L')

240 ià(
Œ
 < (
tfÜm©
 + (tformat) - 1))

241 *
Œ
++ = *
fÜm©
;

243 
size
 = *
fÜm©
++;

246 ià(!*
fÜm©
)

249 ià(
Œ
 < (
tfÜm©
 + (tformat) - 1))

250 *
Œ
++ = *
fÜm©
;

252 
ty³
 = *
fÜm©
++;

253 *
Œ
 = '\0';

255 
ty³
)

262 ià((
width
 + 2è> (
‹mp
))

265 
	`¥rštf
(
‹mp
, 
tfÜm©
, 
	`va_¬g
(
­
, ));

267 
by‹s
 +ğ
	`¡¾’
(
‹mp
);

269 ià(
buåŒ
)

271 ià((
buåŒ
 + 
	`¡¾’
(
‹mp
)è> 
buãnd
)

273 
	`¡ºıy
(
buåŒ
, 
‹mp
, (
size_t
)(
buãnd
 - bufptr));

274 
buåŒ
 = 
buãnd
;

278 
	`¡rıy
(
buåŒ
, 
‹mp
);

279 
buåŒ
 +ğ
	`¡¾’
(
‹mp
);

292 ià((
width
 + 2è> (
‹mp
))

295 #ifdeà
HAVE_LONG_LONG


296 ià(
size
 == 'L')

297 
	`¥rštf
(
‹mp
, 
tfÜm©
, 
	`va_¬g
(
­
, ));

300 
	`¥rštf
(
‹mp
, 
tfÜm©
, 
	`va_¬g
(
­
, ));

302 
by‹s
 +ğ
	`¡¾’
(
‹mp
);

304 ià(
buåŒ
)

306 ià((
buåŒ
 + 
	`¡¾’
(
‹mp
)è> 
buãnd
)

308 
	`¡ºıy
(
buåŒ
, 
‹mp
, (
size_t
)(
buãnd
 - bufptr));

309 
buåŒ
 = 
buãnd
;

313 
	`¡rıy
(
buåŒ
, 
‹mp
);

314 
buåŒ
 +ğ
	`¡¾’
(
‹mp
);

320 ià((
width
 + 2è> (
‹mp
))

323 
	`¥rštf
(
‹mp
, 
tfÜm©
, 
	`va_¬g
(
­
, *));

325 
by‹s
 +ğ
	`¡¾’
(
‹mp
);

327 ià(
buåŒ
)

329 ià((
buåŒ
 + 
	`¡¾’
(
‹mp
)è> 
buãnd
)

331 
	`¡ºıy
(
buåŒ
, 
‹mp
, (
size_t
)(
buãnd
 - bufptr));

332 
buåŒ
 = 
buãnd
;

336 
	`¡rıy
(
buåŒ
, 
‹mp
);

337 
buåŒ
 +ğ
	`¡¾’
(
‹mp
);

343 
by‹s
 +ğ
width
;

345 ià(
buåŒ
)

347 ià(
width
 <= 1)

348 *
buåŒ
++ = 
	`va_¬g
(
­
, );

351 ià((
buåŒ
 + 
width
è> 
buãnd
)

352 
width
 = 
buãnd
 - 
buåŒ
;

354 
	`memıy
(
buåŒ
, 
	`va_¬g
(
­
, *), (
size_t
)
width
);

355 
buåŒ
 +ğ
width
;

361 ià((
s
 = 
	`va_¬g
(
­
, *)è=ğ
NULL
)

362 
s
 = "(null)";

364 
¦’
 = 
	`¡¾’
(
s
);

365 ià(
¦’
 > 
width
 && 
´ec
 != width)

366 
width
 = 
¦’
;

368 
by‹s
 +ğ
width
;

370 ià(
buåŒ
)

372 ià((
buåŒ
 + 
width
è> 
buãnd
)

373 
width
 = 
buãnd
 - 
buåŒ
;

375 ià(
¦’
 > 
width
)

376 
¦’
 = 
width
;

378 ià(
sign
 == '-')

380 
	`¡ºıy
(
buåŒ
, 
s
, (
size_t
)
¦’
);

381 
	`mem£t
(
buåŒ
 + 
¦’
, ' ', (
size_t
)(
width
 - slen));

385 
	`mem£t
(
buåŒ
, ' ', (
size_t
)(
width
 - 
¦’
));

386 
	`¡ºıy
(
buåŒ
 + 
width
 - 
¦’
, 
s
, (
size_t
)slen);

389 
buåŒ
 +ğ
width
;

394 *(
	`va_¬g
(
­
, *)èğ
by‹s
;

400 
by‹s
 ++;

402 ià(
buåŒ
 && buåŒ < 
buãnd
)

403 *
buåŒ
++ = *
fÜm©
;

405 
fÜm©
 ++;

413 *
buåŒ
 = '\0';

414 
size
=size;

415  (
by‹s
);

416 
	}
}

425 
	$_mxml_v¡rdupf
(cÚ¡ *
fÜm©
,

426 
va_li¡
 
­
)

428 
by‹s
;

429 *
bufãr
,

430 
‹mp
[256];

431 
va_li¡
 
­cİy
;

439 
	`va_cİy
(
­cİy
, 
­
);

440 
by‹s
 = 
	`v¢´štf
(
‹mp
, Ñemp), 
fÜm©
, 
­cİy
);

442 ià(
by‹s
 < (
‹mp
))

448  (
	`¡rdup
(
‹mp
));

456 ià((
bufãr
 = 
	`ÿÎoc
(1, 
by‹s
 + 1)è!ğ
NULL
)

457 
	`v¢´štf
(
bufãr
, 
by‹s
 + 1, 
fÜm©
, 
­
);

463  (
bufãr
);

464 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\testmxml.c

26 
	~"cÚfig.h
"

27 
	~"mxml.h
"

33 
	gev’t_couÁs
[6];

41 
	$‹¡mxml_’Œy
(
¬gc
,

42 *
¬gv
[])

44 
i
;

45 
FIL
 
f
;

46 
mxml_node_t
 *
Œ“
,

47 *
node
;

48 
mxml_šdex_t
 *
šd
;

49 
bufãr
[16384];

50 cÚ¡ *
ty³s
[] =

64 ià(
¬gc
 != 2 &&‡rgc != 3)

66 
	`åuts
("U§ge:e¡mxmÈf’ame.xmÈ[¡ršg-ouut.xml]\n", 
¡d”r
);

74 
Œ“
 = 
	`mxmlNewEËm’t
(
MXML_NO_PARENT
, "element");

76 ià(!
Œ“
)

78 
	`åuts
("ERROR: NØ·»Á‚odš basiø‹¡.\n", 
¡d”r
);

82 ià(
Œ“
->
ty³
 !ğ
MXML_ELEMENT
)

84 
	`årštf
(
¡d”r
, "ERROR: Parent hasype %s (%d),ƒxpected MXML_ELEMENT.\n",

85 
Œ“
->
ty³
 < 
MXML_ELEMENT
 ||»e->ty³ > 
MXML_TEXT
 ?

86 "UNKNOWN" : 
ty³s
[
Œ“
->
ty³
],ree->type);

87 
	`mxmlD–‘e
(
Œ“
);

91 ià(
	`¡rcmp
(
Œ“
->
v®ue
.
–em’t
.
Çme
, "element"))

93 
	`årštf
(
¡d”r
, "ERROR: Parent value is \"%s\",ƒxpected \"element\".\n",

94 
Œ“
->
v®ue
.
–em’t
.
Çme
);

95 
	`mxmlD–‘e
(
Œ“
);

99 
	`mxmlNewIÁeg”
(
Œ“
, 123);

100 
	`mxmlNewO·que
(
Œ“
, "opaque");

101 
	`mxmlNewR—l
(
Œ“
, 123.4f);

102 
	`mxmlNewText
(
Œ“
, 1, "text");

104 
	`mxmlLßdSŒšg
(
Œ“
, "<groupype='string'>string string string</group>",

105 
MXML_NO_CALLBACK
);

106 
	`mxmlLßdSŒšg
(
Œ“
, "<groupype='integer'>1 2 3</group>",

107 
MXML_INTEGER_CALLBACK
);

108 
	`mxmlLßdSŒšg
(
Œ“
, "<groupype='real'>1.0 2.0 3.0</group>",

109 
MXML_REAL_CALLBACK
);

110 
	`mxmlLßdSŒšg
(
Œ“
, "<group>opaque opaque opaque</group>",

111 
MXML_OPAQUE_CALLBACK
);

112 
	`mxmlLßdSŒšg
(
Œ“
, "<foo><bar><one><two>value<two>value2</two></two></one>"

113 "</b¬></foo>", 
MXML_OPAQUE_CALLBACK
);

115 
node
 = 
Œ“
->
chd
;

117 ià(!
node
)

119 
	`åuts
("ERROR: NØfœ¡ chd‚odš basiø‹¡.\n", 
¡d”r
);

120 
	`mxmlD–‘e
(
Œ“
);

124 ià(
node
->
ty³
 !ğ
MXML_INTEGER
)

126 
	`årštf
(
¡d”r
, "ERROR: First child hasype %s (%d),ƒxpected MXML_INTEGER.\n",

127 
node
->
ty³
 < 
MXML_ELEMENT
 ||‚ode->ty³ > 
MXML_TEXT
 ?

128 "UNKNOWN" : 
ty³s
[
node
->
ty³
],‚ode->type);

129 
	`mxmlD–‘e
(
Œ“
);

133 ià(
node
->
v®ue
.
š‹g”
 != 123)

135 
	`årštf
(
¡d”r
, "ERROR: First child value is %d,ƒxpected 123.\n",

136 
node
->
v®ue
.
š‹g”
);

137 
	`mxmlD–‘e
(
Œ“
);

141 
node
 =‚ode->
Ãxt
;

143 ià(!
node
)

145 
	`åuts
("ERROR: NØ£cÚd chd‚odš basiø‹¡.\n", 
¡d”r
);

146 
	`mxmlD–‘e
(
Œ“
);

150 ià(
node
->
ty³
 !ğ
MXML_OPAQUE
)

152 
	`årštf
(
¡d”r
, "ERROR: Second child hasype %s (%d),ƒxpected MXML_OPAQUE.\n",

153 
node
->
ty³
 < 
MXML_ELEMENT
 ||‚ode->ty³ > 
MXML_TEXT
 ?

154 "UNKNOWN" : 
ty³s
[
node
->
ty³
],‚ode->type);

155 
	`mxmlD–‘e
(
Œ“
);

159 ià(!
node
->
v®ue
.
İaque
 || 
	`¡rcmp
(node->value.opaque, "opaque"))

161 
	`årštf
(
¡d”r
, "ERROR: Second child value is \"%s\",ƒxpected \"opaque\".\n",

162 
node
->
v®ue
.
İaque
 ?‚ode->value.opaque : "(null)");

163 
	`mxmlD–‘e
(
Œ“
);

167 
node
 =‚ode->
Ãxt
;

169 ià(!
node
)

171 
	`åuts
("ERROR: NØthœd chd‚odš basiø‹¡.\n", 
¡d”r
);

172 
	`mxmlD–‘e
(
Œ“
);

176 ià(
node
->
ty³
 !ğ
MXML_REAL
)

178 
	`årštf
(
¡d”r
, "ERROR: Third child hasype %s (%d),ƒxpected MXML_REAL.\n",

179 
node
->
ty³
 < 
MXML_ELEMENT
 ||‚ode->ty³ > 
MXML_TEXT
 ?

180 "UNKNOWN" : 
ty³s
[
node
->
ty³
],‚ode->type);

181 
	`mxmlD–‘e
(
Œ“
);

185 ià(
node
->
v®ue
.
»®
 != 123.4f)

187 
	`årštf
(
¡d”r
, "ERROR: Third child value is %f,ƒxpected 123.4.\n",

188 
node
->
v®ue
.
»®
);

189 
	`mxmlD–‘e
(
Œ“
);

193 
node
 =‚ode->
Ãxt
;

195 ià(!
node
)

197 
	`åuts
("ERROR: NØfou¹h chd‚odš basiø‹¡.\n", 
¡d”r
);

198 
	`mxmlD–‘e
(
Œ“
);

202 ià(
node
->
ty³
 !ğ
MXML_TEXT
)

204 
	`årštf
(
¡d”r
, "ERROR: Fourth child hasype %s (%d),ƒxpected MXML_TEXT.\n",

205 
node
->
ty³
 < 
MXML_ELEMENT
 ||‚ode->ty³ > 
MXML_TEXT
 ?

206 "UNKNOWN" : 
ty³s
[
node
->
ty³
],‚ode->type);

207 
	`mxmlD–‘e
(
Œ“
);

211 ià(!
node
->
v®ue
.
‹xt
.
wh™e¥aû
 ||

212 !
node
->
v®ue
.
‹xt
.
¡ršg
 || 
	`¡rcmp
(node->value.text.string, "text"))

214 
	`årštf
(
¡d”r
, "ERROR: Fourth child value is %d,\"%s\",ƒxpected 1,\"text\".\n",

215 
node
->
v®ue
.
‹xt
.
wh™e¥aû
,

216 
node
->
v®ue
.
‹xt
.
¡ršg
 ?‚ode->value.text.string : "(null)");

217 
	`mxmlD–‘e
(
Œ“
);

221 
i
 = 0; i < 4; i ++)

223 
node
 =‚ode->
Ãxt
;

225 ià(!
node
)

227 
	`årštf
(
¡d”r
, "ERROR: NØgrou°#%d chd‚odš basiø‹¡.\n", 
i
 + 1);

228 
	`mxmlD–‘e
(
Œ“
);

232 ià(
node
->
ty³
 !ğ
MXML_ELEMENT
)

234 
	`årštf
(
¡d”r
, "ERROR: Group child #%d hasype %s (%d),ƒxpected MXML_ELEMENT.\n",

235 
i
 + 1, 
node
->
ty³
 < 
MXML_ELEMENT
 ||‚ode->ty³ > 
MXML_TEXT
 ?

236 "UNKNOWN" : 
ty³s
[
node
->
ty³
],‚ode->type);

237 
	`mxmlD–‘e
(
Œ“
);

246 
node
 = 
	`mxmlFšdP©h
(
Œ“
, "*/two");

247 ià(!
node
)

249 
	`åuts
("ERROR: UÇbËØfšd v®ufÜ \"*/two\".\n", 
¡d”r
);

250 
	`mxmlD–‘e
(
Œ“
);

253 ià(
node
->
ty³
 !ğ
MXML_OPAQUE
 || 
	`¡rcmp
Òode->
v®ue
.
İaque
, "value"))

255 
	`åuts
("ERROR: Bad v®ufÜ \"*/two\".\n", 
¡d”r
);

256 
	`mxmlD–‘e
(
Œ“
);

260 
node
 = 
	`mxmlFšdP©h
(
Œ“
, "foo/*/two");

261 ià(!
node
)

263 
	`åuts
("ERROR: UÇbËØfšd v®ufÜ \"foo/*/two\".\n", 
¡d”r
);

264 
	`mxmlD–‘e
(
Œ“
);

267 ià(
node
->
ty³
 !ğ
MXML_OPAQUE
 || 
	`¡rcmp
Òode->
v®ue
.
İaque
, "value"))

269 
	`åuts
("ERROR: Bad v®ufÜ \"foo/*/two\".\n", 
¡d”r
);

270 
	`mxmlD–‘e
(
Œ“
);

274 
node
 = 
	`mxmlFšdP©h
(
Œ“
, "foo/bar/one/two");

275 ià(!
node
)

277 
	`åuts
("ERROR: UÇbËØfšd v®ufÜ \"foo/b¬/Úe/two\".\n", 
¡d”r
);

278 
	`mxmlD–‘e
(
Œ“
);

281 ià(
node
->
ty³
 !ğ
MXML_OPAQUE
 || 
	`¡rcmp
Òode->
v®ue
.
İaque
, "value"))

283 
	`åuts
("ERROR: Bad v®ufÜ \"foo/b¬/Úe/two\".\n", 
¡d”r
);

284 
	`mxmlD–‘e
(
Œ“
);

292 
šd
 = 
	`mxmlIndexNew
(
Œ“
, 
NULL
, NULL);

293 ià(!
šd
)

295 
	`åuts
("ERROR: UÇbËØü—‹ index oà®Ènodes.\n", 
¡d”r
);

296 
	`mxmlD–‘e
(
Œ“
);

300 ià(
šd
->
num_nodes
 != 10)

302 
	`årštf
(
¡d”r
, "ERROR: Index of‡ll‚odes contains %d "

303 "nodes;ƒx³ùed 10.\n", 
šd
->
num_nodes
);

304 
	`mxmlIndexD–‘e
(
šd
);

305 
	`mxmlD–‘e
(
Œ“
);

309 
	`mxmlIndexRe£t
(
šd
);

310 ià(!
	`mxmlIndexFšd
(
šd
, "group", 
NULL
))

312 
	`åuts
("ERROR: mxmlIndexFšd fÜ \"group\" faed.\n", 
¡d”r
);

313 
	`mxmlIndexD–‘e
(
šd
);

314 
	`mxmlD–‘e
(
Œ“
);

318 
	`mxmlIndexD–‘e
(
šd
);

320 
šd
 = 
	`mxmlIndexNew
(
Œ“
, "group", 
NULL
);

321 ià(!
šd
)

323 
	`åuts
("ERROR: UÇbËØü—‹ index oàgroups.\n", 
¡d”r
);

324 
	`mxmlD–‘e
(
Œ“
);

328 ià(
šd
->
num_nodes
 != 4)

330 
	`årštf
(
¡d”r
, "ERROR: Index of groups contains %d "

331 "nodes;ƒx³ùed 4.\n", 
šd
->
num_nodes
);

332 
	`mxmlIndexD–‘e
(
šd
);

333 
	`mxmlD–‘e
(
Œ“
);

337 
	`mxmlIndexRe£t
(
šd
);

338 ià(!
	`mxmlIndexEnum
(
šd
))

340 
	`åuts
("ERROR: mxmlIndexEnum faed.\n", 
¡d”r
);

341 
	`mxmlIndexD–‘e
(
šd
);

342 
	`mxmlD–‘e
(
Œ“
);

346 
	`mxmlIndexD–‘e
(
šd
);

348 
šd
 = 
	`mxmlIndexNew
(
Œ“
, 
NULL
, "type");

349 ià(!
šd
)

351 
	`åuts
("ERROR: UÇbËØü—‹ index oàty³‡‰ribu‹s.\n", 
¡d”r
);

352 
	`mxmlD–‘e
(
Œ“
);

356 ià(
šd
->
num_nodes
 != 3)

358 
	`årštf
(
¡d”r
, "ERROR: Index ofype‡ttributes contains %d "

359 "nodes;ƒx³ùed 3.\n", 
šd
->
num_nodes
);

360 
	`mxmlIndexD–‘e
(
šd
);

361 
	`mxmlD–‘e
(
Œ“
);

365 
	`mxmlIndexRe£t
(
šd
);

366 ià(!
	`mxmlIndexFšd
(
šd
, 
NULL
, "string"))

368 
	`åuts
("ERROR: mxmlIndexFšd fÜ \"¡ršg\" faed.\n", 
¡d”r
);

369 
	`mxmlIndexD–‘e
(
šd
);

370 
	`mxmlD–‘e
(
Œ“
);

374 
	`mxmlIndexD–‘e
(
šd
);

376 
šd
 = 
	`mxmlIndexNew
(
Œ“
, "group", "type");

377 ià(!
šd
)

379 
	`åuts
("ERROR: UÇbËØü—‹ index oà–em’t ªd‡‰ribu‹s.\n", 
¡d”r
);

380 
	`mxmlD–‘e
(
Œ“
);

384 ià(
šd
->
num_nodes
 != 3)

386 
	`årštf
(
¡d”r
, "ERROR: Index ofƒlements‡nd‡ttributes contains %d "

387 "nodes;ƒx³ùed 3.\n", 
šd
->
num_nodes
);

388 
	`mxmlIndexD–‘e
(
šd
);

389 
	`mxmlD–‘e
(
Œ“
);

393 
	`mxmlIndexRe£t
(
šd
);

394 ià(!
	`mxmlIndexFšd
(
šd
, "group", "string"))

396 
	`åuts
("ERROR: mxmlIndexFšd fÜ \"¡ršg\" faed.\n", 
¡d”r
);

397 
	`mxmlIndexD–‘e
(
šd
);

398 
	`mxmlD–‘e
(
Œ“
);

402 
	`mxmlIndexD–‘e
(
šd
);

408 
i
 = 0; i < 9; i ++)

410 ià(
Œ“
->
chd
)

411 
	`mxmlD–‘e
(
Œ“
->
chd
);

414 
	`årštf
(
¡d”r
, "ERROR: Child…ointer…rematurely NULL on child #%d\n",

415 
i
 + 1);

416 
	`mxmlD–‘e
(
Œ“
);

421 ià(
Œ“
->
chd
)

423 
	`åuts
("ERROR: Chd…oš‹¸nÙ NULL‡á” d–‘šg‡Î chd»n.\n", 
¡d”r
);

427 ià(
Œ“
->
Ï¡_chd
)

429 
	`åuts
("ERROR: La¡ chd…oš‹¸nÙ NULL‡á” d–‘šg‡Î chd»n.\n", 
¡d”r
);

433 
	`mxmlD–‘e
(
Œ“
);

439 ià(
¬gv
[1][0] == '<')

440 
Œ“
 = 
	`mxmlLßdSŒšg
(
NULL
, 
¬gv
[1], 
MXML_NO_CALLBACK
);

441 ià((
	`f_İ’
(&
f
, 
¬gv
[1], 
FA_READ
)è!ğ
FR_OK
)

443 
	`³¼Ü
(
¬gv
[1]);

452 
Œ“
 = 
	`mxmlLßdFe
(
NULL
, &
f
, 
MXML_NO_CALLBACK
);

454 
	`f_şo£
(&
f
);

457 ià(!
Œ“
)

459 
	`åuts
("UÇbËØ»ad XML fw™h deçuÉ c®lback.\n", 
¡d”r
);

463 ià(!
	`¡rcmp
(
¬gv
[1], "test.xml"))

465 cÚ¡ *
‹xt
;

472 ià((
node
 = 
	`mxmlFšdP©h
(
Œ“
, "group/İtiÚ/keywÜd")è=ğ
NULL
)

474 
	`åuts
("UÇbËØfšd group/İtiÚ/keywÜdƒËm’ˆš XML»e.\n", 
¡d”r
);

475 
	`mxmlD–‘e
(
Œ“
);

479 ià(
node
->
ty³
 !ğ
MXML_TEXT
)

481 
	`åuts
("NØchd‚odoàgroup/İtiÚ/keywÜd.\n", 
¡d”r
);

485 
	`mxmlD–‘e
(
Œ“
);

489 ià((
‹xt
 = 
	`mxmlG‘Text
(
node
, 
NULL
)è=ğNULL || 
	`¡rcmp
(text, "InputSlot"))

491 
	`årštf
(
¡d”r
, "Chd‚odoàgroup/İtiÚ/v®uha v®u\"%s\" in¡—d oà\"IÅutSlÙ\".\n", 
‹xt
 ?ext : "(null)");

492 
	`mxmlD–‘e
(
Œ“
);

497 
	`mxmlD–‘e
(
Œ“
);

503 ià(
¬gv
[1][0] == '<')

504 
Œ“
 = 
	`mxmlLßdSŒšg
(
NULL
, 
¬gv
[1], 
ty³_cb
);

505 ià(
	`f_İ’
(&
f
, 
¬gv
[1], 
FA_READ
è!ğ
FR_OK
)

507 
	`³¼Ü
(
¬gv
[1]);

516 
Œ“
 = 
	`mxmlLßdFe
(
NULL
, &
f
, 
ty³_cb
);

518 
	`f_şo£
(&
f
);

521 ià(!
Œ“
)

523 
	`åuts
("UÇbËØ»ad XML fe.\n", 
¡d”r
);

527 ià(!
	`¡rcmp
(
¬gv
[1], "test.xml"))

534 ià((
node
 = 
	`mxmlFšdEËm’t
(
Œ“
,»e, "choiû", 
NULL
, NULL,

535 
MXML_DESCEND
)è=ğ
NULL
)

537 
	`åuts
("UÇbËØfšd fœ¡ <choiû>ƒËm’ˆš XML»e.\n", 
¡d”r
);

538 
	`mxmlD–‘e
(
Œ“
);

542 ià(!
	`mxmlFšdEËm’t
(
node
, 
Œ“
, "choiû", 
NULL
, NULL, 
MXML_NO_DESCEND
))

544 
	`åuts
("UÇbËØfšd secÚd <choiû>ƒËm’ˆš XML»e.\n", 
¡d”r
);

545 
	`mxmlD–‘e
(
Œ“
);

558 ià(
	`mxmlSaveSŒšg
(
Œ“
, 
bufãr
, (bufãr), 
wh™e¥aû_cb
) > 0)

560 ià(
¬gc
 == 3)

562 
	`f_İ’
(&
f
, 
¬gv
[2], 
FA_OPEN_ALWAYS
 | 
FA_WRITE
);

563 
	`f_puts
(
bufãr
, &
f
);

564 
	`f_şo£
(&
f
);

565 
	`´štf_§ã
("%s", 
bufãr
);

573 
	`mxmlD–‘e
(
Œ“
);

579 
	`mem£t
(
ev’t_couÁs
, 0, (event_counts));

581 ià(
¬gv
[1][0] == '<')

582 
	`mxmlSAXLßdSŒšg
(
NULL
, 
¬gv
[1], 
ty³_cb
, 
§x_cb
, NULL);

583 ià((
	`f_İ’
(&
f
, 
¬gv
[1], 
FA_READ
)è!ğ
FR_OK
)

585 
	`³¼Ü
(
¬gv
[1]);

594 
	`mxmlSAXLßdFe
(
NULL
, &
f
, 
ty³_cb
, 
§x_cb
, NULL);

596 
	`f_şo£
(&
f
);

599 ià(!
	`¡rcmp
(
¬gv
[1], "test.xml"))

601 ià(
ev’t_couÁs
[
MXML_SAX_CDATA
] != 1)

603 
	`årštf
(
¡d”r
, "MXML_SAX_CDATA seen %dimes,ƒxpected 1imes.\n",

604 
ev’t_couÁs
[
MXML_SAX_CDATA
]);

608 ià(
ev’t_couÁs
[
MXML_SAX_COMMENT
] != 1)

610 
	`årštf
(
¡d”r
, "MXML_SAX_COMMENT seen %dimes,ƒxpected 1imes.\n",

611 
ev’t_couÁs
[
MXML_SAX_COMMENT
]);

615 ià(
ev’t_couÁs
[
MXML_SAX_DATA
] != 60)

617 
	`årštf
(
¡d”r
, "MXML_SAX_DATA seen %dimes,ƒxpected 60imes.\n",

618 
ev’t_couÁs
[
MXML_SAX_DATA
]);

622 ià(
ev’t_couÁs
[
MXML_SAX_DIRECTIVE
] != 1)

624 
	`årštf
(
¡d”r
, "MXML_SAX_DIRECTIVE seen %dimes,ƒxpected 1imes.\n",

625 
ev’t_couÁs
[
MXML_SAX_DIRECTIVE
]);

629 ià(
ev’t_couÁs
[
MXML_SAX_ELEMENT_CLOSE
] != 20)

631 
	`årštf
(
¡d”r
, "MXML_SAX_ELEMENT_CLOSE seen %dimes,ƒxpected 20imes.\n",

632 
ev’t_couÁs
[
MXML_SAX_ELEMENT_CLOSE
]);

636 ià(
ev’t_couÁs
[
MXML_SAX_ELEMENT_OPEN
] != 20)

638 
	`årštf
(
¡d”r
, "MXML_SAX_ELEMENT_OPEN seen %dimes,ƒxpected 20imes.\n",

639 
ev’t_couÁs
[
MXML_SAX_ELEMENT_OPEN
]);

649 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\tinysh\tinysh.c

23 
	~"tšysh.h
"

25 #iâdeà
BUFFER_SIZE


26 
	#BUFFER_SIZE
 256

	)

28 #iâdeà
HISTORY_DEPTH


29 
	#HISTORY_DEPTH
 16

	)

31 #iâdeà
MAX_ARGS


32 
	#MAX_ARGS
 16

	)

34 #iâdeà
PROMPT_SIZE


35 
	#PROMPT_SIZE
 16

	)

37 #iâdeà
TOPCHAR


38 
	#TOPCHAR
 '/'

	)

42 
	tuch¬
;

44 
	#¡¾’
 
tšysh_¡¾’


	)

45 
	#puts
 
tšysh_puts


	)

46 
	#putch¬
 
tšysh_ch¬_out


	)

48 
h–p_ât
(
¬gc
, **
¬gv
);

50 
tšysh_cmd_t
 
	gh–p_cmd
 =

52 0, "h–p", "di¥Ïy h–p\r\n------------------------------------", "<ü>", 
h–p_ât
, 0, 0, 0

55 
uch¬
 
	gšput_bufãrs
[
HISTORY_DEPTH
][
BUFFER_SIZE
 + 1] = {0};

56 
uch¬
 
	gŒash_bufãr
[
BUFFER_SIZE
 + 1] = {0};

57 
	gcur_buf_šdex
 = 0;

58 
uch¬
 
	gcÚ‹xt_bufãr
[
BUFFER_SIZE
 + 1] = {0};

59 
	gcur_cÚ‹xt
 = 0;

60 
	gcur_šdex
 = 0;

61 
	gecho
 = 1;

62 
	g´om±
[
PROMPT_SIZE
 + 1] = "$ ";

63 
tšysh_cmd_t
 *
	groÙ_cmd
 = &
h–p_cmd
;

64 
tšysh_cmd_t
 *
	gcur_cmd_ùx
 = 0;

65 *
	gtšysh_¬g
 = 0;

69 
	$¡¾’
(
uch¬
 *
s
)

71 
i
;

72 
i
 = 0; *
s
; s++, i++);

73  
i
;

74 
	}
}

76 
	$puts
(*
s
)

78 *
s
)

80 
	`putch¬
(*
s
++);

82 
	}
}

86 
	$h–p_ât
(
¬gc
, **
¬gv
)

88 
	`puts
("? display help on given or‡vailable commands\n");

89 
	`puts
("<TAB>‡uto-completion\n");

90 
	`puts
("<CR>ƒxecute command†ine\n");

91 
	`puts
("CTRL-P„ecall…revious input†ine\n");

92 
	`puts
("CTRL-N„ecall‚ext input†ine\n");

93 
	`puts
("\\„eturno„oot\n");

94 
	`puts
("<any>reat‡s input character\n");

95 
	}
}

100 ’um { 
	mNULLMATCH
, 
	mFULLMATCH
, 
	mPARTMATCH
, 
	mUNMATCH
, 
	mMATCH
, 
	mAMBIG
 };

108 
	$¡r¡¬t
(
uch¬
 *
s1
, uch¬ *
s2
)

110 *
s1
 && *s1 =ğ*
s2
)

112 
s1
++;

113 
s2
++;

116 if(*
s2
 == ' ' || *s2 == 0)

118 if(*
s1
 == 0)

120  
FULLMATCH
;

124  
PARTMATCH
;

129  
UNMATCH
;

131 
	}
}

138 
	$·r£_commªd
(
tšysh_cmd_t
 **
_cmd
, 
uch¬
 **
_¡r
)

140 
uch¬
 *
¡r
 = *
_¡r
;

141 
tšysh_cmd_t
 *
cmd
;

142 
m©ched_Ën
 = 0;

143 
tšysh_cmd_t
 *
m©ched_cmd
 = 0;

146 *
¡r
 == ' ')

148 
¡r
++;

150 if(!*
¡r
)

152 *
_¡r
 = 
¡r
;

153  
NULLMATCH
;

157 
cmd
 = *
_cmd
; cmd; cmd = cmd->
Ãxt
)

159 
»t
 = 
	`¡r¡¬t
(
cmd
->
Çme
, 
¡r
);

161 if(
»t
 =ğ
FULLMATCH
)

164 *
¡r
 && *str != ' ')

166 
¡r
++;

168 *
¡r
 == ' ')

170 
¡r
++;

172 *
_¡r
 = 
¡r
;

173 *
_cmd
 = 
cmd
;

174  
MATCH
;

176 ià(
»t
 =ğ
PARTMATCH
)

178 if(
m©ched_cmd
)

180 *
_cmd
 = 
m©ched_cmd
;

181  
AMBIG
;

185 
m©ched_cmd
 = 
cmd
;

192 if(
m©ched_cmd
)

194 *
¡r
 && *str != ' ')

196 
¡r
++;

198 *
¡r
 == ' ')

200 
¡r
++;

202 *
_cmd
 = 
m©ched_cmd
;

203 *
_¡r
 = 
¡r
;

204  
MATCH
;

208  
UNMATCH
;

210 
	}
}

214 
	$do_cÚ‹xt
(
tšysh_cmd_t
 *
cmd
, 
uch¬
 *
¡r
)

216 *
¡r
)

218 
cÚ‹xt_bufãr
[
cur_cÚ‹xt
++] = *
¡r
++;

220 
cÚ‹xt_bufãr
[
cur_cÚ‹xt
] = 0;

221 
cur_cmd_ùx
 = 
cmd
;

222 
	}
}

227 
	$exec_commªd
(
tšysh_cmd_t
 *
cmd
, 
uch¬
 *
¡r
)

229 *
¬gv
[
MAX_ARGS
];

230 
¬gc
 = 0;

231 
i
;

234 
i
 = 0; i < 
BUFFER_SIZE
; i++)

236 
Œash_bufãr
[
i
] = 
¡r
[i];

238 
¡r
 = 
Œash_bufãr
;

241 
¬gv
[
¬gc
++] = 
cmd
->
Çme
;

242 *
¡r
 && 
¬gc
 < 
MAX_ARGS
)

244 *
¡r
 == ' ')

246 
¡r
++;

248 if(*
¡r
 == 0)

252 
¬gv
[
¬gc
++] = 
¡r
;

254 if(*
¡r
 == '\"')

256 
¡r
++;

257 *
¡r
 != '\"' && *str)

259 
¡r
++;

261 if(*
¡r
 == '\"')

263 
¡r
++;

268 *
¡r
 != ' ' && *str)

270 
¡r
++;

273 if(!*
¡r
)

277 *
¡r
++ = 0;

280 if(
cmd
->
funùiÚ
)

282 
tšysh_¬g
 = 
cmd
->
¬g
;

283 
cmd
->
	`funùiÚ
(
¬gc
, &
¬gv
[0]);

285 
	}
}

289 
	$exec_commªd_lše
(
tšysh_cmd_t
 *
cmd
, 
uch¬
 *
_¡r
)

291 
uch¬
 *
¡r
 = 
_¡r
;

295 
»t
;

296 
»t
 = 
	`·r£_commªd
(&
cmd
, &
¡r
);

297 if(
»t
 =ğ
MATCH
)

299 if(
cmd
)

301 if(!
cmd
->
chd
)

303 
	`exec_commªd
(
cmd
, 
¡r
);

308 if(*
¡r
 == 0)

310 
	`do_cÚ‹xt
(
cmd
, 
_¡r
);

315 
cmd
 = cmd->
chd
;

324 if(
»t
 =ğ
AMBIG
)

326 
	`puts
("ambiguity: ");

327 
	`puts
(
¡r
);

328 
	`putch¬
('\n');

331 if(
»t
 =ğ
UNMATCH
)

333 
	`puts
("no match: ");

334 
	`puts
(
¡r
);

335 
	`putch¬
('\n');

343 
	}
}

347 
	$di¥Ïy_chd_h–p
(
tšysh_cmd_t
 *
cmd
)

349 
tšysh_cmd_t
 *
cm
;

350 
Ën
 = 0;

352 
	`putch¬
('\n');

353 
cm
 = 
cmd
; cm; cm = cm->
Ãxt
)

354 if(
Ën
 < 
	`¡¾’
(
cm
->
Çme
))

356 
Ën
 = 
	`¡¾’
(
cm
->
Çme
);

358 
cm
 = 
cmd
; cm; cm = cm->
Ãxt
)

359 if(
cm
->
h–p
)

361 
i
;

362 
	`puts
(
cm
->
Çme
);

363 
i
 = 
	`¡¾’
(
cm
->
Çme
); i < 
Ën
 + 2; i++)

365 
	`putch¬
(' ');

367 
	`puts
(
cm
->
h–p
);

368 
	`putch¬
('\n');

370 
	}
}

374 
	$h–p_commªd_lše
(
tšysh_cmd_t
 *
cmd
, 
uch¬
 *
_¡r
)

376 
uch¬
 *
¡r
 = 
_¡r
;

380 
»t
;

381 
»t
 = 
	`·r£_commªd
(&
cmd
, &
¡r
);

382 if(
»t
 =ğ
MATCH
 && *
¡r
 == 0)

384 
tšysh_cmd_t
 *
cm
;

385 
Ën
 = 0;

387 if(
cmd
->
chd
)

389 
	`di¥Ïy_chd_h–p
(
cmd
->
chd
);

394 if(*(
¡r
 - 1) != ' ')

396 
	`putch¬
(' ');

398 if(
cmd
->
u§ge
)

400 
	`puts
(
cmd
->
u§ge
);

402 
	`puts
(": ");

403 if(
cmd
->
h–p
)

405 
	`puts
(
cmd
->
h–p
);

409 
	`puts
("no help‡vailable");

411 
	`putch¬
('\n');

415 if(
»t
 =ğ
MATCH
 && *
¡r
)

418 
cmd
 = cmd->
chd
;

420 if(
»t
 =ğ
AMBIG
)

422 
	`puts
("\nambiguity: ");

423 
	`puts
(
¡r
);

424 
	`putch¬
('\n');

427 if(
»t
 =ğ
UNMATCH
)

429 
	`puts
("\nno match: ");

430 
	`puts
(
¡r
);

431 
	`putch¬
('\n');

436 if(
cur_cmd_ùx
)

438 
	`di¥Ïy_chd_h–p
(
cur_cmd_ùx
->
chd
);

442 
	`di¥Ïy_chd_h–p
(
roÙ_cmd
);

447 
	}
}

451 
	$com¶‘e_commªd_lše
(
tšysh_cmd_t
 *
cmd
, 
uch¬
 *
_¡r
)

453 
uch¬
 *
¡r
 = 
_¡r
;

457 
»t
;

458 
commÚ_Ën
 = 
BUFFER_SIZE
;

459 
_¡r_Ën
;

460 
i
;

461 
uch¬
 *
__¡r
 = 
¡r
;

463 
tšysh_cmd_t
 *
_cmd
 = 
cmd
;

464 
»t
 = 
	`·r£_commªd
(&
cmd
, &
¡r
);

465 
_¡r_Ën
 = 0; 
__¡r
[_str_len] && __str[_str_len] != ' '; _str_len++);

466 if(
»t
 =ğ
MATCH
 && *
¡r
)

468 
cmd
 = cmd->
chd
;

470 if(
»t
 =ğ
AMBIG
 ||„‘ =ğ
MATCH
 ||„‘ =ğ
NULLMATCH
)

472 
tšysh_cmd_t
 *
cm
;

473 
tšysh_cmd_t
 *
m©ched_cmd
 = 0;

474 
nb_m©ch
 = 0;

476 
cm
 = 
cmd
; cm; cm = cm->
Ãxt
)

478 
r
 = 
	`¡r¡¬t
(
cm
->
Çme
, 
__¡r
);

479 if(
r
 =ğ
FULLMATCH
)

481 
i
 = 
_¡r_Ën
; 
cmd
->
Çme
[i]; i++)

483 
	`tšysh_ch¬_š
(
cmd
->
Çme
[
i
]);

485 if(*(
¡r
 - 1) != ' ')

487 
	`tšysh_ch¬_š
(' ');

489 if(!
cmd
->
chd
)

491 if(
cmd
->
u§ge
)

493 
	`puts
(
cmd
->
u§ge
);

494 
	`putch¬
('\n');

504 
cmd
 = cmd->
chd
;

508 if(
r
 =ğ
PARTMATCH
)

510 
nb_m©ch
++;

511 if(!
m©ched_cmd
)

513 
m©ched_cmd
 = 
cm
;

514 
commÚ_Ën
 = 
	`¡¾’
(
cm
->
Çme
);

518 
i
 = 
_¡r_Ën
; 
cm
->
Çme
[i] && i < 
commÚ_Ën
 &&

519 
cm
->
Çme
[
i
] =ğ
m©ched_cmd
->name[i]; i++);

520 if(
i
 < 
commÚ_Ën
)

522 
commÚ_Ën
 = 
i
;

527 if(
cm
)

531 if(
m©ched_cmd
)

533 if(
_¡r_Ën
 =ğ
commÚ_Ën
)

535 
	`putch¬
('\n');

536 
cm
 = 
cmd
; cm; cm = cm->
Ãxt
)

538 
r
 = 
	`¡r¡¬t
(
cm
->
Çme
, 
__¡r
);

539 if(
r
 =ğ
FULLMATCH
 ||„ =ğ
PARTMATCH
)

541 
	`puts
(
cm
->
Çme
);

542 
	`putch¬
('\n');

549 
i
 = 
_¡r_Ën
; i < 
commÚ_Ën
; i++)

551 
	`tšysh_ch¬_š
(
m©ched_cmd
->
Çme
[
i
]);

553 if(
nb_m©ch
 == 1)

555 
	`tšysh_ch¬_š
(' ');

566 
	}
}

570 
	$¡¬t_of_lše
()

573 
	`puts
(
´om±
);

574 if(
cur_cÚ‹xt
)

576 
	`puts
(
cÚ‹xt_bufãr
);

577 
	`puts
("> ");

579 
cur_šdex
 = 0;

580 
	}
}

584 
	$_tšysh_ch¬_š
(
uch¬
 
c
)

586 
uch¬
 *
lše
 = 
šput_bufãrs
[
cur_buf_šdex
];

588 if(
c
 == '\n' || c == '\r')

590 
tšysh_cmd_t
 *
cmd
;

591 
cÚ‹xt
 = 0;

594 if(
echo
)

596 
	`putch¬
(
c
);

599 *
lše
 && *line == ' ')

601 
lše
++;

603 if(*
lše
)

605 
cmd
 = 
cur_cmd_ùx
 ? cur_cmd_ùx->
chd
 : 
roÙ_cmd
;

606 
	`exec_commªd_lše
(
cmd
, 
lše
);

607 
cur_buf_šdex
 = (cur_buf_šdex + 1è% 
HISTORY_DEPTH
;

608 
cur_šdex
 = 0;

609 
šput_bufãrs
[
cur_buf_šdex
][0] = 0;

611 
	`¡¬t_of_lše
();

613 if(
c
 =ğ
TOPCHAR
)

615 if(
echo
)

617 
	`putch¬
(
c
);

620 
cur_cÚ‹xt
 = 0;

621 
cur_cmd_ùx
 = 0;

623 if(
c
 == 8 || c == 127)

625 if(
cur_šdex
 > 0)

627 
	`puts
("\b \b");

628 
cur_šdex
--;

629 
lše
[
cur_šdex
] = 0;

632 if(
c
 == 16)

634 
´evlše
 = (
cur_buf_šdex
 + 
HISTORY_DEPTH
 - 1) % HISTORY_DEPTH;

636 if(
šput_bufãrs
[
´evlše
][0])

638 
lše
 = 
šput_bufãrs
[
´evlše
];

640 
cur_šdex
-- > 
	`¡¾’
(
lše
))

642 
	`puts
("\b \b");

644 
	`putch¬
('\r');

645 
	`¡¬t_of_lše
();

646 
	`puts
(
lše
);

647 
cur_šdex
 = 
	`¡¾’
(
lše
);

648 
cur_buf_šdex
 = 
´evlše
;

651 if(
c
 == 14)

653 
Ãxše
 = (
cur_buf_šdex
 + 1è% 
HISTORY_DEPTH
;

655 if(
šput_bufãrs
[
Ãxše
][0])

657 
lše
 = 
šput_bufãrs
[
Ãxše
];

659 
cur_šdex
-- > 
	`¡¾’
(
lše
))

661 
	`puts
("\b \b");

663 
	`putch¬
('\r');

664 
	`¡¬t_of_lše
();

665 
	`puts
(
lše
);

666 
cur_šdex
 = 
	`¡¾’
(
lše
);

667 
cur_buf_šdex
 = 
Ãxše
;

670 if(
c
 == '?')

672 
tšysh_cmd_t
 *
cmd
;

673 
cmd
 = 
cur_cmd_ùx
 ? cur_cmd_ùx->
chd
 : 
roÙ_cmd
;

674 
	`h–p_commªd_lše
(
cmd
, 
lše
);

675 
	`¡¬t_of_lše
();

676 
	`puts
(
lše
);

677 
cur_šdex
 = 
	`¡¾’
(
lše
);

679 if(
c
 == 9 || c == '!')

681 
tšysh_cmd_t
 *
cmd
;

682 
cmd
 = 
cur_cmd_ùx
 ? cur_cmd_ùx->
chd
 : 
roÙ_cmd
;

683 if(
	`com¶‘e_commªd_lše
(
cmd
, 
lše
))

685 
	`¡¬t_of_lše
();

686 
	`puts
(
lše
);

688 
cur_šdex
 = 
	`¡¾’
(
lše
);

692 if(
cur_šdex
 < 
BUFFER_SIZE
)

694 if(
echo
)

696 
	`putch¬
(
c
);

698 
lše
[
cur_šdex
++] = 
c
;

699 
lše
[
cur_šdex
] = 0;

702 
	}
}

705 
	$tšysh_ch¬_š
(
uch¬
 
c
)

710 
	`_tšysh_ch¬_š
(
c
);

711 
	}
}

714 
	$tšysh_add_commªd
(
tšysh_cmd_t
 *
cmd
)

716 
tšysh_cmd_t
 *
cm
;

718 if(
cmd
->
·»Á
)

720 
cm
 = 
cmd
->
·»Á
->
chd
;

721 if(!
cm
)

723 
cmd
->
·»Á
->
chd
 = cmd;

727 
cm
->
Ãxt
)

729 
cm
 = cm->
Ãxt
;

731 
cm
->
Ãxt
 = 
cmd
;

734 if(!
roÙ_cmd
)

736 
roÙ_cmd
 = 
cmd
;

740 
cm
 = 
roÙ_cmd
;

741 
cm
->
Ãxt
)

743 
cm
 = cm->
Ãxt
;

745 
cm
->
Ãxt
 = 
cmd
;

747 
	}
}

751 
	$tšysh_£t_´om±
(*
¡r
)

753 
i
;

754 
i
 = 0; 
¡r
[i] && i < 
PROMPT_SIZE
; i++)

756 
´om±
[
i
] = 
¡r
[i];

758 
´om±
[
i
] = 0;

760 
	`tšysh_ch¬_š
('\r');

761 
	}
}

765 *
	$tšysh_g‘_¬g
()

767  
tšysh_¬g
;

768 
	}
}

772 
	$tšysh_©oxi
(*
s
)

774 
ishex
 = 0;

775 
»s
 = 0;

777 if(*
s
 == 0)

782 if(*
s
 == '0' && *(s + 1) == 'x')

784 
ishex
 = 1;

785 
s
 += 2;

788 *
s
)

790 if(
ishex
)

792 
»s
 *= 16;

796 
»s
 *= 10;

799 if(*
s
 >= '0' && *s <= '9')

801 
»s
 +ğ*
s
 - '0';

803 if(
ishex
 && *
s
 >= 'a' && *s <= 'f')

805 
»s
 +ğ*
s
 + 10 - 'a';

807 if(
ishex
 && *
s
 >= 'A' && *s <= 'F')

809 
»s
 +ğ*
s
 + 10 - 'A';

816 
s
++;

819  
»s
;

820 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\userlib\inc\userlib_list.h

1 #iâdeà
__USER_LIB_LIST_H


2 
	#__USER_LIB_LIST_H


	)

4 
	s_U£rLi¡_t


6 **
	mpLi¡PoštA¼ay
;

7 
	mTÙ®
;

8 (*
	mAdd
)(
_U£rLi¡_t
 *
	mpLi¡
, *
	mpLi¡Pošt
);

9 (*
	mRemove
)(
_U£rLi¡_t
 *
	mpLi¡
, *
	mpLi¡Pošt
);

10 (*
	mD–‘e
)(*
	mpLi¡
);

11 }
	tU£rLi¡_t
;

12 
U£rLi¡_t
 *
U£rLi¡C»©e
();

	@D:\Documents\Projects\chargersdk\src\middlewares\userlib\inc\xprintf.h

5 #iâdeà
_STRFUNC


6 
	#_STRFUNC


	)

8 
	#_USE_XFUNC_OUT
 1

	)

9 
	#_CR_CRLF
 1

	)

11 
	#_USE_XFUNC_IN
 0

	)

12 
	#_LINE_ECHO
 0

	)

15 #ià
_USE_XFUNC_OUT


16 
	#xdev_out
(
func
è
xfunc_out
 = ((*)())(func)

	)

17 (*
xfunc_out
)();

18 
	`xputc
 (
c
);

19 
	`xputs
 (cÚ¡ * 
¡r
);

20 
	`xåuts
 ((*
func
)(), cÚ¡ * 
¡r
);

21 
	`x´štf
 (cÚ¡ * 
fmt
, ...);

22 
	`x¥rštf
 (* 
buff
, cÚ¡ * 
fmt
, ...);

23 
	`xårštf
 ((*
func
)(), cÚ¡ * 
fmt
, ...);

24 
	`put_dump
 (cÚ¡ * 
buff
, 
addr
, 
Ën
, 
width
);

25 
	#DW_CHAR
 ()

	)

26 
	#DW_SHORT
 ()

	)

27 
	#DW_LONG
 ()

	)

30 #ià
_USE_XFUNC_IN


31 
	#xdev_š
(
func
è
xfunc_š
 = ((*)())(func)

	)

32 (*
xfunc_š
)();

33 
	`xg‘s
 (* 
buff
, 
Ën
);

34 
	`xfg‘s
 ((*
func
)(), * 
buff
, 
Ën
);

35 
	`x©oi
 (** 
¡r
, * 
»s
);

	@D:\Documents\Projects\chargersdk\src\middlewares\userlib\src\userlib_list.c

1 
	~"u£¾ib_li¡.h
"

2 
	~<¡dlib.h
>

5 
	$Li¡D–‘e
(*
pLi¡
)

7 if(((
U£rLi¡_t
 *)
pLi¡
)->
pLi¡PoštA¼ay
 !ğ
NULL
)

9 
	`ä“
(((
U£rLi¡_t
 *)
pLi¡
)->
pLi¡PoštA¼ay
);

11 
	`ä“
(
pLi¡
);

12 
	}
}

14 
	$Li¡Add
(
U£rLi¡_t
 *
pLi¡
, *
pLi¡Pošt
)

16 **
tLi¡PoštA¼ay
 = 
	`m®loc
((*è* (
pLi¡
->
TÙ®
 + 1));

17 
pLi¡Index
;

18 
pLi¡Index
 = 0;…Li¡Index < 
pLi¡
->
TÙ®
;…ListIndex++)

20 if(
pLi¡
->
pLi¡PoštA¼ay
[
pLi¡Index
] =ğ
pLi¡Pošt
)

22 
	`ä“
(
tLi¡PoštA¼ay
);

25 
tLi¡PoštA¼ay
[
pLi¡Index
] = 
pLi¡
->
pLi¡PoštA¼ay
[pListIndex];

27 
tLi¡PoštA¼ay
[
pLi¡
->
TÙ®
] = 
pLi¡Pošt
;

28 
pLi¡
->
TÙ®
 += 1;

29 if(
pLi¡
->
pLi¡PoštA¼ay
 !ğ
NULL
)

31 
	`ä“
(
pLi¡
->
pLi¡PoštA¼ay
);

33 
pLi¡
->
pLi¡PoštA¼ay
 = 
tLi¡PoštA¼ay
;

34 
	}
}

36 
	$Li¡Remove
(
U£rLi¡_t
 *
pLi¡
, *
pLi¡Pošt
)

38 
pLi¡Index
, 
tLi¡Index
;

39 **
tLi¡PoštA¼ay
;

40 **
F»ePoštA¼ay
;

41 **
SavePoštA¼ay
;

42 if(
pLi¡
->
TÙ®
 == 0)

46 
tLi¡PoštA¼ay
 = 
	`m®loc
((è* (
pLi¡
->
TÙ®
 - 1));

47 
F»ePoštA¼ay
 = 
tLi¡PoštA¼ay
;

48 
SavePoštA¼ay
 = 
pLi¡
->
pLi¡PoštA¼ay
;

49 
pLi¡Index
 = 0, 
tLi¡Index
 = 0;…Li¡Index < 
pLi¡
->
TÙ®
;…ListIndex++)

51 if(
pLi¡
->
pLi¡PoštA¼ay
[
pLi¡Index
] =ğ
pLi¡Pošt
)

53 
F»ePoštA¼ay
 = 
pLi¡
->
pLi¡PoštA¼ay
;

54 
SavePoštA¼ay
 = 
tLi¡PoštA¼ay
;

57 if(
tLi¡Index
 < (
pLi¡
->
TÙ®
 - 1))

59 
tLi¡PoštA¼ay
[
tLi¡Index
] = 
pLi¡
->
pLi¡PoštA¼ay
[
pLi¡Index
];

60 
tLi¡Index
++;

63 
pLi¡
->
TÙ®
 = (
SavePoštA¼ay
 =ğ
tLi¡PoštA¼ay
) ?…List->Total - 1 :…List->Total;

64 if(
F»ePoštA¼ay
 !ğ
NULL
)

66 
	`ä“
(
F»ePoštA¼ay
);

68 
pLi¡
->
pLi¡PoštA¼ay
 = 
SavePoštA¼ay
;

69 
	}
}

71 
U£rLi¡_t
 *
	$U£rLi¡C»©e
()

73 
U£rLi¡_t
 *
pLi¡
 = (U£rLi¡_ˆ*)
	`m®loc
((UserList_t));

74 
pLi¡
->
TÙ®
 = 0;

75 
pLi¡
->
pLi¡PoštA¼ay
 = 
NULL
;

76 
pLi¡
->
Add
 = 
Li¡Add
;

77 
pLi¡
->
Remove
 = 
Li¡Remove
;

78 
pLi¡
->
D–‘e
 = 
Li¡D–‘e
;

79  
pLi¡
;

80 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\userlib\src\userlib_queue.c

1 
	~"../šc/u£¾ib_queue.h
"

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡ršg.h
>

6 
QUERESULT
 
	$isFuÎ
(
Queue
 *
q
)

8 if(
q
->
äÚt
 =ğ(q->
»¬
 + 1è% q->
Ëngth
)

10  
QUE_TRUE
;

14  
QUE_FALSE
;

16 
	}
}

17 
QUERESULT
 
	$EnEËm
(
Queue
 *
q
, 
QUEUETYPE
 
–em
)

19 if(
	`isFuÎ
(
q
è=ğ
QUE_TRUE
)

21  
QUE_FAIL
;

23 
q
->
–em
[q->
»¬
] =ƒlem;

24 
q
->
»¬
 = (q->»¬ + 1è% q->
Ëngth
;

25  
QUE_OK
;

26 
	}
}

27 
QUERESULT
 
	$isEm±y
(
Queue
 *
q
)

29 if(
q
->
äÚt
 =ğq->
»¬
)

31  
QUE_TRUE
;

35  
QUE_FALSE
;

37 
	}
}

38 
QUERESULT
 
	$DeEËm
(
Queue
 *
q
, 
QUEUETYPE
 *
³Ëm
)

40 if(
	`isEm±y
(
q
è=ğ
QUE_TRUE
)

42  
QUE_FAIL
;

44 *
³Ëm
 = 
q
->
–em
[q->
äÚt
];

45 
q
->
äÚt
 = (q->äÚˆ+ 1è% q->
Ëngth
;

46  
QUE_OK
;

47 
	}
}

48 
	$D–‘eQue
(
Queue
 *
q
)

50 
	`ä“
(
q
->
–em
);

51 
	`ä“
(
q
);

52 
	}
}

53 
Queue
 *
	$QueueC»©e
(
Ën
)

55 
Queue
 *
pQueue
 = (Queu*)
	`m®loc
((Queue));

56 
pQueue
->
Ëngth
 = 
Ën
;

57 
pQueue
->
–em
 = (
QUEUETYPE
 *)
	`m®loc
((QUEUETYPEè*…Queue->
Ëngth
);

58 
	`mem£t
(
pQueue
->
–em
, 0,…Queue->
Ëngth
);

59 
pQueue
->
äÚt
 = 0;

60 
pQueue
->
»¬
 = 0;

61 
pQueue
->
xHªdËMu‹xQue
 = 
	`xSem­hÜeC»©eMu‹x
();

62 
pQueue
->
isEm±y
 = isEmpty;

63 
pQueue
->
isFuÎ
 = 
isEm±y
;

64 
pQueue
->
EnEËm
 = EnElem;

65 
pQueue
->
DeEËm
 = DeElem;

66 
pQueue
->
D–‘e
 = 
D–‘eQue
;

67  
pQueue
;

68 
	}
}

70 
	$‹¡queue
()

72 
Queue
 *
q
;

73 
ch
;

74 
i
;

75 
q
 = 
	`QueueC»©e
(200);

76 
i
 = 0; i < 128; i++)

78 
q
->
	`EnEËm
(q, 
i
);

80 
i
 = 0; i < 128; i++)

82 
q
->
	`DeEËm
(q, &
ch
);

83 
	`´štf_§ã
("%d\n", 
ch
);

85 
q
->
	`D–‘e
(q);

86 
	}
}

	@D:\Documents\Projects\chargersdk\src\middlewares\userlib\src\xprintf.c

14 
	~"x´štf.h
"

17 #ià
_USE_XFUNC_OUT


18 
	~<¡d¬g.h
>

19 (*
xfunc_out
)();

20 *
ouŒ
;

26 
	$xputc
 (
c
)

28 ià(
_CR_CRLF
 && 
c
 =ğ'\n'è
	`xputc
('\r');

30 ià(
ouŒ
) {

31 *
ouŒ
++ = ()
c
;

35 ià(
xfunc_out
è
	`xfunc_out
(()
c
);

36 
	}
}

44 
	$xputs
 (

45 cÚ¡ * 
¡r


48 *
¡r
)

49 
	`xputc
(*
¡r
++);

50 
	}
}

53 
xåuts
 (

54 (*
func
)(),

55 cÚ¡ * 
¡r


58 (*
pf
)();

61 
pf
 = 
xfunc_out
;

62 
xfunc_out
 = 
func
;

63 *
¡r
)

64 
	`xputc
(*
¡r
++);

65 
xfunc_out
 = 
pf
;

66 
	}
}

88 
	$xv´štf
 (

89 cÚ¡ * 
fmt
,

90 
va_li¡
 
¬p


93 
r
, 
i
, 
j
, 
w
, 
f
;

94 
v
;

95 
s
[16], 
c
, 
d
, *
p
;

99 
c
 = *
fmt
++;

100 ià(!
c
) ;

101 ià(
c
 != '%') {

102 
	`xputc
(
c
); ;

104 
f
 = 0;

105 
c
 = *
fmt
++;

106 ià(
c
 == '0') {

107 
f
 = 1; 
c
 = *
fmt
++;

109 ià(
c
 == '-') {

110 
f
 = 2; 
c
 = *
fmt
++;

113 
w
 = 0; 
c
 >ğ'0' && c <ğ'9'; c = *
fmt
++)

114 
w
 = w * 10 + 
c
 - '0';

115 ià(
c
 == 'l' || c == 'L') {

116 
f
 |ğ4; 
c
 = *
fmt
++;

118 ià(!
c
) ;

119 
d
 = 
c
;

120 ià(
d
 >= 'a') d -= 0x20;

121 
d
) {

123 
p
 = 
	`va_¬g
(
¬p
, *);

124 
j
 = 0; 
p
[j]; j++) ;

125 !(
f
 & 2è&& 
j
++ < 
w
è
	`xputc
(' ');

126 
	`xputs
(
p
);

127 
j
++ < 
w
è
	`xputc
(' ');

130 
	`xputc
(()
	`va_¬g
(
¬p
, )); ;

132 
r
 = 2; ;

134 
r
 = 8; ;

137 
r
 = 10; ;

139 
r
 = 16; ;

141 
	`xputc
(
c
); ;

145 
v
 = (
f
 & 4è? 
	`va_¬g
(
¬p
, è: ((
d
 == 'D') ? ()va_arg(arp, ) : ()va_arg(arp, ));

146 ià(
d
 =ğ'D' && (
v
 & 0x80000000)) {

147 
v
 = 0 - v;

148 
f
 |= 8;

150 
i
 = 0;

152 
d
 = ()(
v
 % 
r
); v /=„;

153 ià(
d
 > 9èd +ğ(
c
 == 'x') ? 0x27 : 0x07;

154 
s
[
i
++] = 
d
 + '0';

155 } 
v
 && 
i
 < (
s
));

156 ià(
f
 & 8è
s
[
i
++] = '-';

157 
j
 = 
i
; 
d
 = (
f
 & 1) ? '0' : ' ';

158 !(
f
 & 2è&& 
j
++ < 
w
è
	`xputc
(
d
);

159 dØ
	`xputc
(
s
[--
i
]); i);

160 
j
++ < 
w
è
	`xputc
(' ');

162 
	}
}

165 
	$x´štf
 (

166 cÚ¡ * 
fmt
,

170 
va_li¡
 
¬p
;

173 
	`va_¡¬t
(
¬p
, 
fmt
);

174 
	`xv´štf
(
fmt
, 
¬p
);

175 
	`va_’d
(
¬p
);

176 
	}
}

179 
	$x¥rštf
 (

180 * 
buff
,

181 cÚ¡ * 
fmt
,

185 
va_li¡
 
¬p
;

188 
ouŒ
 = 
buff
;

190 
	`va_¡¬t
(
¬p
, 
fmt
);

191 
	`xv´štf
(
fmt
, 
¬p
);

192 
	`va_’d
(
¬p
);

194 *
ouŒ
 = 0;

195 
ouŒ
 = 0;

196 
	}
}

199 
xårštf
 (

200 (*
func
)(),

201 cÚ¡ * 
fmt
,

205 
va_li¡
 
¬p
;

206 (*
pf
)();

209 
pf
 = 
xfunc_out
;

210 
xfunc_out
 = 
func
;

212 
	`va_¡¬t
(
¬p
, 
fmt
);

213 
	`xv´štf
(
fmt
, 
¬p
);

214 
	`va_’d
(
¬p
);

216 
xfunc_out
 = 
pf
;

217 
	}
}

225 
	$put_dump
 (

226 cÚ¡ * 
buff
,

227 
addr
,

228 
Ën
,

229 
width


232 
i
;

233 cÚ¡ *
bp
;

234 cÚ¡ *
¥
;

235 cÚ¡ *
Í
;

238 
	`x´štf
("%08lX ", 
addr
);

240 
width
) {

241 
DW_CHAR
:

242 
bp
 = 
buff
;

243 
i
 = 0; i < 
Ën
; i++)

244 
	`x´štf
(" %02X", 
bp
[
i
]);

245 
	`xputc
(' ');

246 
i
 = 0; i < 
Ën
; i++)

247 
	`xputc
((
bp
[
i
] >= ' ' && bp[i] <= '~') ? bp[i] : '.');

249 
DW_SHORT
:

250 
¥
 = 
buff
;

252 
	`x´štf
(" %04X", *
¥
++);

253 --
Ën
);

255 
DW_LONG
:

256 
Í
 = 
buff
;

258 
	`x´štf
(" %08LX", *
Í
++);

259 --
Ën
);

263 
	`xputc
('\n');

264 
	}
}

270 #ià
_USE_XFUNC_IN


271 (*
xfunc_š
)();

277 
	$xg‘s
 (

278 * 
buff
,

279 
Ën


282 
c
, 
i
;

285 ià(!
xfunc_š
)  0;

287 
i
 = 0;

289 
c
 = 
	`xfunc_š
();

290 ià(!
c
)  0;

291 ià(
c
 == '\r') ;

292 ià(
c
 =ğ'\b' && 
i
) {

293 
i
--;

294 ià(
_LINE_ECHO
è
	`xputc
(
c
);

297 ià(
c
 >ğ' ' && 
i
 < 
Ën
 - 1) {

298 
buff
[
i
++] = 
c
;

299 ià(
_LINE_ECHO
è
	`xputc
(
c
);

302 
buff
[
i
] = 0;

303 ià(
_LINE_ECHO
è
	`xputc
('\n');

305 
	}
}

308 
xfg‘s
 (

309 (*
func
)(),

310 * 
buff
,

311 
Ën


314 (*
pf
)();

315 
n
;

318 
pf
 = 
xfunc_š
;

319 
xfunc_š
 = 
func
;

320 
n
 = 
	`xg‘s
(
buff
, 
Ën
);

321 
xfunc_š
 = 
pf
;

323  
n
;

324 
	}
}

339 
	$x©oi
 (

340 **
¡r
,

341 *
»s


344 
v®
;

345 
c
, 
r
, 
s
 = 0;

348 *
»s
 = 0;

350 (
c
 = **
¡r
) == ' ') (*str)++;

352 ià(
c
 == '-') {

353 
s
 = 1;

354 
c
 = *(++(*
¡r
));

357 ià(
c
 == '0') {

358 
c
 = *(++(*
¡r
));

359 
c
) {

361 
r
 = 16; 
c
 = *(++(*
¡r
));

364 
r
 = 2; 
c
 = *(++(*
¡r
));

367 ià(
c
 <= ' ')  1;

368 ià(
c
 < '0' || c > '9')  0;

369 
r
 = 8;

372 ià(
c
 < '0' || c > '9')  0;

373 
r
 = 10;

376 
v®
 = 0;

377 
c
 > ' ') {

378 ià(
c
 >= 'a') c -= 0x20;

379 
c
 -= '0';

380 ià(
c
 >= 17) {

381 
c
 -= 7;

382 ià(
c
 <= 9)  0;

384 ià(
c
 >ğ
r
)  0;

385 
v®
 = v® * 
r
 + 
c
;

386 
c
 = *(++(*
¡r
));

388 ià(
s
è
v®
 = 0 - val;

390 *
»s
 = 
v®
;

392 
	}
}

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOSConfig.h

71 #iâdeà
FREERTOS_CONFIG_H


72 
	#FREERTOS_CONFIG_H


	)

86 
	~"as£¹.h
"

89 #ià
defšed
(
__ICCARM__
è|| defšed(
__CC_ARM
è|| defšed(
__GNUC__
)

90 
	~<¡dšt.h
>

91 
ušt32_t
 
Sy¡emCÜeClock
;

92 vŞ©
ušt32_t
 
ulHighF»qu’cyTim”Ticks
;

95 
	#cÚfigUSE_PREEMPTION
 1

	)

96 
	#cÚfigUSE_IDLE_HOOK
 1

	)

97 
	#cÚfigUSE_TICK_HOOK
 1

	)

98 
	#cÚfigCPU_CLOCK_HZ
 ( 
Sy¡emCÜeClock
 )

99 
	#cÚfigTICK_RATE_HZ
 ( ( 
TickTy³_t
 ) 1000 )

	)

100 
	#cÚfigMAX_PRIORITIES
 ( 10 )

101 
	#cÚfigMINIMAL_STACK_SIZE
 ( ( è130 )

	)

102 
	#cÚfigTOTAL_HEAP_SIZE
 ( ( 
size_t
 ) ( 20*1024 * 1024 ) )

	)

103 
	#cÚfigMAX_TASK_NAME_LEN
 ( 16 )

	)

104 
	#cÚfigUSE_TRACE_FACILITY
 1

	)

105 
	#cÚfigUSE_16_BIT_TICKS
 0

	)

106 
	#cÚfigIDLE_SHOULD_YIELD
 1

	)

107 
	#cÚfigUSE_MUTEXES
 1

	)

108 
	#cÚfigQUEUE_REGISTRY_SIZE
 8

	)

109 
	#cÚfigCHECK_FOR_STACK_OVERFLOW
 2

	)

110 
	#cÚfigUSE_RECURSIVE_MUTEXES
 1

	)

111 
	#cÚfigUSE_MALLOC_FAILED_HOOK
 1

	)

112 
	#cÚfigUSE_APPLICATION_TASK_TAG
 0

	)

113 
	#cÚfigUSE_COUNTING_SEMAPHORES
 1

	)

115 
	#cÚfigUSE_PORT_OPTIMISED_TASK_SELECTION
 1

	)

117 
	#cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 3

	)

119 
	#cÚfigAPPLICATION_ALLOCATED_HEAP
 1

	)

121 
	#cÚfigINCLUDE_APPLICATION_DEFINED_PRIVILEGED_FUNCTIONS
 1

	)

125 
	#cÚfigGENERATE_RUN_TIME_STATS
 1

	)

126 
	#cÚfigUSE_STATS_FORMATTING_FUNCTIONS
 1

	)

127 
	#pÜtCONFIGURE_TIMER_FOR_RUN_TIME_STATS
(è(
ulHighF»qu’cyTim”Ticks
 = 0ul)

	)

128 
	#pÜtGET_RUN_TIME_COUNTER_VALUE
(è
ulHighF»qu’cyTim”Ticks


	)

134 
	#cÚfigUSE_CO_ROUTINES
 0

	)

135 
	#cÚfigMAX_CO_ROUTINE_PRIORITIES
 ( 2 )

	)

138 
	#cÚfigUSE_TIMERS
 1

	)

139 
	#cÚfigTIMER_TASK_PRIORITY
 ( 2 )

	)

140 
	#cÚfigTIMER_QUEUE_LENGTH
 10

	)

141 
	#cÚfigTIMER_TASK_STACK_DEPTH
 ( 
cÚfigMINIMAL_STACK_SIZE
 * 2 )

	)

146 
	#INCLUDE_vTaskD–‘e
 1

	)

148 
	#INCLUDE_uxTaskPriÜ™yG‘
 1

	)

149 
	#INCLUDE_vTaskD–ay
 1

	)

150 
	#INCLUDE_vTaskD–ayUÁ
 1

	)

151 
	#INCLUDE_vTaskPriÜ™yS‘
 1

	)

152 
	#INCLUDE_vTaskSu¥’d
 1

	)

153 
	#INCLUDE_xResumeFromISR
 1

	)

155 
	#INCLUDE_eTaskG‘S‹
 0

	)

156 
	#INCLUDE_pcTaskG‘TaskName
 0

	)

157 
	#INCLUDE_xTaskG‘HªdË
 0

158 
	#INCLUDE_uxTaskG‘SckHighW©”M¬k
 0

	)

159 
	#INCLUDE_xTaskG‘Cu¼’tTaskHªdË
 1

	)

160 
	#INCLUDE_xTaskG‘IdËTaskHªdË
 0

	)

161 
	#INCLUDE_xTaskG‘ScheduËrS‹
 1

	)

163 
	#INCLUDE_xTim”G‘Tim”D«mÚTaskHªdË
 0

	)

164 
	#INCLUDE_xTim”P’dFunùiÚC®l
 1

	)

166 
	#INCLUDE_xEv’tGroupS‘B™FromISR
 1

	)

171 #ifdeà
__NVIC_PRIO_BITS


173 
	#cÚfigPRIO_BITS
 
__NVIC_PRIO_BITS


	)

175 
	#cÚfigPRIO_BITS
 4

	)

180 
	#cÚfigLIBRARY_LOWEST_INTERRUPT_PRIORITY
 0xf

	)

186 
	#cÚfigLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORITY
 2

	)

190 
	#cÚfigKERNEL_INTERRUPT_PRIORITY
 ( 
cÚfigLIBRARY_LOWEST_INTERRUPT_PRIORITY
 << (8 - 
cÚfigPRIO_BITS
è)

	)

193 
	#cÚfigMAX_SYSCALL_INTERRUPT_PRIORITY
 ( 
cÚfigLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORITY
 << (8 - 
cÚfigPRIO_BITS
è)

	)

197 
	#cÚfigASSERT
Ğ
x
 ) ifĞĞx ) =ğ0 ) { 
	`skDISABLE_INTERRUPTS
();  ;; ); }

	)

203 
	#vPÜtSVCHªdËr
 
SVC_HªdËr


	)

204 
	#xPÜtP’dSVHªdËr
 
P’dSV_HªdËr


	)

208 
	#xPÜtSysTickHªdËr
 
SysTick_HªdËr


	)

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\croutine.c

70 
	~"F»eRTOS.h
"

71 
	~"sk.h
"

72 
	~"üoutše.h
"

75 #ifĞ
cÚfigUSE_CO_ROUTINES
 != 0 )

81 #ifdeà
pÜtREMOVE_STATIC_QUALIFIER


82 

	)

87 
Li¡_t
 
	gpxR—dyCoRoutšeLi¡s
[ 
cÚfigMAX_CO_ROUTINE_PRIORITIES
 ];

88 
Li¡_t
 
	gxD–ayedCoRoutšeLi¡1
;

89 
Li¡_t
 
	gxD–ayedCoRoutšeLi¡2
;

90 
Li¡_t
 * 
	gpxD–ayedCoRoutšeLi¡
;

91 
Li¡_t
 * 
	gpxOv”æowD–ayedCoRoutšeLi¡
;

92 
Li¡_t
 
	gxP’dšgR—dyCoRoutšeLi¡
;

95 
CRCB_t
 * 
	gpxCu¼’tCoRoutše
 = 
NULL
;

96 
UBa£Ty³_t
 
	guxTİCoRoutšeR—dyPriÜ™y
 = 0;

97 
TickTy³_t
 
	gxCoRoutšeTickCouÁ
 = 0, 
	gxLa¡TickCouÁ
 = 0, 
	gxPas£dTicks
 = 0;

100 
	#cÜINITIAL_STATE
 ( 0 )

	)

109 
	#´vAddCoRoutšeToR—dyQueue
Ğ
pxCRCB
 ) \

111 ifĞ
pxCRCB
->
uxPriÜ™y
 > 
uxTİCoRoutšeR—dyPriÜ™y
 ) \

113 
uxTİCoRoutšeR—dyPriÜ™y
 = 
pxCRCB
->
uxPriÜ™y
; \

115 
	`vLi¡In£¹End
ĞĞ
Li¡_t
 * ) &Ğ
pxR—dyCoRoutšeLi¡s
[ 
pxCRCB
->
uxPriÜ™y
 ] ), &ĞpxCRCB->
xG’”icLi¡I‹m
 ) ); \

116 }

	)

122 
´vIn™Ÿli£CoRoutšeLi¡s
( );

130 
´vCheckP’dšgR—dyLi¡
( );

140 
´vCheckD–ayedLi¡
( );

144 
Ba£Ty³_t
 
	$xCoRoutšeC»©e
Ğ
üCOROUTINE_CODE
 
pxCoRoutšeCode
, 
UBa£Ty³_t
 
uxPriÜ™y
, UBa£Ty³_ˆ
uxIndex
 )

146 
Ba£Ty³_t
 
xR‘uº
;

147 
CRCB_t
 *
pxCoRoutše
;

150 
pxCoRoutše
 = ( 
CRCB_t
 * ) 
	`pvPÜtM®loc
( ( CRCB_t ) );

151 ifĞ
pxCoRoutše
 )

155 ifĞ
pxCu¼’tCoRoutše
 =ğ
NULL
 )

157 
pxCu¼’tCoRoutše
 = 
pxCoRoutše
;

158 
	`´vIn™Ÿli£CoRoutšeLi¡s
();

162 ifĞ
uxPriÜ™y
 >ğ
cÚfigMAX_CO_ROUTINE_PRIORITIES
 )

164 
uxPriÜ™y
 = 
cÚfigMAX_CO_ROUTINE_PRIORITIES
 - 1;

168 
pxCoRoutše
->
uxS‹
 = 
cÜINITIAL_STATE
;

169 
pxCoRoutše
->
uxPriÜ™y
 = uxPriority;

170 
pxCoRoutše
->
uxIndex
 = uxIndex;

171 
pxCoRoutše
->
pxCoRoutšeFunùiÚ
 = 
pxCoRoutšeCode
;

174 
	`vLi¡In™Ÿli£I‹m
Ğ&Ğ
pxCoRoutše
->
xG’”icLi¡I‹m
 ) );

175 
	`vLi¡In™Ÿli£I‹m
Ğ&Ğ
pxCoRoutše
->
xEv’tLi¡I‹m
 ) );

180 
	`li¡SET_LIST_ITEM_OWNER
Ğ&Ğ
pxCoRoutše
->
xG’”icLi¡I‹m
 ),…xCoRoutine );

181 
	`li¡SET_LIST_ITEM_OWNER
Ğ&Ğ
pxCoRoutše
->
xEv’tLi¡I‹m
 ),…xCoRoutine );

184 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxCoRoutše
->
xEv’tLi¡I‹m
 ), ( ( 
TickTy³_t
 ) 
cÚfigMAX_CO_ROUTINE_PRIORITIES
 - ( TickTy³_ˆè
uxPriÜ™y
 ) );

188 
	`´vAddCoRoutšeToR—dyQueue
Ğ
pxCoRoutše
 );

190 
xR‘uº
 = 
pdPASS
;

194 
xR‘uº
 = 
”rCOULD_NOT_ALLOCATE_REQUIRED_MEMORY
;

197  
xR‘uº
;

198 
	}
}

201 
	$vCoRoutšeAddToD–ayedLi¡
Ğ
TickTy³_t
 
xTicksToD–ay
, 
Li¡_t
 *
pxEv’tLi¡
 )

203 
TickTy³_t
 
xTimeToWake
;

207 
xTimeToWake
 = 
xCoRoutšeTickCouÁ
 + 
xTicksToD–ay
;

212 Ğè
	`uxLi¡Remove
ĞĞ
Li¡I‹m_t
 * ) &Ğ
pxCu¼’tCoRoutše
->
xG’”icLi¡I‹m
 ) );

215 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxCu¼’tCoRoutše
->
xG’”icLi¡I‹m
 ), 
xTimeToWake
 );

217 ifĞ
xTimeToWake
 < 
xCoRoutšeTickCouÁ
 )

221 
	`vLi¡In£¹
ĞĞ
Li¡_t
 * ) 
pxOv”æowD–ayedCoRoutšeLi¡
, ( 
Li¡I‹m_t
 * ) &Ğ
pxCu¼’tCoRoutše
->
xG’”icLi¡I‹m
 ) );

227 
	`vLi¡In£¹
ĞĞ
Li¡_t
 * ) 
pxD–ayedCoRoutšeLi¡
, ( 
Li¡I‹m_t
 * ) &Ğ
pxCu¼’tCoRoutše
->
xG’”icLi¡I‹m
 ) );

230 ifĞ
pxEv’tLi¡
 )

234 
	`vLi¡In£¹
Ğ
pxEv’tLi¡
, &Ğ
pxCu¼’tCoRoutše
->
xEv’tLi¡I‹m
 ) );

236 
	}
}

239 
	$´vCheckP’dšgR—dyLi¡
( )

244  
	`li¡LIST_IS_EMPTY
Ğ&
xP’dšgR—dyCoRoutšeLi¡
 ) =ğ
pdFALSE
 )

246 
CRCB_t
 *
pxUnblockedCRCB
;

249 
	`pÜtDISABLE_INTERRUPTS
();

251 
pxUnblockedCRCB
 = ( 
CRCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ(&
xP’dšgR—dyCoRoutšeLi¡
) );

252 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxUnblockedCRCB
->
xEv’tLi¡I‹m
 ) );

254 
	`pÜtENABLE_INTERRUPTS
();

256 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxUnblockedCRCB
->
xG’”icLi¡I‹m
 ) );

257 
	`´vAddCoRoutšeToR—dyQueue
Ğ
pxUnblockedCRCB
 );

259 
	}
}

262 
	$´vCheckD–ayedLi¡
( )

264 
CRCB_t
 *
pxCRCB
;

266 
xPas£dTicks
 = 
	`xTaskG‘TickCouÁ
(è- 
xLa¡TickCouÁ
;

267  
xPas£dTicks
 )

269 
xCoRoutšeTickCouÁ
++;

270 
xPas£dTicks
--;

273 ifĞ
xCoRoutšeTickCouÁ
 == 0 )

275 
Li¡_t
 * 
pxTemp
;

279 
pxTemp
 = 
pxD–ayedCoRoutšeLi¡
;

280 
pxD–ayedCoRoutšeLi¡
 = 
pxOv”æowD–ayedCoRoutšeLi¡
;

281 
pxOv”æowD–ayedCoRoutšeLi¡
 = 
pxTemp
;

285  
	`li¡LIST_IS_EMPTY
Ğ
pxD–ayedCoRoutšeLi¡
 ) =ğ
pdFALSE
 )

287 
pxCRCB
 = ( 
CRCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ
pxD–ayedCoRoutšeLi¡
 );

289 ifĞ
xCoRoutšeTickCouÁ
 < 
	`li¡GET_LIST_ITEM_VALUE
Ğ&Ğ
pxCRCB
->
xG’”icLi¡I‹m
 ) ) )

295 
	`pÜtDISABLE_INTERRUPTS
();

302 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxCRCB
->
xG’”icLi¡I‹m
 ) );

305 ifĞ
pxCRCB
->
xEv’tLi¡I‹m
.
pvCÚš”
 )

307 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxCRCB
->
xEv’tLi¡I‹m
 ) );

310 
	`pÜtENABLE_INTERRUPTS
();

312 
	`´vAddCoRoutšeToR—dyQueue
Ğ
pxCRCB
 );

316 
xLa¡TickCouÁ
 = 
xCoRoutšeTickCouÁ
;

317 
	}
}

320 
	$vCoRoutšeScheduË
( )

323 
	`´vCheckP’dšgR—dyLi¡
();

326 
	`´vCheckD–ayedLi¡
();

329  
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxR—dyCoRoutšeLi¡s
[ 
uxTİCoRoutšeR—dyPriÜ™y
 ] ) ) )

331 ifĞ
uxTİCoRoutšeR—dyPriÜ™y
 == 0 )

336 --
uxTİCoRoutšeR—dyPriÜ™y
;

341 
	`li¡GET_OWNER_OF_NEXT_ENTRY
Ğ
pxCu¼’tCoRoutše
, &Ğ
pxR—dyCoRoutšeLi¡s
[ 
uxTİCoRoutšeR—dyPriÜ™y
 ] ) );

344 Ğ
pxCu¼’tCoRoutše
->
pxCoRoutšeFunùiÚ
 )ĞpxCu¼’tCoRoutše,…xCu¼’tCoRoutše->
uxIndex
 );

347 
	}
}

350 
	$´vIn™Ÿli£CoRoutšeLi¡s
( )

352 
UBa£Ty³_t
 
uxPriÜ™y
;

354  
uxPriÜ™y
 = 0; uxPriÜ™y < 
cÚfigMAX_CO_ROUTINE_PRIORITIES
; uxPriority++ )

356 
	`vLi¡In™Ÿli£
ĞĞ
Li¡_t
 * ) &Ğ
pxR—dyCoRoutšeLi¡s
[ 
uxPriÜ™y
 ] ) );

359 
	`vLi¡In™Ÿli£
ĞĞ
Li¡_t
 * ) &
xD–ayedCoRoutšeLi¡1
 );

360 
	`vLi¡In™Ÿli£
ĞĞ
Li¡_t
 * ) &
xD–ayedCoRoutšeLi¡2
 );

361 
	`vLi¡In™Ÿli£
ĞĞ
Li¡_t
 * ) &
xP’dšgR—dyCoRoutšeLi¡
 );

365 
pxD–ayedCoRoutšeLi¡
 = &
xD–ayedCoRoutšeLi¡1
;

366 
pxOv”æowD–ayedCoRoutšeLi¡
 = &
xD–ayedCoRoutšeLi¡2
;

367 
	}
}

370 
Ba£Ty³_t
 
	$xCoRoutšeRemoveFromEv’tLi¡
ĞcÚ¡ 
Li¡_t
 *
pxEv’tLi¡
 )

372 
CRCB_t
 *
pxUnblockedCRCB
;

373 
Ba£Ty³_t
 
xR‘uº
;

378 
pxUnblockedCRCB
 = ( 
CRCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ
pxEv’tLi¡
 );

379 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxUnblockedCRCB
->
xEv’tLi¡I‹m
 ) );

380 
	`vLi¡In£¹End
ĞĞ
Li¡_t
 * ) &Ğ
xP’dšgR—dyCoRoutšeLi¡
 ), &Ğ
pxUnblockedCRCB
->
xEv’tLi¡I‹m
 ) );

382 ifĞ
pxUnblockedCRCB
->
uxPriÜ™y
 >ğ
pxCu¼’tCoRoutše
->uxPriority )

384 
xR‘uº
 = 
pdTRUE
;

388 
xR‘uº
 = 
pdFALSE
;

391  
xR‘uº
;

392 
	}
}

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\event_groups.c

71 
	~<¡dlib.h
>

76 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

79 
	~"F»eRTOS.h
"

80 
	~"sk.h
"

81 
	~"tim”s.h
"

82 
	~"ev’t_groups.h
"

88 #undeà
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


93 #ià
cÚfigUSE_16_BIT_TICKS
 == 1

94 
	#ev’tCLEAR_EVENTS_ON_EXIT_BIT
 0x0100U

	)

95 
	#ev’tUNBLOCKED_DUE_TO_BIT_SET
 0x0200U

	)

96 
	#ev’tWAIT_FOR_ALL_BITS
 0x0400U

	)

97 
	#ev’tEVENT_BITS_CONTROL_BYTES
 0xff00U

	)

99 
	#ev’tCLEAR_EVENTS_ON_EXIT_BIT
 0x01000000UL

	)

100 
	#ev’tUNBLOCKED_DUE_TO_BIT_SET
 0x02000000UL

	)

101 
	#ev’tWAIT_FOR_ALL_BITS
 0x04000000UL

	)

102 
	#ev’tEVENT_BITS_CONTROL_BYTES
 0xff000000UL

	)

105 
	sxEv’tGroupDefš™iÚ


107 
Ev’tB™s_t
 
	muxEv’tB™s
;

108 
Li¡_t
 
	mxTasksWa™šgFÜB™s
;

110 #ifĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

111 
UBa£Ty³_t
 
	muxEv’tGroupNumb”
;

114 #ifĞĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 ) )

115 
ušt8_t
 
	mucStiÿÎyAÎoÿ‹d
;

117 } 
	tEv’tGroup_t
;

129 
Ba£Ty³_t
 
	$´vTe¡Wa™CÚd™iÚ
ĞcÚ¡ 
Ev’tB™s_t
 
uxCu¼’tEv’tB™s
, cÚ¡ Ev’tB™s_ˆ
uxB™sToWa™FÜ
, cÚ¡ 
Ba£Ty³_t
 
xWa™FÜAÎB™s
 ) 
PRIVILEGED_FUNCTION
;

133 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

135 
Ev’tGroupHªdË_t
 
	$xEv’tGroupC»©eStic
Ğ
SticEv’tGroup_t
 *
pxEv’tGroupBufãr
 )

137 
Ev’tGroup_t
 *
pxEv’tB™s
;

140 
	`cÚfigASSERT
Ğ
pxEv’tGroupBufãr
 );

143 
pxEv’tB™s
 = ( 
Ev’tGroup_t
 * ) 
pxEv’tGroupBufãr
;

145 ifĞ
pxEv’tB™s
 !ğ
NULL
 )

147 
pxEv’tB™s
->
uxEv’tB™s
 = 0;

148 
	`vLi¡In™Ÿli£
Ğ&Ğ
pxEv’tB™s
->
xTasksWa™šgFÜB™s
 ) );

150 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 )

155 
pxEv’tB™s
->
ucStiÿÎyAÎoÿ‹d
 = 
pdTRUE
;

159 
	`ŒaûEVENT_GROUP_CREATE
Ğ
pxEv’tB™s
 );

163 
	`ŒaûEVENT_GROUP_CREATE_FAILED
();

166  ( 
Ev’tGroupHªdË_t
 ) 
pxEv’tB™s
;

167 
	}
}

172 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 )

174 
Ev’tGroupHªdË_t
 
	$xEv’tGroupC»©e
( )

176 
Ev’tGroup_t
 *
pxEv’tB™s
;

179 
pxEv’tB™s
 = ( 
Ev’tGroup_t
 * ) 
	`pvPÜtM®loc
( ( EventGroup_t ) );

181 ifĞ
pxEv’tB™s
 !ğ
NULL
 )

183 
pxEv’tB™s
->
uxEv’tB™s
 = 0;

184 
	`vLi¡In™Ÿli£
Ğ&Ğ
pxEv’tB™s
->
xTasksWa™šgFÜB™s
 ) );

186 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

191 
pxEv’tB™s
->
ucStiÿÎyAÎoÿ‹d
 = 
pdFALSE
;

195 
	`ŒaûEVENT_GROUP_CREATE
Ğ
pxEv’tB™s
 );

199 
	`ŒaûEVENT_GROUP_CREATE_FAILED
();

202  ( 
Ev’tGroupHªdË_t
 ) 
pxEv’tB™s
;

203 
	}
}

208 
Ev’tB™s_t
 
	$xEv’tGroupSync
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
, cÚ¡ 
Ev’tB™s_t
 
uxB™sToS‘
, cÚ¡ Ev’tB™s_ˆ
uxB™sToWa™FÜ
, 
TickTy³_t
 
xTicksToWa™
 )

210 
Ev’tB™s_t
 
uxOrigš®B™V®ue
, 
uxR‘uº
;

211 
Ev’tGroup_t
 *
pxEv’tB™s
 = ( Ev’tGroup_ˆ* ) 
xEv’tGroup
;

212 
Ba£Ty³_t
 
xAÌ—dyY›lded
;

213 
Ba£Ty³_t
 
xTimeoutOccu¼ed
 = 
pdFALSE
;

215 
	`cÚfigASSERT
ĞĞ
uxB™sToWa™FÜ
 & 
ev’tEVENT_BITS_CONTROL_BYTES
 ) == 0 );

216 
	`cÚfigASSERT
Ğ
uxB™sToWa™FÜ
 != 0 );

217 #iàĞĞ
INCLUDE_xTaskG‘ScheduËrS‹
 =ğ1 ) || ( 
cÚfigUSE_TIMERS
 == 1 ) )

219 
	`cÚfigASSERT
Ğ!ĞĞ
	`xTaskG‘ScheduËrS‹
(è=ğ
skSCHEDULER_SUSPENDED
 ) && ( 
xTicksToWa™
 != 0 ) ) );

223 
	`vTaskSu¥’dAÎ
();

225 
uxOrigš®B™V®ue
 = 
pxEv’tB™s
->
uxEv’tB™s
;

227 Ğè
	`xEv’tGroupS‘B™s
Ğ
xEv’tGroup
, 
uxB™sToS‘
 );

229 ifĞĞĞ
uxOrigš®B™V®ue
 | 
uxB™sToS‘
 ) & 
uxB™sToWa™FÜ
 ) == uxBitsToWaitFor )

232 
uxR‘uº
 = ( 
uxOrigš®B™V®ue
 | 
uxB™sToS‘
 );

236 
pxEv’tB™s
->
uxEv’tB™s
 &ğ~
uxB™sToWa™FÜ
;

238 
xTicksToWa™
 = 0;

242 ifĞ
xTicksToWa™
 !ğĞ
TickTy³_t
 ) 0 )

244 
	`ŒaûEVENT_GROUP_SYNC_BLOCK
Ğ
xEv’tGroup
, 
uxB™sToS‘
, 
uxB™sToWa™FÜ
 );

249 
	`vTaskPÏûOnUnÜd”edEv’tLi¡
Ğ&Ğ
pxEv’tB™s
->
xTasksWa™šgFÜB™s
 ), ( 
uxB™sToWa™FÜ
 | 
ev’tCLEAR_EVENTS_ON_EXIT_BIT
 | 
ev’tWAIT_FOR_ALL_BITS
 ), 
xTicksToWa™
 );

255 
uxR‘uº
 = 0;

261 
uxR‘uº
 = 
pxEv’tB™s
->
uxEv’tB™s
;

265 
xAÌ—dyY›lded
 = 
	`xTaskResumeAÎ
();

267 ifĞ
xTicksToWa™
 !ğĞ
TickTy³_t
 ) 0 )

269 ifĞ
xAÌ—dyY›lded
 =ğ
pdFALSE
 )

271 
	`pÜtYIELD_WITHIN_API
();

275 
	`mtCOVERAGE_TEST_MARKER
();

282 
uxR‘uº
 = 
	`uxTaskRe£tEv’tI‹mV®ue
();

284 ifĞĞ
uxR‘uº
 & 
ev’tUNBLOCKED_DUE_TO_BIT_SET
 ) =ğĞ
Ev’tB™s_t
 ) 0 )

287 
	`skENTER_CRITICAL
();

289 
uxR‘uº
 = 
pxEv’tB™s
->
uxEv’tB™s
;

295 ifĞĞ
uxR‘uº
 & 
uxB™sToWa™FÜ
 ) == uxBitsToWaitFor )

297 
pxEv’tB™s
->
uxEv’tB™s
 &ğ~
uxB™sToWa™FÜ
;

301 
	`mtCOVERAGE_TEST_MARKER
();

304 
	`skEXIT_CRITICAL
();

306 
xTimeoutOccu¼ed
 = 
pdTRUE
;

315 
uxR‘uº
 &ğ~
ev’tEVENT_BITS_CONTROL_BYTES
;

318 
	`ŒaûEVENT_GROUP_SYNC_END
Ğ
xEv’tGroup
, 
uxB™sToS‘
, 
uxB™sToWa™FÜ
, 
xTimeoutOccu¼ed
 );

320  
uxR‘uº
;

321 
	}
}

324 
Ev’tB™s_t
 
	$xEv’tGroupWa™B™s
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
, cÚ¡ 
Ev’tB™s_t
 
uxB™sToWa™FÜ
, cÚ¡ 
Ba£Ty³_t
 
xCË¬OnEx™
, cÚ¡ Ba£Ty³_ˆ
xWa™FÜAÎB™s
, 
TickTy³_t
 
xTicksToWa™
 )

326 
Ev’tGroup_t
 *
pxEv’tB™s
 = ( Ev’tGroup_ˆ* ) 
xEv’tGroup
;

327 
Ev’tB™s_t
 
uxR‘uº
, 
uxCÚŒŞB™s
 = 0;

328 
Ba£Ty³_t
 
xWa™CÚd™iÚM‘
, 
xAÌ—dyY›lded
;

329 
Ba£Ty³_t
 
xTimeoutOccu¼ed
 = 
pdFALSE
;

333 
	`cÚfigASSERT
Ğ
xEv’tGroup
 );

334 
	`cÚfigASSERT
ĞĞ
uxB™sToWa™FÜ
 & 
ev’tEVENT_BITS_CONTROL_BYTES
 ) == 0 );

335 
	`cÚfigASSERT
Ğ
uxB™sToWa™FÜ
 != 0 );

336 #iàĞĞ
INCLUDE_xTaskG‘ScheduËrS‹
 =ğ1 ) || ( 
cÚfigUSE_TIMERS
 == 1 ) )

338 
	`cÚfigASSERT
Ğ!ĞĞ
	`xTaskG‘ScheduËrS‹
(è=ğ
skSCHEDULER_SUSPENDED
 ) && ( 
xTicksToWa™
 != 0 ) ) );

342 
	`vTaskSu¥’dAÎ
();

344 cÚ¡ 
Ev’tB™s_t
 
uxCu¼’tEv’tB™s
 = 
pxEv’tB™s
->
uxEv’tB™s
;

347 
xWa™CÚd™iÚM‘
 = 
	`´vTe¡Wa™CÚd™iÚ
Ğ
uxCu¼’tEv’tB™s
, 
uxB™sToWa™FÜ
, 
xWa™FÜAÎB™s
 );

349 ifĞ
xWa™CÚd™iÚM‘
 !ğ
pdFALSE
 )

353 
uxR‘uº
 = 
uxCu¼’tEv’tB™s
;

354 
xTicksToWa™
 = ( 
TickTy³_t
 ) 0;

357 ifĞ
xCË¬OnEx™
 !ğ
pdFALSE
 )

359 
pxEv’tB™s
->
uxEv’tB™s
 &ğ~
uxB™sToWa™FÜ
;

363 
	`mtCOVERAGE_TEST_MARKER
();

366 ifĞ
xTicksToWa™
 =ğĞ
TickTy³_t
 ) 0 )

370 
uxR‘uº
 = 
uxCu¼’tEv’tB™s
;

378 ifĞ
xCË¬OnEx™
 !ğ
pdFALSE
 )

380 
uxCÚŒŞB™s
 |ğ
ev’tCLEAR_EVENTS_ON_EXIT_BIT
;

384 
	`mtCOVERAGE_TEST_MARKER
();

387 ifĞ
xWa™FÜAÎB™s
 !ğ
pdFALSE
 )

389 
uxCÚŒŞB™s
 |ğ
ev’tWAIT_FOR_ALL_BITS
;

393 
	`mtCOVERAGE_TEST_MARKER
();

399 
	`vTaskPÏûOnUnÜd”edEv’tLi¡
Ğ&Ğ
pxEv’tB™s
->
xTasksWa™šgFÜB™s
 ), ( 
uxB™sToWa™FÜ
 | 
uxCÚŒŞB™s
 ), 
xTicksToWa™
 );

404 
uxR‘uº
 = 0;

406 
	`ŒaûEVENT_GROUP_WAIT_BITS_BLOCK
Ğ
xEv’tGroup
, 
uxB™sToWa™FÜ
 );

409 
xAÌ—dyY›lded
 = 
	`xTaskResumeAÎ
();

411 ifĞ
xTicksToWa™
 !ğĞ
TickTy³_t
 ) 0 )

413 ifĞ
xAÌ—dyY›lded
 =ğ
pdFALSE
 )

415 
	`pÜtYIELD_WITHIN_API
();

419 
	`mtCOVERAGE_TEST_MARKER
();

426 
uxR‘uº
 = 
	`uxTaskRe£tEv’tI‹mV®ue
();

428 ifĞĞ
uxR‘uº
 & 
ev’tUNBLOCKED_DUE_TO_BIT_SET
 ) =ğĞ
Ev’tB™s_t
 ) 0 )

430 
	`skENTER_CRITICAL
();

433 
uxR‘uº
 = 
pxEv’tB™s
->
uxEv’tB™s
;

437 ifĞ
	`´vTe¡Wa™CÚd™iÚ
Ğ
uxR‘uº
, 
uxB™sToWa™FÜ
, 
xWa™FÜAÎB™s
 ) !ğ
pdFALSE
 )

439 ifĞ
xCË¬OnEx™
 !ğ
pdFALSE
 )

441 
pxEv’tB™s
->
uxEv’tB™s
 &ğ~
uxB™sToWa™FÜ
;

445 
	`mtCOVERAGE_TEST_MARKER
();

450 
	`mtCOVERAGE_TEST_MARKER
();

453 
	`skEXIT_CRITICAL
();

456 
xTimeoutOccu¼ed
 = 
pdFALSE
;

464 
uxR‘uº
 &ğ~
ev’tEVENT_BITS_CONTROL_BYTES
;

466 
	`ŒaûEVENT_GROUP_WAIT_BITS_END
Ğ
xEv’tGroup
, 
uxB™sToWa™FÜ
, 
xTimeoutOccu¼ed
 );

468  
uxR‘uº
;

469 
	}
}

472 
Ev’tB™s_t
 
	$xEv’tGroupCË¬B™s
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
, cÚ¡ 
Ev’tB™s_t
 
uxB™sToCË¬
 )

474 
Ev’tGroup_t
 *
pxEv’tB™s
 = ( Ev’tGroup_ˆ* ) 
xEv’tGroup
;

475 
Ev’tB™s_t
 
uxR‘uº
;

479 
	`cÚfigASSERT
Ğ
xEv’tGroup
 );

480 
	`cÚfigASSERT
ĞĞ
uxB™sToCË¬
 & 
ev’tEVENT_BITS_CONTROL_BYTES
 ) == 0 );

482 
	`skENTER_CRITICAL
();

484 
	`ŒaûEVENT_GROUP_CLEAR_BITS
Ğ
xEv’tGroup
, 
uxB™sToCË¬
 );

488 
uxR‘uº
 = 
pxEv’tB™s
->
uxEv’tB™s
;

491 
pxEv’tB™s
->
uxEv’tB™s
 &ğ~
uxB™sToCË¬
;

493 
	`skEXIT_CRITICAL
();

495  
uxR‘uº
;

496 
	}
}

499 #iàĞĞ
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) && ( 
INCLUDE_xTim”P’dFunùiÚC®l
 =ğ1 ) && ( 
cÚfigUSE_TIMERS
 == 1 ) )

501 
Ba£Ty³_t
 
	$xEv’tGroupCË¬B™sFromISR
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
, cÚ¡ 
Ev’tB™s_t
 
uxB™sToCË¬
 )

503 
Ba£Ty³_t
 
xR‘uº
;

505 
	`ŒaûEVENT_GROUP_CLEAR_BITS_FROM_ISR
Ğ
xEv’tGroup
, 
uxB™sToCË¬
 );

506 
xR‘uº
 = 
	`xTim”P’dFunùiÚC®lFromISR
Ğ
vEv’tGroupCË¬B™sC®lback
, ( * ) 
xEv’tGroup
, ( 
ušt32_t
 ) 
uxB™sToCË¬
, 
NULL
 );

508  
xR‘uº
;

509 
	}
}

514 
Ev’tB™s_t
 
	$xEv’tGroupG‘B™sFromISR
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
 )

516 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

517 
Ev’tGroup_t
 *
pxEv’tB™s
 = ( Ev’tGroup_ˆ* ) 
xEv’tGroup
;

518 
Ev’tB™s_t
 
uxR‘uº
;

520 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

522 
uxR‘uº
 = 
pxEv’tB™s
->
uxEv’tB™s
;

524 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

526  
uxR‘uº
;

527 
	}
}

530 
Ev’tB™s_t
 
	$xEv’tGroupS‘B™s
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
, cÚ¡ 
Ev’tB™s_t
 
uxB™sToS‘
 )

532 
Li¡I‹m_t
 *
pxLi¡I‹m
, *
pxNext
;

533 
Li¡I‹m_t
 cÚ¡ *
pxLi¡End
;

534 
Li¡_t
 *
pxLi¡
;

535 
Ev’tB™s_t
 
uxB™sToCË¬
 = 0, 
uxB™sWa™edFÜ
, 
uxCÚŒŞB™s
;

536 
Ev’tGroup_t
 *
pxEv’tB™s
 = ( Ev’tGroup_ˆ* ) 
xEv’tGroup
;

537 
Ba£Ty³_t
 
xM©chFound
 = 
pdFALSE
;

541 
	`cÚfigASSERT
Ğ
xEv’tGroup
 );

542 
	`cÚfigASSERT
ĞĞ
uxB™sToS‘
 & 
ev’tEVENT_BITS_CONTROL_BYTES
 ) == 0 );

544 
pxLi¡
 = &Ğ
pxEv’tB™s
->
xTasksWa™šgFÜB™s
 );

545 
pxLi¡End
 = 
	`li¡GET_END_MARKER
Ğ
pxLi¡
 );

546 
	`vTaskSu¥’dAÎ
();

548 
	`ŒaûEVENT_GROUP_SET_BITS
Ğ
xEv’tGroup
, 
uxB™sToS‘
 );

550 
pxLi¡I‹m
 = 
	`li¡GET_HEAD_ENTRY
Ğ
pxLi¡
 );

553 
pxEv’tB™s
->
uxEv’tB™s
 |ğ
uxB™sToS‘
;

556  
pxLi¡I‹m
 !ğ
pxLi¡End
 )

558 
pxNext
 = 
	`li¡GET_NEXT
Ğ
pxLi¡I‹m
 );

559 
uxB™sWa™edFÜ
 = 
	`li¡GET_LIST_ITEM_VALUE
Ğ
pxLi¡I‹m
 );

560 
xM©chFound
 = 
pdFALSE
;

563 
uxCÚŒŞB™s
 = 
uxB™sWa™edFÜ
 & 
ev’tEVENT_BITS_CONTROL_BYTES
;

564 
uxB™sWa™edFÜ
 &ğ~
ev’tEVENT_BITS_CONTROL_BYTES
;

566 ifĞĞ
uxCÚŒŞB™s
 & 
ev’tWAIT_FOR_ALL_BITS
 ) =ğĞ
Ev’tB™s_t
 ) 0 )

569 ifĞĞ
uxB™sWa™edFÜ
 & 
pxEv’tB™s
->
uxEv’tB™s
 ) !ğĞ
Ev’tB™s_t
 ) 0 )

571 
xM©chFound
 = 
pdTRUE
;

575 
	`mtCOVERAGE_TEST_MARKER
();

578 ifĞĞ
uxB™sWa™edFÜ
 & 
pxEv’tB™s
->
uxEv’tB™s
 ) == uxBitsWaitedFor )

581 
xM©chFound
 = 
pdTRUE
;

588 ifĞ
xM©chFound
 !ğ
pdFALSE
 )

591 ifĞĞ
uxCÚŒŞB™s
 & 
ev’tCLEAR_EVENTS_ON_EXIT_BIT
 ) !ğĞ
Ev’tB™s_t
 ) 0 )

593 
uxB™sToCË¬
 |ğ
uxB™sWa™edFÜ
;

597 
	`mtCOVERAGE_TEST_MARKER
();

605 Ğè
	`xTaskRemoveFromUnÜd”edEv’tLi¡
Ğ
pxLi¡I‹m
, 
pxEv’tB™s
->
uxEv’tB™s
 | 
ev’tUNBLOCKED_DUE_TO_BIT_SET
 );

611 
pxLi¡I‹m
 = 
pxNext
;

616 
pxEv’tB™s
->
uxEv’tB™s
 &ğ~
uxB™sToCË¬
;

618 Ğè
	`xTaskResumeAÎ
();

620  
pxEv’tB™s
->
uxEv’tB™s
;

621 
	}
}

624 
	$vEv’tGroupD–‘e
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
 )

626 
Ev’tGroup_t
 *
pxEv’tB™s
 = ( Ev’tGroup_ˆ* ) 
xEv’tGroup
;

627 cÚ¡ 
Li¡_t
 *
pxTasksWa™šgFÜB™s
 = &Ğ
pxEv’tB™s
->
xTasksWa™šgFÜB™s
 );

629 
	`vTaskSu¥’dAÎ
();

631 
	`ŒaûEVENT_GROUP_DELETE
Ğ
xEv’tGroup
 );

633  
	`li¡CURRENT_LIST_LENGTH
Ğ
pxTasksWa™šgFÜB™s
 ) > ( 
UBa£Ty³_t
 ) 0 )

637 
	`cÚfigASSERT
Ğ
pxTasksWa™šgFÜB™s
->
xLi¡End
.
pxNext
 !ğĞ
Li¡I‹m_t
 * ) &(…xTasksWaitingForBits->xListEnd ) );

638 Ğè
	`xTaskRemoveFromUnÜd”edEv’tLi¡
Ğ
pxTasksWa™šgFÜB™s
->
xLi¡End
.
pxNext
, 
ev’tUNBLOCKED_DUE_TO_BIT_SET
 );

641 #ifĞĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 0 ) )

645 
	`vPÜtF»e
Ğ
pxEv’tB™s
 );

647 #–ifĞĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 ) )

651 ifĞ
pxEv’tB™s
->
ucStiÿÎyAÎoÿ‹d
 =ğĞ
ušt8_t
 ) 
pdFALSE
 )

653 
	`vPÜtF»e
Ğ
pxEv’tB™s
 );

657 
	`mtCOVERAGE_TEST_MARKER
();

662 Ğè
	`xTaskResumeAÎ
();

663 
	}
}

668 
	$vEv’tGroupS‘B™sC®lback
Ğ*
pvEv’tGroup
, cÚ¡ 
ušt32_t
 
ulB™sToS‘
 )

670 Ğè
	`xEv’tGroupS‘B™s
Ğ
pvEv’tGroup
, ( 
Ev’tB™s_t
 ) 
ulB™sToS‘
 );

671 
	}
}

676 
	$vEv’tGroupCË¬B™sC®lback
Ğ*
pvEv’tGroup
, cÚ¡ 
ušt32_t
 
ulB™sToCË¬
 )

678 Ğè
	`xEv’tGroupCË¬B™s
Ğ
pvEv’tGroup
, ( 
Ev’tB™s_t
 ) 
ulB™sToCË¬
 );

679 
	}
}

682 
Ba£Ty³_t
 
	$´vTe¡Wa™CÚd™iÚ
ĞcÚ¡ 
Ev’tB™s_t
 
uxCu¼’tEv’tB™s
, cÚ¡ Ev’tB™s_ˆ
uxB™sToWa™FÜ
, cÚ¡ 
Ba£Ty³_t
 
xWa™FÜAÎB™s
 )

684 
Ba£Ty³_t
 
xWa™CÚd™iÚM‘
 = 
pdFALSE
;

686 ifĞ
xWa™FÜAÎB™s
 =ğ
pdFALSE
 )

690 ifĞĞ
uxCu¼’tEv’tB™s
 & 
uxB™sToWa™FÜ
 ) !ğĞ
Ev’tB™s_t
 ) 0 )

692 
xWa™CÚd™iÚM‘
 = 
pdTRUE
;

696 
	`mtCOVERAGE_TEST_MARKER
();

703 ifĞĞ
uxCu¼’tEv’tB™s
 & 
uxB™sToWa™FÜ
 ) == uxBitsToWaitFor )

705 
xWa™CÚd™iÚM‘
 = 
pdTRUE
;

709 
	`mtCOVERAGE_TEST_MARKER
();

713  
xWa™CÚd™iÚM‘
;

714 
	}
}

717 #iàĞĞ
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) && ( 
INCLUDE_xTim”P’dFunùiÚC®l
 =ğ1 ) && ( 
cÚfigUSE_TIMERS
 == 1 ) )

719 
Ba£Ty³_t
 
	$xEv’tGroupS‘B™sFromISR
Ğ
Ev’tGroupHªdË_t
 
xEv’tGroup
, cÚ¡ 
Ev’tB™s_t
 
uxB™sToS‘
, 
Ba£Ty³_t
 *
pxHigh”PriÜ™yTaskWok’
 )

721 
Ba£Ty³_t
 
xR‘uº
;

723 
	`ŒaûEVENT_GROUP_SET_BITS_FROM_ISR
Ğ
xEv’tGroup
, 
uxB™sToS‘
 );

724 
xR‘uº
 = 
	`xTim”P’dFunùiÚC®lFromISR
Ğ
vEv’tGroupS‘B™sC®lback
, ( * ) 
xEv’tGroup
, ( 
ušt32_t
 ) 
uxB™sToS‘
, 
pxHigh”PriÜ™yTaskWok’
 );

726  
xR‘uº
;

727 
	}
}

732 #ià(
cÚfigUSE_TRACE_FACILITY
 == 1)

734 
UBa£Ty³_t
 
	$uxEv’tGroupG‘Numb”
Ğ* 
xEv’tGroup
 )

736 
UBa£Ty³_t
 
xR‘uº
;

737 
Ev’tGroup_t
 *
pxEv’tB™s
 = ( Ev’tGroup_ˆ* ) 
xEv’tGroup
;

739 ifĞ
xEv’tGroup
 =ğ
NULL
 )

741 
xR‘uº
 = 0;

745 
xR‘uº
 = 
pxEv’tB™s
->
uxEv’tGroupNumb”
;

748  
xR‘uº
;

749 
	}
}

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\list.c

71 
	~<¡dlib.h
>

72 
	~"F»eRTOS.h
"

73 
	~"li¡.h
"

79 
	$vLi¡In™Ÿli£
Ğ
Li¡_t
 * cÚ¡ 
pxLi¡
 )

84 
pxLi¡
->
pxIndex
 = ( 
Li¡I‹m_t
 * ) &ĞpxLi¡->
xLi¡End
 );

88 
pxLi¡
->
xLi¡End
.
xI‹mV®ue
 = 
pÜtMAX_DELAY
;

92 
pxLi¡
->
xLi¡End
.
pxNext
 = ( 
Li¡I‹m_t
 * ) &(…xList->xListEnd );

93 
pxLi¡
->
xLi¡End
.
pxP»vious
 = ( 
Li¡I‹m_t
 * ) &(…xList->xListEnd );

95 
pxLi¡
->
uxNumb”OfI‹ms
 = ( 
UBa£Ty³_t
 ) 0U;

99 
	`li¡SET_LIST_INTEGRITY_CHECK_1_VALUE
Ğ
pxLi¡
 );

100 
	`li¡SET_LIST_INTEGRITY_CHECK_2_VALUE
Ğ
pxLi¡
 );

101 
	}
}

104 
	$vLi¡In™Ÿli£I‹m
Ğ
Li¡I‹m_t
 * cÚ¡ 
pxI‹m
 )

107 
pxI‹m
->
pvCÚš”
 = 
NULL
;

111 
	`li¡SET_FIRST_LIST_ITEM_INTEGRITY_CHECK_VALUE
Ğ
pxI‹m
 );

112 
	`li¡SET_SECOND_LIST_ITEM_INTEGRITY_CHECK_VALUE
Ğ
pxI‹m
 );

113 
	}
}

116 
	$vLi¡In£¹End
Ğ
Li¡_t
 * cÚ¡ 
pxLi¡
, 
Li¡I‹m_t
 * cÚ¡ 
pxNewLi¡I‹m
 )

118 
Li¡I‹m_t
 * cÚ¡ 
pxIndex
 = 
pxLi¡
->pxIndex;

123 
	`li¡TEST_LIST_INTEGRITY
Ğ
pxLi¡
 );

124 
	`li¡TEST_LIST_ITEM_INTEGRITY
Ğ
pxNewLi¡I‹m
 );

129 
pxNewLi¡I‹m
->
pxNext
 = 
pxIndex
;

130 
pxNewLi¡I‹m
->
pxP»vious
 = 
pxIndex
->pxPrevious;

133 
	`mtCOVERAGE_TEST_DELAY
();

135 
pxIndex
->
pxP»vious
->
pxNext
 = 
pxNewLi¡I‹m
;

136 
pxIndex
->
pxP»vious
 = 
pxNewLi¡I‹m
;

139 
pxNewLi¡I‹m
->
pvCÚš”
 = ( * ) 
pxLi¡
;

141 Ğ
pxLi¡
->
uxNumb”OfI‹ms
 )++;

142 
	}
}

145 
	$vLi¡In£¹
Ğ
Li¡_t
 * cÚ¡ 
pxLi¡
, 
Li¡I‹m_t
 * cÚ¡ 
pxNewLi¡I‹m
 )

147 
Li¡I‹m_t
 *
pxI‹¿tÜ
;

148 cÚ¡ 
TickTy³_t
 
xV®ueOfIn£¹iÚ
 = 
pxNewLi¡I‹m
->
xI‹mV®ue
;

153 
	`li¡TEST_LIST_INTEGRITY
Ğ
pxLi¡
 );

154 
	`li¡TEST_LIST_ITEM_INTEGRITY
Ğ
pxNewLi¡I‹m
 );

164 ifĞ
xV®ueOfIn£¹iÚ
 =ğ
pÜtMAX_DELAY
 )

166 
pxI‹¿tÜ
 = 
pxLi¡
->
xLi¡End
.
pxP»vious
;

192  
pxI‹¿tÜ
 = ( 
Li¡I‹m_t
 * ) &Ğ
pxLi¡
->
xLi¡End
 );…xI‹¿tÜ->
pxNext
->
xI‹mV®ue
 <ğ
xV®ueOfIn£¹iÚ
;…xIterator =…xIterator->pxNext )

199 
pxNewLi¡I‹m
->
pxNext
 = 
pxI‹¿tÜ
->pxNext;

200 
pxNewLi¡I‹m
->
pxNext
->
pxP»vious
 =…xNewListItem;

201 
pxNewLi¡I‹m
->
pxP»vious
 = 
pxI‹¿tÜ
;

202 
pxI‹¿tÜ
->
pxNext
 = 
pxNewLi¡I‹m
;

206 
pxNewLi¡I‹m
->
pvCÚš”
 = ( * ) 
pxLi¡
;

208 Ğ
pxLi¡
->
uxNumb”OfI‹ms
 )++;

209 
	}
}

212 
UBa£Ty³_t
 
	$uxLi¡Remove
Ğ
Li¡I‹m_t
 * cÚ¡ 
pxI‹mToRemove
 )

216 
Li¡_t
 * cÚ¡ 
pxLi¡
 = ( Li¡_ˆ* ) 
pxI‹mToRemove
->
pvCÚš”
;

218 
pxI‹mToRemove
->
pxNext
->
pxP»vious
 =…xItemToRemove->pxPrevious;

219 
pxI‹mToRemove
->
pxP»vious
->
pxNext
 =…xItemToRemove->pxNext;

222 
	`mtCOVERAGE_TEST_DELAY
();

225 ifĞ
pxLi¡
->
pxIndex
 =ğ
pxI‹mToRemove
 )

227 
pxLi¡
->
pxIndex
 = 
pxI‹mToRemove
->
pxP»vious
;

231 
	`mtCOVERAGE_TEST_MARKER
();

234 
pxI‹mToRemove
->
pvCÚš”
 = 
NULL
;

235 Ğ
pxLi¡
->
uxNumb”OfI‹ms
 )--;

237  
pxLi¡
->
uxNumb”OfI‹ms
;

238 
	}
}

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\portable\GCC\ARM_CM4F\port.c

75 
	~"F»eRTOS.h
"

76 
	~"sk.h
"

78 #iâdeà
__VFP_FP__


79 #”rÜ 
This
 
pÜt
 
ÿn
 
Úly
 
be
 
u£d
 
wh’
 
the
 
´ojeù
 
İtiÚs
 
¬e
 
cÚfigu»d
 
to
 
’abË
 
h¬dw¬e
 
æßtšg
 
pošt
 
suµÜt
.

82 #iâdeà
cÚfigSYSTICK_CLOCK_HZ


83 
	#cÚfigSYSTICK_CLOCK_HZ
 
cÚfigCPU_CLOCK_HZ


	)

85 
	#pÜtNVIC_SYSTICK_CLK_BIT
 ( 1UL << 2UL )

	)

89 
	#pÜtNVIC_SYSTICK_CLK_BIT
 ( 0 )

	)

93 
	#pÜtNVIC_SYSTICK_CTRL_REG
 ( * ( ( vŞ©
ušt32_t
 * ) 0xe000e010 ) )

	)

94 
	#pÜtNVIC_SYSTICK_LOAD_REG
 ( * ( ( vŞ©
ušt32_t
 * ) 0xe000e014 ) )

	)

95 
	#pÜtNVIC_SYSTICK_CURRENT_VALUE_REG
 ( * ( ( vŞ©
ušt32_t
 * ) 0xe000e018 ) )

	)

96 
	#pÜtNVIC_SYSPRI2_REG
 ( * ( ( vŞ©
ušt32_t
 * ) 0xe000ed20 ) )

	)

98 
	#pÜtNVIC_SYSTICK_INT_BIT
 ( 1UL << 1UL )

	)

99 
	#pÜtNVIC_SYSTICK_ENABLE_BIT
 ( 1UL << 0UL )

	)

100 
	#pÜtNVIC_SYSTICK_COUNT_FLAG_BIT
 ( 1UL << 16UL )

	)

101 
	#pÜtNVIC_PENDSVCLEAR_BIT
 ( 1UL << 27UL )

	)

102 
	#pÜtNVIC_PEND_SYSTICK_CLEAR_BIT
 ( 1UL << 25UL )

	)

106 
	#pÜtCPUID
 ( * ( ( vŞ©
ušt32_t
 * ) 0xE000ed00 ) )

	)

107 
	#pÜtCORTEX_M7_r0p1_ID
 ( 0x410FC271UL )

	)

108 
	#pÜtCORTEX_M7_r0p0_ID
 ( 0x410FC270UL )

	)

110 
	#pÜtNVIC_PENDSV_PRI
 ( ( ( 
ušt32_t
 ) 
cÚfigKERNEL_INTERRUPT_PRIORITY
 ) << 16UL )

	)

111 
	#pÜtNVIC_SYSTICK_PRI
 ( ( ( 
ušt32_t
 ) 
cÚfigKERNEL_INTERRUPT_PRIORITY
 ) << 24UL )

	)

114 
	#pÜtFIRST_USER_INTERRUPT_NUMBER
 ( 16 )

	)

115 
	#pÜtNVIC_IP_REGISTERS_OFFSET_16
 ( 0xE000E3F0 )

	)

116 
	#pÜtAIRCR_REG
 ( * ( ( vŞ©
ušt32_t
 * ) 0xE000ED0C ) )

	)

117 
	#pÜtMAX_8_BIT_VALUE
 ( ( 
ušt8_t
 ) 0xfà)

	)

118 
	#pÜtTOP_BIT_OF_BYTE
 ( ( 
ušt8_t
 ) 0x80 )

	)

119 
	#pÜtMAX_PRIGROUP_BITS
 ( ( 
ušt8_t
 ) 7 )

	)

120 
	#pÜtPRIORITY_GROUP_MASK
 ( 0x07UL << 8UL )

	)

121 
	#pÜtPRIGROUP_SHIFT
 ( 8UL )

	)

124 
	#pÜtVECTACTIVE_MASK
 ( 0xFFUL )

	)

127 
	#pÜtFPCCR
 ( ( vŞ©
ušt32_t
 * ) 0xe000ef34 )

	)

128 
	#pÜtASPEN_AND_LSPEN_BITS
 ( 0x3UL << 30UL )

	)

131 
	#pÜtINITIAL_XPSR
 ( 0x01000000 )

	)

132 
	#pÜtINITIAL_EXEC_RETURN
 ( 0xfffffffd )

	)

135 
	#pÜtMAX_24_BIT_NUMBER
 ( 0xffffffUL )

	)

139 
	#pÜtSTART_ADDRESS_MASK
 ( ( 
SckTy³_t
 ) 0xffffffãUL )

	)

144 
	#pÜtMISSED_COUNTS_FACTOR
 ( 45UL )

	)

149 #ifdeà
cÚfigTASK_RETURN_ADDRESS


150 
	#pÜtTASK_RETURN_ADDRESS
 
cÚfigTASK_RETURN_ADDRESS


	)

152 
	#pÜtTASK_RETURN_ADDRESS
 
´vTaskEx™E¼Ü


	)

157 
UBa£Ty³_t
 
	guxCr™iÿlNe¡šg
 = 0xaaaaaaaa;

164 
vPÜtS‘upTim”IÁ”ru±
( );

169 
	$xPÜtP’dSVHªdËr
Ğè
	`__©Œibu‹__
 (Ğ
Çked
 ));

170 
	`xPÜtSysTickHªdËr
( );

171 
	$vPÜtSVCHªdËr
Ğè
	`__©Œibu‹__
 (Ğ
Çked
 ));

176 
	$´vPÜtS¹Fœ¡Task
Ğè
	`__©Œibu‹__
 (Ğ
Çked
 ));

181 
	$vPÜtEÇbËVFP
Ğè
	`__©Œibu‹__
 (Ğ
Çked
 ));

186 
	`´vTaskEx™E¼Ü
( );

193 #ià
cÚfigUSE_TICKLESS_IDLE
 == 1

194 
ušt32_t
 
ulTim”CouÁsFÜOÃTick
 = 0;

201 #ià
cÚfigUSE_TICKLESS_IDLE
 == 1

202 
ušt32_t
 
xMaximumPossibËSuµ»s£dTicks
 = 0;

209 #ià
cÚfigUSE_TICKLESS_IDLE
 == 1

210 
ušt32_t
 
ulStİ³dTim”Com³n§tiÚ
 = 0;

218 #iàĞ
cÚfigASSERT_DEFINED
 == 1 )

219 
ušt8_t
 
ucMaxSysC®lPriÜ™y
 = 0;

220 
ušt32_t
 
ulMaxPRIGROUPV®ue
 = 0;

221 cÚ¡ vŞ©
ušt8_t
 * cÚ¡ 
pcIÁ”ru±PriÜ™yRegi¡”s
 = ( cÚ¡ vŞ©ušt8_ˆ* cÚ¡ ) 
pÜtNVIC_IP_REGISTERS_OFFSET_16
;

229 
SckTy³_t
 *
	$pxPÜtIn™Ÿli£Sck
Ğ
SckTy³_t
 *
pxTİOfSck
, 
TaskFunùiÚ_t
 
pxCode
, *
pvP¬am‘”s
 )

236 
pxTİOfSck
--;

238 *
pxTİOfSck
 = 
pÜtINITIAL_XPSR
;

239 
pxTİOfSck
--;

240 *
pxTİOfSck
 = ( ( 
SckTy³_t
 ) 
pxCode
 ) & 
pÜtSTART_ADDRESS_MASK
;

241 
pxTİOfSck
--;

242 *
pxTİOfSck
 = ( 
SckTy³_t
 ) 
pÜtTASK_RETURN_ADDRESS
;

245 
pxTİOfSck
 -= 5;

246 *
pxTİOfSck
 = ( 
SckTy³_t
 ) 
pvP¬am‘”s
;

250 
pxTİOfSck
--;

251 *
pxTİOfSck
 = 
pÜtINITIAL_EXEC_RETURN
;

253 
pxTİOfSck
 -= 8;

255  
pxTİOfSck
;

256 
	}
}

259 
	$´vTaskEx™E¼Ü
( )

267 
	`cÚfigASSERT
Ğ
uxCr™iÿlNe¡šg
 == ~0UL );

268 
	`pÜtDISABLE_INTERRUPTS
();

270 
	}
}

273 
	$vPÜtSVCHªdËr
( )

275 
__asm
 volatile (

289 
	}
}

292 
	$´vPÜtS¹Fœ¡Task
( )

294 
__asm
 volatile(

306 
	}
}

312 
Ba£Ty³_t
 
	$xPÜtS¹ScheduËr
( )

316 
	`cÚfigASSERT
Ğ
cÚfigMAX_SYSCALL_INTERRUPT_PRIORITY
 );

321 
	`cÚfigASSERT
Ğ
pÜtCPUID
 !ğ
pÜtCORTEX_M7_r0p1_ID
 );

322 
	`cÚfigASSERT
Ğ
pÜtCPUID
 !ğ
pÜtCORTEX_M7_r0p0_ID
 );

324 #ifĞ
cÚfigASSERT_DEFINED
 == 1 )

326 vŞ©
ušt32_t
 
ulOrigš®PriÜ™y
;

327 vŞ©
ušt8_t
 * cÚ¡ 
pucFœ¡U£rPriÜ™yRegi¡”
 = ( vŞ©ušt8_ˆ* cÚ¡ ) ( 
pÜtNVIC_IP_REGISTERS_OFFSET_16
 + 
pÜtFIRST_USER_INTERRUPT_NUMBER
 );

328 vŞ©
ušt8_t
 
ucMaxPriÜ™yV®ue
;

336 
ulOrigš®PriÜ™y
 = *
pucFœ¡U£rPriÜ™yRegi¡”
;

340 *
pucFœ¡U£rPriÜ™yRegi¡”
 = 
pÜtMAX_8_BIT_VALUE
;

343 
ucMaxPriÜ™yV®ue
 = *
pucFœ¡U£rPriÜ™yRegi¡”
;

346 
ucMaxSysC®lPriÜ™y
 = 
cÚfigMAX_SYSCALL_INTERRUPT_PRIORITY
 & 
ucMaxPriÜ™yV®ue
;

350 
ulMaxPRIGROUPV®ue
 = 
pÜtMAX_PRIGROUP_BITS
;

351  ( 
ucMaxPriÜ™yV®ue
 & 
pÜtTOP_BIT_OF_BYTE
 ) ==…ortTOP_BIT_OF_BYTE )

353 
ulMaxPRIGROUPV®ue
--;

354 
ucMaxPriÜ™yV®ue
 <<ğĞ
ušt8_t
 ) 0x01;

359 
ulMaxPRIGROUPV®ue
 <<ğ
pÜtPRIGROUP_SHIFT
;

360 
ulMaxPRIGROUPV®ue
 &ğ
pÜtPRIORITY_GROUP_MASK
;

364 *
pucFœ¡U£rPriÜ™yRegi¡”
 = 
ulOrigš®PriÜ™y
;

369 
pÜtNVIC_SYSPRI2_REG
 |ğ
pÜtNVIC_PENDSV_PRI
;

370 
pÜtNVIC_SYSPRI2_REG
 |ğ
pÜtNVIC_SYSTICK_PRI
;

374 
	`vPÜtS‘upTim”IÁ”ru±
();

377 
uxCr™iÿlNe¡šg
 = 0;

380 
	`vPÜtEÇbËVFP
();

383 *Ğ
pÜtFPCCR
 ) |ğ
pÜtASPEN_AND_LSPEN_BITS
;

386 
	`´vPÜtS¹Fœ¡Task
();

392 
	`´vTaskEx™E¼Ü
();

396 
	}
}

399 
	$vPÜtEndScheduËr
( )

403 
	`cÚfigASSERT
Ğ
uxCr™iÿlNe¡šg
 == 1000UL );

404 
	}
}

407 
	$vPÜtEÁ”Cr™iÿl
( )

409 
	`pÜtDISABLE_INTERRUPTS
();

410 
uxCr™iÿlNe¡šg
++;

417 ifĞ
uxCr™iÿlNe¡šg
 == 1 )

419 
	`cÚfigASSERT
ĞĞ
pÜtNVIC_INT_CTRL_REG
 & 
pÜtVECTACTIVE_MASK
 ) == 0 );

421 
	}
}

424 
	$vPÜtEx™Cr™iÿl
( )

426 
	`cÚfigASSERT
Ğ
uxCr™iÿlNe¡šg
 );

427 
uxCr™iÿlNe¡šg
--;

428 ifĞ
uxCr™iÿlNe¡šg
 == 0 )

430 
	`pÜtENABLE_INTERRUPTS
();

432 
	}
}

435 
	$xPÜtP’dSVHªdËr
( )

439 
__asm
 volatile

477 #ifdeà
WORKAROUND_PMU_CM001


478 #ià
WORKAROUND_PMU_CM001
 == 1

488 ::"i"(
cÚfigMAX_SYSCALL_INTERRUPT_PRIORITY
)

490 
	}
}

493 
	$xPÜtSysTickHªdËr
( )

499 
	`pÜtDISABLE_INTERRUPTS
();

502 ifĞ
	`xTaskInüem’tTick
(è!ğ
pdFALSE
 )

506 
pÜtNVIC_INT_CTRL_REG
 = 
pÜtNVIC_PENDSVSET_BIT
;

509 
	`pÜtENABLE_INTERRUPTS
();

510 
	}
}

513 #ià
cÚfigUSE_TICKLESS_IDLE
 == 1

515 
__©Œibu‹__
((
w—k
)è
	$vPÜtSuµ»ssTicksAndSË•
Ğ
TickTy³_t
 
xEx³ùedIdËTime
 )

517 
ušt32_t
 
ulR–ßdV®ue
, 
ulCom¶‘eTickP”iods
, 
ulCom¶‘edSysTickDeüem’ts
, 
ulSysTickCTRL
;

518 
TickTy³_t
 
xModifŸbËIdËTime
;

521 ifĞ
xEx³ùedIdËTime
 > 
xMaximumPossibËSuµ»s£dTicks
 )

523 
xEx³ùedIdËTime
 = 
xMaximumPossibËSuµ»s£dTicks
;

530 
pÜtNVIC_SYSTICK_CTRL_REG
 &ğ~
pÜtNVIC_SYSTICK_ENABLE_BIT
;

535 
ulR–ßdV®ue
 = 
pÜtNVIC_SYSTICK_CURRENT_VALUE_REG
 + ( 
ulTim”CouÁsFÜOÃTick
 * ( 
xEx³ùedIdËTime
 - 1UL ) );

536 ifĞ
ulR–ßdV®ue
 > 
ulStİ³dTim”Com³n§tiÚ
 )

538 
ulR–ßdV®ue
 -ğ
ulStİ³dTim”Com³n§tiÚ
;

543 
__asm
 volatile( "cpsid i" );

544 
__asm
 volatile( "dsb" );

545 
__asm
 volatile( "isb" );

549 ifĞ
	`eTaskCÚfœmSË•ModeStus
(è=ğ
eAbÜtSË•
 )

553 
pÜtNVIC_SYSTICK_LOAD_REG
 = 
pÜtNVIC_SYSTICK_CURRENT_VALUE_REG
;

556 
pÜtNVIC_SYSTICK_CTRL_REG
 |ğ
pÜtNVIC_SYSTICK_ENABLE_BIT
;

560 
pÜtNVIC_SYSTICK_LOAD_REG
 = 
ulTim”CouÁsFÜOÃTick
 - 1UL;

564 
__asm
 volatile( "cpsie i" );

569 
pÜtNVIC_SYSTICK_LOAD_REG
 = 
ulR–ßdV®ue
;

573 
pÜtNVIC_SYSTICK_CURRENT_VALUE_REG
 = 0UL;

576 
pÜtNVIC_SYSTICK_CTRL_REG
 |ğ
pÜtNVIC_SYSTICK_ENABLE_BIT
;

583 
xModifŸbËIdËTime
 = 
xEx³ùedIdËTime
;

584 
	`cÚfigPRE_SLEEP_PROCESSING
Ğ
xModifŸbËIdËTime
 );

585 ifĞ
xModifŸbËIdËTime
 > 0 )

587 
__asm
 volatile( "dsb" );

588 
__asm
 volatile( "wfi" );

589 
__asm
 volatile( "isb" );

591 
	`cÚfigPOST_SLEEP_PROCESSING
Ğ
xEx³ùedIdËTime
 );

597 
ulSysTickCTRL
 = 
pÜtNVIC_SYSTICK_CTRL_REG
;

598 
pÜtNVIC_SYSTICK_CTRL_REG
 = ( 
ulSysTickCTRL
 & ~
pÜtNVIC_SYSTICK_ENABLE_BIT
 );

602 
__asm
 volatile( "cpsie i" );

604 ifĞĞ
ulSysTickCTRL
 & 
pÜtNVIC_SYSTICK_COUNT_FLAG_BIT
 ) != 0 )

606 
ušt32_t
 
ulC®cuÏ‹dLßdV®ue
;

612 
ulC®cuÏ‹dLßdV®ue
 = ( 
ulTim”CouÁsFÜOÃTick
 - 1UL ) - ( 
ulR–ßdV®ue
 - 
pÜtNVIC_SYSTICK_CURRENT_VALUE_REG
 );

617 ifĞĞ
ulC®cuÏ‹dLßdV®ue
 < 
ulStİ³dTim”Com³n§tiÚ
 ) || ( ulC®cuÏ‹dLßdV®u> 
ulTim”CouÁsFÜOÃTick
 ) )

619 
ulC®cuÏ‹dLßdV®ue
 = ( 
ulTim”CouÁsFÜOÃTick
 - 1UL );

622 
pÜtNVIC_SYSTICK_LOAD_REG
 = 
ulC®cuÏ‹dLßdV®ue
;

629 
ulCom¶‘eTickP”iods
 = 
xEx³ùedIdËTime
 - 1UL;

637 
ulCom¶‘edSysTickDeüem’ts
 = ( 
xEx³ùedIdËTime
 * 
ulTim”CouÁsFÜOÃTick
 ) - 
pÜtNVIC_SYSTICK_CURRENT_VALUE_REG
;

641 
ulCom¶‘eTickP”iods
 = 
ulCom¶‘edSysTickDeüem’ts
 / 
ulTim”CouÁsFÜOÃTick
;

645 
pÜtNVIC_SYSTICK_LOAD_REG
 = ( ( 
ulCom¶‘eTickP”iods
 + 1UL ) * 
ulTim”CouÁsFÜOÃTick
 ) - 
ulCom¶‘edSysTickDeüem’ts
;

653 
pÜtNVIC_SYSTICK_CURRENT_VALUE_REG
 = 0UL;

654 
	`pÜtENTER_CRITICAL
();

656 
pÜtNVIC_SYSTICK_CTRL_REG
 |ğ
pÜtNVIC_SYSTICK_ENABLE_BIT
;

657 
	`vTaskS‹pTick
Ğ
ulCom¶‘eTickP”iods
 );

658 
pÜtNVIC_SYSTICK_LOAD_REG
 = 
ulTim”CouÁsFÜOÃTick
 - 1UL;

660 
	`pÜtEXIT_CRITICAL
();

662 
	}
}

671 
__©Œibu‹__
(Ğ
w—k
 )è
	$vPÜtS‘upTim”IÁ”ru±
( )

674 #ià
cÚfigUSE_TICKLESS_IDLE
 == 1

676 
ulTim”CouÁsFÜOÃTick
 = ( 
cÚfigSYSTICK_CLOCK_HZ
 / 
cÚfigTICK_RATE_HZ
 );

677 
xMaximumPossibËSuµ»s£dTicks
 = 
pÜtMAX_24_BIT_NUMBER
 / 
ulTim”CouÁsFÜOÃTick
;

678 
ulStİ³dTim”Com³n§tiÚ
 = 
pÜtMISSED_COUNTS_FACTOR
 / ( 
cÚfigCPU_CLOCK_HZ
 / 
cÚfigSYSTICK_CLOCK_HZ
 );

683 
pÜtNVIC_SYSTICK_LOAD_REG
 = ( 
cÚfigSYSTICK_CLOCK_HZ
 / 
cÚfigTICK_RATE_HZ
 ) - 1UL;

684 
pÜtNVIC_SYSTICK_CTRL_REG
 = ( 
pÜtNVIC_SYSTICK_CLK_BIT
 | 
pÜtNVIC_SYSTICK_INT_BIT
 | 
pÜtNVIC_SYSTICK_ENABLE_BIT
 );

685 
	}
}

689 
	$vPÜtEÇbËVFP
( )

691 
__asm
 volatile

700 
	}
}

703 #ifĞ
cÚfigASSERT_DEFINED
 == 1 )

705 
	$vPÜtV®id©eIÁ”ru±PriÜ™y
( )

707 
ušt32_t
 
ulCu¼’tIÁ”ru±
;

708 
ušt8_t
 
ucCu¼’tPriÜ™y
;

711 
__asm
 vŞ©eĞ"mr %0, ip¤" : "ô"Ğ
ulCu¼’tIÁ”ru±
 ) );

714 ifĞ
ulCu¼’tIÁ”ru±
 >ğ
pÜtFIRST_USER_INTERRUPT_NUMBER
 )

717 
ucCu¼’tPriÜ™y
 = 
pcIÁ”ru±PriÜ™yRegi¡”s
[ 
ulCu¼’tIÁ”ru±
 ];

742 
	`cÚfigASSERT
Ğ
ucCu¼’tPriÜ™y
 >ğ
ucMaxSysC®lPriÜ™y
 );

758 
	`cÚfigASSERT
ĞĞ
pÜtAIRCR_REG
 & 
pÜtPRIORITY_GROUP_MASK
 ) <ğ
ulMaxPRIGROUPV®ue
 );

759 
	}
}

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\portable\GCC\ARM_CM4F\portmacro.h

71 #iâdeà
PORTMACRO_H


72 
	#PORTMACRO_H


	)

74 #ifdeà
__ılu¥lus


89 
	#pÜtCHAR
 

	)

90 
	#pÜtFLOAT
 

	)

91 
	#pÜtDOUBLE
 

	)

92 
	#pÜtLONG
 

	)

93 
	#pÜtSHORT
 

	)

94 
	#pÜtSTACK_TYPE
 
ušt32_t


	)

95 
	#pÜtBASE_TYPE
 

	)

97 
pÜtSTACK_TYPE
 
	tSckTy³_t
;

98 
	tBa£Ty³_t
;

99 
	tUBa£Ty³_t
;

101 #ifĞ
cÚfigUSE_16_BIT_TICKS
 == 1 )

102 
ušt16_t
 
	tTickTy³_t
;

103 
	#pÜtMAX_DELAY
 ( 
TickTy³_t
 ) 0xffff

	)

105 
ušt32_t
 
	tTickTy³_t
;

106 
	#pÜtMAX_DELAY
 ( 
TickTy³_t
 ) 0xffffffffUL

	)

110 
	#pÜtTICK_TYPE_IS_ATOMIC
 1

	)

115 
	#pÜtSTACK_GROWTH
 ( -1 )

	)

116 
	#pÜtTICK_PERIOD_MS
 ( ( 
TickTy³_t
 ) 1000 / 
cÚfigTICK_RATE_HZ
 )

	)

117 
	#pÜtBYTE_ALIGNMENT
 8

	)

121 
	#pÜtYIELD
() \

124 
pÜtNVIC_INT_CTRL_REG
 = 
pÜtNVIC_PENDSVSET_BIT
; \

128 
__asm
 volatile( "dsb" ); \

129 
__asm
 volatile( "isb" ); \

130 }

	)

132 
	#pÜtNVIC_INT_CTRL_REG
 ( * ( ( vŞ©
ušt32_t
 * ) 0xe000ed04 ) )

	)

133 
	#pÜtNVIC_PENDSVSET_BIT
 ( 1UL << 28UL )

	)

134 
	#pÜtEND_SWITCHING_ISR
Ğ
xSw™chRequœed
 ) ifĞxSw™chRequœed !ğ
pdFALSE
 ) 
	`pÜtYIELD
()

	)

135 
	#pÜtYIELD_FROM_ISR
Ğ
x
 ) 
	`pÜtEND_SWITCHING_ISR
Ğx )

	)

139 
vPÜtEÁ”Cr™iÿl
( );

140 
vPÜtEx™Cr™iÿl
( );

141 
	#pÜtSET_INTERRUPT_MASK_FROM_ISR
(è
	`ulPÜtRai£BASEPRI
()

	)

142 
	#pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
(
x
è
	`vPÜtS‘BASEPRI
(x)

	)

143 
	#pÜtDISABLE_INTERRUPTS
(è
	`vPÜtRai£BASEPRI
()

	)

144 
	#pÜtENABLE_INTERRUPTS
(è
	`vPÜtS‘BASEPRI
(0)

	)

145 
	#pÜtENTER_CRITICAL
(è
	`vPÜtEÁ”Cr™iÿl
()

	)

146 
	#pÜtEXIT_CRITICAL
(è
	`vPÜtEx™Cr™iÿl
()

	)

153 
	#pÜtTASK_FUNCTION_PROTO
Ğ
vFunùiÚ
, 
pvP¬am‘”s
 ) 
	`vFunùiÚ
Ğ*pvP¬am‘” )

	)

154 
	#pÜtTASK_FUNCTION
Ğ
vFunùiÚ
, 
pvP¬am‘”s
 ) 
	`vFunùiÚ
Ğ*pvP¬am‘” )

	)

158 #iâdeà
pÜtSUPPRESS_TICKS_AND_SLEEP


159 
vPÜtSuµ»ssTicksAndSË•
Ğ
TickTy³_t
 
xEx³ùedIdËTime
 );

160 
	#pÜtSUPPRESS_TICKS_AND_SLEEP
Ğ
xEx³ùedIdËTime
 ) 
	`vPÜtSuµ»ssTicksAndSË•
ĞxEx³ùedIdËTim)

	)

165 #iâdeà
cÚfigUSE_PORT_OPTIMISED_TASK_SELECTION


166 
	#cÚfigUSE_PORT_OPTIMISED_TASK_SELECTION
 1

	)

169 #ià
cÚfigUSE_PORT_OPTIMISED_TASK_SELECTION
 == 1

172 
__©Œibu‹__
ĞĞ
®ways_šlše
 ) ) 
šlše
 
ušt8_t
 
ucPÜtCouÁL—dšgZ”os
Ğ
ušt32_t
 
ulB™m­
 )

174 
ušt8_t
 
	gucR‘uº
;

176 
__asm
 vŞ©Ğ"şz %0, %1" : "ô" ( 
ucR‘uº
 ) : "r" ( 
ulB™m­
 ) );

177  
	gucR‘uº
;

181 #ifĞ
cÚfigMAX_PRIORITIES
 > 32 )

182 #”rÜ 
cÚfigUSE_PORT_OPTIMISED_TASK_SELECTION
 
ÿn
 
Úly
 
be
 
£t
 
to
 1 
wh’
 
cÚfigMAX_PRIORITIES
 
is
 
Ëss
 
thª
 
Ü
 
equ®
Ø32. 
It
 i 
v”y
 
¿»
 
th©
 
a
 
sy¡em
 
»quœes
 
mÜe
hª 10Ø15 
difã»nû
 
´iÜ™›s
 
as
 
sks
h© 
sh¬e
‡ 
´iÜ™y
 
wl
 
time
 
¦iû
.

186 
	#pÜtRECORD_READY_PRIORITY
Ğ
uxPriÜ™y
, 
uxR—dyPriÜ™›s
 ) ( uxR—dyPriÜ™› è|ğĞ1UL << ( uxPriÜ™y ) )

	)

187 
	#pÜtRESET_READY_PRIORITY
Ğ
uxPriÜ™y
, 
uxR—dyPriÜ™›s
 ) ( uxR—dyPriÜ™› è&ğ~Ğ1UL << ( uxPriÜ™y ) )

	)

191 
	#pÜtGET_HIGHEST_PRIORITY
Ğ
uxTİPriÜ™y
, 
uxR—dyPriÜ™›s
 ) uxTİPriÜ™y = ( 31UL - ( 
ušt32_t
 ) 
	`ucPÜtCouÁL—dšgZ”os
ĞĞuxR—dyPriÜ™› èè)

	)

197 #ifdeà
cÚfigASSERT


198 
vPÜtV®id©eIÁ”ru±PriÜ™y
( );

199 
	#pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
(è
	`vPÜtV®id©eIÁ”ru±PriÜ™y
()

	)

203 
	#pÜtNOP
()

	)

205 
	#pÜtINLINE
 
__šlše


	)

207 #iâdeà
pÜtFORCE_INLINE


208 
	#pÜtFORCE_INLINE
 
šlše
 
	`__©Œibu‹__
(Ğ
®ways_šlše
))

	)

211 
pÜtFORCE_INLINE
 
Ba£Ty³_t
 
xPÜtIsInsideIÁ”ru±
( )

213 
ušt32_t
 
	gulCu¼’tIÁ”ru±
;

214 
Ba£Ty³_t
 
	gxR‘uº
;

217 
__asm
 vŞ©eĞ"mr %0, ip¤" : "ô"Ğ
ulCu¼’tIÁ”ru±
 ) );

219 ifĞ
	gulCu¼’tIÁ”ru±
 == 0 )

221 
xR‘uº
 = 
pdFALSE
;

225 
	gxR‘uº
 = 
pdTRUE
;

228  
	gxR‘uº
;

233 
pÜtFORCE_INLINE
 
vPÜtRai£BASEPRI
( )

235 
ušt32_t
 
	gulNewBASEPRI
;

237 
__asm
 volatile

243 :"ô" (
ulNewBASEPRI
è: "i" ( 
cÚfigMAX_SYSCALL_INTERRUPT_PRIORITY
 )

249 
pÜtFORCE_INLINE
 
ušt32_t
 
ulPÜtRai£BASEPRI
( )

251 
ušt32_t
 
	gulOrigš®BASEPRI
, 
	gulNewBASEPRI
;

253 
__asm
 volatile

260 :"ô" (
ulOrigš®BASEPRI
), "ô" (
	gulNewBASEPRI
è: "i" ( 
cÚfigMAX_SYSCALL_INTERRUPT_PRIORITY
 )

265  
	gulOrigš®BASEPRI
;

269 
pÜtFORCE_INLINE
 
vPÜtS‘BASEPRI
Ğ
ušt32_t
 
ulNewMaskV®ue
 )

271 
__asm
 volatile

273 " m¤ ba£´i, %0 " :: "r" ( 
ulNewMaskV®ue
 )

279 #ifdeà
__ılu¥lus


	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\portable\MemMang\heap_4.c

78 
	~<¡dlib.h
>

79 
	~<¡ršg.h
>

84 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

86 
	~"F»eRTOS.h
"

87 
	~"sk.h
"

89 #undeà
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


91 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 0 )

92 #”rÜ 
This
 
fe
 
mu¡
 
nÙ
 
be
 
u£d
 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 
is
 0

96 
	#h—pMINIMUM_BLOCK_SIZE
 ( ( 
size_t
 ) ( 
xH—pSŒuùSize
 << 1 ) )

	)

99 
	#h—pBITS_PER_BYTE
 ( ( 
size_t
 ) 8 )

	)

102 #ifĞ
cÚfigAPPLICATION_ALLOCATED_HEAP
 == 1 )

106 
ušt8_t
 *
ucH—p
;

108 
ušt8_t
 
	gucH—p
[ 
cÚfigTOTAL_HEAP_SIZE
 ];

113 
	sA_BLOCK_LINK


115 
A_BLOCK_LINK
 *
	mpxNextF»eBlock
;

116 
size_t
 
	mxBlockSize
;

117 } 
	tBlockLšk_t
;

127 
´vIn£¹BlockIÁoF»eLi¡
Ğ
BlockLšk_t
 *
pxBlockToIn£¹
 );

133 
´vH—pIn™
( );

139 cÚ¡ 
size_t
 
	gxH—pSŒuùSize
 = ( Ğ
BlockLšk_t
 ) + ( ( size_ˆèĞ
pÜtBYTE_ALIGNMENT
 - 1 ) ) ) & ~ĞĞsize_ˆè
pÜtBYTE_ALIGNMENT_MASK
 );

142 
BlockLšk_t
 
	gxS¹
, *
	gpxEnd
 = 
NULL
;

146 
size_t
 
	gxF»eBy‹sRemaššg
 = 0U;

147 
size_t
 
	gxMšimumEv”F»eBy‹sRemaššg
 = 0U;

153 
size_t
 
	gxBlockAÎoÿ‹dB™
 = 0;

157 *
	$pvPÜtM®loc
Ğ
size_t
 
xWª‹dSize
 )

159 
BlockLšk_t
 *
pxBlock
, *
pxP»viousBlock
, *
pxNewBlockLšk
;

160 *
pvR‘uº
 = 
NULL
;

162 
	`vTaskSu¥’dAÎ
();

166 ifĞ
pxEnd
 =ğ
NULL
 )

168 
	`´vH—pIn™
();

172 
	`mtCOVERAGE_TEST_MARKER
();

179 ifĞĞ
xWª‹dSize
 & 
xBlockAÎoÿ‹dB™
 ) == 0 )

183 ifĞ
xWª‹dSize
 > 0 )

185 
xWª‹dSize
 +ğ
xH—pSŒuùSize
;

189 ifĞĞ
xWª‹dSize
 & 
pÜtBYTE_ALIGNMENT_MASK
 ) != 0x00 )

192 
xWª‹dSize
 +ğĞ
pÜtBYTE_ALIGNMENT
 - ( xWª‹dSiz& 
pÜtBYTE_ALIGNMENT_MASK
 ) );

193 
	`cÚfigASSERT
ĞĞ
xWª‹dSize
 & 
pÜtBYTE_ALIGNMENT_MASK
 ) == 0 );

197 
	`mtCOVERAGE_TEST_MARKER
();

202 
	`mtCOVERAGE_TEST_MARKER
();

205 ifĞĞ
xWª‹dSize
 > 0 ) && ( xWª‹dSiz<ğ
xF»eBy‹sRemaššg
 ) )

209 
pxP»viousBlock
 = &
xS¹
;

210 
pxBlock
 = 
xS¹
.
pxNextF»eBlock
;

211  ( 
pxBlock
->
xBlockSize
 < 
xWª‹dSize
 ) && (…xBlock->
pxNextF»eBlock
 !ğ
NULL
 ) )

213 
pxP»viousBlock
 = 
pxBlock
;

214 
pxBlock
 =…xBlock->
pxNextF»eBlock
;

219 ifĞ
pxBlock
 !ğ
pxEnd
 )

223 
pvR‘uº
 = ( * ) ( ( ( 
ušt8_t
 * ) 
pxP»viousBlock
->
pxNextF»eBlock
 ) + 
xH—pSŒuùSize
 );

227 
pxP»viousBlock
->
pxNextF»eBlock
 = 
pxBlock
->pxNextFreeBlock;

231 ifĞĞ
pxBlock
->
xBlockSize
 - 
xWª‹dSize
 ) > 
h—pMINIMUM_BLOCK_SIZE
 )

237 
pxNewBlockLšk
 = ( * ) ( ( ( 
ušt8_t
 * ) 
pxBlock
 ) + 
xWª‹dSize
 );

238 
	`cÚfigASSERT
ĞĞĞĞ
size_t
 ) 
pxNewBlockLšk
 ) & 
pÜtBYTE_ALIGNMENT_MASK
 ) == 0 );

242 
pxNewBlockLšk
->
xBlockSize
 = 
pxBlock
->xBlockSiz- 
xWª‹dSize
;

243 
pxBlock
->
xBlockSize
 = 
xWª‹dSize
;

246 
	`´vIn£¹BlockIÁoF»eLi¡
Ğ
pxNewBlockLšk
 );

250 
	`mtCOVERAGE_TEST_MARKER
();

253 
xF»eBy‹sRemaššg
 -ğ
pxBlock
->
xBlockSize
;

255 ifĞ
xF»eBy‹sRemaššg
 < 
xMšimumEv”F»eBy‹sRemaššg
 )

257 
xMšimumEv”F»eBy‹sRemaššg
 = 
xF»eBy‹sRemaššg
;

261 
	`mtCOVERAGE_TEST_MARKER
();

266 
pxBlock
->
xBlockSize
 |ğ
xBlockAÎoÿ‹dB™
;

267 
pxBlock
->
pxNextF»eBlock
 = 
NULL
;

271 
	`mtCOVERAGE_TEST_MARKER
();

276 
	`mtCOVERAGE_TEST_MARKER
();

281 
	`mtCOVERAGE_TEST_MARKER
();

284 
	`ŒaûMALLOC
Ğ
pvR‘uº
, 
xWª‹dSize
 );

286 Ğè
	`xTaskResumeAÎ
();

288 #ifĞ
cÚfigUSE_MALLOC_FAILED_HOOK
 == 1 )

290 ifĞ
pvR‘uº
 =ğ
NULL
 )

292 
	`vAµliÿtiÚM®locFaedHook
( );

293 
	`vAµliÿtiÚM®locFaedHook
();

297 
	`mtCOVERAGE_TEST_MARKER
();

302 
	`cÚfigASSERT
ĞĞĞĞ
size_t
 ) 
pvR‘uº
 ) & ( size_ˆè
pÜtBYTE_ALIGNMENT_MASK
 ) == 0 );

303  
pvR‘uº
;

304 
	}
}

307 
	$vPÜtF»e
Ğ*
pv
 )

309 
ušt8_t
 *
puc
 = ( ušt8_ˆ* ) 
pv
;

310 
BlockLšk_t
 *
pxLšk
;

312 ifĞ
pv
 !ğ
NULL
 )

316 
puc
 -ğ
xH—pSŒuùSize
;

319 
pxLšk
 = ( * ) 
puc
;

322 
	`cÚfigASSERT
ĞĞ
pxLšk
->
xBlockSize
 & 
xBlockAÎoÿ‹dB™
 ) != 0 );

323 
	`cÚfigASSERT
Ğ
pxLšk
->
pxNextF»eBlock
 =ğ
NULL
 );

325 ifĞĞ
pxLšk
->
xBlockSize
 & 
xBlockAÎoÿ‹dB™
 ) != 0 )

327 ifĞ
pxLšk
->
pxNextF»eBlock
 =ğ
NULL
 )

331 
pxLšk
->
xBlockSize
 &ğ~
xBlockAÎoÿ‹dB™
;

333 
	`vTaskSu¥’dAÎ
();

336 
xF»eBy‹sRemaššg
 +ğ
pxLšk
->
xBlockSize
;

337 
	`ŒaûFREE
Ğ
pv
, 
pxLšk
->
xBlockSize
 );

338 
	`´vIn£¹BlockIÁoF»eLi¡
ĞĞĞ
BlockLšk_t
 * ) 
pxLšk
 ) );

340 Ğè
	`xTaskResumeAÎ
();

344 
	`mtCOVERAGE_TEST_MARKER
();

349 
	`mtCOVERAGE_TEST_MARKER
();

352 
	}
}

355 
size_t
 
	$xPÜtG‘F»eH—pSize
( )

357  
xF»eBy‹sRemaššg
;

358 
	}
}

361 
size_t
 
	$xPÜtG‘MšimumEv”F»eH—pSize
( )

363  
xMšimumEv”F»eBy‹sRemaššg
;

364 
	}
}

367 
	$vPÜtIn™Ÿli£Blocks
( )

370 
	}
}

373 
	$´vH—pIn™
( )

375 
BlockLšk_t
 *
pxFœ¡F»eBlock
;

376 
ušt8_t
 *
pucAligÃdH—p
;

377 
size_t
 
uxAdd»ss
;

378 
size_t
 
xTÙ®H—pSize
 = 
cÚfigTOTAL_HEAP_SIZE
;

381 
uxAdd»ss
 = ( 
size_t
 ) 
ucH—p
;

383 ifĞĞ
uxAdd»ss
 & 
pÜtBYTE_ALIGNMENT_MASK
 ) != 0 )

385 
uxAdd»ss
 +ğĞ
pÜtBYTE_ALIGNMENT
 - 1 );

386 
uxAdd»ss
 &ğ~ĞĞ
size_t
 ) 
pÜtBYTE_ALIGNMENT_MASK
 );

387 
xTÙ®H—pSize
 -ğ
uxAdd»ss
 - ( 
size_t
 ) 
ucH—p
;

390 
pucAligÃdH—p
 = ( 
ušt8_t
 * ) 
uxAdd»ss
;

394 
xS¹
.
pxNextF»eBlock
 = ( * ) 
pucAligÃdH—p
;

395 
xS¹
.
xBlockSize
 = ( 
size_t
 ) 0;

399 
uxAdd»ss
 = ( ( 
size_t
 ) 
pucAligÃdH—p
 ) + 
xTÙ®H—pSize
;

400 
uxAdd»ss
 -ğ
xH—pSŒuùSize
;

401 
uxAdd»ss
 &ğ~ĞĞ
size_t
 ) 
pÜtBYTE_ALIGNMENT_MASK
 );

402 
pxEnd
 = ( * ) 
uxAdd»ss
;

403 
pxEnd
->
xBlockSize
 = 0;

404 
pxEnd
->
pxNextF»eBlock
 = 
NULL
;

408 
pxFœ¡F»eBlock
 = ( * ) 
pucAligÃdH—p
;

409 
pxFœ¡F»eBlock
->
xBlockSize
 = 
uxAdd»ss
 - ( 
size_t
 )…xFirstFreeBlock;

410 
pxFœ¡F»eBlock
->
pxNextF»eBlock
 = 
pxEnd
;

413 
xMšimumEv”F»eBy‹sRemaššg
 = 
pxFœ¡F»eBlock
->
xBlockSize
;

414 
xF»eBy‹sRemaššg
 = 
pxFœ¡F»eBlock
->
xBlockSize
;

417 
xBlockAÎoÿ‹dB™
 = ( ( 
size_t
 ) 1 ) << ( ( Ğsize_ˆè* 
h—pBITS_PER_BYTE
 ) - 1 );

418 
	}
}

421 
	$´vIn£¹BlockIÁoF»eLi¡
Ğ
BlockLšk_t
 *
pxBlockToIn£¹
 )

423 
BlockLšk_t
 *
pxI‹¿tÜ
;

424 
ušt8_t
 *
puc
;

428  
pxI‹¿tÜ
 = &
xS¹
;…xI‹¿tÜ->
pxNextF»eBlock
 < 
pxBlockToIn£¹
;…xIterator =…xIterator->pxNextFreeBlock )

435 
puc
 = ( 
ušt8_t
 * ) 
pxI‹¿tÜ
;

436 ifĞĞ
puc
 + 
pxI‹¿tÜ
->
xBlockSize
 ) =ğĞ
ušt8_t
 * ) 
pxBlockToIn£¹
 )

438 
pxI‹¿tÜ
->
xBlockSize
 +ğ
pxBlockToIn£¹
->xBlockSize;

439 
pxBlockToIn£¹
 = 
pxI‹¿tÜ
;

443 
	`mtCOVERAGE_TEST_MARKER
();

448 
puc
 = ( 
ušt8_t
 * ) 
pxBlockToIn£¹
;

449 ifĞĞ
puc
 + 
pxBlockToIn£¹
->
xBlockSize
 ) =ğĞ
ušt8_t
 * ) 
pxI‹¿tÜ
->
pxNextF»eBlock
 )

451 ifĞ
pxI‹¿tÜ
->
pxNextF»eBlock
 !ğ
pxEnd
 )

454 
pxBlockToIn£¹
->
xBlockSize
 +ğ
pxI‹¿tÜ
->
pxNextF»eBlock
->xBlockSize;

455 
pxBlockToIn£¹
->
pxNextF»eBlock
 = 
pxI‹¿tÜ
->pxNextFreeBlock->pxNextFreeBlock;

459 
pxBlockToIn£¹
->
pxNextF»eBlock
 = 
pxEnd
;

464 
pxBlockToIn£¹
->
pxNextF»eBlock
 = 
pxI‹¿tÜ
->pxNextFreeBlock;

471 ifĞ
pxI‹¿tÜ
 !ğ
pxBlockToIn£¹
 )

473 
pxI‹¿tÜ
->
pxNextF»eBlock
 = 
pxBlockToIn£¹
;

477 
	`mtCOVERAGE_TEST_MARKER
();

479 
	}
}

481 *
	$pvPÜtR—Îoc
(*
mem
, 
size_t
 
Ãwsize
)

483 *
p
;

484 ià(
Ãwsize
 == 0) {

485 
	`vPÜtF»e
(
mem
);

486  
NULL
;

489 
p
 = 
	`pvPÜtM®loc
(
Ãwsize
);

490 ià(
p
) {

492 ià(
mem
 !ğ
NULL
) {

493 
	`memıy
(
p
, 
mem
, 
Ãwsize
);

494 
	`vPÜtF»e
(
mem
);

497  
p
;

498 
	}
}

499 *
	$pvPÜtC®loc
(
size_t
 
couÁ
, size_ˆ
size
)

501 *
p
;

504 
p
 = 
	`pvPÜtM®loc
(
couÁ
 * 
size
);

505 ià(
p
) {

507 
	`mem£t
(
p
, 0, 
couÁ
 * 
size
);

509  
p
;

510 
	}
}

511 *
	$»®loc
(*
±r
, 
size_t
 
nby‹s
è
	`__©Œibu‹__
((
	`®Ÿs
("pvPortRealloc")));

512 *
	$ÿÎoc
(
size_t
 
couÁ
, size_ˆ
nby‹s
è
	`__©Œibu‹__
((
	`®Ÿs
("pvPortCalloc")));

513 *
	$m®loc
(
size_t
 
nby‹s
è
	`__©Œibu‹__
((
	`®Ÿs
("pvPortMalloc")));

514 
	$ä“
(*
±r
è
	`__©Œibu‹__
((
	`®Ÿs
("vPortFree")));

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\queue.c

70 
	~<¡dlib.h
>

71 
	~<¡ršg.h
>

76 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

78 
	~"F»eRTOS.h
"

79 
	~"sk.h
"

80 
	~"queue.h
"

82 #iàĞ
cÚfigUSE_CO_ROUTINES
 == 1 )

83 
	~"üoutše.h
"

90 #undeà
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


94 
	#queueUNLOCKED
 ( ( 
št8_t
 ) -1 )

	)

95 
	#queueLOCKED_UNMODIFIED
 ( ( 
št8_t
 ) 0 )

	)

108 
	#pxMu‹xHŞd”
 
pcTa


	)

109 
	#uxQueueTy³
 
pcH—d


	)

110 
	#queueQUEUE_IS_MUTEX
 
NULL


	)

114 
	#queueSEMAPHORE_QUEUE_ITEM_LENGTH
 ( ( 
UBa£Ty³_t
 ) 0 )

	)

115 
	#queueMUTEX_GIVE_BLOCK_TIME
 ( ( 
TickTy³_t
 ) 0U )

	)

117 #ifĞ
cÚfigUSE_PREEMPTION
 == 0 )

120 
	#queueYIELD_IF_USING_PREEMPTION
()

	)

122 
	#queueYIELD_IF_USING_PREEMPTION
(è
	`pÜtYIELD_WITHIN_API
()

	)

130 
	sQueueDefš™iÚ


132 
št8_t
 *
	mpcH—d
;

133 
št8_t
 *
	mpcTa
;

134 
št8_t
 *
	mpcWr™eTo
;

138 
št8_t
 *
	mpcR—dFrom
;

139 
UBa£Ty³_t
 
	muxRecursiveC®lCouÁ
;

140 } 
	mu
;

142 
Li¡_t
 
	mxTasksWa™šgToS’d
;

143 
Li¡_t
 
	mxTasksWa™šgToReûive
;

145 vŞ©
UBa£Ty³_t
 
	muxMes§gesWa™šg
;

146 
UBa£Ty³_t
 
	muxL’gth
;

147 
UBa£Ty³_t
 
	muxI‹mSize
;

149 vŞ©
št8_t
 
	mcRxLock
;

150 vŞ©
št8_t
 
	mcTxLock
;

152 #ifĞĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 ) )

153 
ušt8_t
 
	mucStiÿÎyAÎoÿ‹d
;

156 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

157 
QueueDefš™iÚ
 *
	mpxQueueS‘CÚš”
;

160 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

161 
UBa£Ty³_t
 
	muxQueueNumb”
;

162 
ušt8_t
 
	mucQueueTy³
;

165 } 
	txQUEUE
;

169 
xQUEUE
 
	tQueue_t
;

177 #iàĞ
cÚfigQUEUE_REGISTRY_SIZE
 > 0 )

182 
	sQUEUE_REGISTRY_ITEM


184 cÚ¡ *
	mpcQueueName
;

185 
QueueHªdË_t
 
	mxHªdË
;

186 } 
	txQueueRegi¡ryI‹m
;

191 
xQueueRegi¡ryI‹m
 
	tQueueRegi¡ryI‹m_t
;

196 
PRIVILEGED_DATA
 
QueueRegi¡ryI‹m_t
 
	gxQueueRegi¡ry
[ 
cÚfigQUEUE_REGISTRY_SIZE
 ];

208 
	$´vUÆockQueue
Ğ
Queue_t
 * cÚ¡ 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

215 
Ba£Ty³_t
 
	$´vIsQueueEm±y
ĞcÚ¡ 
Queue_t
 *
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

222 
Ba£Ty³_t
 
	$´vIsQueueFuÎ
ĞcÚ¡ 
Queue_t
 *
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

228 
Ba£Ty³_t
 
	$´vCİyD©aToQueue
Ğ
Queue_t
 * cÚ¡ 
pxQueue
, cÚ¡ *
pvI‹mToQueue
, cÚ¡ 
Ba£Ty³_t
 
xPos™iÚ
 ) 
PRIVILEGED_FUNCTION
;

233 
	$´vCİyD©aFromQueue
Ğ
Queue_t
 * cÚ¡ 
pxQueue
, * cÚ¡ 
pvBufãr
 ) 
PRIVILEGED_FUNCTION
;

235 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

240 
Ba£Ty³_t
 
	$´vNÙifyQueueS‘CÚš”
ĞcÚ¡ 
Queue_t
 * cÚ¡ 
pxQueue
, cÚ¡ 
Ba£Ty³_t
 
xCİyPos™iÚ
 ) 
PRIVILEGED_FUNCTION
;

247 
	$´vIn™Ÿli£NewQueue
ĞcÚ¡ 
UBa£Ty³_t
 
uxQueueL’gth
, cÚ¡ UBa£Ty³_ˆ
uxI‹mSize
, 
ušt8_t
 *
pucQueueStÜage
, cÚ¡ ušt8_ˆ
ucQueueTy³
, 
Queue_t
 *
pxNewQueue
 ) 
PRIVILEGED_FUNCTION
;

254 #ifĞ
cÚfigUSE_MUTEXES
 == 1 )

255 
	$´vIn™Ÿli£Mu‹x
Ğ
Queue_t
 *
pxNewQueue
 ) 
PRIVILEGED_FUNCTION
;

264 
	#´vLockQueue
Ğ
pxQueue
 ) \

265 
	`skENTER_CRITICAL
(); \

267 ifĞĞ
pxQueue
 )->
cRxLock
 =ğ
queueUNLOCKED
 ) \

269 Ğ
pxQueue
 )->
cRxLock
 = 
queueLOCKED_UNMODIFIED
; \

271 ifĞĞ
pxQueue
 )->
cTxLock
 =ğ
queueUNLOCKED
 ) \

273 Ğ
pxQueue
 )->
cTxLock
 = 
queueLOCKED_UNMODIFIED
; \

275 
	}
} \

276 
	`skEXIT_CRITICAL
()

	)

279 
Ba£Ty³_t
 
	$xQueueG’”icRe£t
Ğ
QueueHªdË_t
 
xQueue
, 
Ba£Ty³_t
 
xNewQueue
 )

281 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

283 
	`cÚfigASSERT
Ğ
pxQueue
 );

285 
	`skENTER_CRITICAL
();

287 
pxQueue
->
pcTa
 =…xQueue->
pcH—d
 + (…xQueue->
uxL’gth
 *…xQueue->
uxI‹mSize
 );

288 
pxQueue
->
uxMes§gesWa™šg
 = ( 
UBa£Ty³_t
 ) 0U;

289 
pxQueue
->
pcWr™eTo
 =…xQueue->
pcH—d
;

290 
pxQueue
->
u
.
pcR—dFrom
 =…xQueue->
pcH—d
 + ( (…xQueue->
uxL’gth
 - ( 
UBa£Ty³_t
 ) 1U ) *…xQueue->
uxI‹mSize
 );

291 
pxQueue
->
cRxLock
 = 
queueUNLOCKED
;

292 
pxQueue
->
cTxLock
 = 
queueUNLOCKED
;

294 ifĞ
xNewQueue
 =ğ
pdFALSE
 )

301 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) =ğ
pdFALSE
 )

303 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) !ğ
pdFALSE
 )

305 
	`queueYIELD_IF_USING_PREEMPTION
();

309 
	`mtCOVERAGE_TEST_MARKER
();

314 
	`mtCOVERAGE_TEST_MARKER
();

320 
	`vLi¡In™Ÿli£
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) );

321 
	`vLi¡In™Ÿli£
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) );

324 
	`skEXIT_CRITICAL
();

328  
pdPASS
;

329 
	}
}

332 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

334 
QueueHªdË_t
 
	$xQueueG’”icC»©eStic
ĞcÚ¡ 
UBa£Ty³_t
 
uxQueueL’gth
, cÚ¡ UBa£Ty³_ˆ
uxI‹mSize
, 
ušt8_t
 *
pucQueueStÜage
, 
SticQueue_t
 *
pxSticQueue
, cÚ¡ ušt8_ˆ
ucQueueTy³
 )

336 
Queue_t
 *
pxNewQueue
;

338 
	`cÚfigASSERT
Ğ
uxQueueL’gth
 > ( 
UBa£Ty³_t
 ) 0 );

342 
	`cÚfigASSERT
Ğ
pxSticQueue
 !ğ
NULL
 );

346 
	`cÚfigASSERT
Ğ!ĞĞ
pucQueueStÜage
 !ğ
NULL
 ) && ( 
uxI‹mSize
 == 0 ) ) );

347 
	`cÚfigASSERT
Ğ!ĞĞ
pucQueueStÜage
 =ğ
NULL
 ) && ( 
uxI‹mSize
 != 0 ) ) );

349 #ifĞ
cÚfigASSERT_DEFINED
 == 1 )

354 vŞ©
size_t
 
xSize
 = Ğ
SticQueue_t
 );

355 
	`cÚfigASSERT
Ğ
xSize
 =ğĞ
Queue_t
 ) );

362 
pxNewQueue
 = ( 
Queue_t
 * ) 
pxSticQueue
;

364 ifĞ
pxNewQueue
 !ğ
NULL
 )

366 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 )

371 
pxNewQueue
->
ucStiÿÎyAÎoÿ‹d
 = 
pdTRUE
;

375 
	`´vIn™Ÿli£NewQueue
Ğ
uxQueueL’gth
, 
uxI‹mSize
, 
pucQueueStÜage
, 
ucQueueTy³
, 
pxNewQueue
 );

378  
pxNewQueue
;

379 
	}
}

384 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 )

386 
QueueHªdË_t
 
	$xQueueG’”icC»©e
ĞcÚ¡ 
UBa£Ty³_t
 
uxQueueL’gth
, cÚ¡ UBa£Ty³_ˆ
uxI‹mSize
, cÚ¡ 
ušt8_t
 
ucQueueTy³
 )

388 
Queue_t
 *
pxNewQueue
;

389 
size_t
 
xQueueSizeInBy‹s
;

390 
ušt8_t
 *
pucQueueStÜage
;

392 
	`cÚfigASSERT
Ğ
uxQueueL’gth
 > ( 
UBa£Ty³_t
 ) 0 );

394 ifĞ
uxI‹mSize
 =ğĞ
UBa£Ty³_t
 ) 0 )

397 
xQueueSizeInBy‹s
 = ( 
size_t
 ) 0;

403 
xQueueSizeInBy‹s
 = ( 
size_t
 ) ( 
uxQueueL’gth
 * 
uxI‹mSize
 );

406 
pxNewQueue
 = ( 
Queue_t
 * ) 
	`pvPÜtM®loc
ĞĞQueue_ˆè+ 
xQueueSizeInBy‹s
 );

408 ifĞ
pxNewQueue
 !ğ
NULL
 )

412 
pucQueueStÜage
 = ( ( 
ušt8_t
 * ) 
pxNewQueue
 ) + Ğ
Queue_t
 );

414 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

419 
pxNewQueue
->
ucStiÿÎyAÎoÿ‹d
 = 
pdFALSE
;

423 
	`´vIn™Ÿli£NewQueue
Ğ
uxQueueL’gth
, 
uxI‹mSize
, 
pucQueueStÜage
, 
ucQueueTy³
, 
pxNewQueue
 );

426  
pxNewQueue
;

427 
	}
}

432 
	$´vIn™Ÿli£NewQueue
ĞcÚ¡ 
UBa£Ty³_t
 
uxQueueL’gth
, cÚ¡ UBa£Ty³_ˆ
uxI‹mSize
, 
ušt8_t
 *
pucQueueStÜage
, cÚ¡ ušt8_ˆ
ucQueueTy³
, 
Queue_t
 *
pxNewQueue
 )

436 Ğè
ucQueueTy³
;

438 ifĞ
uxI‹mSize
 =ğĞ
UBa£Ty³_t
 ) 0 )

444 
pxNewQueue
->
pcH—d
 = ( 
št8_t
 * )…xNewQueue;

449 
pxNewQueue
->
pcH—d
 = ( 
št8_t
 * ) 
pucQueueStÜage
;

454 
pxNewQueue
->
uxL’gth
 = 
uxQueueL’gth
;

455 
pxNewQueue
->
uxI‹mSize
 = uxItemSize;

456 Ğè
	`xQueueG’”icRe£t
Ğ
pxNewQueue
, 
pdTRUE
 );

458 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

460 
pxNewQueue
->
ucQueueTy³
 = ucQueueType;

464 #ifĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

466 
pxNewQueue
->
pxQueueS‘CÚš”
 = 
NULL
;

470 
	`ŒaûQUEUE_CREATE
Ğ
pxNewQueue
 );

471 
	}
}

474 #ifĞ
cÚfigUSE_MUTEXES
 == 1 )

476 
	$´vIn™Ÿli£Mu‹x
Ğ
Queue_t
 *
pxNewQueue
 )

478 ifĞ
pxNewQueue
 !ğ
NULL
 )

484 
pxNewQueue
->
pxMu‹xHŞd”
 = 
NULL
;

485 
pxNewQueue
->
uxQueueTy³
 = 
queueQUEUE_IS_MUTEX
;

488 
pxNewQueue
->
u
.
uxRecursiveC®lCouÁ
 = 0;

490 
	`ŒaûCREATE_MUTEX
Ğ
pxNewQueue
 );

493 Ğè
	`xQueueG’”icS’d
Ğ
pxNewQueue
, 
NULL
, ( 
TickTy³_t
 ) 0U, 
queueSEND_TO_BACK
 );

497 
	`ŒaûCREATE_MUTEX_FAILED
();

499 
	}
}

504 #ifĞĞ
cÚfigUSE_MUTEXES
 =ğ1 ) && ( 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 ) )

506 
QueueHªdË_t
 
	$xQueueC»©eMu‹x
ĞcÚ¡ 
ušt8_t
 
ucQueueTy³
 )

508 
Queue_t
 *
pxNewQueue
;

509 cÚ¡ 
UBa£Ty³_t
 
uxMu‹xL’gth
 = ( UBa£Ty³_ˆè1, 
uxMu‹xSize
 = ( UBaseType_t ) 0;

511 
pxNewQueue
 = ( 
Queue_t
 * ) 
	`xQueueG’”icC»©e
Ğ
uxMu‹xL’gth
, 
uxMu‹xSize
, 
ucQueueTy³
 );

512 
	`´vIn™Ÿli£Mu‹x
Ğ
pxNewQueue
 );

514  
pxNewQueue
;

515 
	}
}

520 #ifĞĞ
cÚfigUSE_MUTEXES
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 ) )

522 
QueueHªdË_t
 
	$xQueueC»©eMu‹xStic
ĞcÚ¡ 
ušt8_t
 
ucQueueTy³
, 
SticQueue_t
 *
pxSticQueue
 )

524 
Queue_t
 *
pxNewQueue
;

525 cÚ¡ 
UBa£Ty³_t
 
uxMu‹xL’gth
 = ( UBa£Ty³_ˆè1, 
uxMu‹xSize
 = ( UBaseType_t ) 0;

529 Ğè
ucQueueTy³
;

531 
pxNewQueue
 = ( 
Queue_t
 * ) 
	`xQueueG’”icC»©eStic
Ğ
uxMu‹xL’gth
, 
uxMu‹xSize
, 
NULL
, 
pxSticQueue
, 
ucQueueTy³
 );

532 
	`´vIn™Ÿli£Mu‹x
Ğ
pxNewQueue
 );

534  
pxNewQueue
;

535 
	}
}

540 #iàĞĞ
cÚfigUSE_MUTEXES
 =ğ1 ) && ( 
INCLUDE_xSem­hÜeG‘Mu‹xHŞd”
 == 1 ) )

542 * 
	$xQueueG‘Mu‹xHŞd”
Ğ
QueueHªdË_t
 
xSem­hÜe
 )

544 *
pxR‘uº
;

551 
	`skENTER_CRITICAL
();

553 ifĞĞĞ
Queue_t
 * ) 
xSem­hÜe
 )->
uxQueueTy³
 =ğ
queueQUEUE_IS_MUTEX
 )

555 
pxR‘uº
 = ( * ) ( ( 
Queue_t
 * ) 
xSem­hÜe
 )->
pxMu‹xHŞd”
;

559 
pxR‘uº
 = 
NULL
;

562 
	`skEXIT_CRITICAL
();

564  
pxR‘uº
;

565 
	}
}

570 #iàĞ
cÚfigUSE_RECURSIVE_MUTEXES
 == 1 )

572 
Ba£Ty³_t
 
	$xQueueGiveMu‹xRecursive
Ğ
QueueHªdË_t
 
xMu‹x
 )

574 
Ba£Ty³_t
 
xR‘uº
;

575 
Queue_t
 * cÚ¡ 
pxMu‹x
 = ( Queue_ˆ* ) 
xMu‹x
;

577 
	`cÚfigASSERT
Ğ
pxMu‹x
 );

585 ifĞ
pxMu‹x
->
pxMu‹xHŞd”
 =ğĞ* ) 
	`xTaskG‘Cu¼’tTaskHªdË
() )

587 
	`ŒaûGIVE_MUTEX_RECURSIVE
Ğ
pxMu‹x
 );

594 Ğ
pxMu‹x
->
u
.
uxRecursiveC®lCouÁ
 )--;

597 ifĞ
pxMu‹x
->
u
.
uxRecursiveC®lCouÁ
 =ğĞ
UBa£Ty³_t
 ) 0 )

601 Ğè
	`xQueueG’”icS’d
Ğ
pxMu‹x
, 
NULL
, 
queueMUTEX_GIVE_BLOCK_TIME
, 
queueSEND_TO_BACK
 );

605 
	`mtCOVERAGE_TEST_MARKER
();

608 
xR‘uº
 = 
pdPASS
;

614 
xR‘uº
 = 
pdFAIL
;

616 
	`ŒaûGIVE_MUTEX_RECURSIVE_FAILED
Ğ
pxMu‹x
 );

619  
xR‘uº
;

620 
	}
}

625 #iàĞ
cÚfigUSE_RECURSIVE_MUTEXES
 == 1 )

627 
Ba£Ty³_t
 
	$xQueueTakeMu‹xRecursive
Ğ
QueueHªdË_t
 
xMu‹x
, 
TickTy³_t
 
xTicksToWa™
 )

629 
Ba£Ty³_t
 
xR‘uº
;

630 
Queue_t
 * cÚ¡ 
pxMu‹x
 = ( Queue_ˆ* ) 
xMu‹x
;

632 
	`cÚfigASSERT
Ğ
pxMu‹x
 );

637 
	`ŒaûTAKE_MUTEX_RECURSIVE
Ğ
pxMu‹x
 );

639 ifĞ
pxMu‹x
->
pxMu‹xHŞd”
 =ğĞ* ) 
	`xTaskG‘Cu¼’tTaskHªdË
() )

641 Ğ
pxMu‹x
->
u
.
uxRecursiveC®lCouÁ
 )++;

642 
xR‘uº
 = 
pdPASS
;

646 
xR‘uº
 = 
	`xQueueG’”icReûive
Ğ
pxMu‹x
, 
NULL
, 
xTicksToWa™
, 
pdFALSE
 );

651 ifĞ
xR‘uº
 !ğ
pdFAIL
 )

653 Ğ
pxMu‹x
->
u
.
uxRecursiveC®lCouÁ
 )++;

657 
	`ŒaûTAKE_MUTEX_RECURSIVE_FAILED
Ğ
pxMu‹x
 );

661  
xR‘uº
;

662 
	}
}

667 #ifĞĞ
cÚfigUSE_COUNTING_SEMAPHORES
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 ) )

669 
QueueHªdË_t
 
	$xQueueC»©eCouÁšgSem­hÜeStic
ĞcÚ¡ 
UBa£Ty³_t
 
uxMaxCouÁ
, cÚ¡ UBa£Ty³_ˆ
uxIn™ŸlCouÁ
, 
SticQueue_t
 *
pxSticQueue
 )

671 
QueueHªdË_t
 
xHªdË
;

673 
	`cÚfigASSERT
Ğ
uxMaxCouÁ
 != 0 );

674 
	`cÚfigASSERT
Ğ
uxIn™ŸlCouÁ
 <ğ
uxMaxCouÁ
 );

676 
xHªdË
 = 
	`xQueueG’”icC»©eStic
Ğ
uxMaxCouÁ
, 
queueSEMAPHORE_QUEUE_ITEM_LENGTH
, 
NULL
, 
pxSticQueue
, 
queueQUEUE_TYPE_COUNTING_SEMAPHORE
 );

678 ifĞ
xHªdË
 !ğ
NULL
 )

680 ĞĞ
Queue_t
 * ) 
xHªdË
 )->
uxMes§gesWa™šg
 = 
uxIn™ŸlCouÁ
;

682 
	`ŒaûCREATE_COUNTING_SEMAPHORE
();

686 
	`ŒaûCREATE_COUNTING_SEMAPHORE_FAILED
();

689  
xHªdË
;

690 
	}
}

695 #ifĞĞ
cÚfigUSE_COUNTING_SEMAPHORES
 =ğ1 ) && ( 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 ) )

697 
QueueHªdË_t
 
	$xQueueC»©eCouÁšgSem­hÜe
ĞcÚ¡ 
UBa£Ty³_t
 
uxMaxCouÁ
, cÚ¡ UBa£Ty³_ˆ
uxIn™ŸlCouÁ
 )

699 
QueueHªdË_t
 
xHªdË
;

701 
	`cÚfigASSERT
Ğ
uxMaxCouÁ
 != 0 );

702 
	`cÚfigASSERT
Ğ
uxIn™ŸlCouÁ
 <ğ
uxMaxCouÁ
 );

704 
xHªdË
 = 
	`xQueueG’”icC»©e
Ğ
uxMaxCouÁ
, 
queueSEMAPHORE_QUEUE_ITEM_LENGTH
, 
queueQUEUE_TYPE_COUNTING_SEMAPHORE
 );

706 ifĞ
xHªdË
 !ğ
NULL
 )

708 ĞĞ
Queue_t
 * ) 
xHªdË
 )->
uxMes§gesWa™šg
 = 
uxIn™ŸlCouÁ
;

710 
	`ŒaûCREATE_COUNTING_SEMAPHORE
();

714 
	`ŒaûCREATE_COUNTING_SEMAPHORE_FAILED
();

717  
xHªdË
;

718 
	}
}

723 
Ba£Ty³_t
 
	$xQueueG’”icS’d
Ğ
QueueHªdË_t
 
xQueue
, cÚ¡ * cÚ¡ 
pvI‹mToQueue
, 
TickTy³_t
 
xTicksToWa™
, cÚ¡ 
Ba£Ty³_t
 
xCİyPos™iÚ
 )

725 
Ba£Ty³_t
 
xEÁryTimeS‘
 = 
pdFALSE
, 
xY›ldRequœed
;

726 
TimeOut_t
 
xTimeOut
;

727 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

729 
	`cÚfigASSERT
Ğ
pxQueue
 );

730 
	`cÚfigASSERT
Ğ!ĞĞ
pvI‹mToQueue
 =ğ
NULL
 ) && ( 
pxQueue
->
uxI‹mSize
 !ğĞ
UBa£Ty³_t
 ) 0U ) ) );

731 
	`cÚfigASSERT
Ğ!ĞĞ
xCİyPos™iÚ
 =ğ
queueOVERWRITE
 ) && ( 
pxQueue
->
uxL’gth
 != 1 ) ) );

732 #iàĞĞ
INCLUDE_xTaskG‘ScheduËrS‹
 =ğ1 ) || ( 
cÚfigUSE_TIMERS
 == 1 ) )

734 
	`cÚfigASSERT
Ğ!ĞĞ
	`xTaskG‘ScheduËrS‹
(è=ğ
skSCHEDULER_SUSPENDED
 ) && ( 
xTicksToWa™
 != 0 ) ) );

744 
	`skENTER_CRITICAL
();

750 ifĞĞ
pxQueue
->
uxMes§gesWa™šg
 <…xQueue->
uxL’gth
 ) || ( 
xCİyPos™iÚ
 =ğ
queueOVERWRITE
 ) )

752 
	`ŒaûQUEUE_SEND
Ğ
pxQueue
 );

753 
xY›ldRequœed
 = 
	`´vCİyD©aToQueue
Ğ
pxQueue
, 
pvI‹mToQueue
, 
xCİyPos™iÚ
 );

755 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

757 ifĞ
pxQueue
->
pxQueueS‘CÚš”
 !ğ
NULL
 )

759 ifĞ
	`´vNÙifyQueueS‘CÚš”
Ğ
pxQueue
, 
xCİyPos™iÚ
 ) !ğ
pdFALSE
 )

764 
	`queueYIELD_IF_USING_PREEMPTION
();

768 
	`mtCOVERAGE_TEST_MARKER
();

775 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

777 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

783 
	`queueYIELD_IF_USING_PREEMPTION
();

787 
	`mtCOVERAGE_TEST_MARKER
();

790 ifĞ
xY›ldRequœed
 !ğ
pdFALSE
 )

796 
	`queueYIELD_IF_USING_PREEMPTION
();

800 
	`mtCOVERAGE_TEST_MARKER
();

808 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

810 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

816 
	`queueYIELD_IF_USING_PREEMPTION
();

820 
	`mtCOVERAGE_TEST_MARKER
();

823 ifĞ
xY›ldRequœed
 !ğ
pdFALSE
 )

829 
	`queueYIELD_IF_USING_PREEMPTION
();

833 
	`mtCOVERAGE_TEST_MARKER
();

838 
	`skEXIT_CRITICAL
();

839  
pdPASS
;

843 ifĞ
xTicksToWa™
 =ğĞ
TickTy³_t
 ) 0 )

847 
	`skEXIT_CRITICAL
();

851 
	`ŒaûQUEUE_SEND_FAILED
Ğ
pxQueue
 );

852  
”rQUEUE_FULL
;

854 ifĞ
xEÁryTimeS‘
 =ğ
pdFALSE
 )

858 
	`vTaskS‘TimeOutS‹
Ğ&
xTimeOut
 );

859 
xEÁryTimeS‘
 = 
pdTRUE
;

864 
	`mtCOVERAGE_TEST_MARKER
();

868 
	`skEXIT_CRITICAL
();

873 
	`vTaskSu¥’dAÎ
();

874 
	`´vLockQueue
Ğ
pxQueue
 );

877 ifĞ
	`xTaskCheckFÜTimeOut
Ğ&
xTimeOut
, &
xTicksToWa™
 ) =ğ
pdFALSE
 )

879 ifĞ
	`´vIsQueueFuÎ
Ğ
pxQueue
 ) !ğ
pdFALSE
 )

881 
	`ŒaûBLOCKING_ON_QUEUE_SEND
Ğ
pxQueue
 );

882 
	`vTaskPÏûOnEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ), 
xTicksToWa™
 );

889 
	`´vUÆockQueue
Ğ
pxQueue
 );

896 ifĞ
	`xTaskResumeAÎ
(è=ğ
pdFALSE
 )

898 
	`pÜtYIELD_WITHIN_API
();

904 
	`´vUÆockQueue
Ğ
pxQueue
 );

905 Ğè
	`xTaskResumeAÎ
();

911 
	`´vUÆockQueue
Ğ
pxQueue
 );

912 Ğè
	`xTaskResumeAÎ
();

914 
	`ŒaûQUEUE_SEND_FAILED
Ğ
pxQueue
 );

915  
”rQUEUE_FULL
;

918 
	}
}

921 
Ba£Ty³_t
 
	$xQueueG’”icS’dFromISR
Ğ
QueueHªdË_t
 
xQueue
, cÚ¡ * cÚ¡ 
pvI‹mToQueue
, 
Ba£Ty³_t
 * cÚ¡ 
pxHigh”PriÜ™yTaskWok’
, cÚ¡ Ba£Ty³_ˆ
xCİyPos™iÚ
 )

923 
Ba£Ty³_t
 
xR‘uº
;

924 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

925 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

927 
	`cÚfigASSERT
Ğ
pxQueue
 );

928 
	`cÚfigASSERT
Ğ!ĞĞ
pvI‹mToQueue
 =ğ
NULL
 ) && ( 
pxQueue
->
uxI‹mSize
 !ğĞ
UBa£Ty³_t
 ) 0U ) ) );

929 
	`cÚfigASSERT
Ğ!ĞĞ
xCİyPos™iÚ
 =ğ
queueOVERWRITE
 ) && ( 
pxQueue
->
uxL’gth
 != 1 ) ) );

945 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

952 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

954 ifĞĞ
pxQueue
->
uxMes§gesWa™šg
 <…xQueue->
uxL’gth
 ) || ( 
xCİyPos™iÚ
 =ğ
queueOVERWRITE
 ) )

956 cÚ¡ 
št8_t
 
cTxLock
 = 
pxQueue
->cTxLock;

958 
	`ŒaûQUEUE_SEND_FROM_ISR
Ğ
pxQueue
 );

965 Ğè
	`´vCİyD©aToQueue
Ğ
pxQueue
, 
pvI‹mToQueue
, 
xCİyPos™iÚ
 );

969 ifĞ
cTxLock
 =ğ
queueUNLOCKED
 )

971 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

973 ifĞ
pxQueue
->
pxQueueS‘CÚš”
 !ğ
NULL
 )

975 ifĞ
	`´vNÙifyQueueS‘CÚš”
Ğ
pxQueue
, 
xCİyPos™iÚ
 ) !ğ
pdFALSE
 )

980 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

982 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

986 
	`mtCOVERAGE_TEST_MARKER
();

991 
	`mtCOVERAGE_TEST_MARKER
();

996 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

998 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

1002 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

1004 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

1008 
	`mtCOVERAGE_TEST_MARKER
();

1013 
	`mtCOVERAGE_TEST_MARKER
();

1018 
	`mtCOVERAGE_TEST_MARKER
();

1024 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

1026 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

1030 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

1032 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

1036 
	`mtCOVERAGE_TEST_MARKER
();

1041 
	`mtCOVERAGE_TEST_MARKER
();

1046 
	`mtCOVERAGE_TEST_MARKER
();

1055 
pxQueue
->
cTxLock
 = ( 
št8_t
 ) ( cTxLock + 1 );

1058 
xR‘uº
 = 
pdPASS
;

1062 
	`ŒaûQUEUE_SEND_FROM_ISR_FAILED
Ğ
pxQueue
 );

1063 
xR‘uº
 = 
”rQUEUE_FULL
;

1066 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

1068  
xR‘uº
;

1069 
	}
}

1072 
Ba£Ty³_t
 
	$xQueueGiveFromISR
Ğ
QueueHªdË_t
 
xQueue
, 
Ba£Ty³_t
 * cÚ¡ 
pxHigh”PriÜ™yTaskWok’
 )

1074 
Ba£Ty³_t
 
xR‘uº
;

1075 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

1076 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

1084 
	`cÚfigASSERT
Ğ
pxQueue
 );

1088 
	`cÚfigASSERT
Ğ
pxQueue
->
uxI‹mSize
 == 0 );

1093 
	`cÚfigASSERT
Ğ!ĞĞ
pxQueue
->
uxQueueTy³
 =ğ
queueQUEUE_IS_MUTEX
 ) && (…xQueue->
pxMu‹xHŞd”
 !ğ
NULL
 ) ) );

1109 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

1111 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

1113 cÚ¡ 
UBa£Ty³_t
 
uxMes§gesWa™šg
 = 
pxQueue
->uxMessagesWaiting;

1118 ifĞ
uxMes§gesWa™šg
 < 
pxQueue
->
uxL’gth
 )

1120 cÚ¡ 
št8_t
 
cTxLock
 = 
pxQueue
->cTxLock;

1122 
	`ŒaûQUEUE_SEND_FROM_ISR
Ğ
pxQueue
 );

1130 
pxQueue
->
uxMes§gesWa™šg
 = uxMessagesWaiting + 1;

1134 ifĞ
cTxLock
 =ğ
queueUNLOCKED
 )

1136 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

1138 ifĞ
pxQueue
->
pxQueueS‘CÚš”
 !ğ
NULL
 )

1140 ifĞ
	`´vNÙifyQueueS‘CÚš”
Ğ
pxQueue
, 
queueSEND_TO_BACK
 ) !ğ
pdFALSE
 )

1145 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

1147 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

1151 
	`mtCOVERAGE_TEST_MARKER
();

1156 
	`mtCOVERAGE_TEST_MARKER
();

1161 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

1163 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

1167 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

1169 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

1173 
	`mtCOVERAGE_TEST_MARKER
();

1178 
	`mtCOVERAGE_TEST_MARKER
();

1183 
	`mtCOVERAGE_TEST_MARKER
();

1189 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

1191 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

1195 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

1197 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

1201 
	`mtCOVERAGE_TEST_MARKER
();

1206 
	`mtCOVERAGE_TEST_MARKER
();

1211 
	`mtCOVERAGE_TEST_MARKER
();

1220 
pxQueue
->
cTxLock
 = ( 
št8_t
 ) ( cTxLock + 1 );

1223 
xR‘uº
 = 
pdPASS
;

1227 
	`ŒaûQUEUE_SEND_FROM_ISR_FAILED
Ğ
pxQueue
 );

1228 
xR‘uº
 = 
”rQUEUE_FULL
;

1231 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

1233  
xR‘uº
;

1234 
	}
}

1237 
Ba£Ty³_t
 
	$xQueueG’”icReûive
Ğ
QueueHªdË_t
 
xQueue
, * cÚ¡ 
pvBufãr
, 
TickTy³_t
 
xTicksToWa™
, cÚ¡ 
Ba£Ty³_t
 
xJu¡P“kšg
 )

1239 
Ba£Ty³_t
 
xEÁryTimeS‘
 = 
pdFALSE
;

1240 
TimeOut_t
 
xTimeOut
;

1241 
št8_t
 *
pcOrigš®R—dPos™iÚ
;

1242 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

1244 
	`cÚfigASSERT
Ğ
pxQueue
 );

1245 
	`cÚfigASSERT
Ğ!ĞĞ
pvBufãr
 =ğ
NULL
 ) && ( 
pxQueue
->
uxI‹mSize
 !ğĞ
UBa£Ty³_t
 ) 0U ) ) );

1246 #iàĞĞ
INCLUDE_xTaskG‘ScheduËrS‹
 =ğ1 ) || ( 
cÚfigUSE_TIMERS
 == 1 ) )

1248 
	`cÚfigASSERT
Ğ!ĞĞ
	`xTaskG‘ScheduËrS‹
(è=ğ
skSCHEDULER_SUSPENDED
 ) && ( 
xTicksToWa™
 != 0 ) ) );

1258 
	`skENTER_CRITICAL
();

1260 cÚ¡ 
UBa£Ty³_t
 
uxMes§gesWa™šg
 = 
pxQueue
->uxMessagesWaiting;

1264 ifĞ
uxMes§gesWa™šg
 > ( 
UBa£Ty³_t
 ) 0 )

1268 
pcOrigš®R—dPos™iÚ
 = 
pxQueue
->
u
.
pcR—dFrom
;

1270 
	`´vCİyD©aFromQueue
Ğ
pxQueue
, 
pvBufãr
 );

1272 ifĞ
xJu¡P“kšg
 =ğ
pdFALSE
 )

1274 
	`ŒaûQUEUE_RECEIVE
Ğ
pxQueue
 );

1277 
pxQueue
->
uxMes§gesWa™šg
 = uxMessagesWaiting - 1;

1279 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

1281 ifĞ
pxQueue
->
uxQueueTy³
 =ğ
queueQUEUE_IS_MUTEX
 )

1285 
pxQueue
->
pxMu‹xHŞd”
 = ( 
št8_t
 * ) 
	`pvTaskInüem’tMu‹xH–dCouÁ
();

1289 
	`mtCOVERAGE_TEST_MARKER
();

1294 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) =ğ
pdFALSE
 )

1296 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) !ğ
pdFALSE
 )

1298 
	`queueYIELD_IF_USING_PREEMPTION
();

1302 
	`mtCOVERAGE_TEST_MARKER
();

1307 
	`mtCOVERAGE_TEST_MARKER
();

1312 
	`ŒaûQUEUE_PEEK
Ğ
pxQueue
 );

1316 
pxQueue
->
u
.
pcR—dFrom
 = 
pcOrigš®R—dPos™iÚ
;

1320 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

1322 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

1325 
	`queueYIELD_IF_USING_PREEMPTION
();

1329 
	`mtCOVERAGE_TEST_MARKER
();

1334 
	`mtCOVERAGE_TEST_MARKER
();

1338 
	`skEXIT_CRITICAL
();

1339  
pdPASS
;

1343 ifĞ
xTicksToWa™
 =ğĞ
TickTy³_t
 ) 0 )

1347 
	`skEXIT_CRITICAL
();

1348 
	`ŒaûQUEUE_RECEIVE_FAILED
Ğ
pxQueue
 );

1349  
”rQUEUE_EMPTY
;

1351 ifĞ
xEÁryTimeS‘
 =ğ
pdFALSE
 )

1355 
	`vTaskS‘TimeOutS‹
Ğ&
xTimeOut
 );

1356 
xEÁryTimeS‘
 = 
pdTRUE
;

1361 
	`mtCOVERAGE_TEST_MARKER
();

1365 
	`skEXIT_CRITICAL
();

1370 
	`vTaskSu¥’dAÎ
();

1371 
	`´vLockQueue
Ğ
pxQueue
 );

1374 ifĞ
	`xTaskCheckFÜTimeOut
Ğ&
xTimeOut
, &
xTicksToWa™
 ) =ğ
pdFALSE
 )

1376 ifĞ
	`´vIsQueueEm±y
Ğ
pxQueue
 ) !ğ
pdFALSE
 )

1378 
	`ŒaûBLOCKING_ON_QUEUE_RECEIVE
Ğ
pxQueue
 );

1380 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

1382 ifĞ
pxQueue
->
uxQueueTy³
 =ğ
queueQUEUE_IS_MUTEX
 )

1384 
	`skENTER_CRITICAL
();

1386 
	`vTaskPriÜ™yInh”™
ĞĞ* ) 
pxQueue
->
pxMu‹xHŞd”
 );

1388 
	`skEXIT_CRITICAL
();

1392 
	`mtCOVERAGE_TEST_MARKER
();

1397 
	`vTaskPÏûOnEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ), 
xTicksToWa™
 );

1398 
	`´vUÆockQueue
Ğ
pxQueue
 );

1399 ifĞ
	`xTaskResumeAÎ
(è=ğ
pdFALSE
 )

1401 
	`pÜtYIELD_WITHIN_API
();

1405 
	`mtCOVERAGE_TEST_MARKER
();

1411 
	`´vUÆockQueue
Ğ
pxQueue
 );

1412 Ğè
	`xTaskResumeAÎ
();

1417 
	`´vUÆockQueue
Ğ
pxQueue
 );

1418 Ğè
	`xTaskResumeAÎ
();

1420 ifĞ
	`´vIsQueueEm±y
Ğ
pxQueue
 ) !ğ
pdFALSE
 )

1422 
	`ŒaûQUEUE_RECEIVE_FAILED
Ğ
pxQueue
 );

1423  
”rQUEUE_EMPTY
;

1427 
	`mtCOVERAGE_TEST_MARKER
();

1431 
	}
}

1434 
Ba£Ty³_t
 
	$xQueueReûiveFromISR
Ğ
QueueHªdË_t
 
xQueue
, * cÚ¡ 
pvBufãr
, 
Ba£Ty³_t
 * cÚ¡ 
pxHigh”PriÜ™yTaskWok’
 )

1436 
Ba£Ty³_t
 
xR‘uº
;

1437 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

1438 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

1440 
	`cÚfigASSERT
Ğ
pxQueue
 );

1441 
	`cÚfigASSERT
Ğ!ĞĞ
pvBufãr
 =ğ
NULL
 ) && ( 
pxQueue
->
uxI‹mSize
 !ğĞ
UBa£Ty³_t
 ) 0U ) ) );

1457 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

1459 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

1461 cÚ¡ 
UBa£Ty³_t
 
uxMes§gesWa™šg
 = 
pxQueue
->uxMessagesWaiting;

1464 ifĞ
uxMes§gesWa™šg
 > ( 
UBa£Ty³_t
 ) 0 )

1466 cÚ¡ 
št8_t
 
cRxLock
 = 
pxQueue
->cRxLock;

1468 
	`ŒaûQUEUE_RECEIVE_FROM_ISR
Ğ
pxQueue
 );

1470 
	`´vCİyD©aFromQueue
Ğ
pxQueue
, 
pvBufãr
 );

1471 
pxQueue
->
uxMes§gesWa™šg
 = uxMessagesWaiting - 1;

1477 ifĞ
cRxLock
 =ğ
queueUNLOCKED
 )

1479 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) =ğ
pdFALSE
 )

1481 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) !ğ
pdFALSE
 )

1485 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

1487 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

1491 
	`mtCOVERAGE_TEST_MARKER
();

1496 
	`mtCOVERAGE_TEST_MARKER
();

1501 
	`mtCOVERAGE_TEST_MARKER
();

1508 
pxQueue
->
cRxLock
 = ( 
št8_t
 ) ( cRxLock + 1 );

1511 
xR‘uº
 = 
pdPASS
;

1515 
xR‘uº
 = 
pdFAIL
;

1516 
	`ŒaûQUEUE_RECEIVE_FROM_ISR_FAILED
Ğ
pxQueue
 );

1519 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

1521  
xR‘uº
;

1522 
	}
}

1525 
Ba£Ty³_t
 
	$xQueueP“kFromISR
Ğ
QueueHªdË_t
 
xQueue
, * cÚ¡ 
pvBufãr
 )

1527 
Ba£Ty³_t
 
xR‘uº
;

1528 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

1529 
št8_t
 *
pcOrigš®R—dPos™iÚ
;

1530 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

1532 
	`cÚfigASSERT
Ğ
pxQueue
 );

1533 
	`cÚfigASSERT
Ğ!ĞĞ
pvBufãr
 =ğ
NULL
 ) && ( 
pxQueue
->
uxI‹mSize
 !ğĞ
UBa£Ty³_t
 ) 0U ) ) );

1534 
	`cÚfigASSERT
Ğ
pxQueue
->
uxI‹mSize
 != 0 );

1550 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

1552 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

1555 ifĞ
pxQueue
->
uxMes§gesWa™šg
 > ( 
UBa£Ty³_t
 ) 0 )

1557 
	`ŒaûQUEUE_PEEK_FROM_ISR
Ğ
pxQueue
 );

1561 
pcOrigš®R—dPos™iÚ
 = 
pxQueue
->
u
.
pcR—dFrom
;

1562 
	`´vCİyD©aFromQueue
Ğ
pxQueue
, 
pvBufãr
 );

1563 
pxQueue
->
u
.
pcR—dFrom
 = 
pcOrigš®R—dPos™iÚ
;

1565 
xR‘uº
 = 
pdPASS
;

1569 
xR‘uº
 = 
pdFAIL
;

1570 
	`ŒaûQUEUE_PEEK_FROM_ISR_FAILED
Ğ
pxQueue
 );

1573 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

1575  
xR‘uº
;

1576 
	}
}

1579 
UBa£Ty³_t
 
	$uxQueueMes§gesWa™šg
ĞcÚ¡ 
QueueHªdË_t
 
xQueue
 )

1581 
UBa£Ty³_t
 
uxR‘uº
;

1583 
	`cÚfigASSERT
Ğ
xQueue
 );

1585 
	`skENTER_CRITICAL
();

1587 
uxR‘uº
 = ( ( 
Queue_t
 * ) 
xQueue
 )->
uxMes§gesWa™šg
;

1589 
	`skEXIT_CRITICAL
();

1591  
uxR‘uº
;

1592 
	}
}

1595 
UBa£Ty³_t
 
	$uxQueueS·ûsAvaabË
ĞcÚ¡ 
QueueHªdË_t
 
xQueue
 )

1597 
UBa£Ty³_t
 
uxR‘uº
;

1598 
Queue_t
 *
pxQueue
;

1600 
pxQueue
 = ( 
Queue_t
 * ) 
xQueue
;

1601 
	`cÚfigASSERT
Ğ
pxQueue
 );

1603 
	`skENTER_CRITICAL
();

1605 
uxR‘uº
 = 
pxQueue
->
uxL’gth
 -…xQueue->
uxMes§gesWa™šg
;

1607 
	`skEXIT_CRITICAL
();

1609  
uxR‘uº
;

1610 
	}
}

1613 
UBa£Ty³_t
 
	$uxQueueMes§gesWa™šgFromISR
ĞcÚ¡ 
QueueHªdË_t
 
xQueue
 )

1615 
UBa£Ty³_t
 
uxR‘uº
;

1617 
	`cÚfigASSERT
Ğ
xQueue
 );

1619 
uxR‘uº
 = ( ( 
Queue_t
 * ) 
xQueue
 )->
uxMes§gesWa™šg
;

1621  
uxR‘uº
;

1622 
	}
}

1625 
	$vQueueD–‘e
Ğ
QueueHªdË_t
 
xQueue
 )

1627 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

1629 
	`cÚfigASSERT
Ğ
pxQueue
 );

1630 
	`ŒaûQUEUE_DELETE
Ğ
pxQueue
 );

1632 #iàĞ
cÚfigQUEUE_REGISTRY_SIZE
 > 0 )

1634 
	`vQueueUÄegi¡”Queue
Ğ
pxQueue
 );

1638 #ifĞĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 0 ) )

1642 
	`vPÜtF»e
Ğ
pxQueue
 );

1644 #–ifĞĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 ) )

1648 ifĞ
pxQueue
->
ucStiÿÎyAÎoÿ‹d
 =ğĞ
ušt8_t
 ) 
pdFALSE
 )

1650 
	`vPÜtF»e
Ğ
pxQueue
 );

1654 
	`mtCOVERAGE_TEST_MARKER
();

1661 Ğè
pxQueue
;

1664 
	}
}

1667 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

1669 
UBa£Ty³_t
 
	$uxQueueG‘QueueNumb”
Ğ
QueueHªdË_t
 
xQueue
 )

1671  ( ( 
Queue_t
 * ) 
xQueue
 )->
uxQueueNumb”
;

1672 
	}
}

1677 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

1679 
	$vQueueS‘QueueNumb”
Ğ
QueueHªdË_t
 
xQueue
, 
UBa£Ty³_t
 
uxQueueNumb”
 )

1681 ĞĞ
Queue_t
 * ) 
xQueue
 )->
uxQueueNumb”
 = uxQueueNumber;

1682 
	}
}

1687 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

1689 
ušt8_t
 
	$ucQueueG‘QueueTy³
Ğ
QueueHªdË_t
 
xQueue
 )

1691  ( ( 
Queue_t
 * ) 
xQueue
 )->
ucQueueTy³
;

1692 
	}
}

1697 
Ba£Ty³_t
 
	$´vCİyD©aToQueue
Ğ
Queue_t
 * cÚ¡ 
pxQueue
, cÚ¡ *
pvI‹mToQueue
, cÚ¡ 
Ba£Ty³_t
 
xPos™iÚ
 )

1699 
Ba£Ty³_t
 
xR‘uº
 = 
pdFALSE
;

1700 
UBa£Ty³_t
 
uxMes§gesWa™šg
;

1704 
uxMes§gesWa™šg
 = 
pxQueue
->uxMessagesWaiting;

1706 ifĞ
pxQueue
->
uxI‹mSize
 =ğĞ
UBa£Ty³_t
 ) 0 )

1708 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

1710 ifĞ
pxQueue
->
uxQueueTy³
 =ğ
queueQUEUE_IS_MUTEX
 )

1713 
xR‘uº
 = 
	`xTaskPriÜ™yDisšh”™
ĞĞ* ) 
pxQueue
->
pxMu‹xHŞd”
 );

1714 
pxQueue
->
pxMu‹xHŞd”
 = 
NULL
;

1718 
	`mtCOVERAGE_TEST_MARKER
();

1723 ifĞ
xPos™iÚ
 =ğ
queueSEND_TO_BACK
 )

1725 Ğè
	`memıy
ĞĞ* ) 
pxQueue
->
pcWr™eTo
, 
pvI‹mToQueue
, ( 
size_t
 )…xQueue->
uxI‹mSize
 );

1726 
pxQueue
->
pcWr™eTo
 +ğpxQueue->
uxI‹mSize
;

1727 ifĞ
pxQueue
->
pcWr™eTo
 >ğpxQueue->
pcTa
 )

1729 
pxQueue
->
pcWr™eTo
 =…xQueue->
pcH—d
;

1733 
	`mtCOVERAGE_TEST_MARKER
();

1738 Ğè
	`memıy
ĞĞ* ) 
pxQueue
->
u
.
pcR—dFrom
, 
pvI‹mToQueue
, ( 
size_t
 )…xQueue->
uxI‹mSize
 );

1739 
pxQueue
->
u
.
pcR—dFrom
 -ğpxQueue->
uxI‹mSize
;

1740 ifĞ
pxQueue
->
u
.
pcR—dFrom
 <…xQueue->
pcH—d
 )

1742 
pxQueue
->
u
.
pcR—dFrom
 = (…xQueue->
pcTa
 -…xQueue->
uxI‹mSize
 );

1746 
	`mtCOVERAGE_TEST_MARKER
();

1749 ifĞ
xPos™iÚ
 =ğ
queueOVERWRITE
 )

1751 ifĞ
uxMes§gesWa™šg
 > ( 
UBa£Ty³_t
 ) 0 )

1757 --
uxMes§gesWa™šg
;

1761 
	`mtCOVERAGE_TEST_MARKER
();

1766 
	`mtCOVERAGE_TEST_MARKER
();

1770 
pxQueue
->
uxMes§gesWa™šg
 = uxMessagesWaiting + 1;

1772  
xR‘uº
;

1773 
	}
}

1776 
	$´vCİyD©aFromQueue
Ğ
Queue_t
 * cÚ¡ 
pxQueue
, * cÚ¡ 
pvBufãr
 )

1778 ifĞ
pxQueue
->
uxI‹mSize
 !ğĞ
UBa£Ty³_t
 ) 0 )

1780 
pxQueue
->
u
.
pcR—dFrom
 +ğpxQueue->
uxI‹mSize
;

1781 ifĞ
pxQueue
->
u
.
pcR—dFrom
 >ğpxQueue->
pcTa
 )

1783 
pxQueue
->
u
.
pcR—dFrom
 =…xQueue->
pcH—d
;

1787 
	`mtCOVERAGE_TEST_MARKER
();

1789 Ğè
	`memıy
ĞĞ* ) 
pvBufãr
, ( * ) 
pxQueue
->
u
.
pcR—dFrom
, ( 
size_t
 )…xQueue->
uxI‹mSize
 );

1791 
	}
}

1794 
	$´vUÆockQueue
Ğ
Queue_t
 * cÚ¡ 
pxQueue
 )

1802 
	`skENTER_CRITICAL
();

1804 
št8_t
 
cTxLock
 = 
pxQueue
->cTxLock;

1807  
cTxLock
 > 
queueLOCKED_UNMODIFIED
 )

1811 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

1813 ifĞ
pxQueue
->
pxQueueS‘CÚš”
 !ğ
NULL
 )

1815 ifĞ
	`´vNÙifyQueueS‘CÚš”
Ğ
pxQueue
, 
queueSEND_TO_BACK
 ) !ğ
pdFALSE
 )

1820 
	`vTaskMis£dY›ld
();

1824 
	`mtCOVERAGE_TEST_MARKER
();

1832 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

1834 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

1838 
	`vTaskMis£dY›ld
();

1842 
	`mtCOVERAGE_TEST_MARKER
();

1855 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

1857 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

1861 
	`vTaskMis£dY›ld
();

1865 
	`mtCOVERAGE_TEST_MARKER
();

1875 --
cTxLock
;

1878 
pxQueue
->
cTxLock
 = 
queueUNLOCKED
;

1880 
	`skEXIT_CRITICAL
();

1883 
	`skENTER_CRITICAL
();

1885 
št8_t
 
cRxLock
 = 
pxQueue
->cRxLock;

1887  
cRxLock
 > 
queueLOCKED_UNMODIFIED
 )

1889 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) =ğ
pdFALSE
 )

1891 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) !ğ
pdFALSE
 )

1893 
	`vTaskMis£dY›ld
();

1897 
	`mtCOVERAGE_TEST_MARKER
();

1900 --
cRxLock
;

1908 
pxQueue
->
cRxLock
 = 
queueUNLOCKED
;

1910 
	`skEXIT_CRITICAL
();

1911 
	}
}

1914 
Ba£Ty³_t
 
	$´vIsQueueEm±y
ĞcÚ¡ 
Queue_t
 *
pxQueue
 )

1916 
Ba£Ty³_t
 
xR‘uº
;

1918 
	`skENTER_CRITICAL
();

1920 ifĞ
pxQueue
->
uxMes§gesWa™šg
 =ğĞ
UBa£Ty³_t
 ) 0 )

1922 
xR‘uº
 = 
pdTRUE
;

1926 
xR‘uº
 = 
pdFALSE
;

1929 
	`skEXIT_CRITICAL
();

1931  
xR‘uº
;

1932 
	}
}

1935 
Ba£Ty³_t
 
	$xQueueIsQueueEm±yFromISR
ĞcÚ¡ 
QueueHªdË_t
 
xQueue
 )

1937 
Ba£Ty³_t
 
xR‘uº
;

1939 
	`cÚfigASSERT
Ğ
xQueue
 );

1940 ifĞĞĞ
Queue_t
 * ) 
xQueue
 )->
uxMes§gesWa™šg
 =ğĞ
UBa£Ty³_t
 ) 0 )

1942 
xR‘uº
 = 
pdTRUE
;

1946 
xR‘uº
 = 
pdFALSE
;

1949  
xR‘uº
;

1950 
	}
}

1953 
Ba£Ty³_t
 
	$´vIsQueueFuÎ
ĞcÚ¡ 
Queue_t
 *
pxQueue
 )

1955 
Ba£Ty³_t
 
xR‘uº
;

1957 
	`skENTER_CRITICAL
();

1959 ifĞ
pxQueue
->
uxMes§gesWa™šg
 =ğpxQueue->
uxL’gth
 )

1961 
xR‘uº
 = 
pdTRUE
;

1965 
xR‘uº
 = 
pdFALSE
;

1968 
	`skEXIT_CRITICAL
();

1970  
xR‘uº
;

1971 
	}
}

1974 
Ba£Ty³_t
 
	$xQueueIsQueueFuÎFromISR
ĞcÚ¡ 
QueueHªdË_t
 
xQueue
 )

1976 
Ba£Ty³_t
 
xR‘uº
;

1978 
	`cÚfigASSERT
Ğ
xQueue
 );

1979 ifĞĞĞ
Queue_t
 * ) 
xQueue
 )->
uxMes§gesWa™šg
 =ğĞĞQueue_ˆ* ) xQueu)->
uxL’gth
 )

1981 
xR‘uº
 = 
pdTRUE
;

1985 
xR‘uº
 = 
pdFALSE
;

1988  
xR‘uº
;

1989 
	}
}

1992 #iàĞ
cÚfigUSE_CO_ROUTINES
 == 1 )

1994 
Ba£Ty³_t
 
	$xQueueCRS’d
Ğ
QueueHªdË_t
 
xQueue
, cÚ¡ *
pvI‹mToQueue
, 
TickTy³_t
 
xTicksToWa™
 )

1996 
Ba£Ty³_t
 
xR‘uº
;

1997 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

2002 
	`pÜtDISABLE_INTERRUPTS
();

2004 ifĞ
	`´vIsQueueFuÎ
Ğ
pxQueue
 ) !ğ
pdFALSE
 )

2008 ifĞ
xTicksToWa™
 > ( 
TickTy³_t
 ) 0 )

2012 
	`vCoRoutšeAddToD–ayedLi¡
Ğ
xTicksToWa™
, &Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) );

2013 
	`pÜtENABLE_INTERRUPTS
();

2014  
”rQUEUE_BLOCKED
;

2018 
	`pÜtENABLE_INTERRUPTS
();

2019  
”rQUEUE_FULL
;

2023 
	`pÜtENABLE_INTERRUPTS
();

2025 
	`pÜtDISABLE_INTERRUPTS
();

2027 ifĞ
pxQueue
->
uxMes§gesWa™šg
 <…xQueue->
uxL’gth
 )

2030 
	`´vCİyD©aToQueue
Ğ
pxQueue
, 
pvI‹mToQueue
, 
queueSEND_TO_BACK
 );

2031 
xR‘uº
 = 
pdPASS
;

2034 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

2040 ifĞ
	`xCoRoutšeRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

2044 
xR‘uº
 = 
”rQUEUE_YIELD
;

2048 
	`mtCOVERAGE_TEST_MARKER
();

2053 
	`mtCOVERAGE_TEST_MARKER
();

2058 
xR‘uº
 = 
”rQUEUE_FULL
;

2061 
	`pÜtENABLE_INTERRUPTS
();

2063  
xR‘uº
;

2064 
	}
}

2069 #iàĞ
cÚfigUSE_CO_ROUTINES
 == 1 )

2071 
Ba£Ty³_t
 
	$xQueueCRReûive
Ğ
QueueHªdË_t
 
xQueue
, *
pvBufãr
, 
TickTy³_t
 
xTicksToWa™
 )

2073 
Ba£Ty³_t
 
xR‘uº
;

2074 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

2079 
	`pÜtDISABLE_INTERRUPTS
();

2081 ifĞ
pxQueue
->
uxMes§gesWa™šg
 =ğĞ
UBa£Ty³_t
 ) 0 )

2085 ifĞ
xTicksToWa™
 > ( 
TickTy³_t
 ) 0 )

2089 
	`vCoRoutšeAddToD–ayedLi¡
Ğ
xTicksToWa™
, &Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) );

2090 
	`pÜtENABLE_INTERRUPTS
();

2091  
”rQUEUE_BLOCKED
;

2095 
	`pÜtENABLE_INTERRUPTS
();

2096  
”rQUEUE_FULL
;

2101 
	`mtCOVERAGE_TEST_MARKER
();

2104 
	`pÜtENABLE_INTERRUPTS
();

2106 
	`pÜtDISABLE_INTERRUPTS
();

2108 ifĞ
pxQueue
->
uxMes§gesWa™šg
 > ( 
UBa£Ty³_t
 ) 0 )

2111 
pxQueue
->
u
.
pcR—dFrom
 +ğpxQueue->
uxI‹mSize
;

2112 ifĞ
pxQueue
->
u
.
pcR—dFrom
 >ğpxQueue->
pcTa
 )

2114 
pxQueue
->
u
.
pcR—dFrom
 =…xQueue->
pcH—d
;

2118 
	`mtCOVERAGE_TEST_MARKER
();

2120 --Ğ
pxQueue
->
uxMes§gesWa™šg
 );

2121 Ğè
	`memıy
ĞĞ* ) 
pvBufãr
, ( * ) 
pxQueue
->
u
.
pcR—dFrom
, ( èpxQueue->
uxI‹mSize
 );

2123 
xR‘uº
 = 
pdPASS
;

2126 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) =ğ
pdFALSE
 )

2132 ifĞ
	`xCoRoutšeRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) !ğ
pdFALSE
 )

2134 
xR‘uº
 = 
”rQUEUE_YIELD
;

2138 
	`mtCOVERAGE_TEST_MARKER
();

2143 
	`mtCOVERAGE_TEST_MARKER
();

2148 
xR‘uº
 = 
pdFAIL
;

2151 
	`pÜtENABLE_INTERRUPTS
();

2153  
xR‘uº
;

2154 
	}
}

2159 #iàĞ
cÚfigUSE_CO_ROUTINES
 == 1 )

2161 
Ba£Ty³_t
 
	$xQueueCRS’dFromISR
Ğ
QueueHªdË_t
 
xQueue
, cÚ¡ *
pvI‹mToQueue
, 
Ba£Ty³_t
 
xCoRoutšeP»viou¦yWok’
 )

2163 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

2167 ifĞ
pxQueue
->
uxMes§gesWa™šg
 <…xQueue->
uxL’gth
 )

2169 
	`´vCİyD©aToQueue
Ğ
pxQueue
, 
pvI‹mToQueue
, 
queueSEND_TO_BACK
 );

2173 ifĞ
xCoRoutšeP»viou¦yWok’
 =ğ
pdFALSE
 )

2175 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

2177 ifĞ
	`xCoRoutšeRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

2179  
pdTRUE
;

2183 
	`mtCOVERAGE_TEST_MARKER
();

2188 
	`mtCOVERAGE_TEST_MARKER
();

2193 
	`mtCOVERAGE_TEST_MARKER
();

2198 
	`mtCOVERAGE_TEST_MARKER
();

2201  
xCoRoutšeP»viou¦yWok’
;

2202 
	}
}

2207 #iàĞ
cÚfigUSE_CO_ROUTINES
 == 1 )

2209 
Ba£Ty³_t
 
	$xQueueCRReûiveFromISR
Ğ
QueueHªdË_t
 
xQueue
, *
pvBufãr
, 
Ba£Ty³_t
 *
pxCoRoutšeWok’
 )

2211 
Ba£Ty³_t
 
xR‘uº
;

2212 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

2216 ifĞ
pxQueue
->
uxMes§gesWa™šg
 > ( 
UBa£Ty³_t
 ) 0 )

2219 
pxQueue
->
u
.
pcR—dFrom
 +ğpxQueue->
uxI‹mSize
;

2220 ifĞ
pxQueue
->
u
.
pcR—dFrom
 >ğpxQueue->
pcTa
 )

2222 
pxQueue
->
u
.
pcR—dFrom
 =…xQueue->
pcH—d
;

2226 
	`mtCOVERAGE_TEST_MARKER
();

2228 --Ğ
pxQueue
->
uxMes§gesWa™šg
 );

2229 Ğè
	`memıy
ĞĞ* ) 
pvBufãr
, ( * ) 
pxQueue
->
u
.
pcR—dFrom
, ( èpxQueue->
uxI‹mSize
 );

2231 ifĞĞ*
pxCoRoutšeWok’
 ) =ğ
pdFALSE
 )

2233 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) =ğ
pdFALSE
 )

2235 ifĞ
	`xCoRoutšeRemoveFromEv’tLi¡
Ğ&Ğ
pxQueue
->
xTasksWa™šgToS’d
 ) ) !ğ
pdFALSE
 )

2237 *
pxCoRoutšeWok’
 = 
pdTRUE
;

2241 
	`mtCOVERAGE_TEST_MARKER
();

2246 
	`mtCOVERAGE_TEST_MARKER
();

2251 
	`mtCOVERAGE_TEST_MARKER
();

2254 
xR‘uº
 = 
pdPASS
;

2258 
xR‘uº
 = 
pdFAIL
;

2261  
xR‘uº
;

2262 
	}
}

2267 #iàĞ
cÚfigQUEUE_REGISTRY_SIZE
 > 0 )

2269 
	$vQueueAddToRegi¡ry
Ğ
QueueHªdË_t
 
xQueue
, cÚ¡ *
pcQueueName
 )

2271 
UBa£Ty³_t
 
ux
;

2275  
ux
 = ( 
UBa£Ty³_t
 ) 0U; ux < ( UBa£Ty³_ˆè
cÚfigQUEUE_REGISTRY_SIZE
; ux++ )

2277 ifĞ
xQueueRegi¡ry
[ 
ux
 ].
pcQueueName
 =ğ
NULL
 )

2280 
xQueueRegi¡ry
[ 
ux
 ].
pcQueueName
 =…cQueueName;

2281 
xQueueRegi¡ry
[ 
ux
 ].
xHªdË
 = 
xQueue
;

2283 
	`ŒaûQUEUE_REGISTRY_ADD
Ğ
xQueue
, 
pcQueueName
 );

2288 
	`mtCOVERAGE_TEST_MARKER
();

2291 
	}
}

2296 #iàĞ
cÚfigQUEUE_REGISTRY_SIZE
 > 0 )

2298 cÚ¡ *
	$pcQueueG‘Name
Ğ
QueueHªdË_t
 
xQueue
 )

2300 
UBa£Ty³_t
 
ux
;

2301 cÚ¡ *
pcR‘uº
 = 
NULL
;

2305  
ux
 = ( 
UBa£Ty³_t
 ) 0U; ux < ( UBa£Ty³_ˆè
cÚfigQUEUE_REGISTRY_SIZE
; ux++ )

2307 ifĞ
xQueueRegi¡ry
[ 
ux
 ].
xHªdË
 =ğ
xQueue
 )

2309 
pcR‘uº
 = 
xQueueRegi¡ry
[ 
ux
 ].
pcQueueName
;

2314 
	`mtCOVERAGE_TEST_MARKER
();

2318  
pcR‘uº
;

2319 
	}
}

2324 #iàĞ
cÚfigQUEUE_REGISTRY_SIZE
 > 0 )

2326 
	$vQueueUÄegi¡”Queue
Ğ
QueueHªdË_t
 
xQueue
 )

2328 
UBa£Ty³_t
 
ux
;

2332  
ux
 = ( 
UBa£Ty³_t
 ) 0U; ux < ( UBa£Ty³_ˆè
cÚfigQUEUE_REGISTRY_SIZE
; ux++ )

2334 ifĞ
xQueueRegi¡ry
[ 
ux
 ].
xHªdË
 =ğ
xQueue
 )

2337 
xQueueRegi¡ry
[ 
ux
 ].
pcQueueName
 = 
NULL
;

2342 
xQueueRegi¡ry
[ 
ux
 ].
xHªdË
 = ( 
QueueHªdË_t
 ) 0;

2347 
	`mtCOVERAGE_TEST_MARKER
();

2351 
	}
}

2356 #iàĞ
cÚfigUSE_TIMERS
 == 1 )

2358 
	$vQueueWa™FÜMes§geRe¡riùed
Ğ
QueueHªdË_t
 
xQueue
, 
TickTy³_t
 
xTicksToWa™
, cÚ¡ 
Ba£Ty³_t
 
xWa™Indefš™–y
 )

2360 
Queue_t
 * cÚ¡ 
pxQueue
 = ( Queue_ˆ* ) 
xQueue
;

2376 
	`´vLockQueue
Ğ
pxQueue
 );

2377 ifĞ
pxQueue
->
uxMes§gesWa™šg
 =ğĞ
UBa£Ty³_t
 ) 0U )

2380 
	`vTaskPÏûOnEv’tLi¡Re¡riùed
Ğ&Ğ
pxQueue
->
xTasksWa™šgToReûive
 ), 
xTicksToWa™
, 
xWa™Indefš™–y
 );

2384 
	`mtCOVERAGE_TEST_MARKER
();

2386 
	`´vUÆockQueue
Ğ
pxQueue
 );

2387 
	}
}

2392 #ifĞĞ
cÚfigUSE_QUEUE_SETS
 =ğ1 ) && ( 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 ) )

2394 
QueueS‘HªdË_t
 
	$xQueueC»©eS‘
ĞcÚ¡ 
UBa£Ty³_t
 
uxEv’tQueueL’gth
 )

2396 
QueueS‘HªdË_t
 
pxQueue
;

2398 
pxQueue
 = 
	`xQueueG’”icC»©e
Ğ
uxEv’tQueueL’gth
, Ğ
Queue_t
 * ), 
queueQUEUE_TYPE_SET
 );

2400  
pxQueue
;

2401 
	}
}

2406 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

2408 
Ba£Ty³_t
 
	$xQueueAddToS‘
Ğ
QueueS‘Memb”HªdË_t
 
xQueueOrSem­hÜe
, 
QueueS‘HªdË_t
 
xQueueS‘
 )

2410 
Ba£Ty³_t
 
xR‘uº
;

2412 
	`skENTER_CRITICAL
();

2414 ifĞĞĞ
Queue_t
 * ) 
xQueueOrSem­hÜe
 )->
pxQueueS‘CÚš”
 !ğ
NULL
 )

2417 
xR‘uº
 = 
pdFAIL
;

2419 ifĞĞĞ
Queue_t
 * ) 
xQueueOrSem­hÜe
 )->
uxMes§gesWa™šg
 !ğĞ
UBa£Ty³_t
 ) 0 )

2423 
xR‘uº
 = 
pdFAIL
;

2427 ĞĞ
Queue_t
 * ) 
xQueueOrSem­hÜe
 )->
pxQueueS‘CÚš”
 = 
xQueueS‘
;

2428 
xR‘uº
 = 
pdPASS
;

2431 
	`skEXIT_CRITICAL
();

2433  
xR‘uº
;

2434 
	}
}

2439 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

2441 
Ba£Ty³_t
 
	$xQueueRemoveFromS‘
Ğ
QueueS‘Memb”HªdË_t
 
xQueueOrSem­hÜe
, 
QueueS‘HªdË_t
 
xQueueS‘
 )

2443 
Ba£Ty³_t
 
xR‘uº
;

2444 
Queue_t
 * cÚ¡ 
pxQueueOrSem­hÜe
 = ( Queue_ˆ* ) 
xQueueOrSem­hÜe
;

2446 ifĞ
pxQueueOrSem­hÜe
->
pxQueueS‘CÚš”
 !ğ
xQueueS‘
 )

2449 
xR‘uº
 = 
pdFAIL
;

2451 ifĞ
pxQueueOrSem­hÜe
->
uxMes§gesWa™šg
 !ğĞ
UBa£Ty³_t
 ) 0 )

2456 
xR‘uº
 = 
pdFAIL
;

2460 
	`skENTER_CRITICAL
();

2463 
pxQueueOrSem­hÜe
->
pxQueueS‘CÚš”
 = 
NULL
;

2465 
	`skEXIT_CRITICAL
();

2466 
xR‘uº
 = 
pdPASS
;

2469  
xR‘uº
;

2470 
	}
}

2475 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

2477 
QueueS‘Memb”HªdË_t
 
	$xQueueS–eùFromS‘
Ğ
QueueS‘HªdË_t
 
xQueueS‘
, 
TickTy³_t
 cÚ¡ 
xTicksToWa™
 )

2479 
QueueS‘Memb”HªdË_t
 
xR‘uº
 = 
NULL
;

2481 Ğè
	`xQueueG’”icReûive
ĞĞ
QueueHªdË_t
 ) 
xQueueS‘
, &
xR‘uº
, 
xTicksToWa™
, 
pdFALSE
 );

2482  
xR‘uº
;

2483 
	}
}

2488 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

2490 
QueueS‘Memb”HªdË_t
 
	$xQueueS–eùFromS‘FromISR
Ğ
QueueS‘HªdË_t
 
xQueueS‘
 )

2492 
QueueS‘Memb”HªdË_t
 
xR‘uº
 = 
NULL
;

2494 Ğè
	`xQueueReûiveFromISR
ĞĞ
QueueHªdË_t
 ) 
xQueueS‘
, &
xR‘uº
, 
NULL
 );

2495  
xR‘uº
;

2496 
	}
}

2501 #iàĞ
cÚfigUSE_QUEUE_SETS
 == 1 )

2503 
Ba£Ty³_t
 
	$´vNÙifyQueueS‘CÚš”
ĞcÚ¡ 
Queue_t
 * cÚ¡ 
pxQueue
, cÚ¡ 
Ba£Ty³_t
 
xCİyPos™iÚ
 )

2505 
Queue_t
 *
pxQueueS‘CÚš”
 = 
pxQueue
->pxQueueSetContainer;

2506 
Ba£Ty³_t
 
xR‘uº
 = 
pdFALSE
;

2510 
	`cÚfigASSERT
Ğ
pxQueueS‘CÚš”
 );

2511 
	`cÚfigASSERT
Ğ
pxQueueS‘CÚš”
->
uxMes§gesWa™šg
 <…xQueueS‘CÚš”->
uxL’gth
 );

2513 ifĞ
pxQueueS‘CÚš”
->
uxMes§gesWa™šg
 <…xQueueS‘CÚš”->
uxL’gth
 )

2515 cÚ¡ 
št8_t
 
cTxLock
 = 
pxQueueS‘CÚš”
->cTxLock;

2517 
	`ŒaûQUEUE_SEND
Ğ
pxQueueS‘CÚš”
 );

2520 
xR‘uº
 = 
	`´vCİyD©aToQueue
Ğ
pxQueueS‘CÚš”
, &
pxQueue
, 
xCİyPos™iÚ
 );

2522 ifĞ
cTxLock
 =ğ
queueUNLOCKED
 )

2524 ifĞ
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxQueueS‘CÚš”
->
xTasksWa™šgToReûive
 ) ) =ğ
pdFALSE
 )

2526 ifĞ
	`xTaskRemoveFromEv’tLi¡
Ğ&Ğ
pxQueueS‘CÚš”
->
xTasksWa™šgToReûive
 ) ) !ğ
pdFALSE
 )

2529 
xR‘uº
 = 
pdTRUE
;

2533 
	`mtCOVERAGE_TEST_MARKER
();

2538 
	`mtCOVERAGE_TEST_MARKER
();

2543 
pxQueueS‘CÚš”
->
cTxLock
 = ( 
št8_t
 ) ( cTxLock + 1 );

2548 
	`mtCOVERAGE_TEST_MARKER
();

2551  
xR‘uº
;

2552 
	}
}

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\tasks.c

71 
	~<¡dlib.h
>

72 
	~<¡ršg.h
>

77 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

80 
	~"F»eRTOS.h
"

81 
	~"sk.h
"

82 
	~"tim”s.h
"

83 
	~"SckMaüos.h
"

89 #undeà
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


93 #iàĞ
cÚfigUSE_STATS_FORMATTING_FUNCTIONS
 == 1 )

98 
	~<¡dio.h
>

101 #ifĞ
cÚfigUSE_PREEMPTION
 == 0 )

104 
	#skYIELD_IF_USING_PREEMPTION
()

	)

106 
	#skYIELD_IF_USING_PREEMPTION
(è
	`pÜtYIELD_WITHIN_API
()

	)

110 
	#skNOT_WAITING_NOTIFICATION
 ( ( 
ušt8_t
 ) 0 )

	)

111 
	#skWAITING_NOTIFICATION
 ( ( 
ušt8_t
 ) 1 )

	)

112 
	#skNOTIFICATION_RECEIVED
 ( ( 
ušt8_t
 ) 2 )

	)

118 
	#tskSTACK_FILL_BYTE
 ( 0xa5U )

	)

135 
	#tskSTATIC_AND_DYNAMIC_ALLOCATION_POSSIBLE
 ( ( ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) ) || ( 
pÜtUSING_MPU_WRAPPERS
 =ğ1 ) )

	)

136 
	#tskDYNAMICALLY_ALLOCATED_STACK_AND_TCB
 ( ( 
ušt8_t
 ) 0 )

	)

137 
	#tskSTATICALLY_ALLOCATED_STACK_ONLY
 ( ( 
ušt8_t
 ) 1 )

	)

138 
	#tskSTATICALLY_ALLOCATED_STACK_AND_TCB
 ( ( 
ušt8_t
 ) 2 )

	)

143 
	#tskBLOCKED_CHAR
 ( 'B' )

	)

144 
	#tskREADY_CHAR
 ( 'R' )

	)

145 
	#tskDELETED_CHAR
 ( 'D' )

	)

146 
	#tskSUSPENDED_CHAR
 ( 'S' )

	)

152 #ifdeà
pÜtREMOVE_STATIC_QUALIFIER


153 

	)

156 #iàĞ
cÚfigUSE_PORT_OPTIMISED_TASK_SELECTION
 == 0 )

164 
	#skRECORD_READY_PRIORITY
Ğ
uxPriÜ™y
 ) \

166 ifĞĞ
uxPriÜ™y
 ) > 
uxTİR—dyPriÜ™y
 ) \

168 
uxTİR—dyPriÜ™y
 = ( 
uxPriÜ™y
 ); \

170 }

	)

174 
	#skSELECT_HIGHEST_PRIORITY_TASK
() \

176 
UBa£Ty³_t
 
uxTİPriÜ™y
 = 
uxTİR—dyPriÜ™y
; \

179  
	`li¡LIST_IS_EMPTY
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
uxTİPriÜ™y
 ] ) ) ) \

181 
	`cÚfigASSERT
Ğ
uxTİPriÜ™y
 ); \

182 --
uxTİPriÜ™y
; \

187 
	`li¡GET_OWNER_OF_NEXT_ENTRY
Ğ
pxCu¼’tTCB
, &Ğ
pxR—dyTasksLi¡s
[ 
uxTİPriÜ™y
 ] ) ); \

188 
uxTİR—dyPriÜ™y
 = 
uxTİPriÜ™y
; \

189 }

	)

196 
	#skRESET_READY_PRIORITY
Ğ
uxPriÜ™y
 )

	)

197 
	#pÜtRESET_READY_PRIORITY
Ğ
uxPriÜ™y
, 
uxTİR—dyPriÜ™y
 )

	)

206 
	#skRECORD_READY_PRIORITY
Ğ
uxPriÜ™y
 ) 
	`pÜtRECORD_READY_PRIORITY
ĞuxPriÜ™y, 
uxTİR—dyPriÜ™y
 )

	)

210 
	#skSELECT_HIGHEST_PRIORITY_TASK
() \

212 
UBa£Ty³_t
 
uxTİPriÜ™y
; \

215 
	`pÜtGET_HIGHEST_PRIORITY
Ğ
uxTİPriÜ™y
, 
uxTİR—dyPriÜ™y
 ); \

216 
	`cÚfigASSERT
Ğ
	`li¡CURRENT_LIST_LENGTH
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
uxTİPriÜ™y
 ] ) ) > 0 ); \

217 
	`li¡GET_OWNER_OF_NEXT_ENTRY
Ğ
pxCu¼’tTCB
, &Ğ
pxR—dyTasksLi¡s
[ 
uxTİPriÜ™y
 ] ) ); \

218 }

	)

225 
	#skRESET_READY_PRIORITY
Ğ
uxPriÜ™y
 ) \

227 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ&Ğ
pxR—dyTasksLi¡s
[ ( 
uxPriÜ™y
 ) ] ) ) =ğĞ
UBa£Ty³_t
 ) 0 ) \

229 
	`pÜtRESET_READY_PRIORITY
ĞĞ
uxPriÜ™y
 ), ( 
uxTİR—dyPriÜ™y
 ) ); \

231 }

	)

239 
	#skSWITCH_DELAYED_LISTS
() \

241 
Li¡_t
 *
pxTemp
; \

244 
	`cÚfigASSERT
ĞĞ
	`li¡LIST_IS_EMPTY
Ğ
pxD–ayedTaskLi¡
 ) ) ); \

246 
pxTemp
 = 
pxD–ayedTaskLi¡
; \

247 
pxD–ayedTaskLi¡
 = 
pxOv”æowD–ayedTaskLi¡
; \

248 
pxOv”æowD–ayedTaskLi¡
 = 
pxTemp
; \

249 
xNumOfOv”æows
++; \

250 
	`´vRe£tNextTaskUnblockTime
(); \

251 }

	)

259 
	#´vAddTaskToR—dyLi¡
Ğ
pxTCB
 ) \

260 
	`ŒaûMOVED_TASK_TO_READY_STATE
Ğ
pxTCB
 ); \

261 
	`skRECORD_READY_PRIORITY
ĞĞ
pxTCB
 )->
uxPriÜ™y
 ); \

262 
	`vLi¡In£¹End
Ğ&Ğ
pxR—dyTasksLi¡s
[ ( 
pxTCB
 )->
uxPriÜ™y
 ] ), &ĞĞpxTCB )->
xS‹Li¡I‹m
 ) ); \

263 
	`ŒaûPOST_MOVED_TASK_TO_READY_STATE
Ğ
pxTCB
 )

	)

272 
	#´vG‘TCBFromHªdË
Ğ
pxHªdË
 ) ( ( (…xHªdË ) =ğ
NULL
 ) ? ( 
TCB_t
 * ) 
pxCu¼’tTCB
 : ( TCB_ˆ* ) (…xHªdË ) )

	)

282 #ifĞ
cÚfigUSE_16_BIT_TICKS
 == 1 )

283 
	#skEVENT_LIST_ITEM_VALUE_IN_USE
 0x8000U

	)

285 
	#skEVENT_LIST_ITEM_VALUE_IN_USE
 0x80000000UL

	)

293 
	stskTaskCÚŒŞBlock


295 vŞ©
SckTy³_t
 *
	mpxTİOfSck
;

297 #iàĞ
pÜtUSING_MPU_WRAPPERS
 == 1 )

298 
xMPU_SETTINGS
 
	mxMPUS‘tšgs
;

301 
Li¡I‹m_t
 
	mxS‹Li¡I‹m
;

302 
Li¡I‹m_t
 
	mxEv’tLi¡I‹m
;

303 
UBa£Ty³_t
 
	muxPriÜ™y
;

304 
SckTy³_t
 *
	mpxSck
;

305 
	mpcTaskName
[ 
cÚfigMAX_TASK_NAME_LEN
 ];

307 #iàĞ
pÜtSTACK_GROWTH
 > 0 )

308 
SckTy³_t
 *
	mpxEndOfSck
;

311 #iàĞ
pÜtCRITICAL_NESTING_IN_TCB
 == 1 )

312 
UBa£Ty³_t
 
	muxCr™iÿlNe¡šg
;

315 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

316 
UBa£Ty³_t
 
	muxTCBNumb”
;

317 
UBa£Ty³_t
 
	muxTaskNumb”
;

320 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

321 
UBa£Ty³_t
 
	muxBa£PriÜ™y
;

322 
UBa£Ty³_t
 
	muxMu‹xesH–d
;

325 #iàĞ
cÚfigUSE_APPLICATION_TASK_TAG
 == 1 )

326 
TaskHookFunùiÚ_t
 
	mpxTaskTag
;

329 #ifĞ
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 > 0 )

330 *
	mpvTh»adLoÿlStÜagePoš‹rs
[ 
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 ];

333 #ifĞ
cÚfigGENERATE_RUN_TIME_STATS
 == 1 )

334 
ušt32_t
 
	mulRunTimeCouÁ”
;

337 #iàĞ
cÚfigUSE_NEWLIB_REENTRANT
 == 1 )

345 
_»’t
 
	mxNewLib_»’t
;

348 #ifĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

349 vŞ©
ušt32_t
 
	mulNÙif›dV®ue
;

350 vŞ©
ušt8_t
 
	mucNÙifyS‹
;

355 #ifĞ
tskSTATIC_AND_DYNAMIC_ALLOCATION_POSSIBLE
 != 0 )

356 
ušt8_t
 
	mucStiÿÎyAÎoÿ‹d
;

359 #ifĞ
INCLUDE_xTaskAbÜtD–ay
 == 1 )

360 
ušt8_t
 
	mucD–ayAbÜ‹d
;

363 } 
	ttskTCB
;

367 
tskTCB
 
	tTCB_t
;

372 
PRIVILEGED_DATA
 
TCB_t
 * vŞ©
	gpxCu¼’tTCB
 = 
NULL
;

375 
PRIVILEGED_DATA
 
Li¡_t
 
	gpxR—dyTasksLi¡s
[ 
cÚfigMAX_PRIORITIES
 ];

376 
PRIVILEGED_DATA
 
Li¡_t
 
	gxD–ayedTaskLi¡1
;

377 
PRIVILEGED_DATA
 
Li¡_t
 
	gxD–ayedTaskLi¡2
;

378 
PRIVILEGED_DATA
 
Li¡_t
 * vŞ©
	gpxD–ayedTaskLi¡
;

379 
PRIVILEGED_DATA
 
Li¡_t
 * vŞ©
	gpxOv”æowD–ayedTaskLi¡
;

380 
PRIVILEGED_DATA
 
Li¡_t
 
	gxP’dšgR—dyLi¡
;

382 #ifĞ
INCLUDE_vTaskD–‘e
 == 1 )

384 
PRIVILEGED_DATA
 
Li¡_t
 
	gxTasksWa™šgT”mš©iÚ
;

385 
PRIVILEGED_DATA
 vŞ©
UBa£Ty³_t
 
	guxD–‘edTasksWa™šgCËªUp
 = ( UBaseType_t ) 0U;

389 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

391 
PRIVILEGED_DATA
 
Li¡_t
 
	gxSu¥’dedTaskLi¡
;

396 
PRIVILEGED_DATA
 vŞ©
UBa£Ty³_t
 
	guxCu¼’tNumb”OfTasks
 = ( UBaseType_t ) 0U;

397 
PRIVILEGED_DATA
 vŞ©
TickTy³_t
 
	gxTickCouÁ
 = ( TickType_t ) 0U;

398 
PRIVILEGED_DATA
 vŞ©
UBa£Ty³_t
 
	guxTİR—dyPriÜ™y
 = 
tskIDLE_PRIORITY
;

399 
PRIVILEGED_DATA
 vŞ©
Ba£Ty³_t
 
	gxScheduËrRuÂšg
 = 
pdFALSE
;

400 
PRIVILEGED_DATA
 vŞ©
UBa£Ty³_t
 
	guxP’dedTicks
 = ( UBaseType_t ) 0U;

401 
PRIVILEGED_DATA
 vŞ©
Ba£Ty³_t
 
	gxY›ldP’dšg
 = 
pdFALSE
;

402 
PRIVILEGED_DATA
 vŞ©
Ba£Ty³_t
 
	gxNumOfOv”æows
 = ( BaseType_t ) 0;

403 
PRIVILEGED_DATA
 
UBa£Ty³_t
 
	guxTaskNumb”
 = ( UBaseType_t ) 0U;

404 
PRIVILEGED_DATA
 vŞ©
TickTy³_t
 
	gxNextTaskUnblockTime
 = ( TickType_t ) 0U;

405 
PRIVILEGED_DATA
 
TaskHªdË_t
 
	gxIdËTaskHªdË
 = 
NULL
;

415 
PRIVILEGED_DATA
 vŞ©
UBa£Ty³_t
 
	guxScheduËrSu¥’ded
 = ( UBa£Ty³_ˆè
pdFALSE
;

417 #iàĞ
cÚfigGENERATE_RUN_TIME_STATS
 == 1 )

419 
PRIVILEGED_DATA
 
ušt32_t
 
	gulTaskSw™chedInTime
 = 0UL;

420 
PRIVILEGED_DATA
 
ušt32_t
 
	gulTÙ®RunTime
 = 0UL;

429 #ifĞ
cÚfigCHECK_FOR_STACK_OVERFLOW
 > 0 )

430 
vAµliÿtiÚSckOv”æowHook
Ğ
TaskHªdË_t
 
xTask
, *
pcTaskName
 );

433 #ifĞ
cÚfigUSE_TICK_HOOK
 > 0 )

434 
vAµliÿtiÚTickHook
( );

437 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

438 
vAµliÿtiÚG‘IdËTaskMemÜy
Ğ
SticTask_t
 **
µxIdËTaskTCBBufãr
, 
SckTy³_t
 **
µxIdËTaskSckBufãr
, 
ušt32_t
 *
pulIdËTaskSckSize
 );

448 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

449 
Ba£Ty³_t
 
	$´vTaskIsTaskSu¥’ded
ĞcÚ¡ 
TaskHªdË_t
 
xTask
 ) 
PRIVILEGED_FUNCTION
;

456 
	$´vIn™Ÿli£TaskLi¡s
Ğè
PRIVILEGED_FUNCTION
;

469 
	`pÜtTASK_FUNCTION_PROTO
Ğ
´vIdËTask
, 
pvP¬am‘”s
 );

478 #iàĞ
INCLUDE_vTaskD–‘e
 == 1 )

480 
	$´vD–‘eTCB
Ğ
TCB_t
 *
pxTCB
 ) 
PRIVILEGED_FUNCTION
;

489 
	$´vCheckTasksWa™šgT”mš©iÚ
Ğè
PRIVILEGED_FUNCTION
;

495 
	$´vAddCu¼’tTaskToD–ayedLi¡
Ğ
TickTy³_t
 
xTicksToWa™
, cÚ¡ 
Ba£Ty³_t
 
xCªBlockIndefš™–y
 ) 
PRIVILEGED_FUNCTION
;

505 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

507 
UBa£Ty³_t
 
	$´vLi¡TasksW™hšSšgËLi¡
Ğ
TaskStus_t
 *
pxTaskStusA¼ay
, 
Li¡_t
 *
pxLi¡
, 
eTaskS‹
 
eS‹
 ) 
PRIVILEGED_FUNCTION
;

515 #iàĞ
INCLUDE_xTaskG‘HªdË
 == 1 )

517 
TCB_t
 *
	$´vS—rchFÜNameW™hšSšgËLi¡
Ğ
Li¡_t
 *
pxLi¡
, cÚ¡ 
pcNameToQu”y
[] ) 
PRIVILEGED_FUNCTION
;

526 #iàĞĞ
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) || ( 
INCLUDE_uxTaskG‘SckHighW©”M¬k
 == 1 ) )

528 
ušt16_t
 
	$´vTaskCheckF»eSckS·û
ĞcÚ¡ 
ušt8_t
 * 
pucSckBy‹
 ) 
PRIVILEGED_FUNCTION
;

541 #iàĞ
cÚfigUSE_TICKLESS_IDLE
 != 0 )

543 
TickTy³_t
 
	$´vG‘Ex³ùedIdËTime
Ğè
PRIVILEGED_FUNCTION
;

551 
	`´vRe£tNextTaskUnblockTime
( );

553 #iàĞĞ
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) && ( 
cÚfigUSE_STATS_FORMATTING_FUNCTIONS
 > 0 ) )

559 *
	$´vWr™eNameToBufãr
Ğ*
pcBufãr
, cÚ¡ *
pcTaskName
 ) 
PRIVILEGED_FUNCTION
;

567 
	$´vIn™Ÿli£NewTask
Ğ
TaskFunùiÚ_t
 
pxTaskCode
,

568 cÚ¡ * cÚ¡ 
pcName
,

569 cÚ¡ 
ušt32_t
 
ulSckD•th
,

570 * cÚ¡ 
pvP¬am‘”s
,

571 
UBa£Ty³_t
 
uxPriÜ™y
,

572 
TaskHªdË_t
 * cÚ¡ 
pxC»©edTask
,

573 
TCB_t
 *
pxNewTCB
,

574 cÚ¡ 
MemÜyRegiÚ_t
 * cÚ¡ 
xRegiÚs
 ) 
PRIVILEGED_FUNCTION
;

580 
	$´vAddNewTaskToR—dyLi¡
Ğ
TCB_t
 *
pxNewTCB
 ) 
PRIVILEGED_FUNCTION
;

584 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

586 
TaskHªdË_t
 
	$xTaskC»©eStic
Ğ
TaskFunùiÚ_t
 
pxTaskCode
,

587 cÚ¡ * cÚ¡ 
pcName
,

588 cÚ¡ 
ušt32_t
 
ulSckD•th
,

589 * cÚ¡ 
pvP¬am‘”s
,

590 
UBa£Ty³_t
 
uxPriÜ™y
,

591 
SckTy³_t
 * cÚ¡ 
puxSckBufãr
,

592 
SticTask_t
 * cÚ¡ 
pxTaskBufãr
 )

594 
TCB_t
 *
pxNewTCB
;

595 
TaskHªdË_t
 
xR‘uº
;

597 
	`cÚfigASSERT
Ğ
puxSckBufãr
 !ğ
NULL
 );

598 
	`cÚfigASSERT
Ğ
pxTaskBufãr
 !ğ
NULL
 );

600 ifĞĞ
pxTaskBufãr
 !ğ
NULL
 ) && ( 
puxSckBufãr
 != NULL ) )

604 
pxNewTCB
 = ( 
TCB_t
 * ) 
pxTaskBufãr
;

605 
pxNewTCB
->
pxSck
 = ( 
SckTy³_t
 * ) 
puxSckBufãr
;

607 #ifĞ
tskSTATIC_AND_DYNAMIC_ALLOCATION_POSSIBLE
 != 0 )

611 
pxNewTCB
->
ucStiÿÎyAÎoÿ‹d
 = 
tskSTATICALLY_ALLOCATED_STACK_AND_TCB
;

615 
	`´vIn™Ÿli£NewTask
Ğ
pxTaskCode
, 
pcName
, 
ulSckD•th
, 
pvP¬am‘”s
, 
uxPriÜ™y
, &
xR‘uº
, 
pxNewTCB
, 
NULL
 );

616 
	`´vAddNewTaskToR—dyLi¡
Ğ
pxNewTCB
 );

620 
xR‘uº
 = 
NULL
;

623  
xR‘uº
;

624 
	}
}

629 #ifĞ
pÜtUSING_MPU_WRAPPERS
 == 1 )

631 
Ba£Ty³_t
 
	$xTaskC»©eRe¡riùed
ĞcÚ¡ 
TaskP¬am‘”s_t
 * cÚ¡ 
pxTaskDefš™iÚ
, 
TaskHªdË_t
 *
pxC»©edTask
 )

633 
TCB_t
 *
pxNewTCB
;

634 
Ba£Ty³_t
 
xR‘uº
 = 
”rCOULD_NOT_ALLOCATE_REQUIRED_MEMORY
;

636 
	`cÚfigASSERT
Ğ
pxTaskDefš™iÚ
->
puxSckBufãr
 );

638 ifĞ
pxTaskDefš™iÚ
->
puxSckBufãr
 !ğ
NULL
 )

643 
pxNewTCB
 = ( 
TCB_t
 * ) 
	`pvPÜtM®loc
( ( TCB_t ) );

645 ifĞ
pxNewTCB
 !ğ
NULL
 )

648 
pxNewTCB
->
pxSck
 = 
pxTaskDefš™iÚ
->
puxSckBufãr
;

653 
pxNewTCB
->
ucStiÿÎyAÎoÿ‹d
 = 
tskSTATICALLY_ALLOCATED_STACK_ONLY
;

655 
	`´vIn™Ÿli£NewTask
Ğ
pxTaskDefš™iÚ
->
pvTaskCode
,

656 
pxTaskDefš™iÚ
->
pcName
,

657 Ğ
ušt32_t
 ) 
pxTaskDefš™iÚ
->
usSckD•th
,

658 
pxTaskDefš™iÚ
->
pvP¬am‘”s
,

659 
pxTaskDefš™iÚ
->
uxPriÜ™y
,

660 
pxC»©edTask
, 
pxNewTCB
,

661 
pxTaskDefš™iÚ
->
xRegiÚs
 );

663 
	`´vAddNewTaskToR—dyLi¡
Ğ
pxNewTCB
 );

664 
xR‘uº
 = 
pdPASS
;

668  
xR‘uº
;

669 
	}
}

674 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 )

676 
Ba£Ty³_t
 
	$xTaskC»©e
Ğ
TaskFunùiÚ_t
 
pxTaskCode
,

677 cÚ¡ * cÚ¡ 
pcName
,

678 cÚ¡ 
ušt16_t
 
usSckD•th
,

679 * cÚ¡ 
pvP¬am‘”s
,

680 
UBa£Ty³_t
 
uxPriÜ™y
,

681 
TaskHªdË_t
 * cÚ¡ 
pxC»©edTask
 )

683 
TCB_t
 *
pxNewTCB
;

684 
Ba£Ty³_t
 
xR‘uº
;

689 #ifĞ
pÜtSTACK_GROWTH
 > 0 )

694 
pxNewTCB
 = ( 
TCB_t
 * ) 
	`pvPÜtM®loc
( ( TCB_t ) );

696 ifĞ
pxNewTCB
 !ğ
NULL
 )

701 
pxNewTCB
->
pxSck
 = ( 
SckTy³_t
 * ) 
	`pvPÜtM®loc
ĞĞĞĞ
size_t
 ) 
usSckD•th
 ) * ( StackType_t ) ) );

703 ifĞ
pxNewTCB
->
pxSck
 =ğ
NULL
 )

706 
	`vPÜtF»e
Ğ
pxNewTCB
 );

707 
pxNewTCB
 = 
NULL
;

713 
SckTy³_t
 *
pxSck
;

716 
pxSck
 = ( 
SckTy³_t
 * ) 
	`pvPÜtM®loc
ĞĞĞĞ
size_t
 ) 
usSckD•th
 ) * ( StackType_t ) ) );

718 ifĞ
pxSck
 !ğ
NULL
 )

721 
pxNewTCB
 = ( 
TCB_t
 * ) 
	`pvPÜtM®loc
( ( TCB_t ) );

723 ifĞ
pxNewTCB
 !ğ
NULL
 )

726 
pxNewTCB
->
pxSck
 =…xStack;

732 
	`vPÜtF»e
Ğ
pxSck
 );

737 
pxNewTCB
 = 
NULL
;

742 ifĞ
pxNewTCB
 !ğ
NULL
 )

744 #ifĞ
tskSTATIC_AND_DYNAMIC_ALLOCATION_POSSIBLE
 != 0 )

748 
pxNewTCB
->
ucStiÿÎyAÎoÿ‹d
 = 
tskDYNAMICALLY_ALLOCATED_STACK_AND_TCB
;

752 
	`´vIn™Ÿli£NewTask
Ğ
pxTaskCode
, 
pcName
, ( 
ušt32_t
 ) 
usSckD•th
, 
pvP¬am‘”s
, 
uxPriÜ™y
, 
pxC»©edTask
, 
pxNewTCB
, 
NULL
 );

753 
	`´vAddNewTaskToR—dyLi¡
Ğ
pxNewTCB
 );

754 
xR‘uº
 = 
pdPASS
;

758 
xR‘uº
 = 
”rCOULD_NOT_ALLOCATE_REQUIRED_MEMORY
;

761  
xR‘uº
;

762 
	}
}

767 
	$´vIn™Ÿli£NewTask
Ğ
TaskFunùiÚ_t
 
pxTaskCode
,

768 cÚ¡ * cÚ¡ 
pcName
,

769 cÚ¡ 
ušt32_t
 
ulSckD•th
,

770 * cÚ¡ 
pvP¬am‘”s
,

771 
UBa£Ty³_t
 
uxPriÜ™y
,

772 
TaskHªdË_t
 * cÚ¡ 
pxC»©edTask
,

773 
TCB_t
 *
pxNewTCB
,

774 cÚ¡ 
MemÜyRegiÚ_t
 * cÚ¡ 
xRegiÚs
 )

776 
SckTy³_t
 *
pxTİOfSck
;

777 
UBa£Ty³_t
 
x
;

779 #ifĞ
pÜtUSING_MPU_WRAPPERS
 == 1 )

781 
Ba£Ty³_t
 
xRunPriveged
;

782 ifĞĞ
uxPriÜ™y
 & 
pÜtPRIVILEGE_BIT
 ) != 0U )

784 
xRunPriveged
 = 
pdTRUE
;

788 
xRunPriveged
 = 
pdFALSE
;

790 
uxPriÜ™y
 &ğ~
pÜtPRIVILEGE_BIT
;

794 #ifĞĞ
cÚfigCHECK_FOR_STACK_OVERFLOW
 > 1 ) || ( 
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) || ( 
INCLUDE_uxTaskG‘SckHighW©”M¬k
 == 1 ) )

797 Ğè
	`mem£t
Ğ
pxNewTCB
->
pxSck
, ( è
tskSTACK_FILL_BYTE
, ( 
size_t
 ) 
ulSckD•th
 * Ğ
SckTy³_t
 ) );

805 #ifĞ
pÜtSTACK_GROWTH
 < 0 )

807 
pxTİOfSck
 = 
pxNewTCB
->
pxSck
 + ( 
ulSckD•th
 - ( 
ušt32_t
 ) 1 );

808 
pxTİOfSck
 = ( 
SckTy³_t
 * ) ( ( ( 
pÜtPOINTER_SIZE_TYPE
 )…xTİOfSck ) & ( ~ĞĞpÜtPOINTER_SIZE_TYPE ) 
pÜtBYTE_ALIGNMENT_MASK
 ) ) );

811 
	`cÚfigASSERT
ĞĞĞĞ
pÜtPOINTER_SIZE_TYPE
 ) 
pxTİOfSck
 & (…ÜtPOINTER_SIZE_TYPE ) 
pÜtBYTE_ALIGNMENT_MASK
 ) == 0UL ) );

815 
pxTİOfSck
 = 
pxNewTCB
->
pxSck
;

818 
	`cÚfigASSERT
ĞĞĞĞ
pÜtPOINTER_SIZE_TYPE
 ) 
pxNewTCB
->
pxSck
 & (…ÜtPOINTER_SIZE_TYPE ) 
pÜtBYTE_ALIGNMENT_MASK
 ) == 0UL ) );

822 
pxNewTCB
->
pxEndOfSck
 =…xNewTCB->
pxSck
 + ( 
ulSckD•th
 - ( 
ušt32_t
 ) 1 );

827  
x
 = ( 
UBa£Ty³_t
 ) 0; x < ( UBa£Ty³_ˆè
cÚfigMAX_TASK_NAME_LEN
; x++ )

829 
pxNewTCB
->
pcTaskName
[ 
x
 ] = 
pcName
[ x ];

834 ifĞ
pcName
[ 
x
 ] == 0x00 )

840 
	`mtCOVERAGE_TEST_MARKER
();

846 
pxNewTCB
->
pcTaskName
[ 
cÚfigMAX_TASK_NAME_LEN
 - 1 ] = '\0';

850 ifĞ
uxPriÜ™y
 >ğĞ
UBa£Ty³_t
 ) 
cÚfigMAX_PRIORITIES
 )

852 
uxPriÜ™y
 = ( 
UBa£Ty³_t
 ) 
cÚfigMAX_PRIORITIES
 - ( UBaseType_t ) 1U;

856 
	`mtCOVERAGE_TEST_MARKER
();

859 
pxNewTCB
->
uxPriÜ™y
 = uxPriority;

860 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

862 
pxNewTCB
->
uxBa£PriÜ™y
 = 
uxPriÜ™y
;

863 
pxNewTCB
->
uxMu‹xesH–d
 = 0;

867 
	`vLi¡In™Ÿli£I‹m
Ğ&Ğ
pxNewTCB
->
xS‹Li¡I‹m
 ) );

868 
	`vLi¡In™Ÿli£I‹m
Ğ&Ğ
pxNewTCB
->
xEv’tLi¡I‹m
 ) );

872 
	`li¡SET_LIST_ITEM_OWNER
Ğ&Ğ
pxNewTCB
->
xS‹Li¡I‹m
 ),…xNewTCB );

875 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxNewTCB
->
xEv’tLi¡I‹m
 ), ( 
TickTy³_t
 ) 
cÚfigMAX_PRIORITIES
 - ( TickTy³_ˆè
uxPriÜ™y
 );

876 
	`li¡SET_LIST_ITEM_OWNER
Ğ&Ğ
pxNewTCB
->
xEv’tLi¡I‹m
 ),…xNewTCB );

878 #iàĞ
pÜtCRITICAL_NESTING_IN_TCB
 == 1 )

880 
pxNewTCB
->
uxCr™iÿlNe¡šg
 = ( 
UBa£Ty³_t
 ) 0U;

884 #iàĞ
cÚfigUSE_APPLICATION_TASK_TAG
 == 1 )

886 
pxNewTCB
->
pxTaskTag
 = 
NULL
;

890 #iàĞ
cÚfigGENERATE_RUN_TIME_STATS
 == 1 )

892 
pxNewTCB
->
ulRunTimeCouÁ”
 = 0UL;

896 #iàĞ
pÜtUSING_MPU_WRAPPERS
 == 1 )

898 
	`vPÜtStÜeTaskMPUS‘tšgs
Ğ&Ğ
pxNewTCB
->
xMPUS‘tšgs
 ), 
xRegiÚs
,…xNewTCB->
pxSck
, 
ulSckD•th
 );

903 Ğè
xRegiÚs
;

907 #ifĞ
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 != 0 )

909  
x
 = 0; x < ( 
UBa£Ty³_t
 ) 
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
; x++ )

911 
pxNewTCB
->
pvTh»adLoÿlStÜagePoš‹rs
[ 
x
 ] = 
NULL
;

916 #iàĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

918 
pxNewTCB
->
ulNÙif›dV®ue
 = 0;

919 
pxNewTCB
->
ucNÙifyS‹
 = 
skNOT_WAITING_NOTIFICATION
;

923 #iàĞ
cÚfigUSE_NEWLIB_REENTRANT
 == 1 )

926 
	`_REENT_INIT_PTR
ĞĞ&Ğ
pxNewTCB
->
xNewLib_»’t
 ) ) );

930 #ifĞ
INCLUDE_xTaskAbÜtD–ay
 == 1 )

932 
pxNewTCB
->
ucD–ayAbÜ‹d
 = 
pdFALSE
;

940 #ifĞ
pÜtUSING_MPU_WRAPPERS
 == 1 )

942 
pxNewTCB
->
pxTİOfSck
 = 
	`pxPÜtIn™Ÿli£Sck
ĞpxTİOfSck, 
pxTaskCode
, 
pvP¬am‘”s
, 
xRunPriveged
 );

946 
pxNewTCB
->
pxTİOfSck
 = 
	`pxPÜtIn™Ÿli£Sck
ĞpxTİOfSck, 
pxTaskCode
, 
pvP¬am‘”s
 );

950 ifĞĞ* ) 
pxC»©edTask
 !ğ
NULL
 )

954 *
pxC»©edTask
 = ( 
TaskHªdË_t
 ) 
pxNewTCB
;

958 
	`mtCOVERAGE_TEST_MARKER
();

960 
	}
}

963 
	$´vAddNewTaskToR—dyLi¡
Ğ
TCB_t
 *
pxNewTCB
 )

967 
	`skENTER_CRITICAL
();

969 
uxCu¼’tNumb”OfTasks
++;

970 ifĞ
pxCu¼’tTCB
 =ğ
NULL
 )

974 
pxCu¼’tTCB
 = 
pxNewTCB
;

976 ifĞ
uxCu¼’tNumb”OfTasks
 =ğĞ
UBa£Ty³_t
 ) 1 )

981 
	`´vIn™Ÿli£TaskLi¡s
();

985 
	`mtCOVERAGE_TEST_MARKER
();

993 ifĞ
xScheduËrRuÂšg
 =ğ
pdFALSE
 )

995 ifĞ
pxCu¼’tTCB
->
uxPriÜ™y
 <ğ
pxNewTCB
->uxPriority )

997 
pxCu¼’tTCB
 = 
pxNewTCB
;

1001 
	`mtCOVERAGE_TEST_MARKER
();

1006 
	`mtCOVERAGE_TEST_MARKER
();

1010 
uxTaskNumb”
++;

1012 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

1015 
pxNewTCB
->
uxTCBNumb”
 = 
uxTaskNumb”
;

1018 
	`ŒaûTASK_CREATE
Ğ
pxNewTCB
 );

1020 
	`´vAddTaskToR—dyLi¡
Ğ
pxNewTCB
 );

1022 
	`pÜtSETUP_TCB
Ğ
pxNewTCB
 );

1024 
	`skEXIT_CRITICAL
();

1026 ifĞ
xScheduËrRuÂšg
 !ğ
pdFALSE
 )

1030 ifĞ
pxCu¼’tTCB
->
uxPriÜ™y
 < 
pxNewTCB
->uxPriority )

1032 
	`skYIELD_IF_USING_PREEMPTION
();

1036 
	`mtCOVERAGE_TEST_MARKER
();

1041 
	`mtCOVERAGE_TEST_MARKER
();

1043 
	}
}

1046 #iàĞ
INCLUDE_vTaskD–‘e
 == 1 )

1048 
	$vTaskD–‘e
Ğ
TaskHªdË_t
 
xTaskToD–‘e
 )

1050 
TCB_t
 *
pxTCB
;

1052 
	`skENTER_CRITICAL
();

1056 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTaskToD–‘e
 );

1059 ifĞ
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) ) =ğĞ
UBa£Ty³_t
 ) 0 )

1061 
	`skRESET_READY_PRIORITY
Ğ
pxTCB
->
uxPriÜ™y
 );

1065 
	`mtCOVERAGE_TEST_MARKER
();

1069 ifĞ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) !ğ
NULL
 )

1071 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

1075 
	`mtCOVERAGE_TEST_MARKER
();

1082 
uxTaskNumb”
++;

1084 ifĞ
pxTCB
 =ğ
pxCu¼’tTCB
 )

1091 
	`vLi¡In£¹End
Ğ&
xTasksWa™šgT”mš©iÚ
, &Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

1096 ++
uxD–‘edTasksWa™šgCËªUp
;

1103 
	`pÜtPRE_TASK_DELETE_HOOK
Ğ
pxTCB
, &
xY›ldP’dšg
 );

1107 --
uxCu¼’tNumb”OfTasks
;

1108 
	`´vD–‘eTCB
Ğ
pxTCB
 );

1112 
	`´vRe£tNextTaskUnblockTime
();

1115 
	`ŒaûTASK_DELETE
Ğ
pxTCB
 );

1117 
	`skEXIT_CRITICAL
();

1121 ifĞ
xScheduËrRuÂšg
 !ğ
pdFALSE
 )

1123 ifĞ
pxTCB
 =ğ
pxCu¼’tTCB
 )

1125 
	`cÚfigASSERT
Ğ
uxScheduËrSu¥’ded
 == 0 );

1126 
	`pÜtYIELD_WITHIN_API
();

1130 
	`mtCOVERAGE_TEST_MARKER
();

1133 
	}
}

1138 #iàĞ
INCLUDE_vTaskD–ayUÁ
 == 1 )

1140 
	$vTaskD–ayUÁ
Ğ
TickTy³_t
 * cÚ¡ 
pxP»viousWakeTime
, cÚ¡ TickTy³_ˆ
xTimeInüem’t
 )

1142 
TickTy³_t
 
xTimeToWake
;

1143 
Ba£Ty³_t
 
xAÌ—dyY›lded
, 
xShouldD–ay
 = 
pdFALSE
;

1145 
	`cÚfigASSERT
Ğ
pxP»viousWakeTime
 );

1146 
	`cÚfigASSERT
ĞĞ
xTimeInüem’t
 > 0U ) );

1147 
	`cÚfigASSERT
Ğ
uxScheduËrSu¥’ded
 == 0 );

1149 
	`vTaskSu¥’dAÎ
();

1153 cÚ¡ 
TickTy³_t
 
xCÚ¡TickCouÁ
 = 
xTickCouÁ
;

1156 
xTimeToWake
 = *
pxP»viousWakeTime
 + 
xTimeInüem’t
;

1158 ifĞ
xCÚ¡TickCouÁ
 < *
pxP»viousWakeTime
 )

1165 ifĞĞ
xTimeToWake
 < *
pxP»viousWakeTime
 ) && ( xTimeToWak> 
xCÚ¡TickCouÁ
 ) )

1167 
xShouldD–ay
 = 
pdTRUE
;

1171 
	`mtCOVERAGE_TEST_MARKER
();

1179 ifĞĞ
xTimeToWake
 < *
pxP»viousWakeTime
 ) || ( xTimeToWak> 
xCÚ¡TickCouÁ
 ) )

1181 
xShouldD–ay
 = 
pdTRUE
;

1185 
	`mtCOVERAGE_TEST_MARKER
();

1190 *
pxP»viousWakeTime
 = 
xTimeToWake
;

1192 ifĞ
xShouldD–ay
 !ğ
pdFALSE
 )

1194 
	`ŒaûTASK_DELAY_UNTIL
Ğ
xTimeToWake
 );

1198 
	`´vAddCu¼’tTaskToD–ayedLi¡
Ğ
xTimeToWake
 - 
xCÚ¡TickCouÁ
, 
pdFALSE
 );

1202 
	`mtCOVERAGE_TEST_MARKER
();

1205 
xAÌ—dyY›lded
 = 
	`xTaskResumeAÎ
();

1209 ifĞ
xAÌ—dyY›lded
 =ğ
pdFALSE
 )

1211 
	`pÜtYIELD_WITHIN_API
();

1215 
	`mtCOVERAGE_TEST_MARKER
();

1217 
	}
}

1222 #iàĞ
INCLUDE_vTaskD–ay
 == 1 )

1224 
	$vTaskD–ay
ĞcÚ¡ 
TickTy³_t
 
xTicksToD–ay
 )

1226 
Ba£Ty³_t
 
xAÌ—dyY›lded
 = 
pdFALSE
;

1229 ifĞ
xTicksToD–ay
 > ( 
TickTy³_t
 ) 0U )

1231 
	`cÚfigASSERT
Ğ
uxScheduËrSu¥’ded
 == 0 );

1232 
	`vTaskSu¥’dAÎ
();

1234 
	`ŒaûTASK_DELAY
();

1243 
	`´vAddCu¼’tTaskToD–ayedLi¡
Ğ
xTicksToD–ay
, 
pdFALSE
 );

1245 
xAÌ—dyY›lded
 = 
	`xTaskResumeAÎ
();

1249 
	`mtCOVERAGE_TEST_MARKER
();

1254 ifĞ
xAÌ—dyY›lded
 =ğ
pdFALSE
 )

1256 
	`pÜtYIELD_WITHIN_API
();

1260 
	`mtCOVERAGE_TEST_MARKER
();

1262 
	}
}

1267 #ifĞĞ
INCLUDE_eTaskG‘S‹
 =ğ1 ) || ( 
cÚfigUSE_TRACE_FACILITY
 == 1 ) )

1269 
eTaskS‹
 
	$eTaskG‘S‹
Ğ
TaskHªdË_t
 
xTask
 )

1271 
eTaskS‹
 
eR‘uº
;

1272 
Li¡_t
 *
pxS‹Li¡
;

1273 cÚ¡ 
TCB_t
 * cÚ¡ 
pxTCB
 = ( TCB_ˆ* ) 
xTask
;

1275 
	`cÚfigASSERT
Ğ
pxTCB
 );

1277 ifĞ
pxTCB
 =ğ
pxCu¼’tTCB
 )

1280 
eR‘uº
 = 
eRuÂšg
;

1284 
	`skENTER_CRITICAL
();

1286 
pxS‹Li¡
 = ( 
Li¡_t
 * ) 
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

1288 
	`skEXIT_CRITICAL
();

1290 ifĞĞ
pxS‹Li¡
 =ğ
pxD–ayedTaskLi¡
 ) || (…xS‹Li¡ =ğ
pxOv”æowD–ayedTaskLi¡
 ) )

1294 
eR‘uº
 = 
eBlocked
;

1297 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

1298 ifĞ
pxS‹Li¡
 =ğ&
xSu¥’dedTaskLi¡
 )

1303 ifĞ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) =ğ
NULL
 )

1305 
eR‘uº
 = 
eSu¥’ded
;

1309 
eR‘uº
 = 
eBlocked
;

1314 #iàĞ
INCLUDE_vTaskD–‘e
 == 1 )

1315 ifĞĞ
pxS‹Li¡
 =ğ&
xTasksWa™šgT”mš©iÚ
 ) || (…xS‹Li¡ =ğ
NULL
 ) )

1320 
eR‘uº
 = 
eD–‘ed
;

1328 
eR‘uº
 = 
eR—dy
;

1332  
eR‘uº
;

1333 
	}
}

1338 #iàĞ
INCLUDE_uxTaskPriÜ™yG‘
 == 1 )

1340 
UBa£Ty³_t
 
	$uxTaskPriÜ™yG‘
Ğ
TaskHªdË_t
 
xTask
 )

1342 
TCB_t
 *
pxTCB
;

1343 
UBa£Ty³_t
 
uxR‘uº
;

1345 
	`skENTER_CRITICAL
();

1349 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTask
 );

1350 
uxR‘uº
 = 
pxTCB
->
uxPriÜ™y
;

1352 
	`skEXIT_CRITICAL
();

1354  
uxR‘uº
;

1355 
	}
}

1360 #iàĞ
INCLUDE_uxTaskPriÜ™yG‘
 == 1 )

1362 
UBa£Ty³_t
 
	$uxTaskPriÜ™yG‘FromISR
Ğ
TaskHªdË_t
 
xTask
 )

1364 
TCB_t
 *
pxTCB
;

1365 
UBa£Ty³_t
 
uxR‘uº
, 
uxSavedIÁ”ru±S‹
;

1383 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

1385 
uxSavedIÁ”ru±S‹
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

1389 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTask
 );

1390 
uxR‘uº
 = 
pxTCB
->
uxPriÜ™y
;

1392 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±S‹
 );

1394  
uxR‘uº
;

1395 
	}
}

1400 #iàĞ
INCLUDE_vTaskPriÜ™yS‘
 == 1 )

1402 
	$vTaskPriÜ™yS‘
Ğ
TaskHªdË_t
 
xTask
, 
UBa£Ty³_t
 
uxNewPriÜ™y
 )

1404 
TCB_t
 *
pxTCB
;

1405 
UBa£Ty³_t
 
uxCu¼’tBa£PriÜ™y
, 
uxPriÜ™yU£dOnEÁry
;

1406 
Ba£Ty³_t
 
xY›ldRequœed
 = 
pdFALSE
;

1408 
	`cÚfigASSERT
ĞĞ
uxNewPriÜ™y
 < 
cÚfigMAX_PRIORITIES
 ) );

1411 ifĞ
uxNewPriÜ™y
 >ğĞ
UBa£Ty³_t
 ) 
cÚfigMAX_PRIORITIES
 )

1413 
uxNewPriÜ™y
 = ( 
UBa£Ty³_t
 ) 
cÚfigMAX_PRIORITIES
 - ( UBaseType_t ) 1U;

1417 
	`mtCOVERAGE_TEST_MARKER
();

1420 
	`skENTER_CRITICAL
();

1424 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTask
 );

1426 
	`ŒaûTASK_PRIORITY_SET
Ğ
pxTCB
, 
uxNewPriÜ™y
 );

1428 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

1430 
uxCu¼’tBa£PriÜ™y
 = 
pxTCB
->
uxBa£PriÜ™y
;

1434 
uxCu¼’tBa£PriÜ™y
 = 
pxTCB
->
uxPriÜ™y
;

1438 ifĞ
uxCu¼’tBa£PriÜ™y
 !ğ
uxNewPriÜ™y
 )

1442 ifĞ
uxNewPriÜ™y
 > 
uxCu¼’tBa£PriÜ™y
 )

1444 ifĞ
pxTCB
 !ğ
pxCu¼’tTCB
 )

1449 ifĞ
uxNewPriÜ™y
 >ğ
pxCu¼’tTCB
->
uxPriÜ™y
 )

1451 
xY›ldRequœed
 = 
pdTRUE
;

1455 
	`mtCOVERAGE_TEST_MARKER
();

1465 ifĞ
pxTCB
 =ğ
pxCu¼’tTCB
 )

1470 
xY›ldRequœed
 = 
pdTRUE
;

1482 
uxPriÜ™yU£dOnEÁry
 = 
pxTCB
->
uxPriÜ™y
;

1484 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

1488 ifĞ
pxTCB
->
uxBa£PriÜ™y
 =ğpxTCB->
uxPriÜ™y
 )

1490 
pxTCB
->
uxPriÜ™y
 = 
uxNewPriÜ™y
;

1494 
	`mtCOVERAGE_TEST_MARKER
();

1498 
pxTCB
->
uxBa£PriÜ™y
 = 
uxNewPriÜ™y
;

1502 
pxTCB
->
uxPriÜ™y
 = 
uxNewPriÜ™y
;

1508 ifĞĞ
	`li¡GET_LIST_ITEM_VALUE
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) & 
skEVENT_LIST_ITEM_VALUE_IN_USE
 ) == 0UL )

1510 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ), ( ( 
TickTy³_t
 ) 
cÚfigMAX_PRIORITIES
 - ( TickTy³_ˆè
uxNewPriÜ™y
 ) );

1514 
	`mtCOVERAGE_TEST_MARKER
();

1521 ifĞ
	`li¡IS_CONTAINED_WITHIN
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
uxPriÜ™yU£dOnEÁry
 ] ), &Ğ
pxTCB
->
xS‹Li¡I‹m
 ) ) !ğ
pdFALSE
 )

1526 ifĞ
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) ) =ğĞ
UBa£Ty³_t
 ) 0 )

1531 
	`pÜtRESET_READY_PRIORITY
Ğ
uxPriÜ™yU£dOnEÁry
, 
uxTİR—dyPriÜ™y
 );

1535 
	`mtCOVERAGE_TEST_MARKER
();

1537 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

1541 
	`mtCOVERAGE_TEST_MARKER
();

1544 ifĞ
xY›ldRequœed
 !ğ
pdFALSE
 )

1546 
	`skYIELD_IF_USING_PREEMPTION
();

1550 
	`mtCOVERAGE_TEST_MARKER
();

1555 Ğè
uxPriÜ™yU£dOnEÁry
;

1558 
	`skEXIT_CRITICAL
();

1559 
	}
}

1564 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

1566 
	$vTaskSu¥’d
Ğ
TaskHªdË_t
 
xTaskToSu¥’d
 )

1568 
TCB_t
 *
pxTCB
;

1570 
	`skENTER_CRITICAL
();

1574 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTaskToSu¥’d
 );

1576 
	`ŒaûTASK_SUSPEND
Ğ
pxTCB
 );

1580 ifĞ
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) ) =ğĞ
UBa£Ty³_t
 ) 0 )

1582 
	`skRESET_READY_PRIORITY
Ğ
pxTCB
->
uxPriÜ™y
 );

1586 
	`mtCOVERAGE_TEST_MARKER
();

1590 ifĞ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) !ğ
NULL
 )

1592 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

1596 
	`mtCOVERAGE_TEST_MARKER
();

1599 
	`vLi¡In£¹End
Ğ&
xSu¥’dedTaskLi¡
, &Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

1601 
	`skEXIT_CRITICAL
();

1603 ifĞ
xScheduËrRuÂšg
 !ğ
pdFALSE
 )

1607 
	`skENTER_CRITICAL
();

1609 
	`´vRe£tNextTaskUnblockTime
();

1611 
	`skEXIT_CRITICAL
();

1615 
	`mtCOVERAGE_TEST_MARKER
();

1618 ifĞ
pxTCB
 =ğ
pxCu¼’tTCB
 )

1620 ifĞ
xScheduËrRuÂšg
 !ğ
pdFALSE
 )

1623 
	`cÚfigASSERT
Ğ
uxScheduËrSu¥’ded
 == 0 );

1624 
	`pÜtYIELD_WITHIN_API
();

1631 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ&
xSu¥’dedTaskLi¡
 ) =ğ
uxCu¼’tNumb”OfTasks
 )

1637 
pxCu¼’tTCB
 = 
NULL
;

1641 
	`vTaskSw™chCÚ‹xt
();

1647 
	`mtCOVERAGE_TEST_MARKER
();

1649 
	}
}

1654 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

1656 
Ba£Ty³_t
 
	$´vTaskIsTaskSu¥’ded
ĞcÚ¡ 
TaskHªdË_t
 
xTask
 )

1658 
Ba£Ty³_t
 
xR‘uº
 = 
pdFALSE
;

1659 cÚ¡ 
TCB_t
 * cÚ¡ 
pxTCB
 = ( TCB_ˆ* ) 
xTask
;

1665 
	`cÚfigASSERT
Ğ
xTask
 );

1668 ifĞ
	`li¡IS_CONTAINED_WITHIN
Ğ&
xSu¥’dedTaskLi¡
, &Ğ
pxTCB
->
xS‹Li¡I‹m
 ) ) !ğ
pdFALSE
 )

1671 ifĞ
	`li¡IS_CONTAINED_WITHIN
Ğ&
xP’dšgR—dyLi¡
, &Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) =ğ
pdFALSE
 )

1675 ifĞ
	`li¡IS_CONTAINED_WITHIN
Ğ
NULL
, &Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) !ğ
pdFALSE
 )

1677 
xR‘uº
 = 
pdTRUE
;

1681 
	`mtCOVERAGE_TEST_MARKER
();

1686 
	`mtCOVERAGE_TEST_MARKER
();

1691 
	`mtCOVERAGE_TEST_MARKER
();

1694  
xR‘uº
;

1695 
	}
}

1700 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

1702 
	$vTaskResume
Ğ
TaskHªdË_t
 
xTaskToResume
 )

1704 
TCB_t
 * cÚ¡ 
pxTCB
 = ( TCB_ˆ* ) 
xTaskToResume
;

1707 
	`cÚfigASSERT
Ğ
xTaskToResume
 );

1711 ifĞĞ
pxTCB
 !ğ
NULL
 ) && (…xTCB !ğ
pxCu¼’tTCB
 ) )

1713 
	`skENTER_CRITICAL
();

1715 ifĞ
	`´vTaskIsTaskSu¥’ded
Ğ
pxTCB
 ) !ğ
pdFALSE
 )

1717 
	`ŒaûTASK_RESUME
Ğ
pxTCB
 );

1721 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

1722 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

1725 ifĞ
pxTCB
->
uxPriÜ™y
 >ğ
pxCu¼’tTCB
->uxPriority )

1730 
	`skYIELD_IF_USING_PREEMPTION
();

1734 
	`mtCOVERAGE_TEST_MARKER
();

1739 
	`mtCOVERAGE_TEST_MARKER
();

1742 
	`skEXIT_CRITICAL
();

1746 
	`mtCOVERAGE_TEST_MARKER
();

1748 
	}
}

1754 #iàĞĞ
INCLUDE_xTaskResumeFromISR
 =ğ1 ) && ( 
INCLUDE_vTaskSu¥’d
 == 1 ) )

1756 
Ba£Ty³_t
 
	$xTaskResumeFromISR
Ğ
TaskHªdË_t
 
xTaskToResume
 )

1758 
Ba£Ty³_t
 
xY›ldRequœed
 = 
pdFALSE
;

1759 
TCB_t
 * cÚ¡ 
pxTCB
 = ( TCB_ˆ* ) 
xTaskToResume
;

1760 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

1762 
	`cÚfigASSERT
Ğ
xTaskToResume
 );

1780 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

1782 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

1784 ifĞ
	`´vTaskIsTaskSu¥’ded
Ğ
pxTCB
 ) !ğ
pdFALSE
 )

1786 
	`ŒaûTASK_RESUME_FROM_ISR
Ğ
pxTCB
 );

1789 ifĞ
uxScheduËrSu¥’ded
 =ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

1793 ifĞ
pxTCB
->
uxPriÜ™y
 >ğ
pxCu¼’tTCB
->uxPriority )

1795 
xY›ldRequœed
 = 
pdTRUE
;

1799 
	`mtCOVERAGE_TEST_MARKER
();

1802 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

1803 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

1810 
	`vLi¡In£¹End
Ğ&Ğ
xP’dšgR—dyLi¡
 ), &Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

1815 
	`mtCOVERAGE_TEST_MARKER
();

1818 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

1820  
xY›ldRequœed
;

1821 
	}
}

1826 
	$vTaskS¹ScheduËr
( )

1828 
Ba£Ty³_t
 
xR‘uº
;

1831 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

1833 
SticTask_t
 *
pxIdËTaskTCBBufãr
 = 
NULL
;

1834 
SckTy³_t
 *
pxIdËTaskSckBufãr
 = 
NULL
;

1835 
ušt32_t
 
ulIdËTaskSckSize
;

1839 
	`vAµliÿtiÚG‘IdËTaskMemÜy
Ğ&
pxIdËTaskTCBBufãr
, &
pxIdËTaskSckBufãr
, &
ulIdËTaskSckSize
 );

1840 
xIdËTaskHªdË
 = 
	`xTaskC»©eStic
Ğ
´vIdËTask
,

1842 
ulIdËTaskSckSize
,

1843 Ğ* ) 
NULL
,

1844 Ğ
tskIDLE_PRIORITY
 | 
pÜtPRIVILEGE_BIT
 ),

1845 
pxIdËTaskSckBufãr
,

1846 
pxIdËTaskTCBBufãr
 );

1848 ifĞ
xIdËTaskHªdË
 !ğ
NULL
 )

1850 
xR‘uº
 = 
pdPASS
;

1854 
xR‘uº
 = 
pdFAIL
;

1860 
xR‘uº
 = 
	`xTaskC»©e
Ğ
´vIdËTask
,

1861 "IDLE", 
cÚfigMINIMAL_STACK_SIZE
,

1862 Ğ* ) 
NULL
,

1863 Ğ
tskIDLE_PRIORITY
 | 
pÜtPRIVILEGE_BIT
 ),

1864 &
xIdËTaskHªdË
 );

1868 #iàĞ
cÚfigUSE_TIMERS
 == 1 )

1870 ifĞ
xR‘uº
 =ğ
pdPASS
 )

1872 
xR‘uº
 = 
	`xTim”C»©eTim”Task
();

1876 
	`mtCOVERAGE_TEST_MARKER
();

1881 ifĞ
xR‘uº
 =ğ
pdPASS
 )

1888 
	`pÜtDISABLE_INTERRUPTS
();

1890 #iàĞ
cÚfigUSE_NEWLIB_REENTRANT
 == 1 )

1894 
_impu»_±r
 = &Ğ
pxCu¼’tTCB
->
xNewLib_»’t
 );

1898 
xNextTaskUnblockTime
 = 
pÜtMAX_DELAY
;

1899 
xScheduËrRuÂšg
 = 
pdTRUE
;

1900 
xTickCouÁ
 = ( 
TickTy³_t
 ) 0U;

1905 
	`pÜtCONFIGURE_TIMER_FOR_RUN_TIME_STATS
();

1909 ifĞ
	`xPÜtS¹ScheduËr
(è!ğ
pdFALSE
 )

1924 
	`cÚfigASSERT
Ğ
xR‘uº
 !ğ
”rCOULD_NOT_ALLOCATE_REQUIRED_MEMORY
 );

1929 Ğè
xIdËTaskHªdË
;

1930 
	}
}

1933 
	$vTaskEndScheduËr
( )

1938 
	`pÜtDISABLE_INTERRUPTS
();

1939 
xScheduËrRuÂšg
 = 
pdFALSE
;

1940 
	`vPÜtEndScheduËr
();

1941 
	}
}

1944 
	$vTaskSu¥’dAÎ
( )

1950 ++
uxScheduËrSu¥’ded
;

1951 
	}
}

1954 #iàĞ
cÚfigUSE_TICKLESS_IDLE
 != 0 )

1956 
TickTy³_t
 
	$´vG‘Ex³ùedIdËTime
( )

1958 
TickTy³_t
 
xR‘uº
;

1959 
UBa£Ty³_t
 
uxHigh”PriÜ™yR—dyTasks
 = 
pdFALSE
;

1965 #ifĞ
cÚfigUSE_PORT_OPTIMISED_TASK_SELECTION
 == 0 )

1967 ifĞ
uxTİR—dyPriÜ™y
 > 
tskIDLE_PRIORITY
 )

1969 
uxHigh”PriÜ™yR—dyTasks
 = 
pdTRUE
;

1974 cÚ¡ 
UBa£Ty³_t
 
uxL—¡SignifiÿÁB™
 = ( UBaseType_t ) 0x01;

1981 ifĞ
uxTİR—dyPriÜ™y
 > 
uxL—¡SignifiÿÁB™
 )

1983 
uxHigh”PriÜ™yR—dyTasks
 = 
pdTRUE
;

1985 
	}
}

1988 ifĞ
	gpxCu¼’tTCB
->
	guxPriÜ™y
 > 
	gtskIDLE_PRIORITY
 )

1990 
	gxR‘uº
 = 0;

1992 ifĞ
li¡CURRENT_LIST_LENGTH
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
tskIDLE_PRIORITY
 ] ) ) > 1 )

1997 
	gxR‘uº
 = 0;

1999 ifĞ
	guxHigh”PriÜ™yR—dyTasks
 !ğ
pdFALSE
 )

2004 
xR‘uº
 = 0;

2008 
	gxR‘uº
 = 
xNextTaskUnblockTime
 - 
xTickCouÁ
;

2011  
	gxR‘uº
;

2017 
Ba£Ty³_t
 
	$xTaskResumeAÎ
( )

2019 
TCB_t
 *
pxTCB
 = 
NULL
;

2020 
Ba£Ty³_t
 
xAÌ—dyY›lded
 = 
pdFALSE
;

2024 
	`cÚfigASSERT
Ğ
uxScheduËrSu¥’ded
 );

2031 
	`skENTER_CRITICAL
();

2033 --
uxScheduËrSu¥’ded
;

2035 ifĞ
uxScheduËrSu¥’ded
 =ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

2037 ifĞ
uxCu¼’tNumb”OfTasks
 > ( 
UBa£Ty³_t
 ) 0U )

2041  
	`li¡LIST_IS_EMPTY
Ğ&
xP’dšgR—dyLi¡
 ) =ğ
pdFALSE
 )

2043 
pxTCB
 = ( 
TCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
ĞĞ&
xP’dšgR—dyLi¡
 ) );

2044 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

2045 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

2046 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

2050 ifĞ
pxTCB
->
uxPriÜ™y
 >ğ
pxCu¼’tTCB
->uxPriority )

2052 
xY›ldP’dšg
 = 
pdTRUE
;

2056 
	`mtCOVERAGE_TEST_MARKER
();

2060 ifĞ
pxTCB
 !ğ
NULL
 )

2068 
	`´vRe£tNextTaskUnblockTime
();

2076 
UBa£Ty³_t
 
uxP’dedCouÁs
 = 
uxP’dedTicks
;

2078 ifĞ
uxP’dedCouÁs
 > ( 
UBa£Ty³_t
 ) 0U )

2082 ifĞ
	`xTaskInüem’tTick
(è!ğ
pdFALSE
 )

2084 
xY›ldP’dšg
 = 
pdTRUE
;

2088 
	`mtCOVERAGE_TEST_MARKER
();

2090 --
uxP’dedCouÁs
;

2091 }  
uxP’dedCouÁs
 > ( 
UBa£Ty³_t
 ) 0U );

2093 
uxP’dedTicks
 = 0;

2097 
	`mtCOVERAGE_TEST_MARKER
();

2101 ifĞ
xY›ldP’dšg
 !ğ
pdFALSE
 )

2103 #ifĞ
cÚfigUSE_PREEMPTION
 != 0 )

2105 
xAÌ—dyY›lded
 = 
pdTRUE
;

2108 
	`skYIELD_IF_USING_PREEMPTION
();

2112 
	`mtCOVERAGE_TEST_MARKER
();

2118 
	`mtCOVERAGE_TEST_MARKER
();

2121 
	`skEXIT_CRITICAL
();

2123  
xAÌ—dyY›lded
;

2124 
	}
}

2127 
TickTy³_t
 
	$xTaskG‘TickCouÁ
( )

2129 
TickTy³_t
 
xTicks
;

2132 
	`pÜtTICK_TYPE_ENTER_CRITICAL
();

2134 
xTicks
 = 
xTickCouÁ
;

2136 
	`pÜtTICK_TYPE_EXIT_CRITICAL
();

2138  
xTicks
;

2139 
	}
}

2142 
TickTy³_t
 
	$xTaskG‘TickCouÁFromISR
( )

2144 
TickTy³_t
 
xR‘uº
;

2145 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

2161 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

2163 
uxSavedIÁ”ru±Stus
 = 
	`pÜtTICK_TYPE_SET_INTERRUPT_MASK_FROM_ISR
();

2165 
xR‘uº
 = 
xTickCouÁ
;

2167 
	`pÜtTICK_TYPE_CLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

2169  
xR‘uº
;

2170 
	}
}

2173 
UBa£Ty³_t
 
	$uxTaskG‘Numb”OfTasks
( )

2177  
uxCu¼’tNumb”OfTasks
;

2178 
	}
}

2181 *
	$pcTaskG‘Name
Ğ
TaskHªdË_t
 
xTaskToQu”y
 )

2183 
TCB_t
 *
pxTCB
;

2187 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTaskToQu”y
 );

2188 
	`cÚfigASSERT
Ğ
pxTCB
 );

2189  &Ğ
pxTCB
->
pcTaskName
[ 0 ] );

2190 
	}
}

2193 #iàĞ
INCLUDE_xTaskG‘HªdË
 == 1 )

2195 
TCB_t
 *
	$´vS—rchFÜNameW™hšSšgËLi¡
Ğ
Li¡_t
 *
pxLi¡
, cÚ¡ 
pcNameToQu”y
[] )

2197 
TCB_t
 *
pxNextTCB
, *
pxFœ¡TCB
, *
pxR‘uº
 = 
NULL
;

2198 
UBa£Ty³_t
 
x
;

2199 
cNextCh¬
;

2203 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ
pxLi¡
 ) > ( 
UBa£Ty³_t
 ) 0 )

2205 
	`li¡GET_OWNER_OF_NEXT_ENTRY
Ğ
pxFœ¡TCB
, 
pxLi¡
 );

2209 
	`li¡GET_OWNER_OF_NEXT_ENTRY
Ğ
pxNextTCB
, 
pxLi¡
 );

2213  
x
 = ( 
UBa£Ty³_t
 ) 0; x < ( UBa£Ty³_ˆè
cÚfigMAX_TASK_NAME_LEN
; x++ )

2215 
cNextCh¬
 = 
pxNextTCB
->
pcTaskName
[ 
x
 ];

2217 ifĞ
cNextCh¬
 !ğ
pcNameToQu”y
[ 
x
 ] )

2222 ifĞ
cNextCh¬
 == 0x00 )

2226 
pxR‘uº
 = 
pxNextTCB
;

2231 
	`mtCOVERAGE_TEST_MARKER
();

2235 ifĞ
pxR‘uº
 !ğ
NULL
 )

2241 }  
pxNextTCB
 !ğ
pxFœ¡TCB
 );

2245 
	`mtCOVERAGE_TEST_MARKER
();

2248  
pxR‘uº
;

2249 
	}
}

2254 #iàĞ
INCLUDE_xTaskG‘HªdË
 == 1 )

2256 
TaskHªdË_t
 
	$xTaskG‘HªdË
ĞcÚ¡ *
pcNameToQu”y
 )

2258 
UBa£Ty³_t
 
uxQueue
 = 
cÚfigMAX_PRIORITIES
;

2259 
TCB_t
* 
pxTCB
;

2262 
	`cÚfigASSERT
Ğ
	`¡¾’
Ğ
pcNameToQu”y
 ) < 
cÚfigMAX_TASK_NAME_LEN
 );

2264 
	`vTaskSu¥’dAÎ
();

2269 
uxQueue
--;

2270 
pxTCB
 = 
	`´vS—rchFÜNameW™hšSšgËLi¡
ĞĞ
Li¡_t
 * ) &Ğ
pxR—dyTasksLi¡s
[ 
uxQueue
 ] ), 
pcNameToQu”y
 );

2272 ifĞ
pxTCB
 !ğ
NULL
 )

2278 }  
uxQueue
 > ( 
UBa£Ty³_t
 ) 
tskIDLE_PRIORITY
 );

2281 ifĞ
pxTCB
 =ğ
NULL
 )

2283 
pxTCB
 = 
	`´vS—rchFÜNameW™hšSšgËLi¡
ĞĞ
Li¡_t
 * ) 
pxD–ayedTaskLi¡
, 
pcNameToQu”y
 );

2286 ifĞ
pxTCB
 =ğ
NULL
 )

2288 
pxTCB
 = 
	`´vS—rchFÜNameW™hšSšgËLi¡
ĞĞ
Li¡_t
 * ) 
pxOv”æowD–ayedTaskLi¡
, 
pcNameToQu”y
 );

2291 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

2293 ifĞ
pxTCB
 =ğ
NULL
 )

2296 
pxTCB
 = 
	`´vS—rchFÜNameW™hšSšgËLi¡
Ğ&
xSu¥’dedTaskLi¡
, 
pcNameToQu”y
 );

2301 #ifĞ
INCLUDE_vTaskD–‘e
 == 1 )

2303 ifĞ
pxTCB
 =ğ
NULL
 )

2306 
pxTCB
 = 
	`´vS—rchFÜNameW™hšSšgËLi¡
Ğ&
xTasksWa™šgT”mš©iÚ
, 
pcNameToQu”y
 );

2311 Ğè
	`xTaskResumeAÎ
();

2313  ( 
TaskHªdË_t
 ) 
pxTCB
;

2314 
	}
}

2319 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

2321 
UBa£Ty³_t
 
	$uxTaskG‘Sy¡emS‹
Ğ
TaskStus_t
 * cÚ¡ 
pxTaskStusA¼ay
, cÚ¡ 
UBa£Ty³_t
 
uxA¼aySize
, 
ušt32_t
 * cÚ¡ 
pulTÙ®RunTime
 )

2323 
UBa£Ty³_t
 
uxTask
 = 0, 
uxQueue
 = 
cÚfigMAX_PRIORITIES
;

2325 
	`vTaskSu¥’dAÎ
();

2328 ifĞ
uxA¼aySize
 >ğ
uxCu¼’tNumb”OfTasks
 )

2334 
uxQueue
--;

2335 
uxTask
 +ğ
	`´vLi¡TasksW™hšSšgËLi¡
Ğ&Ğ
pxTaskStusA¼ay
[ uxTask ] ), &Ğ
pxR—dyTasksLi¡s
[ 
uxQueue
 ] ), 
eR—dy
 );

2337 }  
uxQueue
 > ( 
UBa£Ty³_t
 ) 
tskIDLE_PRIORITY
 );

2341 
uxTask
 +ğ
	`´vLi¡TasksW™hšSšgËLi¡
Ğ&Ğ
pxTaskStusA¼ay
[ uxTask ] ), ( 
Li¡_t
 * ) 
pxD–ayedTaskLi¡
, 
eBlocked
 );

2342 
uxTask
 +ğ
	`´vLi¡TasksW™hšSšgËLi¡
Ğ&Ğ
pxTaskStusA¼ay
[ uxTask ] ), ( 
Li¡_t
 * ) 
pxOv”æowD–ayedTaskLi¡
, 
eBlocked
 );

2344 #ifĞ
INCLUDE_vTaskD–‘e
 == 1 )

2348 
uxTask
 +ğ
	`´vLi¡TasksW™hšSšgËLi¡
Ğ&Ğ
pxTaskStusA¼ay
[ uxTask ] ), &
xTasksWa™šgT”mš©iÚ
, 
eD–‘ed
 );

2352 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

2356 
uxTask
 +ğ
	`´vLi¡TasksW™hšSšgËLi¡
Ğ&Ğ
pxTaskStusA¼ay
[ uxTask ] ), &
xSu¥’dedTaskLi¡
, 
eSu¥’ded
 );

2360 #iàĞ
cÚfigGENERATE_RUN_TIME_STATS
 == 1)

2362 ifĞ
pulTÙ®RunTime
 !ğ
NULL
 )

2364 #ifdeà
pÜtALT_GET_RUN_TIME_COUNTER_VALUE


2365 
	`pÜtALT_GET_RUN_TIME_COUNTER_VALUE
ĞĞ*
pulTÙ®RunTime
 ) );

2367 *
pulTÙ®RunTime
 = 
	`pÜtGET_RUN_TIME_COUNTER_VALUE
();

2373 ifĞ
pulTÙ®RunTime
 !ğ
NULL
 )

2375 *
pulTÙ®RunTime
 = 0;

2382 
	`mtCOVERAGE_TEST_MARKER
();

2385 Ğè
	`xTaskResumeAÎ
();

2387  
uxTask
;

2388 
	}
}

2393 #iàĞ
INCLUDE_xTaskG‘IdËTaskHªdË
 == 1 )

2395 
TaskHªdË_t
 
	$xTaskG‘IdËTaskHªdË
( )

2399 
	`cÚfigASSERT
ĞĞ
xIdËTaskHªdË
 !ğ
NULL
 ) );

2400  
xIdËTaskHªdË
;

2401 
	}
}

2410 #iàĞ
cÚfigUSE_TICKLESS_IDLE
 != 0 )

2412 
	$vTaskS‹pTick
ĞcÚ¡ 
TickTy³_t
 
xTicksToJump
 )

2417 
	`cÚfigASSERT
ĞĞ
xTickCouÁ
 + 
xTicksToJump
 ) <ğ
xNextTaskUnblockTime
 );

2418 
xTickCouÁ
 +ğ
xTicksToJump
;

2419 
	`ŒaûINCREASE_TICK_COUNT
Ğ
xTicksToJump
 );

2420 
	}
}

2425 #iàĞ
INCLUDE_xTaskAbÜtD–ay
 == 1 )

2427 
Ba£Ty³_t
 
	$xTaskAbÜtD–ay
Ğ
TaskHªdË_t
 
xTask
 )

2429 
TCB_t
 *
pxTCB
 = ( TCB_ˆ* ) 
xTask
;

2430 
Ba£Ty³_t
 
xR‘uº
 = 
pdFALSE
;

2432 
	`cÚfigASSERT
Ğ
pxTCB
 );

2434 
	`vTaskSu¥’dAÎ
();

2438 ifĞ
	`eTaskG‘S‹
Ğ
xTask
 ) =ğ
eBlocked
 )

2443 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

2449 
	`skENTER_CRITICAL
();

2451 ifĞ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) !ğ
NULL
 )

2453 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

2454 
pxTCB
->
ucD–ayAbÜ‹d
 = 
pdTRUE
;

2458 
	`mtCOVERAGE_TEST_MARKER
();

2461 
	`skEXIT_CRITICAL
();

2464 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

2468 #iàĞ
cÚfigUSE_PREEMPTION
 == 1 )

2473 ifĞ
pxTCB
->
uxPriÜ™y
 > 
pxCu¼’tTCB
->uxPriority )

2477 
xY›ldP’dšg
 = 
pdTRUE
;

2481 
	`mtCOVERAGE_TEST_MARKER
();

2488 
	`mtCOVERAGE_TEST_MARKER
();

2491 
	`xTaskResumeAÎ
();

2493  
xR‘uº
;

2494 
	}
}

2499 
Ba£Ty³_t
 
	$xTaskInüem’tTick
( )

2501 
TCB_t
 * 
pxTCB
;

2502 
TickTy³_t
 
xI‹mV®ue
;

2503 
Ba£Ty³_t
 
xSw™chRequœed
 = 
pdFALSE
;

2508 
	`ŒaûTASK_INCREMENT_TICK
Ğ
xTickCouÁ
 );

2509 ifĞ
uxScheduËrSu¥’ded
 =ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

2513 cÚ¡ 
TickTy³_t
 
xCÚ¡TickCouÁ
 = 
xTickCouÁ
 + 1;

2517 
xTickCouÁ
 = 
xCÚ¡TickCouÁ
;

2519 ifĞ
xCÚ¡TickCouÁ
 =ğĞ
TickTy³_t
 ) 0U )

2521 
	`skSWITCH_DELAYED_LISTS
();

2525 
	`mtCOVERAGE_TEST_MARKER
();

2532 ifĞ
xCÚ¡TickCouÁ
 >ğ
xNextTaskUnblockTime
 )

2536 ifĞ
	`li¡LIST_IS_EMPTY
Ğ
pxD–ayedTaskLi¡
 ) !ğ
pdFALSE
 )

2543 
xNextTaskUnblockTime
 = 
pÜtMAX_DELAY
;

2552 
pxTCB
 = ( 
TCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ
pxD–ayedTaskLi¡
 );

2553 
xI‹mV®ue
 = 
	`li¡GET_LIST_ITEM_VALUE
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

2555 ifĞ
xCÚ¡TickCouÁ
 < 
xI‹mV®ue
 )

2562 
xNextTaskUnblockTime
 = 
xI‹mV®ue
;

2567 
	`mtCOVERAGE_TEST_MARKER
();

2571 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

2575 ifĞ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) !ğ
NULL
 )

2577 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

2581 
	`mtCOVERAGE_TEST_MARKER
();

2586 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

2590 #iàĞ
cÚfigUSE_PREEMPTION
 == 1 )

2596 ifĞ
pxTCB
->
uxPriÜ™y
 >ğ
pxCu¼’tTCB
->uxPriority )

2598 
xSw™chRequœed
 = 
pdTRUE
;

2602 
	`mtCOVERAGE_TEST_MARKER
();

2613 #iàĞĞ
cÚfigUSE_PREEMPTION
 =ğ1 ) && ( 
cÚfigUSE_TIME_SLICING
 == 1 ) )

2615 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
pxCu¼’tTCB
->
uxPriÜ™y
 ] ) ) > ( 
UBa£Ty³_t
 ) 1 )

2617 
xSw™chRequœed
 = 
pdTRUE
;

2621 
	`mtCOVERAGE_TEST_MARKER
();

2626 #iàĞ
cÚfigUSE_TICK_HOOK
 == 1 )

2630 ifĞ
uxP’dedTicks
 =ğĞ
UBa£Ty³_t
 ) 0U )

2632 
	`vAµliÿtiÚTickHook
();

2636 
	`mtCOVERAGE_TEST_MARKER
();

2643 ++
uxP’dedTicks
;

2647 #iàĞ
cÚfigUSE_TICK_HOOK
 == 1 )

2649 
	`vAµliÿtiÚTickHook
();

2654 #iàĞ
cÚfigUSE_PREEMPTION
 == 1 )

2656 ifĞ
xY›ldP’dšg
 !ğ
pdFALSE
 )

2658 
xSw™chRequœed
 = 
pdTRUE
;

2662 
	`mtCOVERAGE_TEST_MARKER
();

2667  
xSw™chRequœed
;

2668 
	}
}

2671 #iàĞ
cÚfigUSE_APPLICATION_TASK_TAG
 == 1 )

2673 
	$vTaskS‘AµliÿtiÚTaskTag
Ğ
TaskHªdË_t
 
xTask
, 
TaskHookFunùiÚ_t
 
pxHookFunùiÚ
 )

2675 
TCB_t
 *
xTCB
;

2679 ifĞ
xTask
 =ğ
NULL
 )

2681 
xTCB
 = ( 
TCB_t
 * ) 
pxCu¼’tTCB
;

2685 
xTCB
 = ( 
TCB_t
 * ) 
xTask
;

2690 
	`skENTER_CRITICAL
();

2691 
xTCB
->
pxTaskTag
 = 
pxHookFunùiÚ
;

2692 
	`skEXIT_CRITICAL
();

2693 
	}
}

2698 #iàĞ
cÚfigUSE_APPLICATION_TASK_TAG
 == 1 )

2700 
TaskHookFunùiÚ_t
 
	$xTaskG‘AµliÿtiÚTaskTag
Ğ
TaskHªdË_t
 
xTask
 )

2702 
TCB_t
 *
xTCB
;

2703 
TaskHookFunùiÚ_t
 
xR‘uº
;

2706 ifĞ
xTask
 =ğ
NULL
 )

2708 
xTCB
 = ( 
TCB_t
 * ) 
pxCu¼’tTCB
;

2712 
xTCB
 = ( 
TCB_t
 * ) 
xTask
;

2717 
	`skENTER_CRITICAL
();

2719 
xR‘uº
 = 
xTCB
->
pxTaskTag
;

2721 
	`skEXIT_CRITICAL
();

2723  
xR‘uº
;

2724 
	}
}

2729 #iàĞ
cÚfigUSE_APPLICATION_TASK_TAG
 == 1 )

2731 
Ba£Ty³_t
 
	$xTaskC®lAµliÿtiÚTaskHook
Ğ
TaskHªdË_t
 
xTask
, *
pvP¬am‘”
 )

2733 
TCB_t
 *
xTCB
;

2734 
Ba£Ty³_t
 
xR‘uº
;

2737 ifĞ
xTask
 =ğ
NULL
 )

2739 
xTCB
 = ( 
TCB_t
 * ) 
pxCu¼’tTCB
;

2743 
xTCB
 = ( 
TCB_t
 * ) 
xTask
;

2746 ifĞ
xTCB
->
pxTaskTag
 !ğ
NULL
 )

2748 
xR‘uº
 = 
xTCB
->
	`pxTaskTag
Ğ
pvP¬am‘”
 );

2752 
xR‘uº
 = 
pdFAIL
;

2755  
xR‘uº
;

2756 
	}
}

2761 
	$vTaskSw™chCÚ‹xt
( )

2763 ifĞ
uxScheduËrSu¥’ded
 !ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

2767 
xY›ldP’dšg
 = 
pdTRUE
;

2771 
xY›ldP’dšg
 = 
pdFALSE
;

2772 
	`ŒaûTASK_SWITCHED_OUT
();

2774 #iàĞ
cÚfigGENERATE_RUN_TIME_STATS
 == 1 )

2776 #ifdeà
pÜtALT_GET_RUN_TIME_COUNTER_VALUE


2777 
	`pÜtALT_GET_RUN_TIME_COUNTER_VALUE
Ğ
ulTÙ®RunTime
 );

2779 
ulTÙ®RunTime
 = 
	`pÜtGET_RUN_TIME_COUNTER_VALUE
();

2789 ifĞ
ulTÙ®RunTime
 > 
ulTaskSw™chedInTime
 )

2791 
pxCu¼’tTCB
->
ulRunTimeCouÁ”
 +ğĞ
ulTÙ®RunTime
 - 
ulTaskSw™chedInTime
 );

2795 
	`mtCOVERAGE_TEST_MARKER
();

2797 
ulTaskSw™chedInTime
 = 
ulTÙ®RunTime
;

2802 
	`skCHECK_FOR_STACK_OVERFLOW
();

2806 
	`skSELECT_HIGHEST_PRIORITY_TASK
();

2807 
	`ŒaûTASK_SWITCHED_IN
();

2809 #iàĞ
cÚfigUSE_NEWLIB_REENTRANT
 == 1 )

2813 
_impu»_±r
 = &Ğ
pxCu¼’tTCB
->
xNewLib_»’t
 );

2817 
	}
}

2820 
	$vTaskPÏûOnEv’tLi¡
Ğ
Li¡_t
 * cÚ¡ 
pxEv’tLi¡
, cÚ¡ 
TickTy³_t
 
xTicksToWa™
 )

2822 
	`cÚfigASSERT
Ğ
pxEv’tLi¡
 );

2831 
	`vLi¡In£¹
Ğ
pxEv’tLi¡
, &Ğ
pxCu¼’tTCB
->
xEv’tLi¡I‹m
 ) );

2833 
	`´vAddCu¼’tTaskToD–ayedLi¡
Ğ
xTicksToWa™
, 
pdTRUE
 );

2834 
	}
}

2837 
	$vTaskPÏûOnUnÜd”edEv’tLi¡
Ğ
Li¡_t
 * 
pxEv’tLi¡
, cÚ¡ 
TickTy³_t
 
xI‹mV®ue
, cÚ¡ TickTy³_ˆ
xTicksToWa™
 )

2839 
	`cÚfigASSERT
Ğ
pxEv’tLi¡
 );

2843 
	`cÚfigASSERT
Ğ
uxScheduËrSu¥’ded
 != 0 );

2848 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxCu¼’tTCB
->
xEv’tLi¡I‹m
 ), 
xI‹mV®ue
 | 
skEVENT_LIST_ITEM_VALUE_IN_USE
 );

2855 
	`vLi¡In£¹End
Ğ
pxEv’tLi¡
, &Ğ
pxCu¼’tTCB
->
xEv’tLi¡I‹m
 ) );

2857 
	`´vAddCu¼’tTaskToD–ayedLi¡
Ğ
xTicksToWa™
, 
pdTRUE
 );

2858 
	}
}

2861 #ifĞ
cÚfigUSE_TIMERS
 == 1 )

2863 
	$vTaskPÏûOnEv’tLi¡Re¡riùed
Ğ
Li¡_t
 * cÚ¡ 
pxEv’tLi¡
, 
TickTy³_t
 
xTicksToWa™
, cÚ¡ 
Ba£Ty³_t
 
xWa™Indefš™–y
 )

2865 
	`cÚfigASSERT
Ğ
pxEv’tLi¡
 );

2877 
	`vLi¡In£¹End
Ğ
pxEv’tLi¡
, &Ğ
pxCu¼’tTCB
->
xEv’tLi¡I‹m
 ) );

2882 ifĞ
xWa™Indefš™–y
 !ğ
pdFALSE
 )

2884 
xTicksToWa™
 = 
pÜtMAX_DELAY
;

2887 
	`ŒaûTASK_DELAY_UNTIL
ĞĞ
xTickCouÁ
 + 
xTicksToWa™
 ) );

2888 
	`´vAddCu¼’tTaskToD–ayedLi¡
Ğ
xTicksToWa™
, 
xWa™Indefš™–y
 );

2889 
	}
}

2894 
Ba£Ty³_t
 
	$xTaskRemoveFromEv’tLi¡
ĞcÚ¡ 
Li¡_t
 * cÚ¡ 
pxEv’tLi¡
 )

2896 
TCB_t
 *
pxUnblockedTCB
;

2897 
Ba£Ty³_t
 
xR‘uº
;

2912 
pxUnblockedTCB
 = ( 
TCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ
pxEv’tLi¡
 );

2913 
	`cÚfigASSERT
Ğ
pxUnblockedTCB
 );

2914 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxUnblockedTCB
->
xEv’tLi¡I‹m
 ) );

2916 ifĞ
uxScheduËrSu¥’ded
 =ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

2918 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxUnblockedTCB
->
xS‹Li¡I‹m
 ) );

2919 
	`´vAddTaskToR—dyLi¡
Ğ
pxUnblockedTCB
 );

2925 
	`vLi¡In£¹End
Ğ&Ğ
xP’dšgR—dyLi¡
 ), &Ğ
pxUnblockedTCB
->
xEv’tLi¡I‹m
 ) );

2928 ifĞ
pxUnblockedTCB
->
uxPriÜ™y
 > 
pxCu¼’tTCB
->uxPriority )

2933 
xR‘uº
 = 
pdTRUE
;

2937 
xY›ldP’dšg
 = 
pdTRUE
;

2941 
xR‘uº
 = 
pdFALSE
;

2944 #ifĞ
cÚfigUSE_TICKLESS_IDLE
 != 0 )

2954 
	`´vRe£tNextTaskUnblockTime
();

2958  
xR‘uº
;

2959 
	}
}

2962 
Ba£Ty³_t
 
	$xTaskRemoveFromUnÜd”edEv’tLi¡
Ğ
Li¡I‹m_t
 * 
pxEv’tLi¡I‹m
, cÚ¡ 
TickTy³_t
 
xI‹mV®ue
 )

2964 
TCB_t
 *
pxUnblockedTCB
;

2965 
Ba£Ty³_t
 
xR‘uº
;

2969 
	`cÚfigASSERT
Ğ
uxScheduËrSu¥’ded
 !ğ
pdFALSE
 );

2972 
	`li¡SET_LIST_ITEM_VALUE
Ğ
pxEv’tLi¡I‹m
, 
xI‹mV®ue
 | 
skEVENT_LIST_ITEM_VALUE_IN_USE
 );

2976 
pxUnblockedTCB
 = ( 
TCB_t
 * ) 
	`li¡GET_LIST_ITEM_OWNER
Ğ
pxEv’tLi¡I‹m
 );

2977 
	`cÚfigASSERT
Ğ
pxUnblockedTCB
 );

2978 Ğè
	`uxLi¡Remove
Ğ
pxEv’tLi¡I‹m
 );

2983 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxUnblockedTCB
->
xS‹Li¡I‹m
 ) );

2984 
	`´vAddTaskToR—dyLi¡
Ğ
pxUnblockedTCB
 );

2986 ifĞ
pxUnblockedTCB
->
uxPriÜ™y
 > 
pxCu¼’tTCB
->uxPriority )

2992 
xR‘uº
 = 
pdTRUE
;

2996 
xY›ldP’dšg
 = 
pdTRUE
;

3000 
xR‘uº
 = 
pdFALSE
;

3003  
xR‘uº
;

3004 
	}
}

3007 
	$vTaskS‘TimeOutS‹
Ğ
TimeOut_t
 * cÚ¡ 
pxTimeOut
 )

3009 
	`cÚfigASSERT
Ğ
pxTimeOut
 );

3010 
pxTimeOut
->
xOv”æowCouÁ
 = 
xNumOfOv”æows
;

3011 
pxTimeOut
->
xTimeOnEÁ”šg
 = 
xTickCouÁ
;

3012 
	}
}

3015 
Ba£Ty³_t
 
	$xTaskCheckFÜTimeOut
Ğ
TimeOut_t
 * cÚ¡ 
pxTimeOut
, 
TickTy³_t
 * cÚ¡ 
pxTicksToWa™
 )

3017 
Ba£Ty³_t
 
xR‘uº
;

3019 
	`cÚfigASSERT
Ğ
pxTimeOut
 );

3020 
	`cÚfigASSERT
Ğ
pxTicksToWa™
 );

3022 
	`skENTER_CRITICAL
();

3025 cÚ¡ 
TickTy³_t
 
xCÚ¡TickCouÁ
 = 
xTickCouÁ
;

3027 #ifĞ
INCLUDE_xTaskAbÜtD–ay
 == 1 )

3028 ifĞ
pxCu¼’tTCB
->
ucD–ayAbÜ‹d
 !ğ
pdFALSE
 )

3032 
pxCu¼’tTCB
->
ucD–ayAbÜ‹d
 = 
pdFALSE
;

3033 
xR‘uº
 = 
pdTRUE
;

3038 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

3039 ifĞ*
pxTicksToWa™
 =ğ
pÜtMAX_DELAY
 )

3044 
xR‘uº
 = 
pdFALSE
;

3049 ifĞĞ
xNumOfOv”æows
 !ğ
pxTimeOut
->
xOv”æowCouÁ
 ) && ( 
xCÚ¡TickCouÁ
 >ğpxTimeOut->
xTimeOnEÁ”šg
 ) )

3056 
xR‘uº
 = 
pdTRUE
;

3058 ifĞĞĞ
TickTy³_t
 ) ( 
xCÚ¡TickCouÁ
 - 
pxTimeOut
->
xTimeOnEÁ”šg
 ) ) < *
pxTicksToWa™
 )

3061 *
pxTicksToWa™
 -ğĞ
xCÚ¡TickCouÁ
 - 
pxTimeOut
->
xTimeOnEÁ”šg
 );

3062 
	`vTaskS‘TimeOutS‹
Ğ
pxTimeOut
 );

3063 
xR‘uº
 = 
pdFALSE
;

3067 
xR‘uº
 = 
pdTRUE
;

3070 
	`skEXIT_CRITICAL
();

3072  
xR‘uº
;

3073 
	}
}

3076 
	$vTaskMis£dY›ld
( )

3078 
xY›ldP’dšg
 = 
pdTRUE
;

3079 
	}
}

3082 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

3084 
UBa£Ty³_t
 
	$uxTaskG‘TaskNumb”
Ğ
TaskHªdË_t
 
xTask
 )

3086 
UBa£Ty³_t
 
uxR‘uº
;

3087 
TCB_t
 *
pxTCB
;

3089 ifĞ
xTask
 !ğ
NULL
 )

3091 
pxTCB
 = ( 
TCB_t
 * ) 
xTask
;

3092 
uxR‘uº
 = 
pxTCB
->
uxTaskNumb”
;

3096 
uxR‘uº
 = 0U;

3099  
uxR‘uº
;

3100 
	}
}

3105 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

3107 
	$vTaskS‘TaskNumb”
Ğ
TaskHªdË_t
 
xTask
, cÚ¡ 
UBa£Ty³_t
 
uxHªdË
 )

3109 
TCB_t
 *
pxTCB
;

3111 ifĞ
xTask
 !ğ
NULL
 )

3113 
pxTCB
 = ( 
TCB_t
 * ) 
xTask
;

3114 
pxTCB
->
uxTaskNumb”
 = 
uxHªdË
;

3116 
	}
}

3131 
	$pÜtTASK_FUNCTION
Ğ
´vIdËTask
, 
pvP¬am‘”s
 )

3134 Ğè
pvP¬am‘”s
;

3143 
	`´vCheckTasksWa™šgT”mš©iÚ
();

3145 #iàĞ
cÚfigUSE_PREEMPTION
 == 0 )

3151 
	`skYIELD
();

3155 #iàĞĞ
cÚfigUSE_PREEMPTION
 =ğ1 ) && ( 
cÚfigIDLE_SHOULD_YIELD
 == 1 ) )

3166 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
tskIDLE_PRIORITY
 ] ) ) > ( 
UBa£Ty³_t
 ) 1 )

3168 
	`skYIELD
();

3172 
	`mtCOVERAGE_TEST_MARKER
();

3177 #iàĞ
cÚfigUSE_IDLE_HOOK
 == 1 )

3179 
	`vAµliÿtiÚIdËHook
( );

3186 
	`vAµliÿtiÚIdËHook
();

3194 #iàĞ
cÚfigUSE_TICKLESS_IDLE
 != 0 )

3196 
TickTy³_t
 
xEx³ùedIdËTime
;

3203 
xEx³ùedIdËTime
 = 
	`´vG‘Ex³ùedIdËTime
();

3205 ifĞ
xEx³ùedIdËTime
 >ğ
cÚfigEXPECTED_IDLE_TIME_BEFORE_SLEEP
 )

3207 
	`vTaskSu¥’dAÎ
();

3212 
	`cÚfigASSERT
Ğ
xNextTaskUnblockTime
 >ğ
xTickCouÁ
 );

3213 
xEx³ùedIdËTime
 = 
	`´vG‘Ex³ùedIdËTime
();

3215 ifĞ
xEx³ùedIdËTime
 >ğ
cÚfigEXPECTED_IDLE_TIME_BEFORE_SLEEP
 )

3217 
	`ŒaûLOW_POWER_IDLE_BEGIN
();

3218 
	`pÜtSUPPRESS_TICKS_AND_SLEEP
Ğ
xEx³ùedIdËTime
 );

3219 
	`ŒaûLOW_POWER_IDLE_END
();

3223 
	`mtCOVERAGE_TEST_MARKER
();

3226 Ğè
	`xTaskResumeAÎ
();

3230 
	`mtCOVERAGE_TEST_MARKER
();

3235 
	}
}

3238 #ifĞ
cÚfigUSE_TICKLESS_IDLE
 != 0 )

3240 
eSË•ModeStus
 
	$eTaskCÚfœmSË•ModeStus
( )

3243 cÚ¡ 
UBa£Ty³_t
 
uxNÚAµliÿtiÚTasks
 = 1;

3244 
eSË•ModeStus
 
eR‘uº
 = 
eSnd¬dSË•
;

3246 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ&
xP’dšgR—dyLi¡
 ) != 0 )

3249 
eR‘uº
 = 
eAbÜtSË•
;

3251 ifĞ
xY›ldP’dšg
 !ğ
pdFALSE
 )

3254 
eR‘uº
 = 
eAbÜtSË•
;

3262 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ&
xSu¥’dedTaskLi¡
 ) =ğĞ
uxCu¼’tNumb”OfTasks
 - 
uxNÚAµliÿtiÚTasks
 ) )

3264 
eR‘uº
 = 
eNoTasksWa™šgTimeout
;

3268 
	`mtCOVERAGE_TEST_MARKER
();

3272  
eR‘uº
;

3273 
	}
}

3278 #iàĞ
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 != 0 )

3280 
	$vTaskS‘Th»adLoÿlStÜagePoš‹r
Ğ
TaskHªdË_t
 
xTaskToS‘
, 
Ba£Ty³_t
 
xIndex
, *
pvV®ue
 )

3282 
TCB_t
 *
pxTCB
;

3284 ifĞ
xIndex
 < 
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 )

3286 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTaskToS‘
 );

3287 
pxTCB
->
pvTh»adLoÿlStÜagePoš‹rs
[ 
xIndex
 ] = 
pvV®ue
;

3289 
	}
}

3294 #iàĞ
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 != 0 )

3296 *
	$pvTaskG‘Th»adLoÿlStÜagePoš‹r
Ğ
TaskHªdË_t
 
xTaskToQu”y
, 
Ba£Ty³_t
 
xIndex
 )

3298 *
pvR‘uº
 = 
NULL
;

3299 
TCB_t
 *
pxTCB
;

3301 ifĞ
xIndex
 < 
cÚfigNUM_THREAD_LOCAL_STORAGE_POINTERS
 )

3303 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTaskToQu”y
 );

3304 
pvR‘uº
 = 
pxTCB
->
pvTh»adLoÿlStÜagePoš‹rs
[ 
xIndex
 ];

3308 
pvR‘uº
 = 
NULL
;

3311  
pvR‘uº
;

3312 
	}
}

3317 #iàĞ
pÜtUSING_MPU_WRAPPERS
 == 1 )

3319 
	$vTaskAÎoÿ‹MPURegiÚs
Ğ
TaskHªdË_t
 
xTaskToModify
, cÚ¡ 
MemÜyRegiÚ_t
 * cÚ¡ 
xRegiÚs
 )

3321 
TCB_t
 *
pxTCB
;

3325 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTaskToModify
 );

3327 
	`vPÜtStÜeTaskMPUS‘tšgs
Ğ&Ğ
pxTCB
->
xMPUS‘tšgs
 ), 
xRegiÚs
, 
NULL
, 0 );

3328 
	}
}

3333 
	$´vIn™Ÿli£TaskLi¡s
( )

3335 
UBa£Ty³_t
 
uxPriÜ™y
;

3337  
uxPriÜ™y
 = ( 
UBa£Ty³_t
 ) 0U; uxPriÜ™y < ( UBa£Ty³_ˆè
cÚfigMAX_PRIORITIES
; uxPriority++ )

3339 
	`vLi¡In™Ÿli£
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
uxPriÜ™y
 ] ) );

3342 
	`vLi¡In™Ÿli£
Ğ&
xD–ayedTaskLi¡1
 );

3343 
	`vLi¡In™Ÿli£
Ğ&
xD–ayedTaskLi¡2
 );

3344 
	`vLi¡In™Ÿli£
Ğ&
xP’dšgR—dyLi¡
 );

3346 #iàĞ
INCLUDE_vTaskD–‘e
 == 1 )

3348 
	`vLi¡In™Ÿli£
Ğ&
xTasksWa™šgT”mš©iÚ
 );

3352 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

3354 
	`vLi¡In™Ÿli£
Ğ&
xSu¥’dedTaskLi¡
 );

3360 
pxD–ayedTaskLi¡
 = &
xD–ayedTaskLi¡1
;

3361 
pxOv”æowD–ayedTaskLi¡
 = &
xD–ayedTaskLi¡2
;

3362 
	}
}

3365 
	$´vCheckTasksWa™šgT”mš©iÚ
( )

3370 #iàĞ
INCLUDE_vTaskD–‘e
 == 1 )

3372 
Ba£Ty³_t
 
xLi¡IsEm±y
;

3376  
uxD–‘edTasksWa™šgCËªUp
 > ( 
UBa£Ty³_t
 ) 0U )

3378 
	`vTaskSu¥’dAÎ
();

3380 
xLi¡IsEm±y
 = 
	`li¡LIST_IS_EMPTY
Ğ&
xTasksWa™šgT”mš©iÚ
 );

3382 Ğè
	`xTaskResumeAÎ
();

3384 ifĞ
xLi¡IsEm±y
 =ğ
pdFALSE
 )

3386 
TCB_t
 *
pxTCB
;

3388 
	`skENTER_CRITICAL
();

3390 
pxTCB
 = ( 
TCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
ĞĞ&
xTasksWa™šgT”mš©iÚ
 ) );

3391 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

3392 --
uxCu¼’tNumb”OfTasks
;

3393 --
uxD–‘edTasksWa™šgCËªUp
;

3395 
	`skEXIT_CRITICAL
();

3397 
	`´vD–‘eTCB
Ğ
pxTCB
 );

3401 
	`mtCOVERAGE_TEST_MARKER
();

3406 
	}
}

3409 #ifĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

3411 
	$vTaskG‘Info
Ğ
TaskHªdË_t
 
xTask
, 
TaskStus_t
 *
pxTaskStus
, 
Ba£Ty³_t
 
xG‘F»eSckS·û
, 
eTaskS‹
 
eS‹
 )

3413 
TCB_t
 *
pxTCB
;

3416 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTask
 );

3418 
pxTaskStus
->
xHªdË
 = ( 
TaskHªdË_t
 ) 
pxTCB
;

3419 
pxTaskStus
->
pcTaskName
 = ( cÚ¡ * ) &Ğ
pxTCB
->pcTaskName [ 0 ] );

3420 
pxTaskStus
->
uxCu¼’tPriÜ™y
 = 
pxTCB
->
uxPriÜ™y
;

3421 
pxTaskStus
->
pxSckBa£
 = 
pxTCB
->
pxSck
;

3422 
pxTaskStus
->
xTaskNumb”
 = 
pxTCB
->
uxTCBNumb”
;

3424 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

3429 ifĞ
pxTaskStus
->
eCu¼’tS‹
 =ğ
eSu¥’ded
 )

3431 
	`vTaskSu¥’dAÎ
();

3433 ifĞ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) !ğ
NULL
 )

3435 
pxTaskStus
->
eCu¼’tS‹
 = 
eBlocked
;

3438 
	`xTaskResumeAÎ
();

3443 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

3445 
pxTaskStus
->
uxBa£PriÜ™y
 = 
pxTCB
->uxBasePriority;

3449 
pxTaskStus
->
uxBa£PriÜ™y
 = 0;

3453 #iàĞ
cÚfigGENERATE_RUN_TIME_STATS
 == 1 )

3455 
pxTaskStus
->
ulRunTimeCouÁ”
 = 
pxTCB
->ulRunTimeCounter;

3459 
pxTaskStus
->
ulRunTimeCouÁ”
 = 0;

3466 ifĞ
eS‹
 !ğ
eInv®id
 )

3468 
pxTaskStus
->
eCu¼’tS‹
 = 
eS‹
;

3472 
pxTaskStus
->
eCu¼’tS‹
 = 
	`eTaskG‘S‹
Ğ
xTask
 );

3477 ifĞ
xG‘F»eSckS·û
 !ğ
pdFALSE
 )

3479 #iàĞ
pÜtSTACK_GROWTH
 > 0 )

3481 
pxTaskStus
->
usSckHighW©”M¬k
 = 
	`´vTaskCheckF»eSckS·û
ĞĞ
ušt8_t
 * ) 
pxTCB
->
pxEndOfSck
 );

3485 
pxTaskStus
->
usSckHighW©”M¬k
 = 
	`´vTaskCheckF»eSckS·û
ĞĞ
ušt8_t
 * ) 
pxTCB
->
pxSck
 );

3491 
pxTaskStus
->
usSckHighW©”M¬k
 = 0;

3493 
	}
}

3498 #iàĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

3500 
UBa£Ty³_t
 
	$´vLi¡TasksW™hšSšgËLi¡
Ğ
TaskStus_t
 *
pxTaskStusA¼ay
, 
Li¡_t
 *
pxLi¡
, 
eTaskS‹
 
eS‹
 )

3502 vŞ©
TCB_t
 *
pxNextTCB
, *
pxFœ¡TCB
;

3503 
UBa£Ty³_t
 
uxTask
 = 0;

3505 ifĞ
	`li¡CURRENT_LIST_LENGTH
Ğ
pxLi¡
 ) > ( 
UBa£Ty³_t
 ) 0 )

3507 
	`li¡GET_OWNER_OF_NEXT_ENTRY
Ğ
pxFœ¡TCB
, 
pxLi¡
 );

3515 
	`li¡GET_OWNER_OF_NEXT_ENTRY
Ğ
pxNextTCB
, 
pxLi¡
 );

3516 
	`vTaskG‘Info
ĞĞ
TaskHªdË_t
 ) 
pxNextTCB
, &Ğ
pxTaskStusA¼ay
[ 
uxTask
 ] ), 
pdTRUE
, 
eS‹
 );

3517 
uxTask
++;

3518 }  
pxNextTCB
 !ğ
pxFœ¡TCB
 );

3522 
	`mtCOVERAGE_TEST_MARKER
();

3525  
uxTask
;

3526 
	}
}

3531 #iàĞĞ
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) || ( 
INCLUDE_uxTaskG‘SckHighW©”M¬k
 == 1 ) )

3533 
ušt16_t
 
	$´vTaskCheckF»eSckS·û
ĞcÚ¡ 
ušt8_t
 * 
pucSckBy‹
 )

3535 
ušt32_t
 
ulCouÁ
 = 0U;

3537  *
pucSckBy‹
 =ğĞ
ušt8_t
 ) 
tskSTACK_FILL_BYTE
 )

3539 
pucSckBy‹
 -ğ
pÜtSTACK_GROWTH
;

3540 
ulCouÁ
++;

3543 
ulCouÁ
 /ğĞ
ušt32_t
 ) Ğ
SckTy³_t
 );

3545  ( 
ušt16_t
 ) 
ulCouÁ
;

3546 
	}
}

3551 #iàĞ
INCLUDE_uxTaskG‘SckHighW©”M¬k
 == 1 )

3553 
UBa£Ty³_t
 
	$uxTaskG‘SckHighW©”M¬k
Ğ
TaskHªdË_t
 
xTask
 )

3555 
TCB_t
 *
pxTCB
;

3556 
ušt8_t
 *
pucEndOfSck
;

3557 
UBa£Ty³_t
 
uxR‘uº
;

3559 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTask
 );

3561 #ià
pÜtSTACK_GROWTH
 < 0

3563 
pucEndOfSck
 = ( 
ušt8_t
 * ) 
pxTCB
->
pxSck
;

3567 
pucEndOfSck
 = ( 
ušt8_t
 * ) 
pxTCB
->
pxEndOfSck
;

3571 
uxR‘uº
 = ( 
UBa£Ty³_t
 ) 
	`´vTaskCheckF»eSckS·û
Ğ
pucEndOfSck
 );

3573  
uxR‘uº
;

3574 
	}
}

3579 #iàĞ
INCLUDE_vTaskD–‘e
 == 1 )

3581 
	$´vD–‘eTCB
Ğ
TCB_t
 *
pxTCB
 )

3586 
	`pÜtCLEAN_UP_TCB
Ğ
pxTCB
 );

3590 #iàĞ
cÚfigUSE_NEWLIB_REENTRANT
 == 1 )

3592 
	`_»şaim_»’t
Ğ&Ğ
pxTCB
->
xNewLib_»’t
 ) );

3596 #ifĞĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 =ğ0 ) && ( 
pÜtUSING_MPU_WRAPPERS
 == 0 ) )

3600 
	`vPÜtF»e
Ğ
pxTCB
->
pxSck
 );

3601 
	`vPÜtF»e
Ğ
pxTCB
 );

3603 #–ifĞ
tskSTATIC_AND_DYNAMIC_ALLOCATION_POSSIBLE
 == 1 )

3608 ifĞ
pxTCB
->
ucStiÿÎyAÎoÿ‹d
 =ğ
tskDYNAMICALLY_ALLOCATED_STACK_AND_TCB
 )

3612 
	`vPÜtF»e
Ğ
pxTCB
->
pxSck
 );

3613 
	`vPÜtF»e
Ğ
pxTCB
 );

3615 ifĞ
pxTCB
->
ucStiÿÎyAÎoÿ‹d
 =ğ
tskSTATICALLY_ALLOCATED_STACK_ONLY
 )

3619 
	`vPÜtF»e
Ğ
pxTCB
 );

3625 
	`cÚfigASSERT
Ğ
pxTCB
->
ucStiÿÎyAÎoÿ‹d
 =ğ
tskSTATICALLY_ALLOCATED_STACK_AND_TCB
 )

3626 
	`mtCOVERAGE_TEST_MARKER
();

3630 
	}
}

3635 
	$´vRe£tNextTaskUnblockTime
( )

3637 
TCB_t
 *
pxTCB
;

3639 ifĞ
	`li¡LIST_IS_EMPTY
Ğ
pxD–ayedTaskLi¡
 ) !ğ
pdFALSE
 )

3645 
xNextTaskUnblockTime
 = 
pÜtMAX_DELAY
;

3653 Ğ
pxTCB
 ) = ( 
TCB_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ
pxD–ayedTaskLi¡
 );

3654 
xNextTaskUnblockTime
 = 
	`li¡GET_LIST_ITEM_VALUE
Ğ&ĞĞ
pxTCB
 )->
xS‹Li¡I‹m
 ) );

3656 
	}
}

3659 #iàĞĞ
INCLUDE_xTaskG‘Cu¼’tTaskHªdË
 =ğ1 ) || ( 
cÚfigUSE_MUTEXES
 == 1 ) )

3661 
TaskHªdË_t
 
	$xTaskG‘Cu¼’tTaskHªdË
( )

3663 
TaskHªdË_t
 
xR‘uº
;

3668 
xR‘uº
 = 
pxCu¼’tTCB
;

3670  
xR‘uº
;

3671 
	}
}

3676 #iàĞĞ
INCLUDE_xTaskG‘ScheduËrS‹
 =ğ1 ) || ( 
cÚfigUSE_TIMERS
 == 1 ) )

3678 
Ba£Ty³_t
 
	$xTaskG‘ScheduËrS‹
( )

3680 
Ba£Ty³_t
 
xR‘uº
;

3682 ifĞ
xScheduËrRuÂšg
 =ğ
pdFALSE
 )

3684 
xR‘uº
 = 
skSCHEDULER_NOT_STARTED
;

3688 ifĞ
uxScheduËrSu¥’ded
 =ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

3690 
xR‘uº
 = 
skSCHEDULER_RUNNING
;

3694 
xR‘uº
 = 
skSCHEDULER_SUSPENDED
;

3698  
xR‘uº
;

3699 
	}
}

3704 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

3706 
	$vTaskPriÜ™yInh”™
Ğ
TaskHªdË_t
 cÚ¡ 
pxMu‹xHŞd”
 )

3708 
TCB_t
 * cÚ¡ 
pxTCB
 = ( TCB_ˆ* ) 
pxMu‹xHŞd”
;

3712 ifĞ
pxMu‹xHŞd”
 !ğ
NULL
 )

3717 ifĞ
pxTCB
->
uxPriÜ™y
 < 
pxCu¼’tTCB
->uxPriority )

3722 ifĞĞ
	`li¡GET_LIST_ITEM_VALUE
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) & 
skEVENT_LIST_ITEM_VALUE_IN_USE
 ) == 0UL )

3724 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ), ( 
TickTy³_t
 ) 
cÚfigMAX_PRIORITIES
 - ( TickTy³_ˆè
pxCu¼’tTCB
->
uxPriÜ™y
 );

3728 
	`mtCOVERAGE_TEST_MARKER
();

3733 ifĞ
	`li¡IS_CONTAINED_WITHIN
Ğ&Ğ
pxR—dyTasksLi¡s
[ 
pxTCB
->
uxPriÜ™y
 ] ), &ĞpxTCB->
xS‹Li¡I‹m
 ) ) !ğ
pdFALSE
 )

3735 ifĞ
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) ) =ğĞ
UBa£Ty³_t
 ) 0 )

3737 
	`skRESET_READY_PRIORITY
Ğ
pxTCB
->
uxPriÜ™y
 );

3741 
	`mtCOVERAGE_TEST_MARKER
();

3745 
pxTCB
->
uxPriÜ™y
 = 
pxCu¼’tTCB
->uxPriority;

3746 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

3751 
pxTCB
->
uxPriÜ™y
 = 
pxCu¼’tTCB
->uxPriority;

3754 
	`ŒaûTASK_PRIORITY_INHERIT
Ğ
pxTCB
, 
pxCu¼’tTCB
->
uxPriÜ™y
 );

3758 
	`mtCOVERAGE_TEST_MARKER
();

3763 
	`mtCOVERAGE_TEST_MARKER
();

3765 
	}
}

3770 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

3772 
Ba£Ty³_t
 
	$xTaskPriÜ™yDisšh”™
Ğ
TaskHªdË_t
 cÚ¡ 
pxMu‹xHŞd”
 )

3774 
TCB_t
 * cÚ¡ 
pxTCB
 = ( TCB_ˆ* ) 
pxMu‹xHŞd”
;

3775 
Ba£Ty³_t
 
xR‘uº
 = 
pdFALSE
;

3777 ifĞ
pxMu‹xHŞd”
 !ğ
NULL
 )

3783 
	`cÚfigASSERT
Ğ
pxTCB
 =ğ
pxCu¼’tTCB
 );

3785 
	`cÚfigASSERT
Ğ
pxTCB
->
uxMu‹xesH–d
 );

3786 Ğ
pxTCB
->
uxMu‹xesH–d
 )--;

3790 ifĞ
pxTCB
->
uxPriÜ™y
 !ğpxTCB->
uxBa£PriÜ™y
 )

3793 ifĞ
pxTCB
->
uxMu‹xesH–d
 =ğĞ
UBa£Ty³_t
 ) 0 )

3800 ifĞ
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) ) =ğĞ
UBa£Ty³_t
 ) 0 )

3802 
	`skRESET_READY_PRIORITY
Ğ
pxTCB
->
uxPriÜ™y
 );

3806 
	`mtCOVERAGE_TEST_MARKER
();

3811 
	`ŒaûTASK_PRIORITY_DISINHERIT
Ğ
pxTCB
,…xTCB->
uxBa£PriÜ™y
 );

3812 
pxTCB
->
uxPriÜ™y
 =…xTCB->
uxBa£PriÜ™y
;

3817 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ), ( 
TickTy³_t
 ) 
cÚfigMAX_PRIORITIES
 - ( TickTy³_ˆèpxTCB->
uxPriÜ™y
 );

3818 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

3828 
xR‘uº
 = 
pdTRUE
;

3832 
	`mtCOVERAGE_TEST_MARKER
();

3837 
	`mtCOVERAGE_TEST_MARKER
();

3842 
	`mtCOVERAGE_TEST_MARKER
();

3845  
xR‘uº
;

3846 
	}
}

3851 #iàĞ
pÜtCRITICAL_NESTING_IN_TCB
 == 1 )

3853 
	$vTaskEÁ”Cr™iÿl
( )

3855 
	`pÜtDISABLE_INTERRUPTS
();

3857 ifĞ
xScheduËrRuÂšg
 !ğ
pdFALSE
 )

3859 Ğ
pxCu¼’tTCB
->
uxCr™iÿlNe¡šg
 )++;

3867 ifĞ
pxCu¼’tTCB
->
uxCr™iÿlNe¡šg
 == 1 )

3869 
	`pÜtASSERT_IF_IN_ISR
();

3874 
	`mtCOVERAGE_TEST_MARKER
();

3876 
	}
}

3881 #iàĞ
pÜtCRITICAL_NESTING_IN_TCB
 == 1 )

3883 
	$vTaskEx™Cr™iÿl
( )

3885 ifĞ
xScheduËrRuÂšg
 !ğ
pdFALSE
 )

3887 ifĞ
pxCu¼’tTCB
->
uxCr™iÿlNe¡šg
 > 0U )

3889 Ğ
pxCu¼’tTCB
->
uxCr™iÿlNe¡šg
 )--;

3891 ifĞ
pxCu¼’tTCB
->
uxCr™iÿlNe¡šg
 == 0U )

3893 
	`pÜtENABLE_INTERRUPTS
();

3897 
	`mtCOVERAGE_TEST_MARKER
();

3902 
	`mtCOVERAGE_TEST_MARKER
();

3907 
	`mtCOVERAGE_TEST_MARKER
();

3909 
	}
}

3914 #iàĞĞ
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) && ( 
cÚfigUSE_STATS_FORMATTING_FUNCTIONS
 > 0 ) )

3916 *
	$´vWr™eNameToBufãr
Ğ*
pcBufãr
, cÚ¡ *
pcTaskName
 )

3918 
size_t
 
x
;

3921 
	`¡rıy
Ğ
pcBufãr
, 
pcTaskName
 );

3925  
x
 = 
	`¡¾’
Ğ
pcBufãr
 ); x < ( 
size_t
 ) ( 
cÚfigMAX_TASK_NAME_LEN
 - 1 ); x++ )

3927 
pcBufãr
[ 
x
 ] = ' ';

3931 
pcBufãr
[ 
x
 ] = 0x00;

3934  &Ğ
pcBufãr
[ 
x
 ] );

3935 
	}
}

3940 #iàĞĞ
cÚfigUSE_TRACE_FACILITY
 =ğ1 ) && ( 
cÚfigUSE_STATS_FORMATTING_FUNCTIONS
 > 0 ) )

3942 
	$vTaskLi¡
Ğ* 
pcWr™eBufãr
 )

3944 
TaskStus_t
 *
pxTaskStusA¼ay
;

3945 vŞ©
UBa£Ty³_t
 
uxA¼aySize
, 
x
;

3946 
cStus
;

3974 *
pcWr™eBufãr
 = 0x00;

3978 
uxA¼aySize
 = 
uxCu¼’tNumb”OfTasks
;

3983 
pxTaskStusA¼ay
 = 
	`pvPÜtM®loc
Ğ
uxCu¼’tNumb”OfTasks
 * Ğ
TaskStus_t
 ) );

3985 ifĞ
pxTaskStusA¼ay
 !ğ
NULL
 )

3988 
uxA¼aySize
 = 
	`uxTaskG‘Sy¡emS‹
Ğ
pxTaskStusA¼ay
, uxA¼aySize, 
NULL
 );

3991  
x
 = 0; x < 
uxA¼aySize
; x++ )

3993  
pxTaskStusA¼ay
[ 
x
 ].
eCu¼’tS‹
 )

3995 
eR—dy
: 
cStus
 = 
tskREADY_CHAR
;

3998 
eBlocked
: 
cStus
 = 
tskBLOCKED_CHAR
;

4001 
eSu¥’ded
: 
cStus
 = 
tskSUSPENDED_CHAR
;

4004 
eD–‘ed
: 
cStus
 = 
tskDELETED_CHAR
;

4009 
cStus
 = 0x00;

4015 
pcWr™eBufãr
 = 
	`´vWr™eNameToBufãr
ĞpcWr™eBufãr, 
pxTaskStusA¼ay
[ 
x
 ].
pcTaskName
 );

4018 
	`¥rštf
Ğ
pcWr™eBufãr
, "\t%c\t%u\t%u\t%u\r\n", 
cStus
, ( è
pxTaskStusA¼ay
[ 
x
 ].
uxCu¼’tPriÜ™y
, ( èpxTaskStusA¼ay[ x ].
usSckHighW©”M¬k
, ( èpxTaskStusA¼ay[ x ].
xTaskNumb”
 );

4019 
pcWr™eBufãr
 +ğ
	`¡¾’
(…cWriteBuffer );

4024 
	`vPÜtF»e
Ğ
pxTaskStusA¼ay
 );

4028 
	`mtCOVERAGE_TEST_MARKER
();

4030 
	}
}

4035 #iàĞĞ
cÚfigGENERATE_RUN_TIME_STATS
 =ğ1 ) && ( 
cÚfigUSE_STATS_FORMATTING_FUNCTIONS
 > 0 ) )

4037 
	$vTaskG‘RunTimeSts
Ğ*
pcWr™eBufãr
 )

4039 
TaskStus_t
 *
pxTaskStusA¼ay
;

4040 vŞ©
UBa£Ty³_t
 
uxA¼aySize
, 
x
;

4041 
ušt32_t
 
ulTÙ®Time
, 
ulStsAsP”ûÁage
;

4043 #ifĞ
cÚfigUSE_TRACE_FACILITY
 != 1 )

4045 #”rÜ 
cÚfigUSE_TRACE_FACILITY
 
mu¡
 
®so
 
be
 
£t
 
to
 1 
š
 
F»eRTOSCÚfig
.
h
Ø
u£
 
	`vTaskG‘RunTimeSts
().

4075 *
pcWr™eBufãr
 = 0x00;

4079 
uxA¼aySize
 = 
uxCu¼’tNumb”OfTasks
;

4084 
pxTaskStusA¼ay
 = 
	`pvPÜtM®loc
Ğ
uxCu¼’tNumb”OfTasks
 * Ğ
TaskStus_t
 ) );

4086 ifĞ
pxTaskStusA¼ay
 !ğ
NULL
 )

4089 
uxA¼aySize
 = 
	`uxTaskG‘Sy¡emS‹
Ğ
pxTaskStusA¼ay
, uxA¼aySize, &
ulTÙ®Time
 );

4092 
ulTÙ®Time
 /= 100UL;

4095 ifĞ
ulTÙ®Time
 > 0 )

4098  
x
 = 0; x < 
uxA¼aySize
; x++ )

4103 
ulStsAsP”ûÁage
 = 
pxTaskStusA¼ay
[ 
x
 ].
ulRunTimeCouÁ”
 / 
ulTÙ®Time
;

4108 
pcWr™eBufãr
 = 
	`´vWr™eNameToBufãr
ĞpcWr™eBufãr, 
pxTaskStusA¼ay
[ 
x
 ].
pcTaskName
 );

4110 ifĞ
ulStsAsP”ûÁage
 > 0UL )

4112 #ifdeà
pÜtLU_PRINTF_SPECIFIER_REQUIRED


4114 
	`¥rštf
Ğ
pcWr™eBufãr
, "\t%lu\t\t%lu%%\r\n", 
pxTaskStusA¼ay
[ 
x
 ].
ulRunTimeCouÁ”
, 
ulStsAsP”ûÁage
 );

4120 
	`¥rštf
Ğ
pcWr™eBufãr
, "\t%u\t\t%u%%\r\n", ( è
pxTaskStusA¼ay
[ 
x
 ].
ulRunTimeCouÁ”
, ( è
ulStsAsP”ûÁage
 );

4128 #ifdeà
pÜtLU_PRINTF_SPECIFIER_REQUIRED


4130 
	`¥rštf
Ğ
pcWr™eBufãr
, "\t%lu\t\t<1%%\r\n", 
pxTaskStusA¼ay
[ 
x
 ].
ulRunTimeCouÁ”
 );

4136 
	`¥rštf
Ğ
pcWr™eBufãr
, "\t%u\t\t<1%%\r\n", ( è
pxTaskStusA¼ay
[ 
x
 ].
ulRunTimeCouÁ”
 );

4141 
pcWr™eBufãr
 +ğ
	`¡¾’
(…cWriteBuffer );

4146 
	`mtCOVERAGE_TEST_MARKER
();

4151 
	`vPÜtF»e
Ğ
pxTaskStusA¼ay
 );

4155 
	`mtCOVERAGE_TEST_MARKER
();

4157 
	}
}

4162 
TickTy³_t
 
	$uxTaskRe£tEv’tI‹mV®ue
( )

4164 
TickTy³_t
 
uxR‘uº
;

4166 
uxR‘uº
 = 
	`li¡GET_LIST_ITEM_VALUE
Ğ&Ğ
pxCu¼’tTCB
->
xEv’tLi¡I‹m
 ) );

4170 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxCu¼’tTCB
->
xEv’tLi¡I‹m
 ), ( ( 
TickTy³_t
 ) 
cÚfigMAX_PRIORITIES
 - ( TickTy³_ˆèpxCu¼’tTCB->
uxPriÜ™y
 ) );

4172  
uxR‘uº
;

4173 
	}
}

4176 #iàĞ
cÚfigUSE_MUTEXES
 == 1 )

4178 *
	$pvTaskInüem’tMu‹xH–dCouÁ
( )

4182 ifĞ
pxCu¼’tTCB
 !ğ
NULL
 )

4184 Ğ
pxCu¼’tTCB
->
uxMu‹xesH–d
 )++;

4187  
pxCu¼’tTCB
;

4188 
	}
}

4193 #ifĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

4195 
ušt32_t
 
	$ulTaskNÙifyTake
Ğ
Ba£Ty³_t
 
xCË¬CouÁOnEx™
, 
TickTy³_t
 
xTicksToWa™
 )

4197 
ušt32_t
 
ulR‘uº
;

4199 
	`skENTER_CRITICAL
();

4202 ifĞ
pxCu¼’tTCB
->
ulNÙif›dV®ue
 == 0UL )

4205 
pxCu¼’tTCB
->
ucNÙifyS‹
 = 
skWAITING_NOTIFICATION
;

4207 ifĞ
xTicksToWa™
 > ( 
TickTy³_t
 ) 0 )

4209 
	`´vAddCu¼’tTaskToD–ayedLi¡
Ğ
xTicksToWa™
, 
pdTRUE
 );

4210 
	`ŒaûTASK_NOTIFY_TAKE_BLOCK
();

4216 
	`pÜtYIELD_WITHIN_API
();

4220 
	`mtCOVERAGE_TEST_MARKER
();

4225 
	`mtCOVERAGE_TEST_MARKER
();

4228 
	`skEXIT_CRITICAL
();

4230 
	`skENTER_CRITICAL
();

4232 
	`ŒaûTASK_NOTIFY_TAKE
();

4233 
ulR‘uº
 = 
pxCu¼’tTCB
->
ulNÙif›dV®ue
;

4235 ifĞ
ulR‘uº
 != 0UL )

4237 ifĞ
xCË¬CouÁOnEx™
 !ğ
pdFALSE
 )

4239 
pxCu¼’tTCB
->
ulNÙif›dV®ue
 = 0UL;

4243 
pxCu¼’tTCB
->
ulNÙif›dV®ue
 = 
ulR‘uº
 - 1;

4248 
	`mtCOVERAGE_TEST_MARKER
();

4251 
pxCu¼’tTCB
->
ucNÙifyS‹
 = 
skNOT_WAITING_NOTIFICATION
;

4253 
	`skEXIT_CRITICAL
();

4255  
ulR‘uº
;

4256 
	}
}

4261 #ifĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

4263 
Ba£Ty³_t
 
	$xTaskNÙifyWa™
Ğ
ušt32_t
 
ulB™sToCË¬OnEÁry
, ušt32_ˆ
ulB™sToCË¬OnEx™
, ušt32_ˆ*
pulNÙifiÿtiÚV®ue
, 
TickTy³_t
 
xTicksToWa™
 )

4265 
Ba£Ty³_t
 
xR‘uº
;

4267 
	`skENTER_CRITICAL
();

4270 ifĞ
pxCu¼’tTCB
->
ucNÙifyS‹
 !ğ
skNOTIFICATION_RECEIVED
 )

4275 
pxCu¼’tTCB
->
ulNÙif›dV®ue
 &ğ~
ulB™sToCË¬OnEÁry
;

4278 
pxCu¼’tTCB
->
ucNÙifyS‹
 = 
skWAITING_NOTIFICATION
;

4280 ifĞ
xTicksToWa™
 > ( 
TickTy³_t
 ) 0 )

4282 
	`´vAddCu¼’tTaskToD–ayedLi¡
Ğ
xTicksToWa™
, 
pdTRUE
 );

4283 
	`ŒaûTASK_NOTIFY_WAIT_BLOCK
();

4289 
	`pÜtYIELD_WITHIN_API
();

4293 
	`mtCOVERAGE_TEST_MARKER
();

4298 
	`mtCOVERAGE_TEST_MARKER
();

4301 
	`skEXIT_CRITICAL
();

4303 
	`skENTER_CRITICAL
();

4305 
	`ŒaûTASK_NOTIFY_WAIT
();

4307 ifĞ
pulNÙifiÿtiÚV®ue
 !ğ
NULL
 )

4311 *
pulNÙifiÿtiÚV®ue
 = 
pxCu¼’tTCB
->
ulNÙif›dV®ue
;

4318 ifĞ
pxCu¼’tTCB
->
ucNÙifyS‹
 =ğ
skWAITING_NOTIFICATION
 )

4321 
xR‘uº
 = 
pdFALSE
;

4327 
pxCu¼’tTCB
->
ulNÙif›dV®ue
 &ğ~
ulB™sToCË¬OnEx™
;

4328 
xR‘uº
 = 
pdTRUE
;

4331 
pxCu¼’tTCB
->
ucNÙifyS‹
 = 
skNOT_WAITING_NOTIFICATION
;

4333 
	`skEXIT_CRITICAL
();

4335  
xR‘uº
;

4336 
	}
}

4341 #ifĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

4343 
Ba£Ty³_t
 
	$xTaskG’”icNÙify
Ğ
TaskHªdË_t
 
xTaskToNÙify
, 
ušt32_t
 
ulV®ue
, 
eNÙifyAùiÚ
 
eAùiÚ
, ušt32_ˆ*
pulP»viousNÙifiÿtiÚV®ue
 )

4345 
TCB_t
 * 
pxTCB
;

4346 
Ba£Ty³_t
 
xR‘uº
 = 
pdPASS
;

4347 
ušt8_t
 
ucOrigš®NÙifyS‹
;

4349 
	`cÚfigASSERT
Ğ
xTaskToNÙify
 );

4350 
pxTCB
 = ( 
TCB_t
 * ) 
xTaskToNÙify
;

4352 
	`skENTER_CRITICAL
();

4354 ifĞ
pulP»viousNÙifiÿtiÚV®ue
 !ğ
NULL
 )

4356 *
pulP»viousNÙifiÿtiÚV®ue
 = 
pxTCB
->
ulNÙif›dV®ue
;

4359 
ucOrigš®NÙifyS‹
 = 
pxTCB
->
ucNÙifyS‹
;

4361 
pxTCB
->
ucNÙifyS‹
 = 
skNOTIFICATION_RECEIVED
;

4363  
eAùiÚ
 )

4365 
eS‘B™s
 :

4366 
pxTCB
->
ulNÙif›dV®ue
 |ğ
ulV®ue
;

4369 
eInüem’t
 :

4370 Ğ
pxTCB
->
ulNÙif›dV®ue
 )++;

4373 
eS‘V®ueW™hOv”wr™e
 :

4374 
pxTCB
->
ulNÙif›dV®ue
 = 
ulV®ue
;

4377 
eS‘V®ueW™houtOv”wr™e
 :

4378 ifĞ
ucOrigš®NÙifyS‹
 !ğ
skNOTIFICATION_RECEIVED
 )

4380 
pxTCB
->
ulNÙif›dV®ue
 = 
ulV®ue
;

4385 
xR‘uº
 = 
pdFAIL
;

4389 
eNoAùiÚ
:

4395 
	`ŒaûTASK_NOTIFY
();

4399 ifĞ
ucOrigš®NÙifyS‹
 =ğ
skWAITING_NOTIFICATION
 )

4401 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

4402 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

4405 
	`cÚfigASSERT
Ğ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) =ğ
NULL
 );

4407 #ifĞ
cÚfigUSE_TICKLESS_IDLE
 != 0 )

4419 
	`´vRe£tNextTaskUnblockTime
();

4423 ifĞ
pxTCB
->
uxPriÜ™y
 > 
pxCu¼’tTCB
->uxPriority )

4427 
	`skYIELD_IF_USING_PREEMPTION
();

4431 
	`mtCOVERAGE_TEST_MARKER
();

4436 
	`mtCOVERAGE_TEST_MARKER
();

4439 
	`skEXIT_CRITICAL
();

4441  
xR‘uº
;

4442 
	}
}

4447 #ifĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

4449 
Ba£Ty³_t
 
	$xTaskG’”icNÙifyFromISR
Ğ
TaskHªdË_t
 
xTaskToNÙify
, 
ušt32_t
 
ulV®ue
, 
eNÙifyAùiÚ
 
eAùiÚ
, ušt32_ˆ*
pulP»viousNÙifiÿtiÚV®ue
, 
Ba£Ty³_t
 *
pxHigh”PriÜ™yTaskWok’
 )

4451 
TCB_t
 * 
pxTCB
;

4452 
ušt8_t
 
ucOrigš®NÙifyS‹
;

4453 
Ba£Ty³_t
 
xR‘uº
 = 
pdPASS
;

4454 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

4456 
	`cÚfigASSERT
Ğ
xTaskToNÙify
 );

4474 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

4476 
pxTCB
 = ( 
TCB_t
 * ) 
xTaskToNÙify
;

4478 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

4480 ifĞ
pulP»viousNÙifiÿtiÚV®ue
 !ğ
NULL
 )

4482 *
pulP»viousNÙifiÿtiÚV®ue
 = 
pxTCB
->
ulNÙif›dV®ue
;

4485 
ucOrigš®NÙifyS‹
 = 
pxTCB
->
ucNÙifyS‹
;

4486 
pxTCB
->
ucNÙifyS‹
 = 
skNOTIFICATION_RECEIVED
;

4488  
eAùiÚ
 )

4490 
eS‘B™s
 :

4491 
pxTCB
->
ulNÙif›dV®ue
 |ğ
ulV®ue
;

4494 
eInüem’t
 :

4495 Ğ
pxTCB
->
ulNÙif›dV®ue
 )++;

4498 
eS‘V®ueW™hOv”wr™e
 :

4499 
pxTCB
->
ulNÙif›dV®ue
 = 
ulV®ue
;

4502 
eS‘V®ueW™houtOv”wr™e
 :

4503 ifĞ
ucOrigš®NÙifyS‹
 !ğ
skNOTIFICATION_RECEIVED
 )

4505 
pxTCB
->
ulNÙif›dV®ue
 = 
ulV®ue
;

4510 
xR‘uº
 = 
pdFAIL
;

4514 
eNoAùiÚ
 :

4520 
	`ŒaûTASK_NOTIFY_FROM_ISR
();

4524 ifĞ
ucOrigš®NÙifyS‹
 =ğ
skWAITING_NOTIFICATION
 )

4527 
	`cÚfigASSERT
Ğ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) =ğ
NULL
 );

4529 ifĞ
uxScheduËrSu¥’ded
 =ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

4531 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

4532 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

4538 
	`vLi¡In£¹End
Ğ&Ğ
xP’dšgR—dyLi¡
 ), &Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

4541 ifĞ
pxTCB
->
uxPriÜ™y
 > 
pxCu¼’tTCB
->uxPriority )

4545 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

4547 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

4554 
xY›ldP’dšg
 = 
pdTRUE
;

4559 
	`mtCOVERAGE_TEST_MARKER
();

4563 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

4565  
xR‘uº
;

4566 
	}
}

4571 #ifĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

4573 
	$vTaskNÙifyGiveFromISR
Ğ
TaskHªdË_t
 
xTaskToNÙify
, 
Ba£Ty³_t
 *
pxHigh”PriÜ™yTaskWok’
 )

4575 
TCB_t
 * 
pxTCB
;

4576 
ušt8_t
 
ucOrigš®NÙifyS‹
;

4577 
UBa£Ty³_t
 
uxSavedIÁ”ru±Stus
;

4579 
	`cÚfigASSERT
Ğ
xTaskToNÙify
 );

4597 
	`pÜtASSERT_IF_INTERRUPT_PRIORITY_INVALID
();

4599 
pxTCB
 = ( 
TCB_t
 * ) 
xTaskToNÙify
;

4601 
uxSavedIÁ”ru±Stus
 = 
	`pÜtSET_INTERRUPT_MASK_FROM_ISR
();

4603 
ucOrigš®NÙifyS‹
 = 
pxTCB
->
ucNÙifyS‹
;

4604 
pxTCB
->
ucNÙifyS‹
 = 
skNOTIFICATION_RECEIVED
;

4608 Ğ
pxTCB
->
ulNÙif›dV®ue
 )++;

4610 
	`ŒaûTASK_NOTIFY_GIVE_FROM_ISR
();

4614 ifĞ
ucOrigš®NÙifyS‹
 =ğ
skWAITING_NOTIFICATION
 )

4617 
	`cÚfigASSERT
Ğ
	`li¡LIST_ITEM_CONTAINER
Ğ&Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) ) =ğ
NULL
 );

4619 ifĞ
uxScheduËrSu¥’ded
 =ğĞ
UBa£Ty³_t
 ) 
pdFALSE
 )

4621 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTCB
->
xS‹Li¡I‹m
 ) );

4622 
	`´vAddTaskToR—dyLi¡
Ğ
pxTCB
 );

4628 
	`vLi¡In£¹End
Ğ&Ğ
xP’dšgR—dyLi¡
 ), &Ğ
pxTCB
->
xEv’tLi¡I‹m
 ) );

4631 ifĞ
pxTCB
->
uxPriÜ™y
 > 
pxCu¼’tTCB
->uxPriority )

4635 ifĞ
pxHigh”PriÜ™yTaskWok’
 !ğ
NULL
 )

4637 *
pxHigh”PriÜ™yTaskWok’
 = 
pdTRUE
;

4644 
xY›ldP’dšg
 = 
pdTRUE
;

4649 
	`mtCOVERAGE_TEST_MARKER
();

4653 
	`pÜtCLEAR_INTERRUPT_MASK_FROM_ISR
Ğ
uxSavedIÁ”ru±Stus
 );

4654 
	}
}

4660 #ifĞ
cÚfigUSE_TASK_NOTIFICATIONS
 == 1 )

4662 
Ba£Ty³_t
 
	$xTaskNÙifyS‹CË¬
Ğ
TaskHªdË_t
 
xTask
 )

4664 
TCB_t
 *
pxTCB
;

4665 
Ba£Ty³_t
 
xR‘uº
;

4669 
pxTCB
 = 
	`´vG‘TCBFromHªdË
Ğ
xTask
 );

4671 
	`skENTER_CRITICAL
();

4673 ifĞ
pxTCB
->
ucNÙifyS‹
 =ğ
skNOTIFICATION_RECEIVED
 )

4675 
pxTCB
->
ucNÙifyS‹
 = 
skNOT_WAITING_NOTIFICATION
;

4676 
xR‘uº
 = 
pdPASS
;

4680 
xR‘uº
 = 
pdFAIL
;

4683 
	`skEXIT_CRITICAL
();

4685  
xR‘uº
;

4686 
	}
}

4692 
	$´vAddCu¼’tTaskToD–ayedLi¡
Ğ
TickTy³_t
 
xTicksToWa™
, cÚ¡ 
Ba£Ty³_t
 
xCªBlockIndefš™–y
 )

4694 
TickTy³_t
 
xTimeToWake
;

4695 cÚ¡ 
TickTy³_t
 
xCÚ¡TickCouÁ
 = 
xTickCouÁ
;

4697 #ifĞ
INCLUDE_xTaskAbÜtD–ay
 == 1 )

4702 
pxCu¼’tTCB
->
ucD–ayAbÜ‹d
 = 
pdFALSE
;

4708 ifĞ
	`uxLi¡Remove
Ğ&Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ) ) =ğĞ
UBa£Ty³_t
 ) 0 )

4712 
	`pÜtRESET_READY_PRIORITY
Ğ
pxCu¼’tTCB
->
uxPriÜ™y
, 
uxTİR—dyPriÜ™y
 );

4716 
	`mtCOVERAGE_TEST_MARKER
();

4719 #iàĞ
INCLUDE_vTaskSu¥’d
 == 1 )

4721 ifĞĞ
xTicksToWa™
 =ğ
pÜtMAX_DELAY
 ) && ( 
xCªBlockIndefš™–y
 !ğ
pdFALSE
 ) )

4726 
	`vLi¡In£¹End
Ğ&
xSu¥’dedTaskLi¡
, &Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ) );

4733 
xTimeToWake
 = 
xCÚ¡TickCouÁ
 + 
xTicksToWa™
;

4736 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ), 
xTimeToWake
 );

4738 ifĞ
xTimeToWake
 < 
xCÚ¡TickCouÁ
 )

4742 
	`vLi¡In£¹
Ğ
pxOv”æowD–ayedTaskLi¡
, &Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ) );

4748 
	`vLi¡In£¹
Ğ
pxD–ayedTaskLi¡
, &Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ) );

4753 ifĞ
xTimeToWake
 < 
xNextTaskUnblockTime
 )

4755 
xNextTaskUnblockTime
 = 
xTimeToWake
;

4759 
	`mtCOVERAGE_TEST_MARKER
();

4769 
xTimeToWake
 = 
xCÚ¡TickCouÁ
 + 
xTicksToWa™
;

4772 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ), 
xTimeToWake
 );

4774 ifĞ
xTimeToWake
 < 
xCÚ¡TickCouÁ
 )

4777 
	`vLi¡In£¹
Ğ
pxOv”æowD–ayedTaskLi¡
, &Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ) );

4782 
	`vLi¡In£¹
Ğ
pxD–ayedTaskLi¡
, &Ğ
pxCu¼’tTCB
->
xS‹Li¡I‹m
 ) );

4787 ifĞ
xTimeToWake
 < 
xNextTaskUnblockTime
 )

4789 
xNextTaskUnblockTime
 = 
xTimeToWake
;

4793 
	`mtCOVERAGE_TEST_MARKER
();

4798 Ğè
xCªBlockIndefš™–y
;

4801 
	}
}

4804 #ifdeà
FREERTOS_MODULE_TEST


4805 
	~"sks_‹¡_acûss_funùiÚs.h
"

	@D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\timers.c

71 
	~<¡dlib.h
>

76 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

78 
	~"F»eRTOS.h
"

79 
	~"sk.h
"

80 
	~"queue.h
"

81 
	~"tim”s.h
"

83 #iàĞ
INCLUDE_xTim”P’dFunùiÚC®l
 =ğ1 ) && ( 
cÚfigUSE_TIMERS
 == 0 )

84 #”rÜ 
cÚfigUSE_TIMERS
 
mu¡
 
be
 
£t
 
to
 1Ø
make
 
the
 
xTim”P’dFunùiÚC®l
(è
funùiÚ
 
avaabË
.

91 #undeà
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


98 #iàĞ
cÚfigUSE_TIMERS
 == 1 )

101 
	#tmrNO_DELAY
 ( 
TickTy³_t
 ) 0U

	)

104 
	stmrTim”CÚŒŞ


106 cÚ¡ *
	mpcTim”Name
;

107 
Li¡I‹m_t
 
	mxTim”Li¡I‹m
;

108 
TickTy³_t
 
	mxTim”P”iodInTicks
;

109 
UBa£Ty³_t
 
	muxAutoR–ßd
;

110 *
	mpvTim”ID
;

111 
Tim”C®lbackFunùiÚ_t
 
	mpxC®lbackFunùiÚ
;

112 #ifĞ
cÚfigUSE_TRACE_FACILITY
 == 1 )

113 
UBa£Ty³_t
 
	muxTim”Numb”
;

116 #ifĞĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 ) )

117 
ušt8_t
 
	mucStiÿÎyAÎoÿ‹d
;

119 } 
	txTIMER
;

123 
xTIMER
 
	tTim”_t
;

130 
	stmrTim”P¬am‘”s


132 
TickTy³_t
 
	mxMes§geV®ue
;

133 
Tim”_t
 * 
	mpxTim”
;

134 } 
	tTim”P¬am‘”_t
;

137 
	stmrC®lbackP¬am‘”s


139 
P’dedFunùiÚ_t
 
	mpxC®lbackFunùiÚ
;

140 *
	mpvP¬am‘”1
;

141 
ušt32_t
 
	mulP¬am‘”2
;

142 } 
	tC®lbackP¬am‘”s_t
;

146 
	stmrTim”QueueMes§ge


148 
Ba£Ty³_t
 
	mxMes§geID
;

151 
Tim”P¬am‘”_t
 
	mxTim”P¬am‘”s
;

155 #iàĞ
INCLUDE_xTim”P’dFunùiÚC®l
 == 1 )

156 
C®lbackP¬am‘”s_t
 
	mxC®lbackP¬am‘”s
;

158 } 
	mu
;

159 } 
	tD«mÚTaskMes§ge_t
;

167 
PRIVILEGED_DATA
 
Li¡_t
 
	gxAùiveTim”Li¡1
;

168 
PRIVILEGED_DATA
 
Li¡_t
 
	gxAùiveTim”Li¡2
;

169 
PRIVILEGED_DATA
 
Li¡_t
 *
	gpxCu¼’tTim”Li¡
;

170 
PRIVILEGED_DATA
 
Li¡_t
 *
	gpxOv”æowTim”Li¡
;

173 
PRIVILEGED_DATA
 
QueueHªdË_t
 
	gxTim”Queue
 = 
NULL
;

174 
PRIVILEGED_DATA
 
TaskHªdË_t
 
	gxTim”TaskHªdË
 = 
NULL
;

180 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

186 
vAµliÿtiÚG‘Tim”TaskMemÜy
Ğ
SticTask_t
 **
µxTim”TaskTCBBufãr
, 
SckTy³_t
 **
µxTim”TaskSckBufãr
, 
ušt32_t
 *
pulTim”TaskSckSize
 );

194 
	$´vCheckFÜV®idLi¡AndQueue
Ğè
PRIVILEGED_FUNCTION
;

201 
	$´vTim”Task
Ğ*
pvP¬am‘”s
 ) 
PRIVILEGED_FUNCTION
;

207 
	$´vProûssReûivedCommªds
Ğè
PRIVILEGED_FUNCTION
;

213 
Ba£Ty³_t
 
	$´vIn£¹Tim”InAùiveLi¡
Ğ
Tim”_t
 * cÚ¡ 
pxTim”
, cÚ¡ 
TickTy³_t
 
xNextExpœyTime
, cÚ¡ TickTy³_ˆ
xTimeNow
, cÚ¡ TickTy³_ˆ
xCommªdTime
 ) 
PRIVILEGED_FUNCTION
;

219 
	$´vProûssExpœedTim”
ĞcÚ¡ 
TickTy³_t
 
xNextExpœeTime
, cÚ¡ TickTy³_ˆ
xTimeNow
 ) 
PRIVILEGED_FUNCTION
;

225 
	$´vSw™chTim”Li¡s
Ğè
PRIVILEGED_FUNCTION
;

231 
TickTy³_t
 
	$´vSam¶eTimeNow
Ğ
Ba£Ty³_t
 * cÚ¡ 
pxTim”Li¡sW”eSw™ched
 ) 
PRIVILEGED_FUNCTION
;

239 
TickTy³_t
 
	$´vG‘NextExpœeTime
Ğ
Ba£Ty³_t
 * cÚ¡ 
pxLi¡WasEm±y
 ) 
PRIVILEGED_FUNCTION
;

245 
	$´vProûssTim”OrBlockTask
ĞcÚ¡ 
TickTy³_t
 
xNextExpœeTime
, 
Ba£Ty³_t
 
xLi¡WasEm±y
 ) 
PRIVILEGED_FUNCTION
;

251 
	$´vIn™Ÿli£NewTim”
ĞcÚ¡ * cÚ¡ 
pcTim”Name
,

252 cÚ¡ 
TickTy³_t
 
xTim”P”iodInTicks
,

253 cÚ¡ 
UBa£Ty³_t
 
uxAutoR–ßd
,

254 * cÚ¡ 
pvTim”ID
,

255 
Tim”C®lbackFunùiÚ_t
 
pxC®lbackFunùiÚ
,

256 
Tim”_t
 *
pxNewTim”
 ) 
PRIVILEGED_FUNCTION
;

259 
Ba£Ty³_t
 
	$xTim”C»©eTim”Task
( )

261 
Ba£Ty³_t
 
xR‘uº
 = 
pdFAIL
;

267 
	`´vCheckFÜV®idLi¡AndQueue
();

269 ifĞ
xTim”Queue
 !ğ
NULL
 )

271 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

273 
SticTask_t
 *
pxTim”TaskTCBBufãr
 = 
NULL
;

274 
SckTy³_t
 *
pxTim”TaskSckBufãr
 = 
NULL
;

275 
ušt32_t
 
ulTim”TaskSckSize
;

277 
	`vAµliÿtiÚG‘Tim”TaskMemÜy
Ğ&
pxTim”TaskTCBBufãr
, &
pxTim”TaskSckBufãr
, &
ulTim”TaskSckSize
 );

278 
xTim”TaskHªdË
 = 
	`xTaskC»©eStic
Ğ
´vTim”Task
,

280 
ulTim”TaskSckSize
,

281 
NULL
,

282 ĞĞ
UBa£Ty³_t
 ) 
cÚfigTIMER_TASK_PRIORITY
 ) | 
pÜtPRIVILEGE_BIT
,

283 
pxTim”TaskSckBufãr
,

284 
pxTim”TaskTCBBufãr
 );

286 ifĞ
xTim”TaskHªdË
 !ğ
NULL
 )

288 
xR‘uº
 = 
pdPASS
;

293 
xR‘uº
 = 
	`xTaskC»©e
Ğ
´vTim”Task
,

295 
cÚfigTIMER_TASK_STACK_DEPTH
,

296 
NULL
,

297 ĞĞ
UBa£Ty³_t
 ) 
cÚfigTIMER_TASK_PRIORITY
 ) | 
pÜtPRIVILEGE_BIT
,

298 &
xTim”TaskHªdË
 );

304 
	`mtCOVERAGE_TEST_MARKER
();

307 
	`cÚfigASSERT
Ğ
xR‘uº
 );

308  
xR‘uº
;

309 
	}
}

312 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 )

314 
Tim”HªdË_t
 
	$xTim”C»©e
ĞcÚ¡ * cÚ¡ 
pcTim”Name
,

315 cÚ¡ 
TickTy³_t
 
xTim”P”iodInTicks
,

316 cÚ¡ 
UBa£Ty³_t
 
uxAutoR–ßd
,

317 * cÚ¡ 
pvTim”ID
,

318 
Tim”C®lbackFunùiÚ_t
 
pxC®lbackFunùiÚ
 )

320 
Tim”_t
 *
pxNewTim”
;

322 
pxNewTim”
 = ( 
Tim”_t
 * ) 
	`pvPÜtM®loc
( ( Timer_t ) );

324 ifĞ
pxNewTim”
 !ğ
NULL
 )

326 
	`´vIn™Ÿli£NewTim”
Ğ
pcTim”Name
, 
xTim”P”iodInTicks
, 
uxAutoR–ßd
, 
pvTim”ID
, 
pxC®lbackFunùiÚ
, 
pxNewTim”
 );

328 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

333 
pxNewTim”
->
ucStiÿÎyAÎoÿ‹d
 = 
pdFALSE
;

338  
pxNewTim”
;

339 
	}
}

344 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

346 
Tim”HªdË_t
 
	$xTim”C»©eStic
ĞcÚ¡ * cÚ¡ 
pcTim”Name
,

347 cÚ¡ 
TickTy³_t
 
xTim”P”iodInTicks
,

348 cÚ¡ 
UBa£Ty³_t
 
uxAutoR–ßd
,

349 * cÚ¡ 
pvTim”ID
,

350 
Tim”C®lbackFunùiÚ_t
 
pxC®lbackFunùiÚ
,

351 
SticTim”_t
 *
pxTim”Bufãr
 )

353 
Tim”_t
 *
pxNewTim”
;

355 #ifĞ
cÚfigASSERT_DEFINED
 == 1 )

360 vŞ©
size_t
 
xSize
 = Ğ
SticTim”_t
 );

361 
	`cÚfigASSERT
Ğ
xSize
 =ğĞ
Tim”_t
 ) );

366 
	`cÚfigASSERT
Ğ
pxTim”Bufãr
 );

367 
pxNewTim”
 = ( 
Tim”_t
 * ) 
pxTim”Bufãr
;

369 ifĞ
pxNewTim”
 !ğ
NULL
 )

371 
	`´vIn™Ÿli£NewTim”
Ğ
pcTim”Name
, 
xTim”P”iodInTicks
, 
uxAutoR–ßd
, 
pvTim”ID
, 
pxC®lbackFunùiÚ
, 
pxNewTim”
 );

373 #ifĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 == 1 )

377 
pxNewTim”
->
ucStiÿÎyAÎoÿ‹d
 = 
pdTRUE
;

382  
pxNewTim”
;

383 
	}
}

388 
	$´vIn™Ÿli£NewTim”
ĞcÚ¡ * cÚ¡ 
pcTim”Name
,

389 cÚ¡ 
TickTy³_t
 
xTim”P”iodInTicks
,

390 cÚ¡ 
UBa£Ty³_t
 
uxAutoR–ßd
,

391 * cÚ¡ 
pvTim”ID
,

392 
Tim”C®lbackFunùiÚ_t
 
pxC®lbackFunùiÚ
,

393 
Tim”_t
 *
pxNewTim”
 )

396 
	`cÚfigASSERT
ĞĞ
xTim”P”iodInTicks
 > 0 ) );

398 ifĞ
pxNewTim”
 !ğ
NULL
 )

402 
	`´vCheckFÜV®idLi¡AndQueue
();

406 
pxNewTim”
->
pcTim”Name
 =…cTimerName;

407 
pxNewTim”
->
xTim”P”iodInTicks
 = xTimerPeriodInTicks;

408 
pxNewTim”
->
uxAutoR–ßd
 = uxAutoReload;

409 
pxNewTim”
->
pvTim”ID
 =…vTimerID;

410 
pxNewTim”
->
pxC®lbackFunùiÚ
 =…xCallbackFunction;

411 
	`vLi¡In™Ÿli£I‹m
Ğ&Ğ
pxNewTim”
->
xTim”Li¡I‹m
 ) );

412 
	`ŒaûTIMER_CREATE
Ğ
pxNewTim”
 );

414 
	}
}

417 
Ba£Ty³_t
 
	$xTim”G’”icCommªd
Ğ
Tim”HªdË_t
 
xTim”
, cÚ¡ 
Ba£Ty³_t
 
xCommªdID
, cÚ¡ 
TickTy³_t
 
xO±iÚ®V®ue
, Ba£Ty³_ˆ* cÚ¡ 
pxHigh”PriÜ™yTaskWok’
, cÚ¡ TickTy³_ˆ
xTicksToWa™
 )

419 
Ba£Ty³_t
 
xR‘uº
 = 
pdFAIL
;

420 
D«mÚTaskMes§ge_t
 
xMes§ge
;

422 
	`cÚfigASSERT
Ğ
xTim”
 );

426 ifĞ
xTim”Queue
 !ğ
NULL
 )

429 
xMes§ge
.
xMes§geID
 = 
xCommªdID
;

430 
xMes§ge
.
u
.
xTim”P¬am‘”s
.
xMes§geV®ue
 = 
xO±iÚ®V®ue
;

431 
xMes§ge
.
u
.
xTim”P¬am‘”s
.
pxTim”
 = ( 
Tim”_t
 * ) 
xTim”
;

433 ifĞ
xCommªdID
 < 
tmrFIRST_FROM_ISR_COMMAND
 )

435 ifĞ
	`xTaskG‘ScheduËrS‹
(è=ğ
skSCHEDULER_RUNNING
 )

437 
xR‘uº
 = 
	`xQueueS’dToBack
Ğ
xTim”Queue
, &
xMes§ge
, 
xTicksToWa™
 );

441 
xR‘uº
 = 
	`xQueueS’dToBack
Ğ
xTim”Queue
, &
xMes§ge
, 
tmrNO_DELAY
 );

446 
xR‘uº
 = 
	`xQueueS’dToBackFromISR
Ğ
xTim”Queue
, &
xMes§ge
, 
pxHigh”PriÜ™yTaskWok’
 );

449 
	`ŒaûTIMER_COMMAND_SEND
Ğ
xTim”
, 
xCommªdID
, 
xO±iÚ®V®ue
, 
xR‘uº
 );

453 
	`mtCOVERAGE_TEST_MARKER
();

456  
xR‘uº
;

457 
	}
}

460 
TaskHªdË_t
 
	$xTim”G‘Tim”D«mÚTaskHªdË
( )

464 
	`cÚfigASSERT
ĞĞ
xTim”TaskHªdË
 !ğ
NULL
 ) );

465  
xTim”TaskHªdË
;

466 
	}
}

469 
TickTy³_t
 
	$xTim”G‘P”iod
Ğ
Tim”HªdË_t
 
xTim”
 )

471 
Tim”_t
 *
pxTim”
 = ( Tim”_ˆ* ) 
xTim”
;

473 
	`cÚfigASSERT
Ğ
xTim”
 );

474  
pxTim”
->
xTim”P”iodInTicks
;

475 
	}
}

478 
TickTy³_t
 
	$xTim”G‘ExpœyTime
Ğ
Tim”HªdË_t
 
xTim”
 )

480 
Tim”_t
 * 
pxTim”
 = ( Tim”_ˆ* ) 
xTim”
;

481 
TickTy³_t
 
xR‘uº
;

483 
	`cÚfigASSERT
Ğ
xTim”
 );

484 
xR‘uº
 = 
	`li¡GET_LIST_ITEM_VALUE
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ) );

485  
xR‘uº
;

486 
	}
}

489 cÚ¡ * 
	$pcTim”G‘Name
Ğ
Tim”HªdË_t
 
xTim”
 )

491 
Tim”_t
 *
pxTim”
 = ( Tim”_ˆ* ) 
xTim”
;

493 
	`cÚfigASSERT
Ğ
xTim”
 );

494  
pxTim”
->
pcTim”Name
;

495 
	}
}

498 
	$´vProûssExpœedTim”
ĞcÚ¡ 
TickTy³_t
 
xNextExpœeTime
, cÚ¡ TickTy³_ˆ
xTimeNow
 )

500 
Ba£Ty³_t
 
xResuÉ
;

501 
Tim”_t
 * cÚ¡ 
pxTim”
 = ( Tim”_ˆ* ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ
pxCu¼’tTim”Li¡
 );

505 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ) );

506 
	`ŒaûTIMER_EXPIRED
Ğ
pxTim”
 );

510 ifĞ
pxTim”
->
uxAutoR–ßd
 =ğĞ
UBa£Ty³_t
 ) 
pdTRUE
 )

515 ifĞ
	`´vIn£¹Tim”InAùiveLi¡
Ğ
pxTim”
, ( 
xNextExpœeTime
 +…xTim”->
xTim”P”iodInTicks
 ), 
xTimeNow
, xNextExpœeTimè!ğ
pdFALSE
 )

519 
xResuÉ
 = 
	`xTim”G’”icCommªd
Ğ
pxTim”
, 
tmrCOMMAND_START_DONT_TRACE
, 
xNextExpœeTime
, 
NULL
, 
tmrNO_DELAY
 );

520 
	`cÚfigASSERT
Ğ
xResuÉ
 );

521 Ğè
xResuÉ
;

525 
	`mtCOVERAGE_TEST_MARKER
();

530 
	`mtCOVERAGE_TEST_MARKER
();

534 
pxTim”
->
	`pxC®lbackFunùiÚ
ĞĞ
Tim”HªdË_t
 )…xTimer );

535 
	}
}

538 
	$´vTim”Task
Ğ*
pvP¬am‘”s
 )

540 
TickTy³_t
 
xNextExpœeTime
;

541 
Ba£Ty³_t
 
xLi¡WasEm±y
;

544 Ğè
pvP¬am‘”s
;

546 #ifĞ
cÚfigUSE_DAEMON_TASK_STARTUP_HOOK
 == 1 )

548 
	`vAµliÿtiÚD«mÚTaskS¹upHook
( );

554 
	`vAµliÿtiÚD«mÚTaskS¹upHook
();

562 
xNextExpœeTime
 = 
	`´vG‘NextExpœeTime
Ğ&
xLi¡WasEm±y
 );

566 
	`´vProûssTim”OrBlockTask
Ğ
xNextExpœeTime
, 
xLi¡WasEm±y
 );

569 
	`´vProûssReûivedCommªds
();

571 
	}
}

574 
	$´vProûssTim”OrBlockTask
ĞcÚ¡ 
TickTy³_t
 
xNextExpœeTime
, 
Ba£Ty³_t
 
xLi¡WasEm±y
 )

576 
TickTy³_t
 
xTimeNow
;

577 
Ba£Ty³_t
 
xTim”Li¡sW”eSw™ched
;

579 
	`vTaskSu¥’dAÎ
();

586 
xTimeNow
 = 
	`´vSam¶eTimeNow
Ğ&
xTim”Li¡sW”eSw™ched
 );

587 ifĞ
xTim”Li¡sW”eSw™ched
 =ğ
pdFALSE
 )

590 ifĞĞ
xLi¡WasEm±y
 =ğ
pdFALSE
 ) && ( 
xNextExpœeTime
 <ğ
xTimeNow
 ) )

592 Ğè
	`xTaskResumeAÎ
();

593 
	`´vProûssExpœedTim”
Ğ
xNextExpœeTime
, 
xTimeNow
 );

603 ifĞ
xLi¡WasEm±y
 !ğ
pdFALSE
 )

607 
xLi¡WasEm±y
 = 
	`li¡LIST_IS_EMPTY
Ğ
pxOv”æowTim”Li¡
 );

610 
	`vQueueWa™FÜMes§geRe¡riùed
Ğ
xTim”Queue
, ( 
xNextExpœeTime
 - 
xTimeNow
 ), 
xLi¡WasEm±y
 );

612 ifĞ
	`xTaskResumeAÎ
(è=ğ
pdFALSE
 )

618 
	`pÜtYIELD_WITHIN_API
();

622 
	`mtCOVERAGE_TEST_MARKER
();

628 Ğè
	`xTaskResumeAÎ
();

631 
	}
}

634 
TickTy³_t
 
	$´vG‘NextExpœeTime
Ğ
Ba£Ty³_t
 * cÚ¡ 
pxLi¡WasEm±y
 )

636 
TickTy³_t
 
xNextExpœeTime
;

645 *
pxLi¡WasEm±y
 = 
	`li¡LIST_IS_EMPTY
Ğ
pxCu¼’tTim”Li¡
 );

646 ifĞ*
pxLi¡WasEm±y
 =ğ
pdFALSE
 )

648 
xNextExpœeTime
 = 
	`li¡GET_ITEM_VALUE_OF_HEAD_ENTRY
Ğ
pxCu¼’tTim”Li¡
 );

653 
xNextExpœeTime
 = ( 
TickTy³_t
 ) 0U;

656  
xNextExpœeTime
;

657 
	}
}

660 
TickTy³_t
 
	$´vSam¶eTimeNow
Ğ
Ba£Ty³_t
 * cÚ¡ 
pxTim”Li¡sW”eSw™ched
 )

662 
TickTy³_t
 
xTimeNow
;

663 
PRIVILEGED_DATA
 
TickTy³_t
 
xLa¡Time
 = ( TickType_t ) 0U;

665 
xTimeNow
 = 
	`xTaskG‘TickCouÁ
();

667 ifĞ
xTimeNow
 < 
xLa¡Time
 )

669 
	`´vSw™chTim”Li¡s
();

670 *
pxTim”Li¡sW”eSw™ched
 = 
pdTRUE
;

674 *
pxTim”Li¡sW”eSw™ched
 = 
pdFALSE
;

677 
xLa¡Time
 = 
xTimeNow
;

679  
xTimeNow
;

680 
	}
}

683 
Ba£Ty³_t
 
	$´vIn£¹Tim”InAùiveLi¡
Ğ
Tim”_t
 * cÚ¡ 
pxTim”
, cÚ¡ 
TickTy³_t
 
xNextExpœyTime
, cÚ¡ TickTy³_ˆ
xTimeNow
, cÚ¡ TickTy³_ˆ
xCommªdTime
 )

685 
Ba£Ty³_t
 
xProûssTim”Now
 = 
pdFALSE
;

687 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ), 
xNextExpœyTime
 );

688 
	`li¡SET_LIST_ITEM_OWNER
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ),…xTimer );

690 ifĞ
xNextExpœyTime
 <ğ
xTimeNow
 )

694 ifĞĞĞ
TickTy³_t
 ) ( 
xTimeNow
 - 
xCommªdTime
 ) ) >ğ
pxTim”
->
xTim”P”iodInTicks
 )

698 
xProûssTim”Now
 = 
pdTRUE
;

702 
	`vLi¡In£¹
Ğ
pxOv”æowTim”Li¡
, &Ğ
pxTim”
->
xTim”Li¡I‹m
 ) );

707 ifĞĞ
xTimeNow
 < 
xCommªdTime
 ) && ( 
xNextExpœyTime
 >= xCommandTime ) )

712 
xProûssTim”Now
 = 
pdTRUE
;

716 
	`vLi¡In£¹
Ğ
pxCu¼’tTim”Li¡
, &Ğ
pxTim”
->
xTim”Li¡I‹m
 ) );

720  
xProûssTim”Now
;

721 
	}
}

724 
	$´vProûssReûivedCommªds
( )

726 
D«mÚTaskMes§ge_t
 
xMes§ge
;

727 
Tim”_t
 *
pxTim”
;

728 
Ba£Ty³_t
 
xTim”Li¡sW”eSw™ched
, 
xResuÉ
;

729 
TickTy³_t
 
xTimeNow
;

731  
	`xQueueReûive
Ğ
xTim”Queue
, &
xMes§ge
, 
tmrNO_DELAY
 ) !ğ
pdFAIL
 )

733 #iàĞ
INCLUDE_xTim”P’dFunùiÚC®l
 == 1 )

737 ifĞ
xMes§ge
.
xMes§geID
 < ( 
Ba£Ty³_t
 ) 0 )

739 cÚ¡ 
C®lbackP¬am‘”s_t
 * cÚ¡ 
pxC®lback
 = &Ğ
xMes§ge
.
u
.
xC®lbackP¬am‘”s
 );

743 
	`cÚfigASSERT
Ğ
pxC®lback
 );

746 
pxC®lback
->
	`pxC®lbackFunùiÚ
ĞpxC®lback->
pvP¬am‘”1
,…xC®lback->
ulP¬am‘”2
 );

750 
	`mtCOVERAGE_TEST_MARKER
();

757 ifĞ
xMes§ge
.
xMes§geID
 >ğĞ
Ba£Ty³_t
 ) 0 )

761 
pxTim”
 = 
xMes§ge
.
u
.
xTim”P¬am‘”s
.pxTimer;

763 ifĞ
	`li¡IS_CONTAINED_WITHIN
Ğ
NULL
, &Ğ
pxTim”
->
xTim”Li¡I‹m
 ) ) =ğ
pdFALSE
 )

766 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ) );

770 
	`mtCOVERAGE_TEST_MARKER
();

773 
	`ŒaûTIMER_COMMAND_RECEIVED
Ğ
pxTim”
, 
xMes§ge
.
xMes§geID
, xMes§ge.
u
.
xTim”P¬am‘”s
.
xMes§geV®ue
 );

781 
xTimeNow
 = 
	`´vSam¶eTimeNow
Ğ&
xTim”Li¡sW”eSw™ched
 );

783  
xMes§ge
.
xMes§geID
 )

785 
tmrCOMMAND_START
 :

786 
tmrCOMMAND_START_FROM_ISR
 :

787 
tmrCOMMAND_RESET
 :

788 
tmrCOMMAND_RESET_FROM_ISR
 :

789 
tmrCOMMAND_START_DONT_TRACE
 :

791 ifĞ
	`´vIn£¹Tim”InAùiveLi¡
Ğ
pxTim”
, 
xMes§ge
.
u
.
xTim”P¬am‘”s
.
xMes§geV®ue
 +…xTim”->
xTim”P”iodInTicks
, 
xTimeNow
, xMes§ge.u.xTim”P¬am‘”s.xMes§geV®uè!ğ
pdFALSE
 )

795 
pxTim”
->
	`pxC®lbackFunùiÚ
ĞĞ
Tim”HªdË_t
 )…xTimer );

796 
	`ŒaûTIMER_EXPIRED
Ğ
pxTim”
 );

798 ifĞ
pxTim”
->
uxAutoR–ßd
 =ğĞ
UBa£Ty³_t
 ) 
pdTRUE
 )

800 
xResuÉ
 = 
	`xTim”G’”icCommªd
Ğ
pxTim”
, 
tmrCOMMAND_START_DONT_TRACE
, 
xMes§ge
.
u
.
xTim”P¬am‘”s
.
xMes§geV®ue
 +…xTim”->
xTim”P”iodInTicks
, 
NULL
, 
tmrNO_DELAY
 );

801 
	`cÚfigASSERT
Ğ
xResuÉ
 );

802 Ğè
xResuÉ
;

806 
	`mtCOVERAGE_TEST_MARKER
();

811 
	`mtCOVERAGE_TEST_MARKER
();

815 
tmrCOMMAND_STOP
 :

816 
tmrCOMMAND_STOP_FROM_ISR
 :

821 
tmrCOMMAND_CHANGE_PERIOD
 :

822 
tmrCOMMAND_CHANGE_PERIOD_FROM_ISR
 :

823 
pxTim”
->
xTim”P”iodInTicks
 = 
xMes§ge
.
u
.
xTim”P¬am‘”s
.
xMes§geV®ue
;

824 
	`cÚfigASSERT
ĞĞ
pxTim”
->
xTim”P”iodInTicks
 > 0 ) );

832 Ğè
	`´vIn£¹Tim”InAùiveLi¡
Ğ
pxTim”
, ( 
xTimeNow
 +…xTim”->
xTim”P”iodInTicks
 ), xTimeNow, xTimeNow );

835 
tmrCOMMAND_DELETE
 :

839 #ifĞĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 0 ) )

843 
	`vPÜtF»e
Ğ
pxTim”
 );

845 #–ifĞĞ
cÚfigSUPPORT_DYNAMIC_ALLOCATION
 =ğ1 ) && ( 
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 ) )

850 ifĞ
pxTim”
->
ucStiÿÎyAÎoÿ‹d
 =ğĞ
ušt8_t
 ) 
pdFALSE
 )

852 
	`vPÜtF»e
Ğ
pxTim”
 );

856 
	`mtCOVERAGE_TEST_MARKER
();

868 
	}
}

871 
	$´vSw™chTim”Li¡s
( )

873 
TickTy³_t
 
xNextExpœeTime
, 
xR–ßdTime
;

874 
Li¡_t
 *
pxTemp
;

875 
Tim”_t
 *
pxTim”
;

876 
Ba£Ty³_t
 
xResuÉ
;

882  
	`li¡LIST_IS_EMPTY
Ğ
pxCu¼’tTim”Li¡
 ) =ğ
pdFALSE
 )

884 
xNextExpœeTime
 = 
	`li¡GET_ITEM_VALUE_OF_HEAD_ENTRY
Ğ
pxCu¼’tTim”Li¡
 );

887 
pxTim”
 = ( 
Tim”_t
 * ) 
	`li¡GET_OWNER_OF_HEAD_ENTRY
Ğ
pxCu¼’tTim”Li¡
 );

888 Ğè
	`uxLi¡Remove
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ) );

889 
	`ŒaûTIMER_EXPIRED
Ğ
pxTim”
 );

894 
pxTim”
->
	`pxC®lbackFunùiÚ
ĞĞ
Tim”HªdË_t
 )…xTimer );

896 ifĞ
pxTim”
->
uxAutoR–ßd
 =ğĞ
UBa£Ty³_t
 ) 
pdTRUE
 )

904 
xR–ßdTime
 = ( 
xNextExpœeTime
 + 
pxTim”
->
xTim”P”iodInTicks
 );

905 ifĞ
xR–ßdTime
 > 
xNextExpœeTime
 )

907 
	`li¡SET_LIST_ITEM_VALUE
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ), 
xR–ßdTime
 );

908 
	`li¡SET_LIST_ITEM_OWNER
Ğ&Ğ
pxTim”
->
xTim”Li¡I‹m
 ),…xTimer );

909 
	`vLi¡In£¹
Ğ
pxCu¼’tTim”Li¡
, &Ğ
pxTim”
->
xTim”Li¡I‹m
 ) );

913 
xResuÉ
 = 
	`xTim”G’”icCommªd
Ğ
pxTim”
, 
tmrCOMMAND_START_DONT_TRACE
, 
xNextExpœeTime
, 
NULL
, 
tmrNO_DELAY
 );

914 
	`cÚfigASSERT
Ğ
xResuÉ
 );

915 Ğè
xResuÉ
;

920 
	`mtCOVERAGE_TEST_MARKER
();

924 
pxTemp
 = 
pxCu¼’tTim”Li¡
;

925 
pxCu¼’tTim”Li¡
 = 
pxOv”æowTim”Li¡
;

926 
pxOv”æowTim”Li¡
 = 
pxTemp
;

927 
	}
}

930 
	$´vCheckFÜV®idLi¡AndQueue
( )

935 
	`skENTER_CRITICAL
();

937 ifĞ
xTim”Queue
 =ğ
NULL
 )

939 
	`vLi¡In™Ÿli£
Ğ&
xAùiveTim”Li¡1
 );

940 
	`vLi¡In™Ÿli£
Ğ&
xAùiveTim”Li¡2
 );

941 
pxCu¼’tTim”Li¡
 = &
xAùiveTim”Li¡1
;

942 
pxOv”æowTim”Li¡
 = &
xAùiveTim”Li¡2
;

944 #ifĞ
cÚfigSUPPORT_STATIC_ALLOCATION
 == 1 )

948 
SticQueue_t
 
xSticTim”Queue
;

949 
ušt8_t
 
ucSticTim”QueueStÜage
[ 
cÚfigTIMER_QUEUE_LENGTH
 * Ğ
D«mÚTaskMes§ge_t
 ) ];

951 
xTim”Queue
 = 
	`xQueueC»©eStic
ĞĞ
UBa£Ty³_t
 ) 
cÚfigTIMER_QUEUE_LENGTH
, Ğ
D«mÚTaskMes§ge_t
 ), &Ğ
ucSticTim”QueueStÜage
[ 0 ] ), &
xSticTim”Queue
 );

955 
xTim”Queue
 = 
	`xQueueC»©e
ĞĞ
UBa£Ty³_t
 ) 
cÚfigTIMER_QUEUE_LENGTH
, Ğ
D«mÚTaskMes§ge_t
 ) );

959 #iàĞ
cÚfigQUEUE_REGISTRY_SIZE
 > 0 )

961 ifĞ
xTim”Queue
 !ğ
NULL
 )

963 
	`vQueueAddToRegi¡ry
Ğ
xTim”Queue
, "TmrQ" );

967 
	`mtCOVERAGE_TEST_MARKER
();

974 
	`mtCOVERAGE_TEST_MARKER
();

977 
	`skEXIT_CRITICAL
();

978 
	}
}

981 
Ba£Ty³_t
 
	$xTim”IsTim”Aùive
Ğ
Tim”HªdË_t
 
xTim”
 )

983 
Ba£Ty³_t
 
xTim”IsInAùiveLi¡
;

984 
Tim”_t
 *
pxTim”
 = ( Tim”_ˆ* ) 
xTim”
;

986 
	`cÚfigASSERT
Ğ
xTim”
 );

989 
	`skENTER_CRITICAL
();

994 
xTim”IsInAùiveLi¡
 = ( 
Ba£Ty³_t
 ) !Ğ
	`li¡IS_CONTAINED_WITHIN
Ğ
NULL
, &Ğ
pxTim”
->
xTim”Li¡I‹m
 ) ) );

996 
	`skEXIT_CRITICAL
();

998  
xTim”IsInAùiveLi¡
;

999 
	}
}

1002 *
	$pvTim”G‘Tim”ID
ĞcÚ¡ 
Tim”HªdË_t
 
xTim”
 )

1004 
Tim”_t
 * cÚ¡ 
pxTim”
 = ( Tim”_ˆ* ) 
xTim”
;

1005 *
pvR‘uº
;

1007 
	`cÚfigASSERT
Ğ
xTim”
 );

1009 
	`skENTER_CRITICAL
();

1011 
pvR‘uº
 = 
pxTim”
->
pvTim”ID
;

1013 
	`skEXIT_CRITICAL
();

1015  
pvR‘uº
;

1016 
	}
}

1019 
	$vTim”S‘Tim”ID
Ğ
Tim”HªdË_t
 
xTim”
, *
pvNewID
 )

1021 
Tim”_t
 * cÚ¡ 
pxTim”
 = ( Tim”_ˆ* ) 
xTim”
;

1023 
	`cÚfigASSERT
Ğ
xTim”
 );

1025 
	`skENTER_CRITICAL
();

1027 
pxTim”
->
pvTim”ID
 = 
pvNewID
;

1029 
	`skEXIT_CRITICAL
();

1030 
	}
}

1033 #ifĞ
INCLUDE_xTim”P’dFunùiÚC®l
 == 1 )

1035 
Ba£Ty³_t
 
	$xTim”P’dFunùiÚC®lFromISR
Ğ
P’dedFunùiÚ_t
 
xFunùiÚToP’d
, *
pvP¬am‘”1
, 
ušt32_t
 
ulP¬am‘”2
, 
Ba£Ty³_t
 *
pxHigh”PriÜ™yTaskWok’
 )

1037 
D«mÚTaskMes§ge_t
 
xMes§ge
;

1038 
Ba£Ty³_t
 
xR‘uº
;

1042 
xMes§ge
.
xMes§geID
 = 
tmrCOMMAND_EXECUTE_CALLBACK_FROM_ISR
;

1043 
xMes§ge
.
u
.
xC®lbackP¬am‘”s
.
pxC®lbackFunùiÚ
 = 
xFunùiÚToP’d
;

1044 
xMes§ge
.
u
.
xC®lbackP¬am‘”s
.
pvP¬am‘”1
 =…vParameter1;

1045 
xMes§ge
.
u
.
xC®lbackP¬am‘”s
.
ulP¬am‘”2
 = ulParameter2;

1047 
xR‘uº
 = 
	`xQueueS’dFromISR
Ğ
xTim”Queue
, &
xMes§ge
, 
pxHigh”PriÜ™yTaskWok’
 );

1049 
	`ŒaûPEND_FUNC_CALL_FROM_ISR
Ğ
xFunùiÚToP’d
, 
pvP¬am‘”1
, 
ulP¬am‘”2
, 
xR‘uº
 );

1051  
xR‘uº
;

1052 
	}
}

1057 #ifĞ
INCLUDE_xTim”P’dFunùiÚC®l
 == 1 )

1059 
Ba£Ty³_t
 
	$xTim”P’dFunùiÚC®l
Ğ
P’dedFunùiÚ_t
 
xFunùiÚToP’d
, *
pvP¬am‘”1
, 
ušt32_t
 
ulP¬am‘”2
, 
TickTy³_t
 
xTicksToWa™
 )

1061 
D«mÚTaskMes§ge_t
 
xMes§ge
;

1062 
Ba£Ty³_t
 
xR‘uº
;

1067 
	`cÚfigASSERT
Ğ
xTim”Queue
 );

1071 
xMes§ge
.
xMes§geID
 = 
tmrCOMMAND_EXECUTE_CALLBACK
;

1072 
xMes§ge
.
u
.
xC®lbackP¬am‘”s
.
pxC®lbackFunùiÚ
 = 
xFunùiÚToP’d
;

1073 
xMes§ge
.
u
.
xC®lbackP¬am‘”s
.
pvP¬am‘”1
 =…vParameter1;

1074 
xMes§ge
.
u
.
xC®lbackP¬am‘”s
.
ulP¬am‘”2
 = ulParameter2;

1076 
xR‘uº
 = 
	`xQueueS’dToBack
Ğ
xTim”Queue
, &
xMes§ge
, 
xTicksToWa™
 );

1078 
	`ŒaûPEND_FUNC_CALL
Ğ
xFunùiÚToP’d
, 
pvP¬am‘”1
, 
ulP¬am‘”2
, 
xR‘uº
 );

1080  
xR‘uº
;

1081 
	}
}

	@
1
.
0
150
10261
D:\Documents\Projects\chargersdk\build\EmBitz\startup\startup_stm32f429x.S
D:\Documents\Projects\chargersdk\build\EmBitz\version.h
D:\Documents\Projects\chargersdk\nand\system\evse_config.xml
D:\Documents\Projects\chargersdk\nand\system\public_info.xml
D:\Documents\Projects\chargersdk\src\app\EVSE.c
D:\Documents\Projects\chargersdk\src\app\EVSE.h
D:\Documents\Projects\chargersdk\src\app\chargepoint.c
D:\Documents\Projects\chargersdk\src\app\chargepoint.h
D:\Documents\Projects\chargersdk\src\app\errorcode.c
D:\Documents\Projects\chargersdk\src\app\errorcode.h
D:\Documents\Projects\chargersdk\src\app\evse_config.h
D:\Documents\Projects\chargersdk\src\app\evse_globals.c
D:\Documents\Projects\chargersdk\src\app\evse_globals.h
D:\Documents\Projects\chargersdk\src\app\includes.h
D:\Documents\Projects\chargersdk\src\app\interface.h
D:\Documents\Projects\chargersdk\src\app\interface_charge.c
D:\Documents\Projects\chargersdk\src\app\interface_charge.h
D:\Documents\Projects\chargersdk\src\app\interface_data.c
D:\Documents\Projects\chargersdk\src\app\interface_data.h
D:\Documents\Projects\chargersdk\src\app\interface_diag.c
D:\Documents\Projects\chargersdk\src\app\interface_monitor.c
D:\Documents\Projects\chargersdk\src\app\interface_monitor.h
D:\Documents\Projects\chargersdk\src\app\interface_remote.c
D:\Documents\Projects\chargersdk\src\app\interface_remote.h
D:\Documents\Projects\chargersdk\src\app\interface_rfid.c
D:\Documents\Projects\chargersdk\src\app\interface_rfid.h
D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_err.c
D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_err.h
D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_globals.h
D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_protocol.c
D:\Documents\Projects\chargersdk\src\app\libpowershare\ps_transportlayer.c
D:\Documents\Projects\chargersdk\src\app\main.c
D:\Documents\Projects\chargersdk\src\app\stm32f4xx_it.c
D:\Documents\Projects\chargersdk\src\app\sysinit.c
D:\Documents\Projects\chargersdk\src\app\taskOTA.c
D:\Documents\Projects\chargersdk\src\app\taskOTA.h
D:\Documents\Projects\chargersdk\src\app\taskcharge.c
D:\Documents\Projects\chargersdk\src\app\taskcharge.h
D:\Documents\Projects\chargersdk\src\app\taskcreate.c
D:\Documents\Projects\chargersdk\src\app\taskcreate.h
D:\Documents\Projects\chargersdk\src\app\taskdata.c
D:\Documents\Projects\chargersdk\src\app\taskdata.h
D:\Documents\Projects\chargersdk\src\app\taskdiag.c
D:\Documents\Projects\chargersdk\src\app\taskdiag.h
D:\Documents\Projects\chargersdk\src\app\taskmonitor.c
D:\Documents\Projects\chargersdk\src\app\taskmonitor.h
D:\Documents\Projects\chargersdk\src\app\taskremote.c
D:\Documents\Projects\chargersdk\src\app\taskremote.h
D:\Documents\Projects\chargersdk\src\app\taskrfid.c
D:\Documents\Projects\chargersdk\src\app\taskrfid.h
D:\Documents\Projects\chargersdk\src\app\timercallback.c
D:\Documents\Projects\chargersdk\src\cli\cli_app.c
D:\Documents\Projects\chargersdk\src\cli\cli_fatfs.c
D:\Documents\Projects\chargersdk\src\cli\cli_main.c
D:\Documents\Projects\chargersdk\src\cli\cli_main.h
D:\Documents\Projects\chargersdk\src\cli\cli_rtos.c
D:\Documents\Projects\chargersdk\src\cli\cli_xml.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp.h
D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp_gpio.h
D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp_timer.h
D:\Documents\Projects\chargersdk\src\drivers\bsp\inc\bsp_uart.h
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_dwt.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_gpio.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_nand_ftl.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_nand_hw.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_rtc.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_sdram.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_timer.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_touch_2046.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_uart.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\bsp_user_lib.c
D:\Documents\Projects\chargersdk\src\drivers\bsp\src\retarget.c
D:\Documents\Projects\chargersdk\src\drivers\device\inc\RFIDReader_mt626.h
D:\Documents\Projects\chargersdk\src\drivers\device\inc\buzzer.h
D:\Documents\Projects\chargersdk\src\drivers\device\inc\card_m1.h
D:\Documents\Projects\chargersdk\src\drivers\device\inc\led.h
D:\Documents\Projects\chargersdk\src\drivers\device\src\RFIDReader_mt626.c
D:\Documents\Projects\chargersdk\src\drivers\device\src\buzzer.c
D:\Documents\Projects\chargersdk\src\drivers\device\src\card_m1.c
D:\Documents\Projects\chargersdk\src\drivers\device\src\led.c
D:\Documents\Projects\chargersdk\src\drivers\hal\CMSIS\Device\ST\STM32F4xx\Source\Templates\system_stm32f4xx.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Inc\stm32f4xx_hal_conf.h
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_cortex.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_crc.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_dma.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_dma2d.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_dma_ex.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_gpio.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_ltdc.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_ltdc_ex.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_nand.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_pwr.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_pwr_ex.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rcc.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rcc_ex.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rtc.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_rtc_ex.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_sdram.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_uart.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_hal_usart.c
D:\Documents\Projects\chargersdk\src\drivers\hal\STM32F4xx_HAL_Driver\Src\stm32f4xx_ll_fmc.c
D:\Documents\Projects\chargersdk\src\hmi\EVSEDLG.c
D:\Documents\Projects\chargersdk\src\hmi\HMI_Start.c
D:\Documents\Projects\chargersdk\src\hmi\TOUCH_Calibrate.c
D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\GUIConf.c
D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\GUIConf.h
D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\LCDConf_Lin_AT070.c
D:\Documents\Projects\chargersdk\src\middlewares\STemWin\Config\LCDConf_Lin_ATK_7016.c
D:\Documents\Projects\chargersdk\src\middlewares\STemWin\GUI_X\GUI_X_FreeRTOS.c
D:\Documents\Projects\chargersdk\src\middlewares\STemWin\GUI_X\GUI_X_Touch_Analog.c
D:\Documents\Projects\chargersdk\src\middlewares\camellia-BSD-1.2.0\camellia.c
D:\Documents\Projects\chargersdk\src\middlewares\camellia-BSD-1.2.0\camellia.h
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\diskdrv\ff_gen_drv.c
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\diskdrv\nand_diskio.c
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\diskio.c
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\ff.c
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\ff_ex.c
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\ffconf.h
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\option\syscall.c
D:\Documents\Projects\chargersdk\src\middlewares\fatfs\src\option\unicode.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-attr.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-cb.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-entity.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-file-fatfs.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-get.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-index.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-node.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-private.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-search.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-set.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\mxml-string.c
D:\Documents\Projects\chargersdk\src\middlewares\mxml-2.10\testmxml.c
D:\Documents\Projects\chargersdk\src\middlewares\tinysh\tinysh.c
D:\Documents\Projects\chargersdk\src\middlewares\userlib\inc\userlib_list.h
D:\Documents\Projects\chargersdk\src\middlewares\userlib\inc\xprintf.h
D:\Documents\Projects\chargersdk\src\middlewares\userlib\src\userlib_list.c
D:\Documents\Projects\chargersdk\src\middlewares\userlib\src\userlib_queue.c
D:\Documents\Projects\chargersdk\src\middlewares\userlib\src\xprintf.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOSConfig.h
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\croutine.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\event_groups.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\list.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\portable\GCC\ARM_CM4F\port.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\portable\GCC\ARM_CM4F\portmacro.h
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\portable\MemMang\heap_4.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\queue.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\tasks.c
D:\Documents\Projects\chargersdk\src\os\FreeRTOS\Source\timers.c
